/*! For license information please see main.ebfac4bb.js.LICENSE.txt */
!function(){var g={818:function(g){g.exports=function(){"use strict";return function(g,e,I){e.prototype.isBetween=function(g,e,t,n){var C=I(g),l=I(e),o="("===(n=n||"()")[0],a=")"===n[1];return(o?this.isAfter(C,t):!this.isBefore(C,t))&&(a?this.isBefore(l,t):!this.isAfter(l,t))||(o?this.isBefore(C,t):!this.isAfter(C,t))&&(a?this.isAfter(l,t):!this.isBefore(l,t))}}}()},253:function(g){g.exports=function(){"use strict";return function(g,e){e.prototype.isSameOrAfter=function(g,e){return this.isSame(g,e)||this.isAfter(g,e)}}}()},320:function(g){g.exports=function(){"use strict";return function(g,e){e.prototype.isSameOrBefore=function(g,e){return this.isSame(g,e)||this.isBefore(g,e)}}}()},36:function(g){g.exports=function(){"use strict";return function(g,e,I){var t=e.prototype,n=function(g){return g&&(g.indexOf?g:g.s)},C=function(g,e,I,t,C){var l=g.name?g:g.$locale(),o=n(l[e]),a=n(l[I]),r=o||a.map((function(g){return g.slice(0,t)}));if(!C)return r;var c=l.weekStart;return r.map((function(g,e){return r[(e+(c||0))%7]}))},l=function(){return I.Ls[I.locale()]},o=function(g,e){return g.formats[e]||function(g){return g.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(g,e,I){return e||I.slice(1)}))}(g.formats[e.toUpperCase()])},a=function(){var g=this;return{months:function(e){return e?e.format("MMMM"):C(g,"months")},monthsShort:function(e){return e?e.format("MMM"):C(g,"monthsShort","months",3)},firstDayOfWeek:function(){return g.$locale().weekStart||0},weekdays:function(e){return e?e.format("dddd"):C(g,"weekdays")},weekdaysMin:function(e){return e?e.format("dd"):C(g,"weekdaysMin","weekdays",2)},weekdaysShort:function(e){return e?e.format("ddd"):C(g,"weekdaysShort","weekdays",3)},longDateFormat:function(e){return o(g.$locale(),e)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};t.localeData=function(){return a.bind(this)()},I.localeData=function(){var g=l();return{firstDayOfWeek:function(){return g.weekStart||0},weekdays:function(){return I.weekdays()},weekdaysShort:function(){return I.weekdaysShort()},weekdaysMin:function(){return I.weekdaysMin()},months:function(){return I.months()},monthsShort:function(){return I.monthsShort()},longDateFormat:function(e){return o(g,e)},meridiem:g.meridiem,ordinal:g.ordinal}},I.months=function(){return C(l(),"months")},I.monthsShort=function(){return C(l(),"monthsShort","months",3)},I.weekdays=function(g){return C(l(),"weekdays",null,null,g)},I.weekdaysShort=function(g){return C(l(),"weekdaysShort","weekdays",3,g)},I.weekdaysMin=function(g){return C(l(),"weekdaysMin","weekdays",2,g)}}}()},893:function(g){g.exports=function(){"use strict";var g={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(e,I,t){var n=I.prototype,C=n.format;t.en.formats=g,n.format=function(e){void 0===e&&(e="YYYY-MM-DDTHH:mm:ssZ");var I=this.$locale().formats,t=function(e,I){return e.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(e,t,n){var C=n&&n.toUpperCase();return t||I[n]||g[n]||I[C].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(g,e,I){return e||I.slice(1)}))}))}(e,void 0===I?{}:I);return C.call(this,t)}}}()},26:function(g){g.exports=function(){"use strict";return function(g,e,I){var t=function(g,e){if(!e||!e.length||1===e.length&&!e[0]||1===e.length&&Array.isArray(e[0])&&!e[0].length)return null;var I;1===e.length&&e[0].length>0&&(e=e[0]),I=(e=e.filter((function(g){return g})))[0];for(var t=1;t<e.length;t+=1)e[t].isValid()&&!e[t][g](I)||(I=e[t]);return I};I.max=function(){var g=[].slice.call(arguments,0);return t("isAfter",g)},I.min=function(){var g=[].slice.call(arguments,0);return t("isBefore",g)}}}()},27:function(g){g.exports=function(){"use strict";var g="minute",e=/[+-]\d\d(?::?\d\d)?/g,I=/([+-]|\d\d)/g;return function(t,n,C){var l=n.prototype;C.utc=function(g){return new n({date:g,utc:!0,args:arguments})},l.utc=function(e){var I=C(this.toDate(),{locale:this.$L,utc:!0});return e?I.add(this.utcOffset(),g):I},l.local=function(){return C(this.toDate(),{locale:this.$L,utc:!1})};var o=l.parse;l.parse=function(g){g.utc&&(this.$u=!0),this.$utils().u(g.$offset)||(this.$offset=g.$offset),o.call(this,g)};var a=l.init;l.init=function(){if(this.$u){var g=this.$d;this.$y=g.getUTCFullYear(),this.$M=g.getUTCMonth(),this.$D=g.getUTCDate(),this.$W=g.getUTCDay(),this.$H=g.getUTCHours(),this.$m=g.getUTCMinutes(),this.$s=g.getUTCSeconds(),this.$ms=g.getUTCMilliseconds()}else a.call(this)};var r=l.utcOffset;l.utcOffset=function(t,n){var C=this.$utils().u;if(C(t))return this.$u?0:C(this.$offset)?r.call(this):this.$offset;if("string"==typeof t&&(t=function(g){void 0===g&&(g="");var t=g.match(e);if(!t)return null;var n=(""+t[0]).match(I)||["-",0,0],C=n[0],l=60*+n[1]+ +n[2];return 0===l?0:"+"===C?l:-l}(t),null===t))return this;var l=Math.abs(t)<=16?60*t:t,o=this;if(n)return o.$offset=l,o.$u=0===t,o;if(0!==t){var a=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(l+a,g)).$offset=l,o.$x.$localOffset=a}else o=this.utc();return o};var c=l.format;l.format=function(g){var e=g||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return c.call(this,e)},l.valueOf=function(){var g=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*g},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var i=l.toDate;l.toDate=function(g){return"s"===g&&this.$offset?C(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():i.call(this)};var A=l.diff;l.diff=function(g,e,I){if(g&&this.$u===g.$u)return A.call(this,g,e,I);var t=this.local(),n=C(g).local();return A.call(t,n,e,I)}}}()},618:function(g,e,I){var t;!function(){"use strict";var n=!("undefined"===typeof window||!window.document||!window.document.createElement),C={canUseDOM:n,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:n&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:n&&!!window.screen};void 0===(t=function(){return C}.call(e,I,e,g))||(g.exports=t)}()},110:function(g,e,I){"use strict";var t=I(309),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},C={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function a(g){return t.isMemo(g)?l:o[g.$$typeof]||n}o[t.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[t.Memo]=l;var r=Object.defineProperty,c=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,A=Object.getOwnPropertyDescriptor,s=Object.getPrototypeOf,d=Object.prototype;g.exports=function g(e,I,t){if("string"!==typeof I){if(d){var n=s(I);n&&n!==d&&g(e,n,t)}var l=c(I);i&&(l=l.concat(i(I)));for(var o=a(e),u=a(I),m=0;m<l.length;++m){var b=l[m];if(!C[b]&&(!t||!t[b])&&(!u||!u[b])&&(!o||!o[b])){var Z=A(I,b);try{r(e,b,Z)}catch(h){}}}}return e}},746:function(g,e){"use strict";var I="function"===typeof Symbol&&Symbol.for,t=I?Symbol.for("react.element"):60103,n=I?Symbol.for("react.portal"):60106,C=I?Symbol.for("react.fragment"):60107,l=I?Symbol.for("react.strict_mode"):60108,o=I?Symbol.for("react.profiler"):60114,a=I?Symbol.for("react.provider"):60109,r=I?Symbol.for("react.context"):60110,c=I?Symbol.for("react.async_mode"):60111,i=I?Symbol.for("react.concurrent_mode"):60111,A=I?Symbol.for("react.forward_ref"):60112,s=I?Symbol.for("react.suspense"):60113,d=I?Symbol.for("react.suspense_list"):60120,u=I?Symbol.for("react.memo"):60115,m=I?Symbol.for("react.lazy"):60116,b=I?Symbol.for("react.block"):60121,Z=I?Symbol.for("react.fundamental"):60117,h=I?Symbol.for("react.responder"):60118,p=I?Symbol.for("react.scope"):60119;function G(g){if("object"===typeof g&&null!==g){var e=g.$$typeof;switch(e){case t:switch(g=g.type){case c:case i:case C:case o:case l:case s:return g;default:switch(g=g&&g.$$typeof){case r:case A:case m:case u:case a:return g;default:return e}}case n:return e}}}function y(g){return G(g)===i}e.AsyncMode=c,e.ConcurrentMode=i,e.ContextConsumer=r,e.ContextProvider=a,e.Element=t,e.ForwardRef=A,e.Fragment=C,e.Lazy=m,e.Memo=u,e.Portal=n,e.Profiler=o,e.StrictMode=l,e.Suspense=s,e.isAsyncMode=function(g){return y(g)||G(g)===c},e.isConcurrentMode=y,e.isContextConsumer=function(g){return G(g)===r},e.isContextProvider=function(g){return G(g)===a},e.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===t},e.isForwardRef=function(g){return G(g)===A},e.isFragment=function(g){return G(g)===C},e.isLazy=function(g){return G(g)===m},e.isMemo=function(g){return G(g)===u},e.isPortal=function(g){return G(g)===n},e.isProfiler=function(g){return G(g)===o},e.isStrictMode=function(g){return G(g)===l},e.isSuspense=function(g){return G(g)===s},e.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===C||g===i||g===o||g===l||g===s||g===d||"object"===typeof g&&null!==g&&(g.$$typeof===m||g.$$typeof===u||g.$$typeof===a||g.$$typeof===r||g.$$typeof===A||g.$$typeof===Z||g.$$typeof===h||g.$$typeof===p||g.$$typeof===b)},e.typeOf=G},309:function(g,e,I){"use strict";g.exports=I(746)},176:function(g){"use strict";g.exports=function(g,e,I,t,n,C,l,o){if(!g){var a;if(void 0===e)a=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var r=[I,t,n,C,l,o],c=0;(a=new Error(e.replace(/%s/g,(function(){return r[c++]})))).name="Invariant Violation"}throw a.framesToPop=1,a}}},426:function(g,e,I){(g=I.nmd(g)).exports=function(){"use strict";var e,I;function t(){return e.apply(null,arguments)}function n(g){e=g}function C(g){return g instanceof Array||"[object Array]"===Object.prototype.toString.call(g)}function l(g){return null!=g&&"[object Object]"===Object.prototype.toString.call(g)}function o(g,e){return Object.prototype.hasOwnProperty.call(g,e)}function a(g){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(g).length;var e;for(e in g)if(o(g,e))return!1;return!0}function r(g){return void 0===g}function c(g){return"number"===typeof g||"[object Number]"===Object.prototype.toString.call(g)}function i(g){return g instanceof Date||"[object Date]"===Object.prototype.toString.call(g)}function A(g,e){var I,t=[],n=g.length;for(I=0;I<n;++I)t.push(e(g[I],I));return t}function s(g,e){for(var I in e)o(e,I)&&(g[I]=e[I]);return o(e,"toString")&&(g.toString=e.toString),o(e,"valueOf")&&(g.valueOf=e.valueOf),g}function d(g,e,I,t){return TI(g,e,I,t,!0).utc()}function u(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(g){return null==g._pf&&(g._pf=u()),g._pf}function b(g){if(null==g._isValid){var e=m(g),t=I.call(e.parsedDateParts,(function(g){return null!=g})),n=!isNaN(g._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t);if(g._strict&&(n=n&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(g))return n;g._isValid=n}return g._isValid}function Z(g){var e=d(NaN);return null!=g?s(m(e),g):m(e).userInvalidated=!0,e}I=Array.prototype.some?Array.prototype.some:function(g){var e,I=Object(this),t=I.length>>>0;for(e=0;e<t;e++)if(e in I&&g.call(this,I[e],e,I))return!0;return!1};var h=t.momentProperties=[],p=!1;function G(g,e){var I,t,n,C=h.length;if(r(e._isAMomentObject)||(g._isAMomentObject=e._isAMomentObject),r(e._i)||(g._i=e._i),r(e._f)||(g._f=e._f),r(e._l)||(g._l=e._l),r(e._strict)||(g._strict=e._strict),r(e._tzm)||(g._tzm=e._tzm),r(e._isUTC)||(g._isUTC=e._isUTC),r(e._offset)||(g._offset=e._offset),r(e._pf)||(g._pf=m(e)),r(e._locale)||(g._locale=e._locale),C>0)for(I=0;I<C;I++)r(n=e[t=h[I]])||(g[t]=n);return g}function y(g){G(this,g),this._d=new Date(null!=g._d?g._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===p&&(p=!0,t.updateOffset(this),p=!1)}function B(g){return g instanceof y||null!=g&&null!=g._isAMomentObject}function f(g){!1===t.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+g)}function S(g,e){var I=!0;return s((function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,g),I){var n,C,l,a=[],r=arguments.length;for(C=0;C<r;C++){if(n="","object"===typeof arguments[C]){for(l in n+="\n["+C+"] ",arguments[0])o(arguments[0],l)&&(n+=l+": "+arguments[0][l]+", ");n=n.slice(0,-2)}else n=arguments[C];a.push(n)}f(g+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),I=!1}return e.apply(this,arguments)}),e)}var W,V={};function v(g,e){null!=t.deprecationHandler&&t.deprecationHandler(g,e),V[g]||(f(e),V[g]=!0)}function R(g){return"undefined"!==typeof Function&&g instanceof Function||"[object Function]"===Object.prototype.toString.call(g)}function k(g){var e,I;for(I in g)o(g,I)&&(R(e=g[I])?this[I]=e:this["_"+I]=e);this._config=g,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function X(g,e){var I,t=s({},g);for(I in e)o(e,I)&&(l(g[I])&&l(e[I])?(t[I]={},s(t[I],g[I]),s(t[I],e[I])):null!=e[I]?t[I]=e[I]:delete t[I]);for(I in g)o(g,I)&&!o(e,I)&&l(g[I])&&(t[I]=s({},t[I]));return t}function J(g){null!=g&&this.set(g)}t.suppressDeprecationWarnings=!1,t.deprecationHandler=null,W=Object.keys?Object.keys:function(g){var e,I=[];for(e in g)o(g,e)&&I.push(e);return I};var Y={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function H(g,e,I){var t=this._calendar[g]||this._calendar.sameElse;return R(t)?t.call(e,I):t}function w(g,e,I){var t=""+Math.abs(g),n=e-t.length;return(g>=0?I?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+t}var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,K=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,F={},x={};function E(g,e,I,t){var n=t;"string"===typeof t&&(n=function(){return this[t]()}),g&&(x[g]=n),e&&(x[e[0]]=function(){return w(n.apply(this,arguments),e[1],e[2])}),I&&(x[I]=function(){return this.localeData().ordinal(n.apply(this,arguments),g)})}function z(g){return g.match(/\[[\s\S]/)?g.replace(/^\[|\]$/g,""):g.replace(/\\/g,"")}function M(g){var e,I,t=g.match(N);for(e=0,I=t.length;e<I;e++)x[t[e]]?t[e]=x[t[e]]:t[e]=z(t[e]);return function(e){var n,C="";for(n=0;n<I;n++)C+=R(t[n])?t[n].call(e,g):t[n];return C}}function U(g,e){return g.isValid()?(e=D(e,g.localeData()),F[e]=F[e]||M(e),F[e](g)):g.localeData().invalidDate()}function D(g,e){var I=5;function t(g){return e.longDateFormat(g)||g}for(K.lastIndex=0;I>=0&&K.test(g);)g=g.replace(K,t),K.lastIndex=0,I-=1;return g}var Q={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function L(g){var e=this._longDateFormat[g],I=this._longDateFormat[g.toUpperCase()];return e||!I?e:(this._longDateFormat[g]=I.match(N).map((function(g){return"MMMM"===g||"MM"===g||"DD"===g||"dddd"===g?g.slice(1):g})).join(""),this._longDateFormat[g])}var T="Invalid date";function j(){return this._invalidDate}var O="%d",P=/\d{1,2}/;function q(g){return this._ordinal.replace("%d",g)}var _={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function $(g,e,I,t){var n=this._relativeTime[I];return R(n)?n(g,e,I,t):n.replace(/%d/i,g)}function gg(g,e){var I=this._relativeTime[g>0?"future":"past"];return R(I)?I(e):I.replace(/%s/i,e)}var eg={};function Ig(g,e){var I=g.toLowerCase();eg[I]=eg[I+"s"]=eg[e]=g}function tg(g){return"string"===typeof g?eg[g]||eg[g.toLowerCase()]:void 0}function ng(g){var e,I,t={};for(I in g)o(g,I)&&(e=tg(I))&&(t[e]=g[I]);return t}var Cg={};function lg(g,e){Cg[g]=e}function og(g){var e,I=[];for(e in g)o(g,e)&&I.push({unit:e,priority:Cg[e]});return I.sort((function(g,e){return g.priority-e.priority})),I}function ag(g){return g%4===0&&g%100!==0||g%400===0}function rg(g){return g<0?Math.ceil(g)||0:Math.floor(g)}function cg(g){var e=+g,I=0;return 0!==e&&isFinite(e)&&(I=rg(e)),I}function ig(g,e){return function(I){return null!=I?(sg(this,g,I),t.updateOffset(this,e),this):Ag(this,g)}}function Ag(g,e){return g.isValid()?g._d["get"+(g._isUTC?"UTC":"")+e]():NaN}function sg(g,e,I){g.isValid()&&!isNaN(I)&&("FullYear"===e&&ag(g.year())&&1===g.month()&&29===g.date()?(I=cg(I),g._d["set"+(g._isUTC?"UTC":"")+e](I,g.month(),$g(I,g.month()))):g._d["set"+(g._isUTC?"UTC":"")+e](I))}function dg(g){return R(this[g=tg(g)])?this[g]():this}function ug(g,e){if("object"===typeof g){var I,t=og(g=ng(g)),n=t.length;for(I=0;I<n;I++)this[t[I].unit](g[t[I].unit])}else if(R(this[g=tg(g)]))return this[g](e);return this}var mg,bg=/\d/,Zg=/\d\d/,hg=/\d{3}/,pg=/\d{4}/,Gg=/[+-]?\d{6}/,yg=/\d\d?/,Bg=/\d\d\d\d?/,fg=/\d\d\d\d\d\d?/,Sg=/\d{1,3}/,Wg=/\d{1,4}/,Vg=/[+-]?\d{1,6}/,vg=/\d+/,Rg=/[+-]?\d+/,kg=/Z|[+-]\d\d:?\d\d/gi,Xg=/Z|[+-]\d\d(?::?\d\d)?/gi,Jg=/[+-]?\d+(\.\d{1,3})?/,Yg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function Hg(g,e,I){mg[g]=R(e)?e:function(g,t){return g&&I?I:e}}function wg(g,e){return o(mg,g)?mg[g](e._strict,e._locale):new RegExp(Ng(g))}function Ng(g){return Kg(g.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(g,e,I,t,n){return e||I||t||n})))}function Kg(g){return g.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}mg={};var Fg={};function xg(g,e){var I,t,n=e;for("string"===typeof g&&(g=[g]),c(e)&&(n=function(g,I){I[e]=cg(g)}),t=g.length,I=0;I<t;I++)Fg[g[I]]=n}function Eg(g,e){xg(g,(function(g,I,t,n){t._w=t._w||{},e(g,t._w,t,n)}))}function zg(g,e,I){null!=e&&o(Fg,g)&&Fg[g](e,I._a,I,g)}var Mg,Ug=0,Dg=1,Qg=2,Lg=3,Tg=4,jg=5,Og=6,Pg=7,qg=8;function _g(g,e){return(g%e+e)%e}function $g(g,e){if(isNaN(g)||isNaN(e))return NaN;var I=_g(e,12);return g+=(e-I)/12,1===I?ag(g)?29:28:31-I%7%2}Mg=Array.prototype.indexOf?Array.prototype.indexOf:function(g){var e;for(e=0;e<this.length;++e)if(this[e]===g)return e;return-1},E("M",["MM",2],"Mo",(function(){return this.month()+1})),E("MMM",0,0,(function(g){return this.localeData().monthsShort(this,g)})),E("MMMM",0,0,(function(g){return this.localeData().months(this,g)})),Ig("month","M"),lg("month",8),Hg("M",yg),Hg("MM",yg,Zg),Hg("MMM",(function(g,e){return e.monthsShortRegex(g)})),Hg("MMMM",(function(g,e){return e.monthsRegex(g)})),xg(["M","MM"],(function(g,e){e[Dg]=cg(g)-1})),xg(["MMM","MMMM"],(function(g,e,I,t){var n=I._locale.monthsParse(g,t,I._strict);null!=n?e[Dg]=n:m(I).invalidMonth=g}));var ge="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ee="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ie=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,te=Yg,ne=Yg;function Ce(g,e){return g?C(this._months)?this._months[g.month()]:this._months[(this._months.isFormat||Ie).test(e)?"format":"standalone"][g.month()]:C(this._months)?this._months:this._months.standalone}function le(g,e){return g?C(this._monthsShort)?this._monthsShort[g.month()]:this._monthsShort[Ie.test(e)?"format":"standalone"][g.month()]:C(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function oe(g,e,I){var t,n,C,l=g.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],t=0;t<12;++t)C=d([2e3,t]),this._shortMonthsParse[t]=this.monthsShort(C,"").toLocaleLowerCase(),this._longMonthsParse[t]=this.months(C,"").toLocaleLowerCase();return I?"MMM"===e?-1!==(n=Mg.call(this._shortMonthsParse,l))?n:null:-1!==(n=Mg.call(this._longMonthsParse,l))?n:null:"MMM"===e?-1!==(n=Mg.call(this._shortMonthsParse,l))||-1!==(n=Mg.call(this._longMonthsParse,l))?n:null:-1!==(n=Mg.call(this._longMonthsParse,l))||-1!==(n=Mg.call(this._shortMonthsParse,l))?n:null}function ae(g,e,I){var t,n,C;if(this._monthsParseExact)return oe.call(this,g,e,I);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),t=0;t<12;t++){if(n=d([2e3,t]),I&&!this._longMonthsParse[t]&&(this._longMonthsParse[t]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[t]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),I||this._monthsParse[t]||(C="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(C.replace(".",""),"i")),I&&"MMMM"===e&&this._longMonthsParse[t].test(g))return t;if(I&&"MMM"===e&&this._shortMonthsParse[t].test(g))return t;if(!I&&this._monthsParse[t].test(g))return t}}function re(g,e){var I;if(!g.isValid())return g;if("string"===typeof e)if(/^\d+$/.test(e))e=cg(e);else if(!c(e=g.localeData().monthsParse(e)))return g;return I=Math.min(g.date(),$g(g.year(),e)),g._d["set"+(g._isUTC?"UTC":"")+"Month"](e,I),g}function ce(g){return null!=g?(re(this,g),t.updateOffset(this,!0),this):Ag(this,"Month")}function ie(){return $g(this.year(),this.month())}function Ae(g){return this._monthsParseExact?(o(this,"_monthsRegex")||de.call(this),g?this._monthsShortStrictRegex:this._monthsShortRegex):(o(this,"_monthsShortRegex")||(this._monthsShortRegex=te),this._monthsShortStrictRegex&&g?this._monthsShortStrictRegex:this._monthsShortRegex)}function se(g){return this._monthsParseExact?(o(this,"_monthsRegex")||de.call(this),g?this._monthsStrictRegex:this._monthsRegex):(o(this,"_monthsRegex")||(this._monthsRegex=ne),this._monthsStrictRegex&&g?this._monthsStrictRegex:this._monthsRegex)}function de(){function g(g,e){return e.length-g.length}var e,I,t=[],n=[],C=[];for(e=0;e<12;e++)I=d([2e3,e]),t.push(this.monthsShort(I,"")),n.push(this.months(I,"")),C.push(this.months(I,"")),C.push(this.monthsShort(I,""));for(t.sort(g),n.sort(g),C.sort(g),e=0;e<12;e++)t[e]=Kg(t[e]),n[e]=Kg(n[e]);for(e=0;e<24;e++)C[e]=Kg(C[e]);this._monthsRegex=new RegExp("^("+C.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function ue(g){return ag(g)?366:365}E("Y",0,0,(function(){var g=this.year();return g<=9999?w(g,4):"+"+g})),E(0,["YY",2],0,(function(){return this.year()%100})),E(0,["YYYY",4],0,"year"),E(0,["YYYYY",5],0,"year"),E(0,["YYYYYY",6,!0],0,"year"),Ig("year","y"),lg("year",1),Hg("Y",Rg),Hg("YY",yg,Zg),Hg("YYYY",Wg,pg),Hg("YYYYY",Vg,Gg),Hg("YYYYYY",Vg,Gg),xg(["YYYYY","YYYYYY"],Ug),xg("YYYY",(function(g,e){e[Ug]=2===g.length?t.parseTwoDigitYear(g):cg(g)})),xg("YY",(function(g,e){e[Ug]=t.parseTwoDigitYear(g)})),xg("Y",(function(g,e){e[Ug]=parseInt(g,10)})),t.parseTwoDigitYear=function(g){return cg(g)+(cg(g)>68?1900:2e3)};var me=ig("FullYear",!0);function be(){return ag(this.year())}function Ze(g,e,I,t,n,C,l){var o;return g<100&&g>=0?(o=new Date(g+400,e,I,t,n,C,l),isFinite(o.getFullYear())&&o.setFullYear(g)):o=new Date(g,e,I,t,n,C,l),o}function he(g){var e,I;return g<100&&g>=0?((I=Array.prototype.slice.call(arguments))[0]=g+400,e=new Date(Date.UTC.apply(null,I)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(g)):e=new Date(Date.UTC.apply(null,arguments)),e}function pe(g,e,I){var t=7+e-I;return-(7+he(g,0,t).getUTCDay()-e)%7+t-1}function Ge(g,e,I,t,n){var C,l,o=1+7*(e-1)+(7+I-t)%7+pe(g,t,n);return o<=0?l=ue(C=g-1)+o:o>ue(g)?(C=g+1,l=o-ue(g)):(C=g,l=o),{year:C,dayOfYear:l}}function ye(g,e,I){var t,n,C=pe(g.year(),e,I),l=Math.floor((g.dayOfYear()-C-1)/7)+1;return l<1?t=l+Be(n=g.year()-1,e,I):l>Be(g.year(),e,I)?(t=l-Be(g.year(),e,I),n=g.year()+1):(n=g.year(),t=l),{week:t,year:n}}function Be(g,e,I){var t=pe(g,e,I),n=pe(g+1,e,I);return(ue(g)-t+n)/7}function fe(g){return ye(g,this._week.dow,this._week.doy).week}E("w",["ww",2],"wo","week"),E("W",["WW",2],"Wo","isoWeek"),Ig("week","w"),Ig("isoWeek","W"),lg("week",5),lg("isoWeek",5),Hg("w",yg),Hg("ww",yg,Zg),Hg("W",yg),Hg("WW",yg,Zg),Eg(["w","ww","W","WW"],(function(g,e,I,t){e[t.substr(0,1)]=cg(g)}));var Se={dow:0,doy:6};function We(){return this._week.dow}function Ve(){return this._week.doy}function ve(g){var e=this.localeData().week(this);return null==g?e:this.add(7*(g-e),"d")}function Re(g){var e=ye(this,1,4).week;return null==g?e:this.add(7*(g-e),"d")}function ke(g,e){return"string"!==typeof g?g:isNaN(g)?"number"===typeof(g=e.weekdaysParse(g))?g:null:parseInt(g,10)}function Xe(g,e){return"string"===typeof g?e.weekdaysParse(g)%7||7:isNaN(g)?null:g}function Je(g,e){return g.slice(e,7).concat(g.slice(0,e))}E("d",0,"do","day"),E("dd",0,0,(function(g){return this.localeData().weekdaysMin(this,g)})),E("ddd",0,0,(function(g){return this.localeData().weekdaysShort(this,g)})),E("dddd",0,0,(function(g){return this.localeData().weekdays(this,g)})),E("e",0,0,"weekday"),E("E",0,0,"isoWeekday"),Ig("day","d"),Ig("weekday","e"),Ig("isoWeekday","E"),lg("day",11),lg("weekday",11),lg("isoWeekday",11),Hg("d",yg),Hg("e",yg),Hg("E",yg),Hg("dd",(function(g,e){return e.weekdaysMinRegex(g)})),Hg("ddd",(function(g,e){return e.weekdaysShortRegex(g)})),Hg("dddd",(function(g,e){return e.weekdaysRegex(g)})),Eg(["dd","ddd","dddd"],(function(g,e,I,t){var n=I._locale.weekdaysParse(g,t,I._strict);null!=n?e.d=n:m(I).invalidWeekday=g})),Eg(["d","e","E"],(function(g,e,I,t){e[t]=cg(g)}));var Ye="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),He="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),we="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ne=Yg,Ke=Yg,Fe=Yg;function xe(g,e){var I=C(this._weekdays)?this._weekdays:this._weekdays[g&&!0!==g&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===g?Je(I,this._week.dow):g?I[g.day()]:I}function Ee(g){return!0===g?Je(this._weekdaysShort,this._week.dow):g?this._weekdaysShort[g.day()]:this._weekdaysShort}function ze(g){return!0===g?Je(this._weekdaysMin,this._week.dow):g?this._weekdaysMin[g.day()]:this._weekdaysMin}function Me(g,e,I){var t,n,C,l=g.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],t=0;t<7;++t)C=d([2e3,1]).day(t),this._minWeekdaysParse[t]=this.weekdaysMin(C,"").toLocaleLowerCase(),this._shortWeekdaysParse[t]=this.weekdaysShort(C,"").toLocaleLowerCase(),this._weekdaysParse[t]=this.weekdays(C,"").toLocaleLowerCase();return I?"dddd"===e?-1!==(n=Mg.call(this._weekdaysParse,l))?n:null:"ddd"===e?-1!==(n=Mg.call(this._shortWeekdaysParse,l))?n:null:-1!==(n=Mg.call(this._minWeekdaysParse,l))?n:null:"dddd"===e?-1!==(n=Mg.call(this._weekdaysParse,l))||-1!==(n=Mg.call(this._shortWeekdaysParse,l))||-1!==(n=Mg.call(this._minWeekdaysParse,l))?n:null:"ddd"===e?-1!==(n=Mg.call(this._shortWeekdaysParse,l))||-1!==(n=Mg.call(this._weekdaysParse,l))||-1!==(n=Mg.call(this._minWeekdaysParse,l))?n:null:-1!==(n=Mg.call(this._minWeekdaysParse,l))||-1!==(n=Mg.call(this._weekdaysParse,l))||-1!==(n=Mg.call(this._shortWeekdaysParse,l))?n:null}function Ue(g,e,I){var t,n,C;if(this._weekdaysParseExact)return Me.call(this,g,e,I);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),t=0;t<7;t++){if(n=d([2e3,1]).day(t),I&&!this._fullWeekdaysParse[t]&&(this._fullWeekdaysParse[t]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[t]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[t]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[t]||(C="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(C.replace(".",""),"i")),I&&"dddd"===e&&this._fullWeekdaysParse[t].test(g))return t;if(I&&"ddd"===e&&this._shortWeekdaysParse[t].test(g))return t;if(I&&"dd"===e&&this._minWeekdaysParse[t].test(g))return t;if(!I&&this._weekdaysParse[t].test(g))return t}}function De(g){if(!this.isValid())return null!=g?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=g?(g=ke(g,this.localeData()),this.add(g-e,"d")):e}function Qe(g){if(!this.isValid())return null!=g?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==g?e:this.add(g-e,"d")}function Le(g){if(!this.isValid())return null!=g?this:NaN;if(null!=g){var e=Xe(g,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7}function Te(g){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Pe.call(this),g?this._weekdaysStrictRegex:this._weekdaysRegex):(o(this,"_weekdaysRegex")||(this._weekdaysRegex=Ne),this._weekdaysStrictRegex&&g?this._weekdaysStrictRegex:this._weekdaysRegex)}function je(g){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Pe.call(this),g?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ke),this._weekdaysShortStrictRegex&&g?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Oe(g){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Pe.call(this),g?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Fe),this._weekdaysMinStrictRegex&&g?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Pe(){function g(g,e){return e.length-g.length}var e,I,t,n,C,l=[],o=[],a=[],r=[];for(e=0;e<7;e++)I=d([2e3,1]).day(e),t=Kg(this.weekdaysMin(I,"")),n=Kg(this.weekdaysShort(I,"")),C=Kg(this.weekdays(I,"")),l.push(t),o.push(n),a.push(C),r.push(t),r.push(n),r.push(C);l.sort(g),o.sort(g),a.sort(g),r.sort(g),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+l.join("|")+")","i")}function qe(){return this.hours()%12||12}function _e(){return this.hours()||24}function $e(g,e){E(g,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function gI(g,e){return e._meridiemParse}function eI(g){return"p"===(g+"").toLowerCase().charAt(0)}E("H",["HH",2],0,"hour"),E("h",["hh",2],0,qe),E("k",["kk",2],0,_e),E("hmm",0,0,(function(){return""+qe.apply(this)+w(this.minutes(),2)})),E("hmmss",0,0,(function(){return""+qe.apply(this)+w(this.minutes(),2)+w(this.seconds(),2)})),E("Hmm",0,0,(function(){return""+this.hours()+w(this.minutes(),2)})),E("Hmmss",0,0,(function(){return""+this.hours()+w(this.minutes(),2)+w(this.seconds(),2)})),$e("a",!0),$e("A",!1),Ig("hour","h"),lg("hour",13),Hg("a",gI),Hg("A",gI),Hg("H",yg),Hg("h",yg),Hg("k",yg),Hg("HH",yg,Zg),Hg("hh",yg,Zg),Hg("kk",yg,Zg),Hg("hmm",Bg),Hg("hmmss",fg),Hg("Hmm",Bg),Hg("Hmmss",fg),xg(["H","HH"],Lg),xg(["k","kk"],(function(g,e,I){var t=cg(g);e[Lg]=24===t?0:t})),xg(["a","A"],(function(g,e,I){I._isPm=I._locale.isPM(g),I._meridiem=g})),xg(["h","hh"],(function(g,e,I){e[Lg]=cg(g),m(I).bigHour=!0})),xg("hmm",(function(g,e,I){var t=g.length-2;e[Lg]=cg(g.substr(0,t)),e[Tg]=cg(g.substr(t)),m(I).bigHour=!0})),xg("hmmss",(function(g,e,I){var t=g.length-4,n=g.length-2;e[Lg]=cg(g.substr(0,t)),e[Tg]=cg(g.substr(t,2)),e[jg]=cg(g.substr(n)),m(I).bigHour=!0})),xg("Hmm",(function(g,e,I){var t=g.length-2;e[Lg]=cg(g.substr(0,t)),e[Tg]=cg(g.substr(t))})),xg("Hmmss",(function(g,e,I){var t=g.length-4,n=g.length-2;e[Lg]=cg(g.substr(0,t)),e[Tg]=cg(g.substr(t,2)),e[jg]=cg(g.substr(n))}));var II=/[ap]\.?m?\.?/i,tI=ig("Hours",!0);function nI(g,e,I){return g>11?I?"pm":"PM":I?"am":"AM"}var CI,lI={calendar:Y,longDateFormat:Q,invalidDate:T,ordinal:O,dayOfMonthOrdinalParse:P,relativeTime:_,months:ge,monthsShort:ee,week:Se,weekdays:Ye,weekdaysMin:we,weekdaysShort:He,meridiemParse:II},oI={},aI={};function rI(g,e){var I,t=Math.min(g.length,e.length);for(I=0;I<t;I+=1)if(g[I]!==e[I])return I;return t}function cI(g){return g?g.toLowerCase().replace("_","-"):g}function iI(g){for(var e,I,t,n,C=0;C<g.length;){for(e=(n=cI(g[C]).split("-")).length,I=(I=cI(g[C+1]))?I.split("-"):null;e>0;){if(t=sI(n.slice(0,e).join("-")))return t;if(I&&I.length>=e&&rI(n,I)>=e-1)break;e--}C++}return CI}function AI(g){return null!=g.match("^[^/\\\\]*$")}function sI(e){var I=null;if(void 0===oI[e]&&g&&g.exports&&AI(e))try{I=CI._abbr,Object(function(){var g=new Error("Cannot find module 'undefined'");throw g.code="MODULE_NOT_FOUND",g}()),dI(I)}catch(t){oI[e]=null}return oI[e]}function dI(g,e){var I;return g&&((I=r(e)?bI(g):uI(g,e))?CI=I:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+g+" not found. Did you forget to load it?")),CI._abbr}function uI(g,e){if(null!==e){var I,t=lI;if(e.abbr=g,null!=oI[g])v("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),t=oI[g]._config;else if(null!=e.parentLocale)if(null!=oI[e.parentLocale])t=oI[e.parentLocale]._config;else{if(null==(I=sI(e.parentLocale)))return aI[e.parentLocale]||(aI[e.parentLocale]=[]),aI[e.parentLocale].push({name:g,config:e}),null;t=I._config}return oI[g]=new J(X(t,e)),aI[g]&&aI[g].forEach((function(g){uI(g.name,g.config)})),dI(g),oI[g]}return delete oI[g],null}function mI(g,e){if(null!=e){var I,t,n=lI;null!=oI[g]&&null!=oI[g].parentLocale?oI[g].set(X(oI[g]._config,e)):(null!=(t=sI(g))&&(n=t._config),e=X(n,e),null==t&&(e.abbr=g),(I=new J(e)).parentLocale=oI[g],oI[g]=I),dI(g)}else null!=oI[g]&&(null!=oI[g].parentLocale?(oI[g]=oI[g].parentLocale,g===dI()&&dI(g)):null!=oI[g]&&delete oI[g]);return oI[g]}function bI(g){var e;if(g&&g._locale&&g._locale._abbr&&(g=g._locale._abbr),!g)return CI;if(!C(g)){if(e=sI(g))return e;g=[g]}return iI(g)}function ZI(){return W(oI)}function hI(g){var e,I=g._a;return I&&-2===m(g).overflow&&(e=I[Dg]<0||I[Dg]>11?Dg:I[Qg]<1||I[Qg]>$g(I[Ug],I[Dg])?Qg:I[Lg]<0||I[Lg]>24||24===I[Lg]&&(0!==I[Tg]||0!==I[jg]||0!==I[Og])?Lg:I[Tg]<0||I[Tg]>59?Tg:I[jg]<0||I[jg]>59?jg:I[Og]<0||I[Og]>999?Og:-1,m(g)._overflowDayOfYear&&(e<Ug||e>Qg)&&(e=Qg),m(g)._overflowWeeks&&-1===e&&(e=Pg),m(g)._overflowWeekday&&-1===e&&(e=qg),m(g).overflow=e),g}var pI=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,GI=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yI=/Z|[+-]\d\d(?::?\d\d)?/,BI=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],fI=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],SI=/^\/?Date\((-?\d+)/i,WI=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,VI={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function vI(g){var e,I,t,n,C,l,o=g._i,a=pI.exec(o)||GI.exec(o),r=BI.length,c=fI.length;if(a){for(m(g).iso=!0,e=0,I=r;e<I;e++)if(BI[e][1].exec(a[1])){n=BI[e][0],t=!1!==BI[e][2];break}if(null==n)return void(g._isValid=!1);if(a[3]){for(e=0,I=c;e<I;e++)if(fI[e][1].exec(a[3])){C=(a[2]||" ")+fI[e][0];break}if(null==C)return void(g._isValid=!1)}if(!t&&null!=C)return void(g._isValid=!1);if(a[4]){if(!yI.exec(a[4]))return void(g._isValid=!1);l="Z"}g._f=n+(C||"")+(l||""),EI(g)}else g._isValid=!1}function RI(g,e,I,t,n,C){var l=[kI(g),ee.indexOf(e),parseInt(I,10),parseInt(t,10),parseInt(n,10)];return C&&l.push(parseInt(C,10)),l}function kI(g){var e=parseInt(g,10);return e<=49?2e3+e:e<=999?1900+e:e}function XI(g){return g.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function JI(g,e,I){return!g||He.indexOf(g)===new Date(e[0],e[1],e[2]).getDay()||(m(I).weekdayMismatch=!0,I._isValid=!1,!1)}function YI(g,e,I){if(g)return VI[g];if(e)return 0;var t=parseInt(I,10),n=t%100;return(t-n)/100*60+n}function HI(g){var e,I=WI.exec(XI(g._i));if(I){if(e=RI(I[4],I[3],I[2],I[5],I[6],I[7]),!JI(I[1],e,g))return;g._a=e,g._tzm=YI(I[8],I[9],I[10]),g._d=he.apply(null,g._a),g._d.setUTCMinutes(g._d.getUTCMinutes()-g._tzm),m(g).rfc2822=!0}else g._isValid=!1}function wI(g){var e=SI.exec(g._i);null===e?(vI(g),!1===g._isValid&&(delete g._isValid,HI(g),!1===g._isValid&&(delete g._isValid,g._strict?g._isValid=!1:t.createFromInputFallback(g)))):g._d=new Date(+e[1])}function NI(g,e,I){return null!=g?g:null!=e?e:I}function KI(g){var e=new Date(t.now());return g._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function FI(g){var e,I,t,n,C,l=[];if(!g._d){for(t=KI(g),g._w&&null==g._a[Qg]&&null==g._a[Dg]&&xI(g),null!=g._dayOfYear&&(C=NI(g._a[Ug],t[Ug]),(g._dayOfYear>ue(C)||0===g._dayOfYear)&&(m(g)._overflowDayOfYear=!0),I=he(C,0,g._dayOfYear),g._a[Dg]=I.getUTCMonth(),g._a[Qg]=I.getUTCDate()),e=0;e<3&&null==g._a[e];++e)g._a[e]=l[e]=t[e];for(;e<7;e++)g._a[e]=l[e]=null==g._a[e]?2===e?1:0:g._a[e];24===g._a[Lg]&&0===g._a[Tg]&&0===g._a[jg]&&0===g._a[Og]&&(g._nextDay=!0,g._a[Lg]=0),g._d=(g._useUTC?he:Ze).apply(null,l),n=g._useUTC?g._d.getUTCDay():g._d.getDay(),null!=g._tzm&&g._d.setUTCMinutes(g._d.getUTCMinutes()-g._tzm),g._nextDay&&(g._a[Lg]=24),g._w&&"undefined"!==typeof g._w.d&&g._w.d!==n&&(m(g).weekdayMismatch=!0)}}function xI(g){var e,I,t,n,C,l,o,a,r;null!=(e=g._w).GG||null!=e.W||null!=e.E?(C=1,l=4,I=NI(e.GG,g._a[Ug],ye(jI(),1,4).year),t=NI(e.W,1),((n=NI(e.E,1))<1||n>7)&&(a=!0)):(C=g._locale._week.dow,l=g._locale._week.doy,r=ye(jI(),C,l),I=NI(e.gg,g._a[Ug],r.year),t=NI(e.w,r.week),null!=e.d?((n=e.d)<0||n>6)&&(a=!0):null!=e.e?(n=e.e+C,(e.e<0||e.e>6)&&(a=!0)):n=C),t<1||t>Be(I,C,l)?m(g)._overflowWeeks=!0:null!=a?m(g)._overflowWeekday=!0:(o=Ge(I,t,n,C,l),g._a[Ug]=o.year,g._dayOfYear=o.dayOfYear)}function EI(g){if(g._f!==t.ISO_8601)if(g._f!==t.RFC_2822){g._a=[],m(g).empty=!0;var e,I,n,C,l,o,a,r=""+g._i,c=r.length,i=0;for(a=(n=D(g._f,g._locale).match(N)||[]).length,e=0;e<a;e++)C=n[e],(I=(r.match(wg(C,g))||[])[0])&&((l=r.substr(0,r.indexOf(I))).length>0&&m(g).unusedInput.push(l),r=r.slice(r.indexOf(I)+I.length),i+=I.length),x[C]?(I?m(g).empty=!1:m(g).unusedTokens.push(C),zg(C,I,g)):g._strict&&!I&&m(g).unusedTokens.push(C);m(g).charsLeftOver=c-i,r.length>0&&m(g).unusedInput.push(r),g._a[Lg]<=12&&!0===m(g).bigHour&&g._a[Lg]>0&&(m(g).bigHour=void 0),m(g).parsedDateParts=g._a.slice(0),m(g).meridiem=g._meridiem,g._a[Lg]=zI(g._locale,g._a[Lg],g._meridiem),null!==(o=m(g).era)&&(g._a[Ug]=g._locale.erasConvertYear(o,g._a[Ug])),FI(g),hI(g)}else HI(g);else vI(g)}function zI(g,e,I){var t;return null==I?e:null!=g.meridiemHour?g.meridiemHour(e,I):null!=g.isPM?((t=g.isPM(I))&&e<12&&(e+=12),t||12!==e||(e=0),e):e}function MI(g){var e,I,t,n,C,l,o=!1,a=g._f.length;if(0===a)return m(g).invalidFormat=!0,void(g._d=new Date(NaN));for(n=0;n<a;n++)C=0,l=!1,e=G({},g),null!=g._useUTC&&(e._useUTC=g._useUTC),e._f=g._f[n],EI(e),b(e)&&(l=!0),C+=m(e).charsLeftOver,C+=10*m(e).unusedTokens.length,m(e).score=C,o?C<t&&(t=C,I=e):(null==t||C<t||l)&&(t=C,I=e,l&&(o=!0));s(g,I||e)}function UI(g){if(!g._d){var e=ng(g._i),I=void 0===e.day?e.date:e.day;g._a=A([e.year,e.month,I,e.hour,e.minute,e.second,e.millisecond],(function(g){return g&&parseInt(g,10)})),FI(g)}}function DI(g){var e=new y(hI(QI(g)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function QI(g){var e=g._i,I=g._f;return g._locale=g._locale||bI(g._l),null===e||void 0===I&&""===e?Z({nullInput:!0}):("string"===typeof e&&(g._i=e=g._locale.preparse(e)),B(e)?new y(hI(e)):(i(e)?g._d=e:C(I)?MI(g):I?EI(g):LI(g),b(g)||(g._d=null),g))}function LI(g){var e=g._i;r(e)?g._d=new Date(t.now()):i(e)?g._d=new Date(e.valueOf()):"string"===typeof e?wI(g):C(e)?(g._a=A(e.slice(0),(function(g){return parseInt(g,10)})),FI(g)):l(e)?UI(g):c(e)?g._d=new Date(e):t.createFromInputFallback(g)}function TI(g,e,I,t,n){var o={};return!0!==e&&!1!==e||(t=e,e=void 0),!0!==I&&!1!==I||(t=I,I=void 0),(l(g)&&a(g)||C(g)&&0===g.length)&&(g=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=n,o._l=I,o._i=g,o._f=e,o._strict=t,DI(o)}function jI(g,e,I,t){return TI(g,e,I,t,!1)}t.createFromInputFallback=S("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(g){g._d=new Date(g._i+(g._useUTC?" UTC":""))})),t.ISO_8601=function(){},t.RFC_2822=function(){};var OI=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var g=jI.apply(null,arguments);return this.isValid()&&g.isValid()?g<this?this:g:Z()})),PI=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var g=jI.apply(null,arguments);return this.isValid()&&g.isValid()?g>this?this:g:Z()}));function qI(g,e){var I,t;if(1===e.length&&C(e[0])&&(e=e[0]),!e.length)return jI();for(I=e[0],t=1;t<e.length;++t)e[t].isValid()&&!e[t][g](I)||(I=e[t]);return I}function _I(){return qI("isBefore",[].slice.call(arguments,0))}function $I(){return qI("isAfter",[].slice.call(arguments,0))}var gt=function(){return Date.now?Date.now():+new Date},et=["year","quarter","month","week","day","hour","minute","second","millisecond"];function It(g){var e,I,t=!1,n=et.length;for(e in g)if(o(g,e)&&(-1===Mg.call(et,e)||null!=g[e]&&isNaN(g[e])))return!1;for(I=0;I<n;++I)if(g[et[I]]){if(t)return!1;parseFloat(g[et[I]])!==cg(g[et[I]])&&(t=!0)}return!0}function tt(){return this._isValid}function nt(){return Vt(NaN)}function Ct(g){var e=ng(g),I=e.year||0,t=e.quarter||0,n=e.month||0,C=e.week||e.isoWeek||0,l=e.day||0,o=e.hour||0,a=e.minute||0,r=e.second||0,c=e.millisecond||0;this._isValid=It(e),this._milliseconds=+c+1e3*r+6e4*a+1e3*o*60*60,this._days=+l+7*C,this._months=+n+3*t+12*I,this._data={},this._locale=bI(),this._bubble()}function lt(g){return g instanceof Ct}function ot(g){return g<0?-1*Math.round(-1*g):Math.round(g)}function at(g,e,I){var t,n=Math.min(g.length,e.length),C=Math.abs(g.length-e.length),l=0;for(t=0;t<n;t++)(I&&g[t]!==e[t]||!I&&cg(g[t])!==cg(e[t]))&&l++;return l+C}function rt(g,e){E(g,0,0,(function(){var g=this.utcOffset(),I="+";return g<0&&(g=-g,I="-"),I+w(~~(g/60),2)+e+w(~~g%60,2)}))}rt("Z",":"),rt("ZZ",""),Hg("Z",Xg),Hg("ZZ",Xg),xg(["Z","ZZ"],(function(g,e,I){I._useUTC=!0,I._tzm=it(Xg,g)}));var ct=/([\+\-]|\d\d)/gi;function it(g,e){var I,t,n=(e||"").match(g);return null===n?null:0===(t=60*(I=((n[n.length-1]||[])+"").match(ct)||["-",0,0])[1]+cg(I[2]))?0:"+"===I[0]?t:-t}function At(g,e){var I,n;return e._isUTC?(I=e.clone(),n=(B(g)||i(g)?g.valueOf():jI(g).valueOf())-I.valueOf(),I._d.setTime(I._d.valueOf()+n),t.updateOffset(I,!1),I):jI(g).local()}function st(g){return-Math.round(g._d.getTimezoneOffset())}function dt(g,e,I){var n,C=this._offset||0;if(!this.isValid())return null!=g?this:NaN;if(null!=g){if("string"===typeof g){if(null===(g=it(Xg,g)))return this}else Math.abs(g)<16&&!I&&(g*=60);return!this._isUTC&&e&&(n=st(this)),this._offset=g,this._isUTC=!0,null!=n&&this.add(n,"m"),C!==g&&(!e||this._changeInProgress?Jt(this,Vt(g-C,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?C:st(this)}function ut(g,e){return null!=g?("string"!==typeof g&&(g=-g),this.utcOffset(g,e),this):-this.utcOffset()}function mt(g){return this.utcOffset(0,g)}function bt(g){return this._isUTC&&(this.utcOffset(0,g),this._isUTC=!1,g&&this.subtract(st(this),"m")),this}function Zt(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var g=it(kg,this._i);null!=g?this.utcOffset(g):this.utcOffset(0,!0)}return this}function ht(g){return!!this.isValid()&&(g=g?jI(g).utcOffset():0,(this.utcOffset()-g)%60===0)}function pt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Gt(){if(!r(this._isDSTShifted))return this._isDSTShifted;var g,e={};return G(e,this),(e=QI(e))._a?(g=e._isUTC?d(e._a):jI(e._a),this._isDSTShifted=this.isValid()&&at(e._a,g.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function yt(){return!!this.isValid()&&!this._isUTC}function Bt(){return!!this.isValid()&&this._isUTC}function ft(){return!!this.isValid()&&this._isUTC&&0===this._offset}t.updateOffset=function(){};var St=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Wt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Vt(g,e){var I,t,n,C=g,l=null;return lt(g)?C={ms:g._milliseconds,d:g._days,M:g._months}:c(g)||!isNaN(+g)?(C={},e?C[e]=+g:C.milliseconds=+g):(l=St.exec(g))?(I="-"===l[1]?-1:1,C={y:0,d:cg(l[Qg])*I,h:cg(l[Lg])*I,m:cg(l[Tg])*I,s:cg(l[jg])*I,ms:cg(ot(1e3*l[Og]))*I}):(l=Wt.exec(g))?(I="-"===l[1]?-1:1,C={y:vt(l[2],I),M:vt(l[3],I),w:vt(l[4],I),d:vt(l[5],I),h:vt(l[6],I),m:vt(l[7],I),s:vt(l[8],I)}):null==C?C={}:"object"===typeof C&&("from"in C||"to"in C)&&(n=kt(jI(C.from),jI(C.to)),(C={}).ms=n.milliseconds,C.M=n.months),t=new Ct(C),lt(g)&&o(g,"_locale")&&(t._locale=g._locale),lt(g)&&o(g,"_isValid")&&(t._isValid=g._isValid),t}function vt(g,e){var I=g&&parseFloat(g.replace(",","."));return(isNaN(I)?0:I)*e}function Rt(g,e){var I={};return I.months=e.month()-g.month()+12*(e.year()-g.year()),g.clone().add(I.months,"M").isAfter(e)&&--I.months,I.milliseconds=+e-+g.clone().add(I.months,"M"),I}function kt(g,e){var I;return g.isValid()&&e.isValid()?(e=At(e,g),g.isBefore(e)?I=Rt(g,e):((I=Rt(e,g)).milliseconds=-I.milliseconds,I.months=-I.months),I):{milliseconds:0,months:0}}function Xt(g,e){return function(I,t){var n;return null===t||isNaN(+t)||(v(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=I,I=t,t=n),Jt(this,Vt(I,t),g),this}}function Jt(g,e,I,n){var C=e._milliseconds,l=ot(e._days),o=ot(e._months);g.isValid()&&(n=null==n||n,o&&re(g,Ag(g,"Month")+o*I),l&&sg(g,"Date",Ag(g,"Date")+l*I),C&&g._d.setTime(g._d.valueOf()+C*I),n&&t.updateOffset(g,l||o))}Vt.fn=Ct.prototype,Vt.invalid=nt;var Yt=Xt(1,"add"),Ht=Xt(-1,"subtract");function wt(g){return"string"===typeof g||g instanceof String}function Nt(g){return B(g)||i(g)||wt(g)||c(g)||Ft(g)||Kt(g)||null===g||void 0===g}function Kt(g){var e,I,t=l(g)&&!a(g),n=!1,C=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r=C.length;for(e=0;e<r;e+=1)I=C[e],n=n||o(g,I);return t&&n}function Ft(g){var e=C(g),I=!1;return e&&(I=0===g.filter((function(e){return!c(e)&&wt(g)})).length),e&&I}function xt(g){var e,I,t=l(g)&&!a(g),n=!1,C=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(e=0;e<C.length;e+=1)I=C[e],n=n||o(g,I);return t&&n}function Et(g,e){var I=g.diff(e,"days",!0);return I<-6?"sameElse":I<-1?"lastWeek":I<0?"lastDay":I<1?"sameDay":I<2?"nextDay":I<7?"nextWeek":"sameElse"}function zt(g,e){1===arguments.length&&(arguments[0]?Nt(arguments[0])?(g=arguments[0],e=void 0):xt(arguments[0])&&(e=arguments[0],g=void 0):(g=void 0,e=void 0));var I=g||jI(),n=At(I,this).startOf("day"),C=t.calendarFormat(this,n)||"sameElse",l=e&&(R(e[C])?e[C].call(this,I):e[C]);return this.format(l||this.localeData().calendar(C,this,jI(I)))}function Mt(){return new y(this)}function Ut(g,e){var I=B(g)?g:jI(g);return!(!this.isValid()||!I.isValid())&&("millisecond"===(e=tg(e)||"millisecond")?this.valueOf()>I.valueOf():I.valueOf()<this.clone().startOf(e).valueOf())}function Dt(g,e){var I=B(g)?g:jI(g);return!(!this.isValid()||!I.isValid())&&("millisecond"===(e=tg(e)||"millisecond")?this.valueOf()<I.valueOf():this.clone().endOf(e).valueOf()<I.valueOf())}function Qt(g,e,I,t){var n=B(g)?g:jI(g),C=B(e)?e:jI(e);return!!(this.isValid()&&n.isValid()&&C.isValid())&&("("===(t=t||"()")[0]?this.isAfter(n,I):!this.isBefore(n,I))&&(")"===t[1]?this.isBefore(C,I):!this.isAfter(C,I))}function Lt(g,e){var I,t=B(g)?g:jI(g);return!(!this.isValid()||!t.isValid())&&("millisecond"===(e=tg(e)||"millisecond")?this.valueOf()===t.valueOf():(I=t.valueOf(),this.clone().startOf(e).valueOf()<=I&&I<=this.clone().endOf(e).valueOf()))}function Tt(g,e){return this.isSame(g,e)||this.isAfter(g,e)}function jt(g,e){return this.isSame(g,e)||this.isBefore(g,e)}function Ot(g,e,I){var t,n,C;if(!this.isValid())return NaN;if(!(t=At(g,this)).isValid())return NaN;switch(n=6e4*(t.utcOffset()-this.utcOffset()),e=tg(e)){case"year":C=Pt(this,t)/12;break;case"month":C=Pt(this,t);break;case"quarter":C=Pt(this,t)/3;break;case"second":C=(this-t)/1e3;break;case"minute":C=(this-t)/6e4;break;case"hour":C=(this-t)/36e5;break;case"day":C=(this-t-n)/864e5;break;case"week":C=(this-t-n)/6048e5;break;default:C=this-t}return I?C:rg(C)}function Pt(g,e){if(g.date()<e.date())return-Pt(e,g);var I=12*(e.year()-g.year())+(e.month()-g.month()),t=g.clone().add(I,"months");return-(I+(e-t<0?(e-t)/(t-g.clone().add(I-1,"months")):(e-t)/(g.clone().add(I+1,"months")-t)))||0}function qt(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function _t(g){if(!this.isValid())return null;var e=!0!==g,I=e?this.clone().utc():this;return I.year()<0||I.year()>9999?U(I,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):R(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",U(I,"Z")):U(I,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function $t(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var g,e,I,t,n="moment",C="";return this.isLocal()||(n=0===this.utcOffset()?"moment.utc":"moment.parseZone",C="Z"),g="["+n+'("]',e=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",I="-MM-DD[T]HH:mm:ss.SSS",t=C+'[")]',this.format(g+e+I+t)}function gn(g){g||(g=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var e=U(this,g);return this.localeData().postformat(e)}function en(g,e){return this.isValid()&&(B(g)&&g.isValid()||jI(g).isValid())?Vt({to:this,from:g}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function In(g){return this.from(jI(),g)}function tn(g,e){return this.isValid()&&(B(g)&&g.isValid()||jI(g).isValid())?Vt({from:this,to:g}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function nn(g){return this.to(jI(),g)}function Cn(g){var e;return void 0===g?this._locale._abbr:(null!=(e=bI(g))&&(this._locale=e),this)}t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ln=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(g){return void 0===g?this.localeData():this.locale(g)}));function on(){return this._locale}var an=1e3,rn=60*an,cn=60*rn,An=3506328*cn;function sn(g,e){return(g%e+e)%e}function dn(g,e,I){return g<100&&g>=0?new Date(g+400,e,I)-An:new Date(g,e,I).valueOf()}function un(g,e,I){return g<100&&g>=0?Date.UTC(g+400,e,I)-An:Date.UTC(g,e,I)}function mn(g){var e,I;if(void 0===(g=tg(g))||"millisecond"===g||!this.isValid())return this;switch(I=this._isUTC?un:dn,g){case"year":e=I(this.year(),0,1);break;case"quarter":e=I(this.year(),this.month()-this.month()%3,1);break;case"month":e=I(this.year(),this.month(),1);break;case"week":e=I(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=I(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=I(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=sn(e+(this._isUTC?0:this.utcOffset()*rn),cn);break;case"minute":e=this._d.valueOf(),e-=sn(e,rn);break;case"second":e=this._d.valueOf(),e-=sn(e,an)}return this._d.setTime(e),t.updateOffset(this,!0),this}function bn(g){var e,I;if(void 0===(g=tg(g))||"millisecond"===g||!this.isValid())return this;switch(I=this._isUTC?un:dn,g){case"year":e=I(this.year()+1,0,1)-1;break;case"quarter":e=I(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=I(this.year(),this.month()+1,1)-1;break;case"week":e=I(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=I(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=I(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=cn-sn(e+(this._isUTC?0:this.utcOffset()*rn),cn)-1;break;case"minute":e=this._d.valueOf(),e+=rn-sn(e,rn)-1;break;case"second":e=this._d.valueOf(),e+=an-sn(e,an)-1}return this._d.setTime(e),t.updateOffset(this,!0),this}function Zn(){return this._d.valueOf()-6e4*(this._offset||0)}function hn(){return Math.floor(this.valueOf()/1e3)}function pn(){return new Date(this.valueOf())}function Gn(){var g=this;return[g.year(),g.month(),g.date(),g.hour(),g.minute(),g.second(),g.millisecond()]}function yn(){var g=this;return{years:g.year(),months:g.month(),date:g.date(),hours:g.hours(),minutes:g.minutes(),seconds:g.seconds(),milliseconds:g.milliseconds()}}function Bn(){return this.isValid()?this.toISOString():null}function fn(){return b(this)}function Sn(){return s({},m(this))}function Wn(){return m(this).overflow}function Vn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function vn(g,e){var I,n,C,l=this._eras||bI("en")._eras;for(I=0,n=l.length;I<n;++I)switch("string"===typeof l[I].since&&(C=t(l[I].since).startOf("day"),l[I].since=C.valueOf()),typeof l[I].until){case"undefined":l[I].until=1/0;break;case"string":C=t(l[I].until).startOf("day").valueOf(),l[I].until=C.valueOf()}return l}function Rn(g,e,I){var t,n,C,l,o,a=this.eras();for(g=g.toUpperCase(),t=0,n=a.length;t<n;++t)if(C=a[t].name.toUpperCase(),l=a[t].abbr.toUpperCase(),o=a[t].narrow.toUpperCase(),I)switch(e){case"N":case"NN":case"NNN":if(l===g)return a[t];break;case"NNNN":if(C===g)return a[t];break;case"NNNNN":if(o===g)return a[t]}else if([C,l,o].indexOf(g)>=0)return a[t]}function kn(g,e){var I=g.since<=g.until?1:-1;return void 0===e?t(g.since).year():t(g.since).year()+(e-g.offset)*I}function Xn(){var g,e,I,t=this.localeData().eras();for(g=0,e=t.length;g<e;++g){if(I=this.clone().startOf("day").valueOf(),t[g].since<=I&&I<=t[g].until)return t[g].name;if(t[g].until<=I&&I<=t[g].since)return t[g].name}return""}function Jn(){var g,e,I,t=this.localeData().eras();for(g=0,e=t.length;g<e;++g){if(I=this.clone().startOf("day").valueOf(),t[g].since<=I&&I<=t[g].until)return t[g].narrow;if(t[g].until<=I&&I<=t[g].since)return t[g].narrow}return""}function Yn(){var g,e,I,t=this.localeData().eras();for(g=0,e=t.length;g<e;++g){if(I=this.clone().startOf("day").valueOf(),t[g].since<=I&&I<=t[g].until)return t[g].abbr;if(t[g].until<=I&&I<=t[g].since)return t[g].abbr}return""}function Hn(){var g,e,I,n,C=this.localeData().eras();for(g=0,e=C.length;g<e;++g)if(I=C[g].since<=C[g].until?1:-1,n=this.clone().startOf("day").valueOf(),C[g].since<=n&&n<=C[g].until||C[g].until<=n&&n<=C[g].since)return(this.year()-t(C[g].since).year())*I+C[g].offset;return this.year()}function wn(g){return o(this,"_erasNameRegex")||Mn.call(this),g?this._erasNameRegex:this._erasRegex}function Nn(g){return o(this,"_erasAbbrRegex")||Mn.call(this),g?this._erasAbbrRegex:this._erasRegex}function Kn(g){return o(this,"_erasNarrowRegex")||Mn.call(this),g?this._erasNarrowRegex:this._erasRegex}function Fn(g,e){return e.erasAbbrRegex(g)}function xn(g,e){return e.erasNameRegex(g)}function En(g,e){return e.erasNarrowRegex(g)}function zn(g,e){return e._eraYearOrdinalRegex||vg}function Mn(){var g,e,I=[],t=[],n=[],C=[],l=this.eras();for(g=0,e=l.length;g<e;++g)t.push(Kg(l[g].name)),I.push(Kg(l[g].abbr)),n.push(Kg(l[g].narrow)),C.push(Kg(l[g].name)),C.push(Kg(l[g].abbr)),C.push(Kg(l[g].narrow));this._erasRegex=new RegExp("^("+C.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+I.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}function Un(g,e){E(0,[g,g.length],0,e)}function Dn(g){return Pn.call(this,g,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Qn(g){return Pn.call(this,g,this.isoWeek(),this.isoWeekday(),1,4)}function Ln(){return Be(this.year(),1,4)}function Tn(){return Be(this.isoWeekYear(),1,4)}function jn(){var g=this.localeData()._week;return Be(this.year(),g.dow,g.doy)}function On(){var g=this.localeData()._week;return Be(this.weekYear(),g.dow,g.doy)}function Pn(g,e,I,t,n){var C;return null==g?ye(this,t,n).year:(e>(C=Be(g,t,n))&&(e=C),qn.call(this,g,e,I,t,n))}function qn(g,e,I,t,n){var C=Ge(g,e,I,t,n),l=he(C.year,0,C.dayOfYear);return this.year(l.getUTCFullYear()),this.month(l.getUTCMonth()),this.date(l.getUTCDate()),this}function _n(g){return null==g?Math.ceil((this.month()+1)/3):this.month(3*(g-1)+this.month()%3)}E("N",0,0,"eraAbbr"),E("NN",0,0,"eraAbbr"),E("NNN",0,0,"eraAbbr"),E("NNNN",0,0,"eraName"),E("NNNNN",0,0,"eraNarrow"),E("y",["y",1],"yo","eraYear"),E("y",["yy",2],0,"eraYear"),E("y",["yyy",3],0,"eraYear"),E("y",["yyyy",4],0,"eraYear"),Hg("N",Fn),Hg("NN",Fn),Hg("NNN",Fn),Hg("NNNN",xn),Hg("NNNNN",En),xg(["N","NN","NNN","NNNN","NNNNN"],(function(g,e,I,t){var n=I._locale.erasParse(g,t,I._strict);n?m(I).era=n:m(I).invalidEra=g})),Hg("y",vg),Hg("yy",vg),Hg("yyy",vg),Hg("yyyy",vg),Hg("yo",zn),xg(["y","yy","yyy","yyyy"],Ug),xg(["yo"],(function(g,e,I,t){var n;I._locale._eraYearOrdinalRegex&&(n=g.match(I._locale._eraYearOrdinalRegex)),I._locale.eraYearOrdinalParse?e[Ug]=I._locale.eraYearOrdinalParse(g,n):e[Ug]=parseInt(g,10)})),E(0,["gg",2],0,(function(){return this.weekYear()%100})),E(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Un("gggg","weekYear"),Un("ggggg","weekYear"),Un("GGGG","isoWeekYear"),Un("GGGGG","isoWeekYear"),Ig("weekYear","gg"),Ig("isoWeekYear","GG"),lg("weekYear",1),lg("isoWeekYear",1),Hg("G",Rg),Hg("g",Rg),Hg("GG",yg,Zg),Hg("gg",yg,Zg),Hg("GGGG",Wg,pg),Hg("gggg",Wg,pg),Hg("GGGGG",Vg,Gg),Hg("ggggg",Vg,Gg),Eg(["gggg","ggggg","GGGG","GGGGG"],(function(g,e,I,t){e[t.substr(0,2)]=cg(g)})),Eg(["gg","GG"],(function(g,e,I,n){e[n]=t.parseTwoDigitYear(g)})),E("Q",0,"Qo","quarter"),Ig("quarter","Q"),lg("quarter",7),Hg("Q",bg),xg("Q",(function(g,e){e[Dg]=3*(cg(g)-1)})),E("D",["DD",2],"Do","date"),Ig("date","D"),lg("date",9),Hg("D",yg),Hg("DD",yg,Zg),Hg("Do",(function(g,e){return g?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),xg(["D","DD"],Qg),xg("Do",(function(g,e){e[Qg]=cg(g.match(yg)[0])}));var $n=ig("Date",!0);function gC(g){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==g?e:this.add(g-e,"d")}E("DDD",["DDDD",3],"DDDo","dayOfYear"),Ig("dayOfYear","DDD"),lg("dayOfYear",4),Hg("DDD",Sg),Hg("DDDD",hg),xg(["DDD","DDDD"],(function(g,e,I){I._dayOfYear=cg(g)})),E("m",["mm",2],0,"minute"),Ig("minute","m"),lg("minute",14),Hg("m",yg),Hg("mm",yg,Zg),xg(["m","mm"],Tg);var eC=ig("Minutes",!1);E("s",["ss",2],0,"second"),Ig("second","s"),lg("second",15),Hg("s",yg),Hg("ss",yg,Zg),xg(["s","ss"],jg);var IC,tC,nC=ig("Seconds",!1);for(E("S",0,0,(function(){return~~(this.millisecond()/100)})),E(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),E(0,["SSS",3],0,"millisecond"),E(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),E(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),E(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),E(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),E(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),E(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),Ig("millisecond","ms"),lg("millisecond",16),Hg("S",Sg,bg),Hg("SS",Sg,Zg),Hg("SSS",Sg,hg),IC="SSSS";IC.length<=9;IC+="S")Hg(IC,vg);function CC(g,e){e[Og]=cg(1e3*("0."+g))}for(IC="S";IC.length<=9;IC+="S")xg(IC,CC);function lC(){return this._isUTC?"UTC":""}function oC(){return this._isUTC?"Coordinated Universal Time":""}tC=ig("Milliseconds",!1),E("z",0,0,"zoneAbbr"),E("zz",0,0,"zoneName");var aC=y.prototype;function rC(g){return jI(1e3*g)}function cC(){return jI.apply(null,arguments).parseZone()}function iC(g){return g}aC.add=Yt,aC.calendar=zt,aC.clone=Mt,aC.diff=Ot,aC.endOf=bn,aC.format=gn,aC.from=en,aC.fromNow=In,aC.to=tn,aC.toNow=nn,aC.get=dg,aC.invalidAt=Wn,aC.isAfter=Ut,aC.isBefore=Dt,aC.isBetween=Qt,aC.isSame=Lt,aC.isSameOrAfter=Tt,aC.isSameOrBefore=jt,aC.isValid=fn,aC.lang=ln,aC.locale=Cn,aC.localeData=on,aC.max=PI,aC.min=OI,aC.parsingFlags=Sn,aC.set=ug,aC.startOf=mn,aC.subtract=Ht,aC.toArray=Gn,aC.toObject=yn,aC.toDate=pn,aC.toISOString=_t,aC.inspect=$t,"undefined"!==typeof Symbol&&null!=Symbol.for&&(aC[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),aC.toJSON=Bn,aC.toString=qt,aC.unix=hn,aC.valueOf=Zn,aC.creationData=Vn,aC.eraName=Xn,aC.eraNarrow=Jn,aC.eraAbbr=Yn,aC.eraYear=Hn,aC.year=me,aC.isLeapYear=be,aC.weekYear=Dn,aC.isoWeekYear=Qn,aC.quarter=aC.quarters=_n,aC.month=ce,aC.daysInMonth=ie,aC.week=aC.weeks=ve,aC.isoWeek=aC.isoWeeks=Re,aC.weeksInYear=jn,aC.weeksInWeekYear=On,aC.isoWeeksInYear=Ln,aC.isoWeeksInISOWeekYear=Tn,aC.date=$n,aC.day=aC.days=De,aC.weekday=Qe,aC.isoWeekday=Le,aC.dayOfYear=gC,aC.hour=aC.hours=tI,aC.minute=aC.minutes=eC,aC.second=aC.seconds=nC,aC.millisecond=aC.milliseconds=tC,aC.utcOffset=dt,aC.utc=mt,aC.local=bt,aC.parseZone=Zt,aC.hasAlignedHourOffset=ht,aC.isDST=pt,aC.isLocal=yt,aC.isUtcOffset=Bt,aC.isUtc=ft,aC.isUTC=ft,aC.zoneAbbr=lC,aC.zoneName=oC,aC.dates=S("dates accessor is deprecated. Use date instead.",$n),aC.months=S("months accessor is deprecated. Use month instead",ce),aC.years=S("years accessor is deprecated. Use year instead",me),aC.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ut),aC.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Gt);var AC=J.prototype;function sC(g,e,I,t){var n=bI(),C=d().set(t,e);return n[I](C,g)}function dC(g,e,I){if(c(g)&&(e=g,g=void 0),g=g||"",null!=e)return sC(g,e,I,"month");var t,n=[];for(t=0;t<12;t++)n[t]=sC(g,t,I,"month");return n}function uC(g,e,I,t){"boolean"===typeof g?(c(e)&&(I=e,e=void 0),e=e||""):(I=e=g,g=!1,c(e)&&(I=e,e=void 0),e=e||"");var n,C=bI(),l=g?C._week.dow:0,o=[];if(null!=I)return sC(e,(I+l)%7,t,"day");for(n=0;n<7;n++)o[n]=sC(e,(n+l)%7,t,"day");return o}function mC(g,e){return dC(g,e,"months")}function bC(g,e){return dC(g,e,"monthsShort")}function ZC(g,e,I){return uC(g,e,I,"weekdays")}function hC(g,e,I){return uC(g,e,I,"weekdaysShort")}function pC(g,e,I){return uC(g,e,I,"weekdaysMin")}AC.calendar=H,AC.longDateFormat=L,AC.invalidDate=j,AC.ordinal=q,AC.preparse=iC,AC.postformat=iC,AC.relativeTime=$,AC.pastFuture=gg,AC.set=k,AC.eras=vn,AC.erasParse=Rn,AC.erasConvertYear=kn,AC.erasAbbrRegex=Nn,AC.erasNameRegex=wn,AC.erasNarrowRegex=Kn,AC.months=Ce,AC.monthsShort=le,AC.monthsParse=ae,AC.monthsRegex=se,AC.monthsShortRegex=Ae,AC.week=fe,AC.firstDayOfYear=Ve,AC.firstDayOfWeek=We,AC.weekdays=xe,AC.weekdaysMin=ze,AC.weekdaysShort=Ee,AC.weekdaysParse=Ue,AC.weekdaysRegex=Te,AC.weekdaysShortRegex=je,AC.weekdaysMinRegex=Oe,AC.isPM=eI,AC.meridiem=nI,dI("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(g){var e=g%10;return g+(1===cg(g%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),t.lang=S("moment.lang is deprecated. Use moment.locale instead.",dI),t.langData=S("moment.langData is deprecated. Use moment.localeData instead.",bI);var GC=Math.abs;function yC(){var g=this._data;return this._milliseconds=GC(this._milliseconds),this._days=GC(this._days),this._months=GC(this._months),g.milliseconds=GC(g.milliseconds),g.seconds=GC(g.seconds),g.minutes=GC(g.minutes),g.hours=GC(g.hours),g.months=GC(g.months),g.years=GC(g.years),this}function BC(g,e,I,t){var n=Vt(e,I);return g._milliseconds+=t*n._milliseconds,g._days+=t*n._days,g._months+=t*n._months,g._bubble()}function fC(g,e){return BC(this,g,e,1)}function SC(g,e){return BC(this,g,e,-1)}function WC(g){return g<0?Math.floor(g):Math.ceil(g)}function VC(){var g,e,I,t,n,C=this._milliseconds,l=this._days,o=this._months,a=this._data;return C>=0&&l>=0&&o>=0||C<=0&&l<=0&&o<=0||(C+=864e5*WC(RC(o)+l),l=0,o=0),a.milliseconds=C%1e3,g=rg(C/1e3),a.seconds=g%60,e=rg(g/60),a.minutes=e%60,I=rg(e/60),a.hours=I%24,l+=rg(I/24),o+=n=rg(vC(l)),l-=WC(RC(n)),t=rg(o/12),o%=12,a.days=l,a.months=o,a.years=t,this}function vC(g){return 4800*g/146097}function RC(g){return 146097*g/4800}function kC(g){if(!this.isValid())return NaN;var e,I,t=this._milliseconds;if("month"===(g=tg(g))||"quarter"===g||"year"===g)switch(e=this._days+t/864e5,I=this._months+vC(e),g){case"month":return I;case"quarter":return I/3;case"year":return I/12}else switch(e=this._days+Math.round(RC(this._months)),g){case"week":return e/7+t/6048e5;case"day":return e+t/864e5;case"hour":return 24*e+t/36e5;case"minute":return 1440*e+t/6e4;case"second":return 86400*e+t/1e3;case"millisecond":return Math.floor(864e5*e)+t;default:throw new Error("Unknown unit "+g)}}function XC(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*cg(this._months/12):NaN}function JC(g){return function(){return this.as(g)}}var YC=JC("ms"),HC=JC("s"),wC=JC("m"),NC=JC("h"),KC=JC("d"),FC=JC("w"),xC=JC("M"),EC=JC("Q"),zC=JC("y");function MC(){return Vt(this)}function UC(g){return g=tg(g),this.isValid()?this[g+"s"]():NaN}function DC(g){return function(){return this.isValid()?this._data[g]:NaN}}var QC=DC("milliseconds"),LC=DC("seconds"),TC=DC("minutes"),jC=DC("hours"),OC=DC("days"),PC=DC("months"),qC=DC("years");function _C(){return rg(this.days()/7)}var $C=Math.round,gl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function el(g,e,I,t,n){return n.relativeTime(e||1,!!I,g,t)}function Il(g,e,I,t){var n=Vt(g).abs(),C=$C(n.as("s")),l=$C(n.as("m")),o=$C(n.as("h")),a=$C(n.as("d")),r=$C(n.as("M")),c=$C(n.as("w")),i=$C(n.as("y")),A=C<=I.ss&&["s",C]||C<I.s&&["ss",C]||l<=1&&["m"]||l<I.m&&["mm",l]||o<=1&&["h"]||o<I.h&&["hh",o]||a<=1&&["d"]||a<I.d&&["dd",a];return null!=I.w&&(A=A||c<=1&&["w"]||c<I.w&&["ww",c]),(A=A||r<=1&&["M"]||r<I.M&&["MM",r]||i<=1&&["y"]||["yy",i])[2]=e,A[3]=+g>0,A[4]=t,el.apply(null,A)}function tl(g){return void 0===g?$C:"function"===typeof g&&($C=g,!0)}function nl(g,e){return void 0!==gl[g]&&(void 0===e?gl[g]:(gl[g]=e,"s"===g&&(gl.ss=e-1),!0))}function Cl(g,e){if(!this.isValid())return this.localeData().invalidDate();var I,t,n=!1,C=gl;return"object"===typeof g&&(e=g,g=!1),"boolean"===typeof g&&(n=g),"object"===typeof e&&(C=Object.assign({},gl,e),null!=e.s&&null==e.ss&&(C.ss=e.s-1)),t=Il(this,!n,C,I=this.localeData()),n&&(t=I.pastFuture(+this,t)),I.postformat(t)}var ll=Math.abs;function ol(g){return(g>0)-(g<0)||+g}function al(){if(!this.isValid())return this.localeData().invalidDate();var g,e,I,t,n,C,l,o,a=ll(this._milliseconds)/1e3,r=ll(this._days),c=ll(this._months),i=this.asSeconds();return i?(g=rg(a/60),e=rg(g/60),a%=60,g%=60,I=rg(c/12),c%=12,t=a?a.toFixed(3).replace(/\.?0+$/,""):"",n=i<0?"-":"",C=ol(this._months)!==ol(i)?"-":"",l=ol(this._days)!==ol(i)?"-":"",o=ol(this._milliseconds)!==ol(i)?"-":"",n+"P"+(I?C+I+"Y":"")+(c?C+c+"M":"")+(r?l+r+"D":"")+(e||g||a?"T":"")+(e?o+e+"H":"")+(g?o+g+"M":"")+(a?o+t+"S":"")):"P0D"}var rl=Ct.prototype;return rl.isValid=tt,rl.abs=yC,rl.add=fC,rl.subtract=SC,rl.as=kC,rl.asMilliseconds=YC,rl.asSeconds=HC,rl.asMinutes=wC,rl.asHours=NC,rl.asDays=KC,rl.asWeeks=FC,rl.asMonths=xC,rl.asQuarters=EC,rl.asYears=zC,rl.valueOf=XC,rl._bubble=VC,rl.clone=MC,rl.get=UC,rl.milliseconds=QC,rl.seconds=LC,rl.minutes=TC,rl.hours=jC,rl.days=OC,rl.weeks=_C,rl.months=PC,rl.years=qC,rl.humanize=Cl,rl.toISOString=al,rl.toString=al,rl.toJSON=al,rl.locale=Cn,rl.localeData=on,rl.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",al),rl.lang=ln,E("X",0,0,"unix"),E("x",0,0,"valueOf"),Hg("x",Rg),Hg("X",Jg),xg("X",(function(g,e,I){I._d=new Date(1e3*parseFloat(g))})),xg("x",(function(g,e,I){I._d=new Date(cg(g))})),t.version="2.29.4",n(jI),t.fn=aC,t.min=_I,t.max=$I,t.now=gt,t.utc=d,t.unix=rC,t.months=mC,t.isDate=i,t.locale=dI,t.invalid=Z,t.duration=Vt,t.isMoment=B,t.weekdays=ZC,t.parseZone=cC,t.localeData=bI,t.isDuration=lt,t.monthsShort=bC,t.weekdaysMin=pC,t.defineLocale=uI,t.updateLocale=mI,t.locales=ZI,t.weekdaysShort=hC,t.normalizeUnits=tg,t.relativeTimeRounding=tl,t.relativeTimeThreshold=nl,t.calendarFormat=Et,t.prototype=aC,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},t}()},888:function(g,e,I){"use strict";var t=I(47);function n(){}function C(){}C.resetWarningCache=n,g.exports=function(){function g(g,e,I,n,C,l){if(l!==t){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function e(){return g}g.isRequired=g;var I={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:e,element:g,elementType:g,instanceOf:e,node:g,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:C,resetWarningCache:n};return I.PropTypes=I,I}},7:function(g,e,I){g.exports=I(888)()},47:function(g){"use strict";g.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},463:function(g,e,I){"use strict";var t=I(791),n=I(296);function C(g){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+g,I=1;I<arguments.length;I++)e+="&args[]="+encodeURIComponent(arguments[I]);return"Minified React error #"+g+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,o={};function a(g,e){r(g,e),r(g+"Capture",e)}function r(g,e){for(o[g]=e,g=0;g<e.length;g++)l.add(e[g])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),i=Object.prototype.hasOwnProperty,A=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,s={},d={};function u(g,e,I,t,n,C,l){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=t,this.attributeNamespace=n,this.mustUseProperty=I,this.propertyName=g,this.type=e,this.sanitizeURL=C,this.removeEmptyString=l}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(g){m[g]=new u(g,0,!1,g,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(g){var e=g[0];m[e]=new u(e,1,!1,g[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(g){m[g]=new u(g,2,!1,g.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(g){m[g]=new u(g,2,!1,g,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(g){m[g]=new u(g,3,!1,g.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(g){m[g]=new u(g,3,!0,g,null,!1,!1)})),["capture","download"].forEach((function(g){m[g]=new u(g,4,!1,g,null,!1,!1)})),["cols","rows","size","span"].forEach((function(g){m[g]=new u(g,6,!1,g,null,!1,!1)})),["rowSpan","start"].forEach((function(g){m[g]=new u(g,5,!1,g.toLowerCase(),null,!1,!1)}));var b=/[\-:]([a-z])/g;function Z(g){return g[1].toUpperCase()}function h(g,e,I,t){var n=m.hasOwnProperty(e)?m[e]:null;(null!==n?0!==n.type:t||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(g,e,I,t){if(null===e||"undefined"===typeof e||function(g,e,I,t){if(null!==I&&0===I.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!t&&(null!==I?!I.acceptsBooleans:"data-"!==(g=g.toLowerCase().slice(0,5))&&"aria-"!==g);default:return!1}}(g,e,I,t))return!0;if(t)return!1;if(null!==I)switch(I.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,I,n,t)&&(I=null),t||null===n?function(g){return!!i.call(d,g)||!i.call(s,g)&&(A.test(g)?d[g]=!0:(s[g]=!0,!1))}(e)&&(null===I?g.removeAttribute(e):g.setAttribute(e,""+I)):n.mustUseProperty?g[n.propertyName]=null===I?3!==n.type&&"":I:(e=n.attributeName,t=n.attributeNamespace,null===I?g.removeAttribute(e):(I=3===(n=n.type)||4===n&&!0===I?"":""+I,t?g.setAttributeNS(t,e,I):g.setAttribute(e,I))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(g){var e=g.replace(b,Z);m[e]=new u(e,1,!1,g,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(g){var e=g.replace(b,Z);m[e]=new u(e,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(g){var e=g.replace(b,Z);m[e]=new u(e,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(g){m[g]=new u(g,1,!1,g.toLowerCase(),null,!1,!1)})),m.xlinkHref=new u("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(g){m[g]=new u(g,1,!1,g.toLowerCase(),null,!0,!0)}));var p=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),y=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),V=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),J=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var Y=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var H=Symbol.iterator;function w(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=H&&g[H]||g["@@iterator"])?g:null}var N,K=Object.assign;function F(g){if(void 0===N)try{throw Error()}catch(I){var e=I.stack.trim().match(/\n( *(at )?)/);N=e&&e[1]||""}return"\n"+N+g}var x=!1;function E(g,e){if(!g||x)return"";x=!0;var I=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(r){var t=r}Reflect.construct(g,[],e)}else{try{e.call()}catch(r){t=r}g.call(e.prototype)}else{try{throw Error()}catch(r){t=r}g()}}catch(r){if(r&&t&&"string"===typeof r.stack){for(var n=r.stack.split("\n"),C=t.stack.split("\n"),l=n.length-1,o=C.length-1;1<=l&&0<=o&&n[l]!==C[o];)o--;for(;1<=l&&0<=o;l--,o--)if(n[l]!==C[o]){if(1!==l||1!==o)do{if(l--,0>--o||n[l]!==C[o]){var a="\n"+n[l].replace(" at new "," at ");return g.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",g.displayName)),a}}while(1<=l&&0<=o);break}}}finally{x=!1,Error.prepareStackTrace=I}return(g=g?g.displayName||g.name:"")?F(g):""}function z(g){switch(g.tag){case 5:return F(g.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return g=E(g.type,!1);case 11:return g=E(g.type.render,!1);case 1:return g=E(g.type,!0);default:return""}}function M(g){if(null==g)return null;if("function"===typeof g)return g.displayName||g.name||null;if("string"===typeof g)return g;switch(g){case B:return"Fragment";case y:return"Portal";case S:return"Profiler";case f:return"StrictMode";case R:return"Suspense";case k:return"SuspenseList"}if("object"===typeof g)switch(g.$$typeof){case V:return(g.displayName||"Context")+".Consumer";case W:return(g._context.displayName||"Context")+".Provider";case v:var e=g.render;return(g=g.displayName)||(g=""!==(g=e.displayName||e.name||"")?"ForwardRef("+g+")":"ForwardRef"),g;case X:return null!==(e=g.displayName||null)?e:M(g.type)||"Memo";case J:e=g._payload,g=g._init;try{return M(g(e))}catch(I){}}return null}function U(g){var e=g.type;switch(g.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=(g=e.render).displayName||g.name||"",e.displayName||(""!==g?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return M(e);case 8:return e===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function D(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":case"object":return g;default:return""}}function Q(g){var e=g.type;return(g=g.nodeName)&&"input"===g.toLowerCase()&&("checkbox"===e||"radio"===e)}function L(g){g._valueTracker||(g._valueTracker=function(g){var e=Q(g)?"checked":"value",I=Object.getOwnPropertyDescriptor(g.constructor.prototype,e),t=""+g[e];if(!g.hasOwnProperty(e)&&"undefined"!==typeof I&&"function"===typeof I.get&&"function"===typeof I.set){var n=I.get,C=I.set;return Object.defineProperty(g,e,{configurable:!0,get:function(){return n.call(this)},set:function(g){t=""+g,C.call(this,g)}}),Object.defineProperty(g,e,{enumerable:I.enumerable}),{getValue:function(){return t},setValue:function(g){t=""+g},stopTracking:function(){g._valueTracker=null,delete g[e]}}}}(g))}function T(g){if(!g)return!1;var e=g._valueTracker;if(!e)return!0;var I=e.getValue(),t="";return g&&(t=Q(g)?g.checked?"true":"false":g.value),(g=t)!==I&&(e.setValue(g),!0)}function j(g){if("undefined"===typeof(g=g||("undefined"!==typeof document?document:void 0)))return null;try{return g.activeElement||g.body}catch(e){return g.body}}function O(g,e){var I=e.checked;return K({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=I?I:g._wrapperState.initialChecked})}function P(g,e){var I=null==e.defaultValue?"":e.defaultValue,t=null!=e.checked?e.checked:e.defaultChecked;I=D(null!=e.value?e.value:I),g._wrapperState={initialChecked:t,initialValue:I,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function q(g,e){null!=(e=e.checked)&&h(g,"checked",e,!1)}function _(g,e){q(g,e);var I=D(e.value),t=e.type;if(null!=I)"number"===t?(0===I&&""===g.value||g.value!=I)&&(g.value=""+I):g.value!==""+I&&(g.value=""+I);else if("submit"===t||"reset"===t)return void g.removeAttribute("value");e.hasOwnProperty("value")?gg(g,e.type,I):e.hasOwnProperty("defaultValue")&&gg(g,e.type,D(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(g.defaultChecked=!!e.defaultChecked)}function $(g,e,I){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var t=e.type;if(!("submit"!==t&&"reset"!==t||void 0!==e.value&&null!==e.value))return;e=""+g._wrapperState.initialValue,I||e===g.value||(g.value=e),g.defaultValue=e}""!==(I=g.name)&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,""!==I&&(g.name=I)}function gg(g,e,I){"number"===e&&j(g.ownerDocument)===g||(null==I?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+I&&(g.defaultValue=""+I))}var eg=Array.isArray;function Ig(g,e,I,t){if(g=g.options,e){e={};for(var n=0;n<I.length;n++)e["$"+I[n]]=!0;for(I=0;I<g.length;I++)n=e.hasOwnProperty("$"+g[I].value),g[I].selected!==n&&(g[I].selected=n),n&&t&&(g[I].defaultSelected=!0)}else{for(I=""+D(I),e=null,n=0;n<g.length;n++){if(g[n].value===I)return g[n].selected=!0,void(t&&(g[n].defaultSelected=!0));null!==e||g[n].disabled||(e=g[n])}null!==e&&(e.selected=!0)}}function tg(g,e){if(null!=e.dangerouslySetInnerHTML)throw Error(C(91));return K({},e,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function ng(g,e){var I=e.value;if(null==I){if(I=e.children,e=e.defaultValue,null!=I){if(null!=e)throw Error(C(92));if(eg(I)){if(1<I.length)throw Error(C(93));I=I[0]}e=I}null==e&&(e=""),I=e}g._wrapperState={initialValue:D(I)}}function Cg(g,e){var I=D(e.value),t=D(e.defaultValue);null!=I&&((I=""+I)!==g.value&&(g.value=I),null==e.defaultValue&&g.defaultValue!==I&&(g.defaultValue=I)),null!=t&&(g.defaultValue=""+t)}function lg(g){var e=g.textContent;e===g._wrapperState.initialValue&&""!==e&&null!==e&&(g.value=e)}function og(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ag(g,e){return null==g||"http://www.w3.org/1999/xhtml"===g?og(e):"http://www.w3.org/2000/svg"===g&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":g}var rg,cg,ig=(cg=function(g,e){if("http://www.w3.org/2000/svg"!==g.namespaceURI||"innerHTML"in g)g.innerHTML=e;else{for((rg=rg||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rg.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;e.firstChild;)g.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(g,e,I,t){MSApp.execUnsafeLocalFunction((function(){return cg(g,e)}))}:cg);function Ag(g,e){if(e){var I=g.firstChild;if(I&&I===g.lastChild&&3===I.nodeType)return void(I.nodeValue=e)}g.textContent=e}var sg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dg=["Webkit","ms","Moz","O"];function ug(g,e,I){return null==e||"boolean"===typeof e||""===e?"":I||"number"!==typeof e||0===e||sg.hasOwnProperty(g)&&sg[g]?(""+e).trim():e+"px"}function mg(g,e){for(var I in g=g.style,e)if(e.hasOwnProperty(I)){var t=0===I.indexOf("--"),n=ug(I,e[I],t);"float"===I&&(I="cssFloat"),t?g.setProperty(I,n):g[I]=n}}Object.keys(sg).forEach((function(g){dg.forEach((function(e){e=e+g.charAt(0).toUpperCase()+g.substring(1),sg[e]=sg[g]}))}));var bg=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zg(g,e){if(e){if(bg[g]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(C(137,g));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(C(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(C(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(C(62))}}function hg(g,e){if(-1===g.indexOf("-"))return"string"===typeof e.is;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pg=null;function Gg(g){return(g=g.target||g.srcElement||window).correspondingUseElement&&(g=g.correspondingUseElement),3===g.nodeType?g.parentNode:g}var yg=null,Bg=null,fg=null;function Sg(g){if(g=hn(g)){if("function"!==typeof yg)throw Error(C(280));var e=g.stateNode;e&&(e=Gn(e),yg(g.stateNode,g.type,e))}}function Wg(g){Bg?fg?fg.push(g):fg=[g]:Bg=g}function Vg(){if(Bg){var g=Bg,e=fg;if(fg=Bg=null,Sg(g),e)for(g=0;g<e.length;g++)Sg(e[g])}}function vg(g,e){return g(e)}function Rg(){}var kg=!1;function Xg(g,e,I){if(kg)return g(e,I);kg=!0;try{return vg(g,e,I)}finally{kg=!1,(null!==Bg||null!==fg)&&(Rg(),Vg())}}function Jg(g,e){var I=g.stateNode;if(null===I)return null;var t=Gn(I);if(null===t)return null;I=t[e];g:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(t=!t.disabled)||(t=!("button"===(g=g.type)||"input"===g||"select"===g||"textarea"===g)),g=!t;break g;default:g=!1}if(g)return null;if(I&&"function"!==typeof I)throw Error(C(231,e,typeof I));return I}var Yg=!1;if(c)try{var Hg={};Object.defineProperty(Hg,"passive",{get:function(){Yg=!0}}),window.addEventListener("test",Hg,Hg),window.removeEventListener("test",Hg,Hg)}catch(cg){Yg=!1}function wg(g,e,I,t,n,C,l,o,a){var r=Array.prototype.slice.call(arguments,3);try{e.apply(I,r)}catch(c){this.onError(c)}}var Ng=!1,Kg=null,Fg=!1,xg=null,Eg={onError:function(g){Ng=!0,Kg=g}};function zg(g,e,I,t,n,C,l,o,a){Ng=!1,Kg=null,wg.apply(Eg,arguments)}function Mg(g){var e=g,I=g;if(g.alternate)for(;e.return;)e=e.return;else{g=e;do{0!==(4098&(e=g).flags)&&(I=e.return),g=e.return}while(g)}return 3===e.tag?I:null}function Ug(g){if(13===g.tag){var e=g.memoizedState;if(null===e&&(null!==(g=g.alternate)&&(e=g.memoizedState)),null!==e)return e.dehydrated}return null}function Dg(g){if(Mg(g)!==g)throw Error(C(188))}function Qg(g){return null!==(g=function(g){var e=g.alternate;if(!e){if(null===(e=Mg(g)))throw Error(C(188));return e!==g?null:g}for(var I=g,t=e;;){var n=I.return;if(null===n)break;var l=n.alternate;if(null===l){if(null!==(t=n.return)){I=t;continue}break}if(n.child===l.child){for(l=n.child;l;){if(l===I)return Dg(n),g;if(l===t)return Dg(n),e;l=l.sibling}throw Error(C(188))}if(I.return!==t.return)I=n,t=l;else{for(var o=!1,a=n.child;a;){if(a===I){o=!0,I=n,t=l;break}if(a===t){o=!0,t=n,I=l;break}a=a.sibling}if(!o){for(a=l.child;a;){if(a===I){o=!0,I=l,t=n;break}if(a===t){o=!0,t=l,I=n;break}a=a.sibling}if(!o)throw Error(C(189))}}if(I.alternate!==t)throw Error(C(190))}if(3!==I.tag)throw Error(C(188));return I.stateNode.current===I?g:e}(g))?Lg(g):null}function Lg(g){if(5===g.tag||6===g.tag)return g;for(g=g.child;null!==g;){var e=Lg(g);if(null!==e)return e;g=g.sibling}return null}var Tg=n.unstable_scheduleCallback,jg=n.unstable_cancelCallback,Og=n.unstable_shouldYield,Pg=n.unstable_requestPaint,qg=n.unstable_now,_g=n.unstable_getCurrentPriorityLevel,$g=n.unstable_ImmediatePriority,ge=n.unstable_UserBlockingPriority,ee=n.unstable_NormalPriority,Ie=n.unstable_LowPriority,te=n.unstable_IdlePriority,ne=null,Ce=null;var le=Math.clz32?Math.clz32:function(g){return g>>>=0,0===g?32:31-(oe(g)/ae|0)|0},oe=Math.log,ae=Math.LN2;var re=64,ce=4194304;function ie(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&g;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&g;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function Ae(g,e){var I=g.pendingLanes;if(0===I)return 0;var t=0,n=g.suspendedLanes,C=g.pingedLanes,l=268435455&I;if(0!==l){var o=l&~n;0!==o?t=ie(o):0!==(C&=l)&&(t=ie(C))}else 0!==(l=I&~n)?t=ie(l):0!==C&&(t=ie(C));if(0===t)return 0;if(0!==e&&e!==t&&0===(e&n)&&((n=t&-t)>=(C=e&-e)||16===n&&0!==(4194240&C)))return e;if(0!==(4&t)&&(t|=16&I),0!==(e=g.entangledLanes))for(g=g.entanglements,e&=t;0<e;)n=1<<(I=31-le(e)),t|=g[I],e&=~n;return t}function se(g,e){switch(g){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function de(g){return 0!==(g=-1073741825&g.pendingLanes)?g:1073741824&g?1073741824:0}function ue(){var g=re;return 0===(4194240&(re<<=1))&&(re=64),g}function me(g){for(var e=[],I=0;31>I;I++)e.push(g);return e}function be(g,e,I){g.pendingLanes|=e,536870912!==e&&(g.suspendedLanes=0,g.pingedLanes=0),(g=g.eventTimes)[e=31-le(e)]=I}function Ze(g,e){var I=g.entangledLanes|=e;for(g=g.entanglements;I;){var t=31-le(I),n=1<<t;n&e|g[t]&e&&(g[t]|=e),I&=~n}}var he=0;function pe(g){return 1<(g&=-g)?4<g?0!==(268435455&g)?16:536870912:4:1}var Ge,ye,Be,fe,Se,We=!1,Ve=[],ve=null,Re=null,ke=null,Xe=new Map,Je=new Map,Ye=[],He="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function we(g,e){switch(g){case"focusin":case"focusout":ve=null;break;case"dragenter":case"dragleave":Re=null;break;case"mouseover":case"mouseout":ke=null;break;case"pointerover":case"pointerout":Xe.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Je.delete(e.pointerId)}}function Ne(g,e,I,t,n,C){return null===g||g.nativeEvent!==C?(g={blockedOn:e,domEventName:I,eventSystemFlags:t,nativeEvent:C,targetContainers:[n]},null!==e&&(null!==(e=hn(e))&&ye(e)),g):(g.eventSystemFlags|=t,e=g.targetContainers,null!==n&&-1===e.indexOf(n)&&e.push(n),g)}function Ke(g){var e=Zn(g.target);if(null!==e){var I=Mg(e);if(null!==I)if(13===(e=I.tag)){if(null!==(e=Ug(I)))return g.blockedOn=e,void Se(g.priority,(function(){Be(I)}))}else if(3===e&&I.stateNode.current.memoizedState.isDehydrated)return void(g.blockedOn=3===I.tag?I.stateNode.containerInfo:null)}g.blockedOn=null}function Fe(g){if(null!==g.blockedOn)return!1;for(var e=g.targetContainers;0<e.length;){var I=Oe(g.domEventName,g.eventSystemFlags,e[0],g.nativeEvent);if(null!==I)return null!==(e=hn(I))&&ye(e),g.blockedOn=I,!1;var t=new(I=g.nativeEvent).constructor(I.type,I);pg=t,I.target.dispatchEvent(t),pg=null,e.shift()}return!0}function xe(g,e,I){Fe(g)&&I.delete(e)}function Ee(){We=!1,null!==ve&&Fe(ve)&&(ve=null),null!==Re&&Fe(Re)&&(Re=null),null!==ke&&Fe(ke)&&(ke=null),Xe.forEach(xe),Je.forEach(xe)}function ze(g,e){g.blockedOn===e&&(g.blockedOn=null,We||(We=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Ee)))}function Me(g){function e(e){return ze(e,g)}if(0<Ve.length){ze(Ve[0],g);for(var I=1;I<Ve.length;I++){var t=Ve[I];t.blockedOn===g&&(t.blockedOn=null)}}for(null!==ve&&ze(ve,g),null!==Re&&ze(Re,g),null!==ke&&ze(ke,g),Xe.forEach(e),Je.forEach(e),I=0;I<Ye.length;I++)(t=Ye[I]).blockedOn===g&&(t.blockedOn=null);for(;0<Ye.length&&null===(I=Ye[0]).blockedOn;)Ke(I),null===I.blockedOn&&Ye.shift()}var Ue=p.ReactCurrentBatchConfig,De=!0;function Qe(g,e,I,t){var n=he,C=Ue.transition;Ue.transition=null;try{he=1,Te(g,e,I,t)}finally{he=n,Ue.transition=C}}function Le(g,e,I,t){var n=he,C=Ue.transition;Ue.transition=null;try{he=4,Te(g,e,I,t)}finally{he=n,Ue.transition=C}}function Te(g,e,I,t){if(De){var n=Oe(g,e,I,t);if(null===n)Ut(g,e,t,je,I),we(g,t);else if(function(g,e,I,t,n){switch(e){case"focusin":return ve=Ne(ve,g,e,I,t,n),!0;case"dragenter":return Re=Ne(Re,g,e,I,t,n),!0;case"mouseover":return ke=Ne(ke,g,e,I,t,n),!0;case"pointerover":var C=n.pointerId;return Xe.set(C,Ne(Xe.get(C)||null,g,e,I,t,n)),!0;case"gotpointercapture":return C=n.pointerId,Je.set(C,Ne(Je.get(C)||null,g,e,I,t,n)),!0}return!1}(n,g,e,I,t))t.stopPropagation();else if(we(g,t),4&e&&-1<He.indexOf(g)){for(;null!==n;){var C=hn(n);if(null!==C&&Ge(C),null===(C=Oe(g,e,I,t))&&Ut(g,e,t,je,I),C===n)break;n=C}null!==n&&t.stopPropagation()}else Ut(g,e,t,null,I)}}var je=null;function Oe(g,e,I,t){if(je=null,null!==(g=Zn(g=Gg(t))))if(null===(e=Mg(g)))g=null;else if(13===(I=e.tag)){if(null!==(g=Ug(e)))return g;g=null}else if(3===I){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;g=null}else e!==g&&(g=null);return je=g,null}function Pe(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_g()){case $g:return 1;case ge:return 4;case ee:case Ie:return 16;case te:return 536870912;default:return 16}default:return 16}}var qe=null,_e=null,$e=null;function gI(){if($e)return $e;var g,e,I=_e,t=I.length,n="value"in qe?qe.value:qe.textContent,C=n.length;for(g=0;g<t&&I[g]===n[g];g++);var l=t-g;for(e=1;e<=l&&I[t-e]===n[C-e];e++);return $e=n.slice(g,1<e?1-e:void 0)}function eI(g){var e=g.keyCode;return"charCode"in g?0===(g=g.charCode)&&13===e&&(g=13):g=e,10===g&&(g=13),32<=g||13===g?g:0}function II(){return!0}function tI(){return!1}function nI(g){function e(e,I,t,n,C){for(var l in this._reactName=e,this._targetInst=t,this.type=I,this.nativeEvent=n,this.target=C,this.currentTarget=null,g)g.hasOwnProperty(l)&&(e=g[l],this[l]=e?e(n):n[l]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?II:tI,this.isPropagationStopped=tI,this}return K(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():"unknown"!==typeof g.returnValue&&(g.returnValue=!1),this.isDefaultPrevented=II)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():"unknown"!==typeof g.cancelBubble&&(g.cancelBubble=!0),this.isPropagationStopped=II)},persist:function(){},isPersistent:II}),e}var CI,lI,oI,aI={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rI=nI(aI),cI=K({},aI,{view:0,detail:0}),iI=nI(cI),AI=K({},cI,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fI,button:0,buttons:0,relatedTarget:function(g){return void 0===g.relatedTarget?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==oI&&(oI&&"mousemove"===g.type?(CI=g.screenX-oI.screenX,lI=g.screenY-oI.screenY):lI=CI=0,oI=g),CI)},movementY:function(g){return"movementY"in g?g.movementY:lI}}),sI=nI(AI),dI=nI(K({},AI,{dataTransfer:0})),uI=nI(K({},cI,{relatedTarget:0})),mI=nI(K({},aI,{animationName:0,elapsedTime:0,pseudoElement:0})),bI=K({},aI,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),ZI=nI(bI),hI=nI(K({},aI,{data:0})),pI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},GI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BI(g){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(g):!!(g=yI[g])&&!!e[g]}function fI(){return BI}var SI=K({},cI,{key:function(g){if(g.key){var e=pI[g.key]||g.key;if("Unidentified"!==e)return e}return"keypress"===g.type?13===(g=eI(g))?"Enter":String.fromCharCode(g):"keydown"===g.type||"keyup"===g.type?GI[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fI,charCode:function(g){return"keypress"===g.type?eI(g):0},keyCode:function(g){return"keydown"===g.type||"keyup"===g.type?g.keyCode:0},which:function(g){return"keypress"===g.type?eI(g):"keydown"===g.type||"keyup"===g.type?g.keyCode:0}}),WI=nI(SI),VI=nI(K({},AI,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vI=nI(K({},cI,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fI})),RI=nI(K({},aI,{propertyName:0,elapsedTime:0,pseudoElement:0})),kI=K({},AI,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),XI=nI(kI),JI=[9,13,27,32],YI=c&&"CompositionEvent"in window,HI=null;c&&"documentMode"in document&&(HI=document.documentMode);var wI=c&&"TextEvent"in window&&!HI,NI=c&&(!YI||HI&&8<HI&&11>=HI),KI=String.fromCharCode(32),FI=!1;function xI(g,e){switch(g){case"keyup":return-1!==JI.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EI(g){return"object"===typeof(g=g.detail)&&"data"in g?g.data:null}var zI=!1;var MI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function UI(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return"input"===e?!!MI[g.type]:"textarea"===e}function DI(g,e,I,t){Wg(t),0<(e=Qt(e,"onChange")).length&&(I=new rI("onChange","change",null,I,t),g.push({event:I,listeners:e}))}var QI=null,LI=null;function TI(g){Kt(g,0)}function jI(g){if(T(pn(g)))return g}function OI(g,e){if("change"===g)return e}var PI=!1;if(c){var qI;if(c){var _I="oninput"in document;if(!_I){var $I=document.createElement("div");$I.setAttribute("oninput","return;"),_I="function"===typeof $I.oninput}qI=_I}else qI=!1;PI=qI&&(!document.documentMode||9<document.documentMode)}function gt(){QI&&(QI.detachEvent("onpropertychange",et),LI=QI=null)}function et(g){if("value"===g.propertyName&&jI(LI)){var e=[];DI(e,LI,g,Gg(g)),Xg(TI,e)}}function It(g,e,I){"focusin"===g?(gt(),LI=I,(QI=e).attachEvent("onpropertychange",et)):"focusout"===g&&gt()}function tt(g){if("selectionchange"===g||"keyup"===g||"keydown"===g)return jI(LI)}function nt(g,e){if("click"===g)return jI(e)}function Ct(g,e){if("input"===g||"change"===g)return jI(e)}var lt="function"===typeof Object.is?Object.is:function(g,e){return g===e&&(0!==g||1/g===1/e)||g!==g&&e!==e};function ot(g,e){if(lt(g,e))return!0;if("object"!==typeof g||null===g||"object"!==typeof e||null===e)return!1;var I=Object.keys(g),t=Object.keys(e);if(I.length!==t.length)return!1;for(t=0;t<I.length;t++){var n=I[t];if(!i.call(e,n)||!lt(g[n],e[n]))return!1}return!0}function at(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function rt(g,e){var I,t=at(g);for(g=0;t;){if(3===t.nodeType){if(I=g+t.textContent.length,g<=e&&I>=e)return{node:t,offset:e-g};g=I}g:{for(;t;){if(t.nextSibling){t=t.nextSibling;break g}t=t.parentNode}t=void 0}t=at(t)}}function ct(g,e){return!(!g||!e)&&(g===e||(!g||3!==g.nodeType)&&(e&&3===e.nodeType?ct(g,e.parentNode):"contains"in g?g.contains(e):!!g.compareDocumentPosition&&!!(16&g.compareDocumentPosition(e))))}function it(){for(var g=window,e=j();e instanceof g.HTMLIFrameElement;){try{var I="string"===typeof e.contentWindow.location.href}catch(t){I=!1}if(!I)break;e=j((g=e.contentWindow).document)}return e}function At(g){var e=g&&g.nodeName&&g.nodeName.toLowerCase();return e&&("input"===e&&("text"===g.type||"search"===g.type||"tel"===g.type||"url"===g.type||"password"===g.type)||"textarea"===e||"true"===g.contentEditable)}function st(g){var e=it(),I=g.focusedElem,t=g.selectionRange;if(e!==I&&I&&I.ownerDocument&&ct(I.ownerDocument.documentElement,I)){if(null!==t&&At(I))if(e=t.start,void 0===(g=t.end)&&(g=e),"selectionStart"in I)I.selectionStart=e,I.selectionEnd=Math.min(g,I.value.length);else if((g=(e=I.ownerDocument||document)&&e.defaultView||window).getSelection){g=g.getSelection();var n=I.textContent.length,C=Math.min(t.start,n);t=void 0===t.end?C:Math.min(t.end,n),!g.extend&&C>t&&(n=t,t=C,C=n),n=rt(I,C);var l=rt(I,t);n&&l&&(1!==g.rangeCount||g.anchorNode!==n.node||g.anchorOffset!==n.offset||g.focusNode!==l.node||g.focusOffset!==l.offset)&&((e=e.createRange()).setStart(n.node,n.offset),g.removeAllRanges(),C>t?(g.addRange(e),g.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),g.addRange(e)))}for(e=[],g=I;g=g.parentNode;)1===g.nodeType&&e.push({element:g,left:g.scrollLeft,top:g.scrollTop});for("function"===typeof I.focus&&I.focus(),I=0;I<e.length;I++)(g=e[I]).element.scrollLeft=g.left,g.element.scrollTop=g.top}}var dt=c&&"documentMode"in document&&11>=document.documentMode,ut=null,mt=null,bt=null,Zt=!1;function ht(g,e,I){var t=I.window===I?I.document:9===I.nodeType?I:I.ownerDocument;Zt||null==ut||ut!==j(t)||("selectionStart"in(t=ut)&&At(t)?t={start:t.selectionStart,end:t.selectionEnd}:t={anchorNode:(t=(t.ownerDocument&&t.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset},bt&&ot(bt,t)||(bt=t,0<(t=Qt(mt,"onSelect")).length&&(e=new rI("onSelect","select",null,e,I),g.push({event:e,listeners:t}),e.target=ut)))}function pt(g,e){var I={};return I[g.toLowerCase()]=e.toLowerCase(),I["Webkit"+g]="webkit"+e,I["Moz"+g]="moz"+e,I}var Gt={animationend:pt("Animation","AnimationEnd"),animationiteration:pt("Animation","AnimationIteration"),animationstart:pt("Animation","AnimationStart"),transitionend:pt("Transition","TransitionEnd")},yt={},Bt={};function ft(g){if(yt[g])return yt[g];if(!Gt[g])return g;var e,I=Gt[g];for(e in I)if(I.hasOwnProperty(e)&&e in Bt)return yt[g]=I[e];return g}c&&(Bt=document.createElement("div").style,"AnimationEvent"in window||(delete Gt.animationend.animation,delete Gt.animationiteration.animation,delete Gt.animationstart.animation),"TransitionEvent"in window||delete Gt.transitionend.transition);var St=ft("animationend"),Wt=ft("animationiteration"),Vt=ft("animationstart"),vt=ft("transitionend"),Rt=new Map,kt="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xt(g,e){Rt.set(g,e),a(e,[g])}for(var Jt=0;Jt<kt.length;Jt++){var Yt=kt[Jt];Xt(Yt.toLowerCase(),"on"+(Yt[0].toUpperCase()+Yt.slice(1)))}Xt(St,"onAnimationEnd"),Xt(Wt,"onAnimationIteration"),Xt(Vt,"onAnimationStart"),Xt("dblclick","onDoubleClick"),Xt("focusin","onFocus"),Xt("focusout","onBlur"),Xt(vt,"onTransitionEnd"),r("onMouseEnter",["mouseout","mouseover"]),r("onMouseLeave",["mouseout","mouseover"]),r("onPointerEnter",["pointerout","pointerover"]),r("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ht="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wt=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ht));function Nt(g,e,I){var t=g.type||"unknown-event";g.currentTarget=I,function(g,e,I,t,n,l,o,a,r){if(zg.apply(this,arguments),Ng){if(!Ng)throw Error(C(198));var c=Kg;Ng=!1,Kg=null,Fg||(Fg=!0,xg=c)}}(t,e,void 0,g),g.currentTarget=null}function Kt(g,e){e=0!==(4&e);for(var I=0;I<g.length;I++){var t=g[I],n=t.event;t=t.listeners;g:{var C=void 0;if(e)for(var l=t.length-1;0<=l;l--){var o=t[l],a=o.instance,r=o.currentTarget;if(o=o.listener,a!==C&&n.isPropagationStopped())break g;Nt(n,o,r),C=a}else for(l=0;l<t.length;l++){if(a=(o=t[l]).instance,r=o.currentTarget,o=o.listener,a!==C&&n.isPropagationStopped())break g;Nt(n,o,r),C=a}}}if(Fg)throw g=xg,Fg=!1,xg=null,g}function Ft(g,e){var I=e[un];void 0===I&&(I=e[un]=new Set);var t=g+"__bubble";I.has(t)||(Mt(e,g,2,!1),I.add(t))}function xt(g,e,I){var t=0;e&&(t|=4),Mt(I,g,t,e)}var Et="_reactListening"+Math.random().toString(36).slice(2);function zt(g){if(!g[Et]){g[Et]=!0,l.forEach((function(e){"selectionchange"!==e&&(wt.has(e)||xt(e,!1,g),xt(e,!0,g))}));var e=9===g.nodeType?g:g.ownerDocument;null===e||e[Et]||(e[Et]=!0,xt("selectionchange",!1,e))}}function Mt(g,e,I,t){switch(Pe(e)){case 1:var n=Qe;break;case 4:n=Le;break;default:n=Te}I=n.bind(null,e,I,g),n=void 0,!Yg||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(n=!0),t?void 0!==n?g.addEventListener(e,I,{capture:!0,passive:n}):g.addEventListener(e,I,!0):void 0!==n?g.addEventListener(e,I,{passive:n}):g.addEventListener(e,I,!1)}function Ut(g,e,I,t,n){var C=t;if(0===(1&e)&&0===(2&e)&&null!==t)g:for(;;){if(null===t)return;var l=t.tag;if(3===l||4===l){var o=t.stateNode.containerInfo;if(o===n||8===o.nodeType&&o.parentNode===n)break;if(4===l)for(l=t.return;null!==l;){var a=l.tag;if((3===a||4===a)&&((a=l.stateNode.containerInfo)===n||8===a.nodeType&&a.parentNode===n))return;l=l.return}for(;null!==o;){if(null===(l=Zn(o)))return;if(5===(a=l.tag)||6===a){t=C=l;continue g}o=o.parentNode}}t=t.return}Xg((function(){var t=C,n=Gg(I),l=[];g:{var o=Rt.get(g);if(void 0!==o){var a=rI,r=g;switch(g){case"keypress":if(0===eI(I))break g;case"keydown":case"keyup":a=WI;break;case"focusin":r="focus",a=uI;break;case"focusout":r="blur",a=uI;break;case"beforeblur":case"afterblur":a=uI;break;case"click":if(2===I.button)break g;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=sI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=dI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=vI;break;case St:case Wt:case Vt:a=mI;break;case vt:a=RI;break;case"scroll":a=iI;break;case"wheel":a=XI;break;case"copy":case"cut":case"paste":a=ZI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=VI}var c=0!==(4&e),i=!c&&"scroll"===g,A=c?null!==o?o+"Capture":null:o;c=[];for(var s,d=t;null!==d;){var u=(s=d).stateNode;if(5===s.tag&&null!==u&&(s=u,null!==A&&(null!=(u=Jg(d,A))&&c.push(Dt(d,u,s)))),i)break;d=d.return}0<c.length&&(o=new a(o,r,null,I,n),l.push({event:o,listeners:c}))}}if(0===(7&e)){if(a="mouseout"===g||"pointerout"===g,(!(o="mouseover"===g||"pointerover"===g)||I===pg||!(r=I.relatedTarget||I.fromElement)||!Zn(r)&&!r[dn])&&(a||o)&&(o=n.window===n?n:(o=n.ownerDocument)?o.defaultView||o.parentWindow:window,a?(a=t,null!==(r=(r=I.relatedTarget||I.toElement)?Zn(r):null)&&(r!==(i=Mg(r))||5!==r.tag&&6!==r.tag)&&(r=null)):(a=null,r=t),a!==r)){if(c=sI,u="onMouseLeave",A="onMouseEnter",d="mouse","pointerout"!==g&&"pointerover"!==g||(c=VI,u="onPointerLeave",A="onPointerEnter",d="pointer"),i=null==a?o:pn(a),s=null==r?o:pn(r),(o=new c(u,d+"leave",a,I,n)).target=i,o.relatedTarget=s,u=null,Zn(n)===t&&((c=new c(A,d+"enter",r,I,n)).target=s,c.relatedTarget=i,u=c),i=u,a&&r)g:{for(A=r,d=0,s=c=a;s;s=Lt(s))d++;for(s=0,u=A;u;u=Lt(u))s++;for(;0<d-s;)c=Lt(c),d--;for(;0<s-d;)A=Lt(A),s--;for(;d--;){if(c===A||null!==A&&c===A.alternate)break g;c=Lt(c),A=Lt(A)}c=null}else c=null;null!==a&&Tt(l,o,a,c,!1),null!==r&&null!==i&&Tt(l,i,r,c,!0)}if("select"===(a=(o=t?pn(t):window).nodeName&&o.nodeName.toLowerCase())||"input"===a&&"file"===o.type)var m=OI;else if(UI(o))if(PI)m=Ct;else{m=tt;var b=It}else(a=o.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=nt);switch(m&&(m=m(g,t))?DI(l,m,I,n):(b&&b(g,o,t),"focusout"===g&&(b=o._wrapperState)&&b.controlled&&"number"===o.type&&gg(o,"number",o.value)),b=t?pn(t):window,g){case"focusin":(UI(b)||"true"===b.contentEditable)&&(ut=b,mt=t,bt=null);break;case"focusout":bt=mt=ut=null;break;case"mousedown":Zt=!0;break;case"contextmenu":case"mouseup":case"dragend":Zt=!1,ht(l,I,n);break;case"selectionchange":if(dt)break;case"keydown":case"keyup":ht(l,I,n)}var Z;if(YI)g:{switch(g){case"compositionstart":var h="onCompositionStart";break g;case"compositionend":h="onCompositionEnd";break g;case"compositionupdate":h="onCompositionUpdate";break g}h=void 0}else zI?xI(g,I)&&(h="onCompositionEnd"):"keydown"===g&&229===I.keyCode&&(h="onCompositionStart");h&&(NI&&"ko"!==I.locale&&(zI||"onCompositionStart"!==h?"onCompositionEnd"===h&&zI&&(Z=gI()):(_e="value"in(qe=n)?qe.value:qe.textContent,zI=!0)),0<(b=Qt(t,h)).length&&(h=new hI(h,g,null,I,n),l.push({event:h,listeners:b}),Z?h.data=Z:null!==(Z=EI(I))&&(h.data=Z))),(Z=wI?function(g,e){switch(g){case"compositionend":return EI(e);case"keypress":return 32!==e.which?null:(FI=!0,KI);case"textInput":return(g=e.data)===KI&&FI?null:g;default:return null}}(g,I):function(g,e){if(zI)return"compositionend"===g||!YI&&xI(g,e)?(g=gI(),$e=_e=qe=null,zI=!1,g):null;switch(g){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return NI&&"ko"!==e.locale?null:e.data}}(g,I))&&(0<(t=Qt(t,"onBeforeInput")).length&&(n=new hI("onBeforeInput","beforeinput",null,I,n),l.push({event:n,listeners:t}),n.data=Z))}Kt(l,e)}))}function Dt(g,e,I){return{instance:g,listener:e,currentTarget:I}}function Qt(g,e){for(var I=e+"Capture",t=[];null!==g;){var n=g,C=n.stateNode;5===n.tag&&null!==C&&(n=C,null!=(C=Jg(g,I))&&t.unshift(Dt(g,C,n)),null!=(C=Jg(g,e))&&t.push(Dt(g,C,n))),g=g.return}return t}function Lt(g){if(null===g)return null;do{g=g.return}while(g&&5!==g.tag);return g||null}function Tt(g,e,I,t,n){for(var C=e._reactName,l=[];null!==I&&I!==t;){var o=I,a=o.alternate,r=o.stateNode;if(null!==a&&a===t)break;5===o.tag&&null!==r&&(o=r,n?null!=(a=Jg(I,C))&&l.unshift(Dt(I,a,o)):n||null!=(a=Jg(I,C))&&l.push(Dt(I,a,o))),I=I.return}0!==l.length&&g.push({event:e,listeners:l})}var jt=/\r\n?/g,Ot=/\u0000|\uFFFD/g;function Pt(g){return("string"===typeof g?g:""+g).replace(jt,"\n").replace(Ot,"")}function qt(g,e,I){if(e=Pt(e),Pt(g)!==e&&I)throw Error(C(425))}function _t(){}var $t=null,gn=null;function en(g,e){return"textarea"===g||"noscript"===g||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var In="function"===typeof setTimeout?setTimeout:void 0,tn="function"===typeof clearTimeout?clearTimeout:void 0,nn="function"===typeof Promise?Promise:void 0,Cn="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof nn?function(g){return nn.resolve(null).then(g).catch(ln)}:In;function ln(g){setTimeout((function(){throw g}))}function on(g,e){var I=e,t=0;do{var n=I.nextSibling;if(g.removeChild(I),n&&8===n.nodeType)if("/$"===(I=n.data)){if(0===t)return g.removeChild(n),void Me(e);t--}else"$"!==I&&"$?"!==I&&"$!"!==I||t++;I=n}while(I);Me(e)}function an(g){for(;null!=g;g=g.nextSibling){var e=g.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=g.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return g}function rn(g){g=g.previousSibling;for(var e=0;g;){if(8===g.nodeType){var I=g.data;if("$"===I||"$!"===I||"$?"===I){if(0===e)return g;e--}else"/$"===I&&e++}g=g.previousSibling}return null}var cn=Math.random().toString(36).slice(2),An="__reactFiber$"+cn,sn="__reactProps$"+cn,dn="__reactContainer$"+cn,un="__reactEvents$"+cn,mn="__reactListeners$"+cn,bn="__reactHandles$"+cn;function Zn(g){var e=g[An];if(e)return e;for(var I=g.parentNode;I;){if(e=I[dn]||I[An]){if(I=e.alternate,null!==e.child||null!==I&&null!==I.child)for(g=rn(g);null!==g;){if(I=g[An])return I;g=rn(g)}return e}I=(g=I).parentNode}return null}function hn(g){return!(g=g[An]||g[dn])||5!==g.tag&&6!==g.tag&&13!==g.tag&&3!==g.tag?null:g}function pn(g){if(5===g.tag||6===g.tag)return g.stateNode;throw Error(C(33))}function Gn(g){return g[sn]||null}var yn=[],Bn=-1;function fn(g){return{current:g}}function Sn(g){0>Bn||(g.current=yn[Bn],yn[Bn]=null,Bn--)}function Wn(g,e){Bn++,yn[Bn]=g.current,g.current=e}var Vn={},vn=fn(Vn),Rn=fn(!1),kn=Vn;function Xn(g,e){var I=g.type.contextTypes;if(!I)return Vn;var t=g.stateNode;if(t&&t.__reactInternalMemoizedUnmaskedChildContext===e)return t.__reactInternalMemoizedMaskedChildContext;var n,C={};for(n in I)C[n]=e[n];return t&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,g.__reactInternalMemoizedMaskedChildContext=C),C}function Jn(g){return null!==(g=g.childContextTypes)&&void 0!==g}function Yn(){Sn(Rn),Sn(vn)}function Hn(g,e,I){if(vn.current!==Vn)throw Error(C(168));Wn(vn,e),Wn(Rn,I)}function wn(g,e,I){var t=g.stateNode;if(e=e.childContextTypes,"function"!==typeof t.getChildContext)return I;for(var n in t=t.getChildContext())if(!(n in e))throw Error(C(108,U(g)||"Unknown",n));return K({},I,t)}function Nn(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Vn,kn=vn.current,Wn(vn,g),Wn(Rn,Rn.current),!0}function Kn(g,e,I){var t=g.stateNode;if(!t)throw Error(C(169));I?(g=wn(g,e,kn),t.__reactInternalMemoizedMergedChildContext=g,Sn(Rn),Sn(vn),Wn(vn,g)):Sn(Rn),Wn(Rn,I)}var Fn=null,xn=!1,En=!1;function zn(g){null===Fn?Fn=[g]:Fn.push(g)}function Mn(){if(!En&&null!==Fn){En=!0;var g=0,e=he;try{var I=Fn;for(he=1;g<I.length;g++){var t=I[g];do{t=t(!0)}while(null!==t)}Fn=null,xn=!1}catch(n){throw null!==Fn&&(Fn=Fn.slice(g+1)),Tg($g,Mn),n}finally{he=e,En=!1}}return null}var Un=[],Dn=0,Qn=null,Ln=0,Tn=[],jn=0,On=null,Pn=1,qn="";function _n(g,e){Un[Dn++]=Ln,Un[Dn++]=Qn,Qn=g,Ln=e}function $n(g,e,I){Tn[jn++]=Pn,Tn[jn++]=qn,Tn[jn++]=On,On=g;var t=Pn;g=qn;var n=32-le(t)-1;t&=~(1<<n),I+=1;var C=32-le(e)+n;if(30<C){var l=n-n%5;C=(t&(1<<l)-1).toString(32),t>>=l,n-=l,Pn=1<<32-le(e)+n|I<<n|t,qn=C+g}else Pn=1<<C|I<<n|t,qn=g}function gC(g){null!==g.return&&(_n(g,1),$n(g,1,0))}function eC(g){for(;g===Qn;)Qn=Un[--Dn],Un[Dn]=null,Ln=Un[--Dn],Un[Dn]=null;for(;g===On;)On=Tn[--jn],Tn[jn]=null,qn=Tn[--jn],Tn[jn]=null,Pn=Tn[--jn],Tn[jn]=null}var IC=null,tC=null,nC=!1,CC=null;function lC(g,e){var I=Jr(5,null,null,0);I.elementType="DELETED",I.stateNode=e,I.return=g,null===(e=g.deletions)?(g.deletions=[I],g.flags|=16):e.push(I)}function oC(g,e){switch(g.tag){case 5:var I=g.type;return null!==(e=1!==e.nodeType||I.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(g.stateNode=e,IC=g,tC=an(e.firstChild),!0);case 6:return null!==(e=""===g.pendingProps||3!==e.nodeType?null:e)&&(g.stateNode=e,IC=g,tC=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(I=null!==On?{id:Pn,overflow:qn}:null,g.memoizedState={dehydrated:e,treeContext:I,retryLane:1073741824},(I=Jr(18,null,null,0)).stateNode=e,I.return=g,g.child=I,IC=g,tC=null,!0);default:return!1}}function aC(g){return 0!==(1&g.mode)&&0===(128&g.flags)}function rC(g){if(nC){var e=tC;if(e){var I=e;if(!oC(g,e)){if(aC(g))throw Error(C(418));e=an(I.nextSibling);var t=IC;e&&oC(g,e)?lC(t,I):(g.flags=-4097&g.flags|2,nC=!1,IC=g)}}else{if(aC(g))throw Error(C(418));g.flags=-4097&g.flags|2,nC=!1,IC=g}}}function cC(g){for(g=g.return;null!==g&&5!==g.tag&&3!==g.tag&&13!==g.tag;)g=g.return;IC=g}function iC(g){if(g!==IC)return!1;if(!nC)return cC(g),nC=!0,!1;var e;if((e=3!==g.tag)&&!(e=5!==g.tag)&&(e="head"!==(e=g.type)&&"body"!==e&&!en(g.type,g.memoizedProps)),e&&(e=tC)){if(aC(g))throw AC(),Error(C(418));for(;e;)lC(g,e),e=an(e.nextSibling)}if(cC(g),13===g.tag){if(!(g=null!==(g=g.memoizedState)?g.dehydrated:null))throw Error(C(317));g:{for(g=g.nextSibling,e=0;g;){if(8===g.nodeType){var I=g.data;if("/$"===I){if(0===e){tC=an(g.nextSibling);break g}e--}else"$"!==I&&"$!"!==I&&"$?"!==I||e++}g=g.nextSibling}tC=null}}else tC=IC?an(g.stateNode.nextSibling):null;return!0}function AC(){for(var g=tC;g;)g=an(g.nextSibling)}function sC(){tC=IC=null,nC=!1}function dC(g){null===CC?CC=[g]:CC.push(g)}var uC=p.ReactCurrentBatchConfig;function mC(g,e){if(g&&g.defaultProps){for(var I in e=K({},e),g=g.defaultProps)void 0===e[I]&&(e[I]=g[I]);return e}return e}var bC=fn(null),ZC=null,hC=null,pC=null;function GC(){pC=hC=ZC=null}function yC(g){var e=bC.current;Sn(bC),g._currentValue=e}function BC(g,e,I){for(;null!==g;){var t=g.alternate;if((g.childLanes&e)!==e?(g.childLanes|=e,null!==t&&(t.childLanes|=e)):null!==t&&(t.childLanes&e)!==e&&(t.childLanes|=e),g===I)break;g=g.return}}function fC(g,e){ZC=g,pC=hC=null,null!==(g=g.dependencies)&&null!==g.firstContext&&(0!==(g.lanes&e)&&(po=!0),g.firstContext=null)}function SC(g){var e=g._currentValue;if(pC!==g)if(g={context:g,memoizedValue:e,next:null},null===hC){if(null===ZC)throw Error(C(308));hC=g,ZC.dependencies={lanes:0,firstContext:g}}else hC=hC.next=g;return e}var WC=null;function VC(g){null===WC?WC=[g]:WC.push(g)}function vC(g,e,I,t){var n=e.interleaved;return null===n?(I.next=I,VC(e)):(I.next=n.next,n.next=I),e.interleaved=I,RC(g,t)}function RC(g,e){g.lanes|=e;var I=g.alternate;for(null!==I&&(I.lanes|=e),I=g,g=g.return;null!==g;)g.childLanes|=e,null!==(I=g.alternate)&&(I.childLanes|=e),I=g,g=g.return;return 3===I.tag?I.stateNode:null}var kC=!1;function XC(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JC(g,e){g=g.updateQueue,e.updateQueue===g&&(e.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function YC(g,e){return{eventTime:g,lane:e,tag:0,payload:null,callback:null,next:null}}function HC(g,e,I){var t=g.updateQueue;if(null===t)return null;if(t=t.shared,0!==(2&Ra)){var n=t.pending;return null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e,RC(g,I)}return null===(n=t.interleaved)?(e.next=e,VC(t)):(e.next=n.next,n.next=e),t.interleaved=e,RC(g,I)}function wC(g,e,I){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&I))){var t=e.lanes;I|=t&=g.pendingLanes,e.lanes=I,Ze(g,I)}}function NC(g,e){var I=g.updateQueue,t=g.alternate;if(null!==t&&I===(t=t.updateQueue)){var n=null,C=null;if(null!==(I=I.firstBaseUpdate)){do{var l={eventTime:I.eventTime,lane:I.lane,tag:I.tag,payload:I.payload,callback:I.callback,next:null};null===C?n=C=l:C=C.next=l,I=I.next}while(null!==I);null===C?n=C=e:C=C.next=e}else n=C=e;return I={baseState:t.baseState,firstBaseUpdate:n,lastBaseUpdate:C,shared:t.shared,effects:t.effects},void(g.updateQueue=I)}null===(g=I.lastBaseUpdate)?I.firstBaseUpdate=e:g.next=e,I.lastBaseUpdate=e}function KC(g,e,I,t){var n=g.updateQueue;kC=!1;var C=n.firstBaseUpdate,l=n.lastBaseUpdate,o=n.shared.pending;if(null!==o){n.shared.pending=null;var a=o,r=a.next;a.next=null,null===l?C=r:l.next=r,l=a;var c=g.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==l&&(null===o?c.firstBaseUpdate=r:o.next=r,c.lastBaseUpdate=a))}if(null!==C){var i=n.baseState;for(l=0,c=r=a=null,o=C;;){var A=o.lane,s=o.eventTime;if((t&A)===A){null!==c&&(c=c.next={eventTime:s,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});g:{var d=g,u=o;switch(A=e,s=I,u.tag){case 1:if("function"===typeof(d=u.payload)){i=d.call(s,i,A);break g}i=d;break g;case 3:d.flags=-65537&d.flags|128;case 0:if(null===(A="function"===typeof(d=u.payload)?d.call(s,i,A):d)||void 0===A)break g;i=K({},i,A);break g;case 2:kC=!0}}null!==o.callback&&0!==o.lane&&(g.flags|=64,null===(A=n.effects)?n.effects=[o]:A.push(o))}else s={eventTime:s,lane:A,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(r=c=s,a=i):c=c.next=s,l|=A;if(null===(o=o.next)){if(null===(o=n.shared.pending))break;o=(A=o).next,A.next=null,n.lastBaseUpdate=A,n.shared.pending=null}}if(null===c&&(a=i),n.baseState=a,n.firstBaseUpdate=r,n.lastBaseUpdate=c,null!==(e=n.shared.interleaved)){n=e;do{l|=n.lane,n=n.next}while(n!==e)}else null===C&&(n.shared.lanes=0);Ka|=l,g.lanes=l,g.memoizedState=i}}function FC(g,e,I){if(g=e.effects,e.effects=null,null!==g)for(e=0;e<g.length;e++){var t=g[e],n=t.callback;if(null!==n){if(t.callback=null,t=I,"function"!==typeof n)throw Error(C(191,n));n.call(t)}}}var xC=(new t.Component).refs;function EC(g,e,I,t){I=null===(I=I(t,e=g.memoizedState))||void 0===I?e:K({},e,I),g.memoizedState=I,0===g.lanes&&(g.updateQueue.baseState=I)}var zC={isMounted:function(g){return!!(g=g._reactInternals)&&Mg(g)===g},enqueueSetState:function(g,e,I){g=g._reactInternals;var t=er(),n=Ir(g),C=YC(t,n);C.payload=e,void 0!==I&&null!==I&&(C.callback=I),null!==(e=HC(g,C,n))&&(tr(e,g,n,t),wC(e,g,n))},enqueueReplaceState:function(g,e,I){g=g._reactInternals;var t=er(),n=Ir(g),C=YC(t,n);C.tag=1,C.payload=e,void 0!==I&&null!==I&&(C.callback=I),null!==(e=HC(g,C,n))&&(tr(e,g,n,t),wC(e,g,n))},enqueueForceUpdate:function(g,e){g=g._reactInternals;var I=er(),t=Ir(g),n=YC(I,t);n.tag=2,void 0!==e&&null!==e&&(n.callback=e),null!==(e=HC(g,n,t))&&(tr(e,g,t,I),wC(e,g,t))}};function MC(g,e,I,t,n,C,l){return"function"===typeof(g=g.stateNode).shouldComponentUpdate?g.shouldComponentUpdate(t,C,l):!e.prototype||!e.prototype.isPureReactComponent||(!ot(I,t)||!ot(n,C))}function UC(g,e,I){var t=!1,n=Vn,C=e.contextType;return"object"===typeof C&&null!==C?C=SC(C):(n=Jn(e)?kn:vn.current,C=(t=null!==(t=e.contextTypes)&&void 0!==t)?Xn(g,n):Vn),e=new e(I,C),g.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=zC,g.stateNode=e,e._reactInternals=g,t&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,g.__reactInternalMemoizedMaskedChildContext=C),e}function DC(g,e,I,t){g=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(I,t),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(I,t),e.state!==g&&zC.enqueueReplaceState(e,e.state,null)}function QC(g,e,I,t){var n=g.stateNode;n.props=I,n.state=g.memoizedState,n.refs=xC,XC(g);var C=e.contextType;"object"===typeof C&&null!==C?n.context=SC(C):(C=Jn(e)?kn:vn.current,n.context=Xn(g,C)),n.state=g.memoizedState,"function"===typeof(C=e.getDerivedStateFromProps)&&(EC(g,e,C,I),n.state=g.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(e=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),e!==n.state&&zC.enqueueReplaceState(n,n.state,null),KC(g,I,n,t),n.state=g.memoizedState),"function"===typeof n.componentDidMount&&(g.flags|=4194308)}function LC(g,e,I){if(null!==(g=I.ref)&&"function"!==typeof g&&"object"!==typeof g){if(I._owner){if(I=I._owner){if(1!==I.tag)throw Error(C(309));var t=I.stateNode}if(!t)throw Error(C(147,g));var n=t,l=""+g;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===l?e.ref:(e=function(g){var e=n.refs;e===xC&&(e=n.refs={}),null===g?delete e[l]:e[l]=g},e._stringRef=l,e)}if("string"!==typeof g)throw Error(C(284));if(!I._owner)throw Error(C(290,g))}return g}function TC(g,e){throw g=Object.prototype.toString.call(e),Error(C(31,"[object Object]"===g?"object with keys {"+Object.keys(e).join(", ")+"}":g))}function jC(g){return(0,g._init)(g._payload)}function OC(g){function e(e,I){if(g){var t=e.deletions;null===t?(e.deletions=[I],e.flags|=16):t.push(I)}}function I(I,t){if(!g)return null;for(;null!==t;)e(I,t),t=t.sibling;return null}function t(g,e){for(g=new Map;null!==e;)null!==e.key?g.set(e.key,e):g.set(e.index,e),e=e.sibling;return g}function n(g,e){return(g=Hr(g,e)).index=0,g.sibling=null,g}function l(e,I,t){return e.index=t,g?null!==(t=e.alternate)?(t=t.index)<I?(e.flags|=2,I):t:(e.flags|=2,I):(e.flags|=1048576,I)}function o(e){return g&&null===e.alternate&&(e.flags|=2),e}function a(g,e,I,t){return null===e||6!==e.tag?((e=Fr(I,g.mode,t)).return=g,e):((e=n(e,I)).return=g,e)}function r(g,e,I,t){var C=I.type;return C===B?i(g,e,I.props.children,t,I.key):null!==e&&(e.elementType===C||"object"===typeof C&&null!==C&&C.$$typeof===J&&jC(C)===e.type)?((t=n(e,I.props)).ref=LC(g,e,I),t.return=g,t):((t=wr(I.type,I.key,I.props,null,g.mode,t)).ref=LC(g,e,I),t.return=g,t)}function c(g,e,I,t){return null===e||4!==e.tag||e.stateNode.containerInfo!==I.containerInfo||e.stateNode.implementation!==I.implementation?((e=xr(I,g.mode,t)).return=g,e):((e=n(e,I.children||[])).return=g,e)}function i(g,e,I,t,C){return null===e||7!==e.tag?((e=Nr(I,g.mode,t,C)).return=g,e):((e=n(e,I)).return=g,e)}function A(g,e,I){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Fr(""+e,g.mode,I)).return=g,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case G:return(I=wr(e.type,e.key,e.props,null,g.mode,I)).ref=LC(g,null,e),I.return=g,I;case y:return(e=xr(e,g.mode,I)).return=g,e;case J:return A(g,(0,e._init)(e._payload),I)}if(eg(e)||w(e))return(e=Nr(e,g.mode,I,null)).return=g,e;TC(g,e)}return null}function s(g,e,I,t){var n=null!==e?e.key:null;if("string"===typeof I&&""!==I||"number"===typeof I)return null!==n?null:a(g,e,""+I,t);if("object"===typeof I&&null!==I){switch(I.$$typeof){case G:return I.key===n?r(g,e,I,t):null;case y:return I.key===n?c(g,e,I,t):null;case J:return s(g,e,(n=I._init)(I._payload),t)}if(eg(I)||w(I))return null!==n?null:i(g,e,I,t,null);TC(g,I)}return null}function d(g,e,I,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return a(e,g=g.get(I)||null,""+t,n);if("object"===typeof t&&null!==t){switch(t.$$typeof){case G:return r(e,g=g.get(null===t.key?I:t.key)||null,t,n);case y:return c(e,g=g.get(null===t.key?I:t.key)||null,t,n);case J:return d(g,e,I,(0,t._init)(t._payload),n)}if(eg(t)||w(t))return i(e,g=g.get(I)||null,t,n,null);TC(e,t)}return null}function u(n,C,o,a){for(var r=null,c=null,i=C,u=C=0,m=null;null!==i&&u<o.length;u++){i.index>u?(m=i,i=null):m=i.sibling;var b=s(n,i,o[u],a);if(null===b){null===i&&(i=m);break}g&&i&&null===b.alternate&&e(n,i),C=l(b,C,u),null===c?r=b:c.sibling=b,c=b,i=m}if(u===o.length)return I(n,i),nC&&_n(n,u),r;if(null===i){for(;u<o.length;u++)null!==(i=A(n,o[u],a))&&(C=l(i,C,u),null===c?r=i:c.sibling=i,c=i);return nC&&_n(n,u),r}for(i=t(n,i);u<o.length;u++)null!==(m=d(i,n,u,o[u],a))&&(g&&null!==m.alternate&&i.delete(null===m.key?u:m.key),C=l(m,C,u),null===c?r=m:c.sibling=m,c=m);return g&&i.forEach((function(g){return e(n,g)})),nC&&_n(n,u),r}function m(n,o,a,r){var c=w(a);if("function"!==typeof c)throw Error(C(150));if(null==(a=c.call(a)))throw Error(C(151));for(var i=c=null,u=o,m=o=0,b=null,Z=a.next();null!==u&&!Z.done;m++,Z=a.next()){u.index>m?(b=u,u=null):b=u.sibling;var h=s(n,u,Z.value,r);if(null===h){null===u&&(u=b);break}g&&u&&null===h.alternate&&e(n,u),o=l(h,o,m),null===i?c=h:i.sibling=h,i=h,u=b}if(Z.done)return I(n,u),nC&&_n(n,m),c;if(null===u){for(;!Z.done;m++,Z=a.next())null!==(Z=A(n,Z.value,r))&&(o=l(Z,o,m),null===i?c=Z:i.sibling=Z,i=Z);return nC&&_n(n,m),c}for(u=t(n,u);!Z.done;m++,Z=a.next())null!==(Z=d(u,n,m,Z.value,r))&&(g&&null!==Z.alternate&&u.delete(null===Z.key?m:Z.key),o=l(Z,o,m),null===i?c=Z:i.sibling=Z,i=Z);return g&&u.forEach((function(g){return e(n,g)})),nC&&_n(n,m),c}return function g(t,C,l,a){if("object"===typeof l&&null!==l&&l.type===B&&null===l.key&&(l=l.props.children),"object"===typeof l&&null!==l){switch(l.$$typeof){case G:g:{for(var r=l.key,c=C;null!==c;){if(c.key===r){if((r=l.type)===B){if(7===c.tag){I(t,c.sibling),(C=n(c,l.props.children)).return=t,t=C;break g}}else if(c.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===J&&jC(r)===c.type){I(t,c.sibling),(C=n(c,l.props)).ref=LC(t,c,l),C.return=t,t=C;break g}I(t,c);break}e(t,c),c=c.sibling}l.type===B?((C=Nr(l.props.children,t.mode,a,l.key)).return=t,t=C):((a=wr(l.type,l.key,l.props,null,t.mode,a)).ref=LC(t,C,l),a.return=t,t=a)}return o(t);case y:g:{for(c=l.key;null!==C;){if(C.key===c){if(4===C.tag&&C.stateNode.containerInfo===l.containerInfo&&C.stateNode.implementation===l.implementation){I(t,C.sibling),(C=n(C,l.children||[])).return=t,t=C;break g}I(t,C);break}e(t,C),C=C.sibling}(C=xr(l,t.mode,a)).return=t,t=C}return o(t);case J:return g(t,C,(c=l._init)(l._payload),a)}if(eg(l))return u(t,C,l,a);if(w(l))return m(t,C,l,a);TC(t,l)}return"string"===typeof l&&""!==l||"number"===typeof l?(l=""+l,null!==C&&6===C.tag?(I(t,C.sibling),(C=n(C,l)).return=t,t=C):(I(t,C),(C=Fr(l,t.mode,a)).return=t,t=C),o(t)):I(t,C)}}var PC=OC(!0),qC=OC(!1),_C={},$C=fn(_C),gl=fn(_C),el=fn(_C);function Il(g){if(g===_C)throw Error(C(174));return g}function tl(g,e){switch(Wn(el,e),Wn(gl,g),Wn($C,_C),g=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ag(null,"");break;default:e=ag(e=(g=8===g?e.parentNode:e).namespaceURI||null,g=g.tagName)}Sn($C),Wn($C,e)}function nl(){Sn($C),Sn(gl),Sn(el)}function Cl(g){Il(el.current);var e=Il($C.current),I=ag(e,g.type);e!==I&&(Wn(gl,g),Wn($C,I))}function ll(g){gl.current===g&&(Sn($C),Sn(gl))}var ol=fn(0);function al(g){for(var e=g;null!==e;){if(13===e.tag){var I=e.memoizedState;if(null!==I&&(null===(I=I.dehydrated)||"$?"===I.data||"$!"===I.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===g)break;for(;null===e.sibling;){if(null===e.return||e.return===g)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rl=[];function cl(){for(var g=0;g<rl.length;g++)rl[g]._workInProgressVersionPrimary=null;rl.length=0}var il=p.ReactCurrentDispatcher,Al=p.ReactCurrentBatchConfig,sl=0,dl=null,ul=null,ml=null,bl=!1,Zl=!1,hl=0,pl=0;function Gl(){throw Error(C(321))}function yl(g,e){if(null===e)return!1;for(var I=0;I<e.length&&I<g.length;I++)if(!lt(g[I],e[I]))return!1;return!0}function Bl(g,e,I,t,n,l){if(sl=l,dl=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,il.current=null===g||null===g.memoizedState?lo:oo,g=I(t,n),Zl){l=0;do{if(Zl=!1,hl=0,25<=l)throw Error(C(301));l+=1,ml=ul=null,e.updateQueue=null,il.current=ao,g=I(t,n)}while(Zl)}if(il.current=Co,e=null!==ul&&null!==ul.next,sl=0,ml=ul=dl=null,bl=!1,e)throw Error(C(300));return g}function fl(){var g=0!==hl;return hl=0,g}function Sl(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ml?dl.memoizedState=ml=g:ml=ml.next=g,ml}function Wl(){if(null===ul){var g=dl.alternate;g=null!==g?g.memoizedState:null}else g=ul.next;var e=null===ml?dl.memoizedState:ml.next;if(null!==e)ml=e,ul=g;else{if(null===g)throw Error(C(310));g={memoizedState:(ul=g).memoizedState,baseState:ul.baseState,baseQueue:ul.baseQueue,queue:ul.queue,next:null},null===ml?dl.memoizedState=ml=g:ml=ml.next=g}return ml}function Vl(g,e){return"function"===typeof e?e(g):e}function vl(g){var e=Wl(),I=e.queue;if(null===I)throw Error(C(311));I.lastRenderedReducer=g;var t=ul,n=t.baseQueue,l=I.pending;if(null!==l){if(null!==n){var o=n.next;n.next=l.next,l.next=o}t.baseQueue=n=l,I.pending=null}if(null!==n){l=n.next,t=t.baseState;var a=o=null,r=null,c=l;do{var i=c.lane;if((sl&i)===i)null!==r&&(r=r.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),t=c.hasEagerState?c.eagerState:g(t,c.action);else{var A={lane:i,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===r?(a=r=A,o=t):r=r.next=A,dl.lanes|=i,Ka|=i}c=c.next}while(null!==c&&c!==l);null===r?o=t:r.next=a,lt(t,e.memoizedState)||(po=!0),e.memoizedState=t,e.baseState=o,e.baseQueue=r,I.lastRenderedState=t}if(null!==(g=I.interleaved)){n=g;do{l=n.lane,dl.lanes|=l,Ka|=l,n=n.next}while(n!==g)}else null===n&&(I.lanes=0);return[e.memoizedState,I.dispatch]}function Rl(g){var e=Wl(),I=e.queue;if(null===I)throw Error(C(311));I.lastRenderedReducer=g;var t=I.dispatch,n=I.pending,l=e.memoizedState;if(null!==n){I.pending=null;var o=n=n.next;do{l=g(l,o.action),o=o.next}while(o!==n);lt(l,e.memoizedState)||(po=!0),e.memoizedState=l,null===e.baseQueue&&(e.baseState=l),I.lastRenderedState=l}return[l,t]}function kl(){}function Xl(g,e){var I=dl,t=Wl(),n=e(),l=!lt(t.memoizedState,n);if(l&&(t.memoizedState=n,po=!0),t=t.queue,Ul(Hl.bind(null,I,t,g),[g]),t.getSnapshot!==e||l||null!==ml&&1&ml.memoizedState.tag){if(I.flags|=2048,Fl(9,Yl.bind(null,I,t,n,e),void 0,null),null===ka)throw Error(C(349));0!==(30&sl)||Jl(I,e,n)}return n}function Jl(g,e,I){g.flags|=16384,g={getSnapshot:e,value:I},null===(e=dl.updateQueue)?(e={lastEffect:null,stores:null},dl.updateQueue=e,e.stores=[g]):null===(I=e.stores)?e.stores=[g]:I.push(g)}function Yl(g,e,I,t){e.value=I,e.getSnapshot=t,wl(e)&&Nl(g)}function Hl(g,e,I){return I((function(){wl(e)&&Nl(g)}))}function wl(g){var e=g.getSnapshot;g=g.value;try{var I=e();return!lt(g,I)}catch(t){return!0}}function Nl(g){var e=RC(g,1);null!==e&&tr(e,g,1,-1)}function Kl(g){var e=Sl();return"function"===typeof g&&(g=g()),e.memoizedState=e.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vl,lastRenderedState:g},e.queue=g,g=g.dispatch=eo.bind(null,dl,g),[e.memoizedState,g]}function Fl(g,e,I,t){return g={tag:g,create:e,destroy:I,deps:t,next:null},null===(e=dl.updateQueue)?(e={lastEffect:null,stores:null},dl.updateQueue=e,e.lastEffect=g.next=g):null===(I=e.lastEffect)?e.lastEffect=g.next=g:(t=I.next,I.next=g,g.next=t,e.lastEffect=g),g}function xl(){return Wl().memoizedState}function El(g,e,I,t){var n=Sl();dl.flags|=g,n.memoizedState=Fl(1|e,I,void 0,void 0===t?null:t)}function zl(g,e,I,t){var n=Wl();t=void 0===t?null:t;var C=void 0;if(null!==ul){var l=ul.memoizedState;if(C=l.destroy,null!==t&&yl(t,l.deps))return void(n.memoizedState=Fl(e,I,C,t))}dl.flags|=g,n.memoizedState=Fl(1|e,I,C,t)}function Ml(g,e){return El(8390656,8,g,e)}function Ul(g,e){return zl(2048,8,g,e)}function Dl(g,e){return zl(4,2,g,e)}function Ql(g,e){return zl(4,4,g,e)}function Ll(g,e){return"function"===typeof e?(g=g(),e(g),function(){e(null)}):null!==e&&void 0!==e?(g=g(),e.current=g,function(){e.current=null}):void 0}function Tl(g,e,I){return I=null!==I&&void 0!==I?I.concat([g]):null,zl(4,4,Ll.bind(null,e,g),I)}function jl(){}function Ol(g,e){var I=Wl();e=void 0===e?null:e;var t=I.memoizedState;return null!==t&&null!==e&&yl(e,t[1])?t[0]:(I.memoizedState=[g,e],g)}function Pl(g,e){var I=Wl();e=void 0===e?null:e;var t=I.memoizedState;return null!==t&&null!==e&&yl(e,t[1])?t[0]:(g=g(),I.memoizedState=[g,e],g)}function ql(g,e,I){return 0===(21&sl)?(g.baseState&&(g.baseState=!1,po=!0),g.memoizedState=I):(lt(I,e)||(I=ue(),dl.lanes|=I,Ka|=I,g.baseState=!0),e)}function _l(g,e){var I=he;he=0!==I&&4>I?I:4,g(!0);var t=Al.transition;Al.transition={};try{g(!1),e()}finally{he=I,Al.transition=t}}function $l(){return Wl().memoizedState}function go(g,e,I){var t=Ir(g);if(I={lane:t,action:I,hasEagerState:!1,eagerState:null,next:null},Io(g))to(e,I);else if(null!==(I=vC(g,e,I,t))){tr(I,g,t,er()),no(I,e,t)}}function eo(g,e,I){var t=Ir(g),n={lane:t,action:I,hasEagerState:!1,eagerState:null,next:null};if(Io(g))to(e,n);else{var C=g.alternate;if(0===g.lanes&&(null===C||0===C.lanes)&&null!==(C=e.lastRenderedReducer))try{var l=e.lastRenderedState,o=C(l,I);if(n.hasEagerState=!0,n.eagerState=o,lt(o,l)){var a=e.interleaved;return null===a?(n.next=n,VC(e)):(n.next=a.next,a.next=n),void(e.interleaved=n)}}catch(r){}null!==(I=vC(g,e,n,t))&&(tr(I,g,t,n=er()),no(I,e,t))}}function Io(g){var e=g.alternate;return g===dl||null!==e&&e===dl}function to(g,e){Zl=bl=!0;var I=g.pending;null===I?e.next=e:(e.next=I.next,I.next=e),g.pending=e}function no(g,e,I){if(0!==(4194240&I)){var t=e.lanes;I|=t&=g.pendingLanes,e.lanes=I,Ze(g,I)}}var Co={readContext:SC,useCallback:Gl,useContext:Gl,useEffect:Gl,useImperativeHandle:Gl,useInsertionEffect:Gl,useLayoutEffect:Gl,useMemo:Gl,useReducer:Gl,useRef:Gl,useState:Gl,useDebugValue:Gl,useDeferredValue:Gl,useTransition:Gl,useMutableSource:Gl,useSyncExternalStore:Gl,useId:Gl,unstable_isNewReconciler:!1},lo={readContext:SC,useCallback:function(g,e){return Sl().memoizedState=[g,void 0===e?null:e],g},useContext:SC,useEffect:Ml,useImperativeHandle:function(g,e,I){return I=null!==I&&void 0!==I?I.concat([g]):null,El(4194308,4,Ll.bind(null,e,g),I)},useLayoutEffect:function(g,e){return El(4194308,4,g,e)},useInsertionEffect:function(g,e){return El(4,2,g,e)},useMemo:function(g,e){var I=Sl();return e=void 0===e?null:e,g=g(),I.memoizedState=[g,e],g},useReducer:function(g,e,I){var t=Sl();return e=void 0!==I?I(e):e,t.memoizedState=t.baseState=e,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:e},t.queue=g,g=g.dispatch=go.bind(null,dl,g),[t.memoizedState,g]},useRef:function(g){return g={current:g},Sl().memoizedState=g},useState:Kl,useDebugValue:jl,useDeferredValue:function(g){return Sl().memoizedState=g},useTransition:function(){var g=Kl(!1),e=g[0];return g=_l.bind(null,g[1]),Sl().memoizedState=g,[e,g]},useMutableSource:function(){},useSyncExternalStore:function(g,e,I){var t=dl,n=Sl();if(nC){if(void 0===I)throw Error(C(407));I=I()}else{if(I=e(),null===ka)throw Error(C(349));0!==(30&sl)||Jl(t,e,I)}n.memoizedState=I;var l={value:I,getSnapshot:e};return n.queue=l,Ml(Hl.bind(null,t,l,g),[g]),t.flags|=2048,Fl(9,Yl.bind(null,t,l,I,e),void 0,null),I},useId:function(){var g=Sl(),e=ka.identifierPrefix;if(nC){var I=qn;e=":"+e+"R"+(I=(Pn&~(1<<32-le(Pn)-1)).toString(32)+I),0<(I=hl++)&&(e+="H"+I.toString(32)),e+=":"}else e=":"+e+"r"+(I=pl++).toString(32)+":";return g.memoizedState=e},unstable_isNewReconciler:!1},oo={readContext:SC,useCallback:Ol,useContext:SC,useEffect:Ul,useImperativeHandle:Tl,useInsertionEffect:Dl,useLayoutEffect:Ql,useMemo:Pl,useReducer:vl,useRef:xl,useState:function(){return vl(Vl)},useDebugValue:jl,useDeferredValue:function(g){return ql(Wl(),ul.memoizedState,g)},useTransition:function(){return[vl(Vl)[0],Wl().memoizedState]},useMutableSource:kl,useSyncExternalStore:Xl,useId:$l,unstable_isNewReconciler:!1},ao={readContext:SC,useCallback:Ol,useContext:SC,useEffect:Ul,useImperativeHandle:Tl,useInsertionEffect:Dl,useLayoutEffect:Ql,useMemo:Pl,useReducer:Rl,useRef:xl,useState:function(){return Rl(Vl)},useDebugValue:jl,useDeferredValue:function(g){var e=Wl();return null===ul?e.memoizedState=g:ql(e,ul.memoizedState,g)},useTransition:function(){return[Rl(Vl)[0],Wl().memoizedState]},useMutableSource:kl,useSyncExternalStore:Xl,useId:$l,unstable_isNewReconciler:!1};function ro(g,e){try{var I="",t=e;do{I+=z(t),t=t.return}while(t);var n=I}catch(C){n="\nError generating stack: "+C.message+"\n"+C.stack}return{value:g,source:e,stack:n,digest:null}}function co(g,e,I){return{value:g,source:null,stack:null!=I?I:null,digest:null!=e?e:null}}function io(g,e){try{console.error(e.value)}catch(I){setTimeout((function(){throw I}))}}var Ao="function"===typeof WeakMap?WeakMap:Map;function so(g,e,I){(I=YC(-1,I)).tag=3,I.payload={element:null};var t=e.value;return I.callback=function(){Qa||(Qa=!0,La=t),io(0,e)},I}function uo(g,e,I){(I=YC(-1,I)).tag=3;var t=g.type.getDerivedStateFromError;if("function"===typeof t){var n=e.value;I.payload=function(){return t(n)},I.callback=function(){io(0,e)}}var C=g.stateNode;return null!==C&&"function"===typeof C.componentDidCatch&&(I.callback=function(){io(0,e),"function"!==typeof t&&(null===Ta?Ta=new Set([this]):Ta.add(this));var g=e.stack;this.componentDidCatch(e.value,{componentStack:null!==g?g:""})}),I}function mo(g,e,I){var t=g.pingCache;if(null===t){t=g.pingCache=new Ao;var n=new Set;t.set(e,n)}else void 0===(n=t.get(e))&&(n=new Set,t.set(e,n));n.has(I)||(n.add(I),g=Wr.bind(null,g,e,I),e.then(g,g))}function bo(g){do{var e;if((e=13===g.tag)&&(e=null===(e=g.memoizedState)||null!==e.dehydrated),e)return g;g=g.return}while(null!==g);return null}function Zo(g,e,I,t,n){return 0===(1&g.mode)?(g===e?g.flags|=65536:(g.flags|=128,I.flags|=131072,I.flags&=-52805,1===I.tag&&(null===I.alternate?I.tag=17:((e=YC(-1,1)).tag=2,HC(I,e,1))),I.lanes|=1),g):(g.flags|=65536,g.lanes=n,g)}var ho=p.ReactCurrentOwner,po=!1;function Go(g,e,I,t){e.child=null===g?qC(e,null,I,t):PC(e,g.child,I,t)}function yo(g,e,I,t,n){I=I.render;var C=e.ref;return fC(e,n),t=Bl(g,e,I,t,C,n),I=fl(),null===g||po?(nC&&I&&gC(e),e.flags|=1,Go(g,e,t,n),e.child):(e.updateQueue=g.updateQueue,e.flags&=-2053,g.lanes&=~n,Qo(g,e,n))}function Bo(g,e,I,t,n){if(null===g){var C=I.type;return"function"!==typeof C||Yr(C)||void 0!==C.defaultProps||null!==I.compare||void 0!==I.defaultProps?((g=wr(I.type,null,t,e,e.mode,n)).ref=e.ref,g.return=e,e.child=g):(e.tag=15,e.type=C,fo(g,e,C,t,n))}if(C=g.child,0===(g.lanes&n)){var l=C.memoizedProps;if((I=null!==(I=I.compare)?I:ot)(l,t)&&g.ref===e.ref)return Qo(g,e,n)}return e.flags|=1,(g=Hr(C,t)).ref=e.ref,g.return=e,e.child=g}function fo(g,e,I,t,n){if(null!==g){var C=g.memoizedProps;if(ot(C,t)&&g.ref===e.ref){if(po=!1,e.pendingProps=t=C,0===(g.lanes&n))return e.lanes=g.lanes,Qo(g,e,n);0!==(131072&g.flags)&&(po=!0)}}return Vo(g,e,I,t,n)}function So(g,e,I){var t=e.pendingProps,n=t.children,C=null!==g?g.memoizedState:null;if("hidden"===t.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(Ha,Ya),Ya|=I;else{if(0===(1073741824&I))return g=null!==C?C.baseLanes|I:I,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:g,cachePool:null,transitions:null},e.updateQueue=null,Wn(Ha,Ya),Ya|=g,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},t=null!==C?C.baseLanes:I,Wn(Ha,Ya),Ya|=t}else null!==C?(t=C.baseLanes|I,e.memoizedState=null):t=I,Wn(Ha,Ya),Ya|=t;return Go(g,e,n,I),e.child}function Wo(g,e){var I=e.ref;(null===g&&null!==I||null!==g&&g.ref!==I)&&(e.flags|=512,e.flags|=2097152)}function Vo(g,e,I,t,n){var C=Jn(I)?kn:vn.current;return C=Xn(e,C),fC(e,n),I=Bl(g,e,I,t,C,n),t=fl(),null===g||po?(nC&&t&&gC(e),e.flags|=1,Go(g,e,I,n),e.child):(e.updateQueue=g.updateQueue,e.flags&=-2053,g.lanes&=~n,Qo(g,e,n))}function vo(g,e,I,t,n){if(Jn(I)){var C=!0;Nn(e)}else C=!1;if(fC(e,n),null===e.stateNode)Do(g,e),UC(e,I,t),QC(e,I,t,n),t=!0;else if(null===g){var l=e.stateNode,o=e.memoizedProps;l.props=o;var a=l.context,r=I.contextType;"object"===typeof r&&null!==r?r=SC(r):r=Xn(e,r=Jn(I)?kn:vn.current);var c=I.getDerivedStateFromProps,i="function"===typeof c||"function"===typeof l.getSnapshotBeforeUpdate;i||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(o!==t||a!==r)&&DC(e,l,t,r),kC=!1;var A=e.memoizedState;l.state=A,KC(e,t,l,n),a=e.memoizedState,o!==t||A!==a||Rn.current||kC?("function"===typeof c&&(EC(e,I,c,t),a=e.memoizedState),(o=kC||MC(e,I,o,t,A,a,r))?(i||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||("function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"===typeof l.componentDidMount&&(e.flags|=4194308)):("function"===typeof l.componentDidMount&&(e.flags|=4194308),e.memoizedProps=t,e.memoizedState=a),l.props=t,l.state=a,l.context=r,t=o):("function"===typeof l.componentDidMount&&(e.flags|=4194308),t=!1)}else{l=e.stateNode,JC(g,e),o=e.memoizedProps,r=e.type===e.elementType?o:mC(e.type,o),l.props=r,i=e.pendingProps,A=l.context,"object"===typeof(a=I.contextType)&&null!==a?a=SC(a):a=Xn(e,a=Jn(I)?kn:vn.current);var s=I.getDerivedStateFromProps;(c="function"===typeof s||"function"===typeof l.getSnapshotBeforeUpdate)||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(o!==i||A!==a)&&DC(e,l,t,a),kC=!1,A=e.memoizedState,l.state=A,KC(e,t,l,n);var d=e.memoizedState;o!==i||A!==d||Rn.current||kC?("function"===typeof s&&(EC(e,I,s,t),d=e.memoizedState),(r=kC||MC(e,I,r,t,A,d,a)||!1)?(c||"function"!==typeof l.UNSAFE_componentWillUpdate&&"function"!==typeof l.componentWillUpdate||("function"===typeof l.componentWillUpdate&&l.componentWillUpdate(t,d,a),"function"===typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(t,d,a)),"function"===typeof l.componentDidUpdate&&(e.flags|=4),"function"===typeof l.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof l.componentDidUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=1024),e.memoizedProps=t,e.memoizedState=d),l.props=t,l.state=d,l.context=a,t=r):("function"!==typeof l.componentDidUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||o===g.memoizedProps&&A===g.memoizedState||(e.flags|=1024),t=!1)}return Ro(g,e,I,t,C,n)}function Ro(g,e,I,t,n,C){Wo(g,e);var l=0!==(128&e.flags);if(!t&&!l)return n&&Kn(e,I,!1),Qo(g,e,C);t=e.stateNode,ho.current=e;var o=l&&"function"!==typeof I.getDerivedStateFromError?null:t.render();return e.flags|=1,null!==g&&l?(e.child=PC(e,g.child,null,C),e.child=PC(e,null,o,C)):Go(g,e,o,C),e.memoizedState=t.state,n&&Kn(e,I,!0),e.child}function ko(g){var e=g.stateNode;e.pendingContext?Hn(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Hn(0,e.context,!1),tl(g,e.containerInfo)}function Xo(g,e,I,t,n){return sC(),dC(n),e.flags|=256,Go(g,e,I,t),e.child}var Jo,Yo,Ho,wo,No={dehydrated:null,treeContext:null,retryLane:0};function Ko(g){return{baseLanes:g,cachePool:null,transitions:null}}function Fo(g,e,I){var t,n=e.pendingProps,l=ol.current,o=!1,a=0!==(128&e.flags);if((t=a)||(t=(null===g||null!==g.memoizedState)&&0!==(2&l)),t?(o=!0,e.flags&=-129):null!==g&&null===g.memoizedState||(l|=1),Wn(ol,1&l),null===g)return rC(e),null!==(g=e.memoizedState)&&null!==(g=g.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===g.data?e.lanes=8:e.lanes=1073741824,null):(a=n.children,g=n.fallback,o?(n=e.mode,o=e.child,a={mode:"hidden",children:a},0===(1&n)&&null!==o?(o.childLanes=0,o.pendingProps=a):o=Kr(a,n,0,null),g=Nr(g,n,I,null),o.return=e,g.return=e,o.sibling=g,e.child=o,e.child.memoizedState=Ko(I),e.memoizedState=No,g):xo(e,a));if(null!==(l=g.memoizedState)&&null!==(t=l.dehydrated))return function(g,e,I,t,n,l,o){if(I)return 256&e.flags?(e.flags&=-257,Eo(g,e,o,t=co(Error(C(422))))):null!==e.memoizedState?(e.child=g.child,e.flags|=128,null):(l=t.fallback,n=e.mode,t=Kr({mode:"visible",children:t.children},n,0,null),(l=Nr(l,n,o,null)).flags|=2,t.return=e,l.return=e,t.sibling=l,e.child=t,0!==(1&e.mode)&&PC(e,g.child,null,o),e.child.memoizedState=Ko(o),e.memoizedState=No,l);if(0===(1&e.mode))return Eo(g,e,o,null);if("$!"===n.data){if(t=n.nextSibling&&n.nextSibling.dataset)var a=t.dgst;return t=a,Eo(g,e,o,t=co(l=Error(C(419)),t,void 0))}if(a=0!==(o&g.childLanes),po||a){if(null!==(t=ka)){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!==(n&(t.suspendedLanes|o))?0:n)&&n!==l.retryLane&&(l.retryLane=n,RC(g,n),tr(t,g,n,-1))}return mr(),Eo(g,e,o,t=co(Error(C(421))))}return"$?"===n.data?(e.flags|=128,e.child=g.child,e=vr.bind(null,g),n._reactRetry=e,null):(g=l.treeContext,tC=an(n.nextSibling),IC=e,nC=!0,CC=null,null!==g&&(Tn[jn++]=Pn,Tn[jn++]=qn,Tn[jn++]=On,Pn=g.id,qn=g.overflow,On=e),e=xo(e,t.children),e.flags|=4096,e)}(g,e,a,n,t,l,I);if(o){o=n.fallback,a=e.mode,t=(l=g.child).sibling;var r={mode:"hidden",children:n.children};return 0===(1&a)&&e.child!==l?((n=e.child).childLanes=0,n.pendingProps=r,e.deletions=null):(n=Hr(l,r)).subtreeFlags=14680064&l.subtreeFlags,null!==t?o=Hr(t,o):(o=Nr(o,a,I,null)).flags|=2,o.return=e,n.return=e,n.sibling=o,e.child=n,n=o,o=e.child,a=null===(a=g.child.memoizedState)?Ko(I):{baseLanes:a.baseLanes|I,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=g.childLanes&~I,e.memoizedState=No,n}return g=(o=g.child).sibling,n=Hr(o,{mode:"visible",children:n.children}),0===(1&e.mode)&&(n.lanes=I),n.return=e,n.sibling=null,null!==g&&(null===(I=e.deletions)?(e.deletions=[g],e.flags|=16):I.push(g)),e.child=n,e.memoizedState=null,n}function xo(g,e){return(e=Kr({mode:"visible",children:e},g.mode,0,null)).return=g,g.child=e}function Eo(g,e,I,t){return null!==t&&dC(t),PC(e,g.child,null,I),(g=xo(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,g}function zo(g,e,I){g.lanes|=e;var t=g.alternate;null!==t&&(t.lanes|=e),BC(g.return,e,I)}function Mo(g,e,I,t,n){var C=g.memoizedState;null===C?g.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:t,tail:I,tailMode:n}:(C.isBackwards=e,C.rendering=null,C.renderingStartTime=0,C.last=t,C.tail=I,C.tailMode=n)}function Uo(g,e,I){var t=e.pendingProps,n=t.revealOrder,C=t.tail;if(Go(g,e,t.children,I),0!==(2&(t=ol.current)))t=1&t|2,e.flags|=128;else{if(null!==g&&0!==(128&g.flags))g:for(g=e.child;null!==g;){if(13===g.tag)null!==g.memoizedState&&zo(g,I,e);else if(19===g.tag)zo(g,I,e);else if(null!==g.child){g.child.return=g,g=g.child;continue}if(g===e)break g;for(;null===g.sibling;){if(null===g.return||g.return===e)break g;g=g.return}g.sibling.return=g.return,g=g.sibling}t&=1}if(Wn(ol,t),0===(1&e.mode))e.memoizedState=null;else switch(n){case"forwards":for(I=e.child,n=null;null!==I;)null!==(g=I.alternate)&&null===al(g)&&(n=I),I=I.sibling;null===(I=n)?(n=e.child,e.child=null):(n=I.sibling,I.sibling=null),Mo(e,!1,n,I,C);break;case"backwards":for(I=null,n=e.child,e.child=null;null!==n;){if(null!==(g=n.alternate)&&null===al(g)){e.child=n;break}g=n.sibling,n.sibling=I,I=n,n=g}Mo(e,!0,I,null,C);break;case"together":Mo(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Do(g,e){0===(1&e.mode)&&null!==g&&(g.alternate=null,e.alternate=null,e.flags|=2)}function Qo(g,e,I){if(null!==g&&(e.dependencies=g.dependencies),Ka|=e.lanes,0===(I&e.childLanes))return null;if(null!==g&&e.child!==g.child)throw Error(C(153));if(null!==e.child){for(I=Hr(g=e.child,g.pendingProps),e.child=I,I.return=e;null!==g.sibling;)g=g.sibling,(I=I.sibling=Hr(g,g.pendingProps)).return=e;I.sibling=null}return e.child}function Lo(g,e){if(!nC)switch(g.tailMode){case"hidden":e=g.tail;for(var I=null;null!==e;)null!==e.alternate&&(I=e),e=e.sibling;null===I?g.tail=null:I.sibling=null;break;case"collapsed":I=g.tail;for(var t=null;null!==I;)null!==I.alternate&&(t=I),I=I.sibling;null===t?e||null===g.tail?g.tail=null:g.tail.sibling=null:t.sibling=null}}function To(g){var e=null!==g.alternate&&g.alternate.child===g.child,I=0,t=0;if(e)for(var n=g.child;null!==n;)I|=n.lanes|n.childLanes,t|=14680064&n.subtreeFlags,t|=14680064&n.flags,n.return=g,n=n.sibling;else for(n=g.child;null!==n;)I|=n.lanes|n.childLanes,t|=n.subtreeFlags,t|=n.flags,n.return=g,n=n.sibling;return g.subtreeFlags|=t,g.childLanes=I,e}function jo(g,e,I){var t=e.pendingProps;switch(eC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return To(e),null;case 1:case 17:return Jn(e.type)&&Yn(),To(e),null;case 3:return t=e.stateNode,nl(),Sn(Rn),Sn(vn),cl(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),null!==g&&null!==g.child||(iC(e)?e.flags|=4:null===g||g.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==CC&&(or(CC),CC=null))),Yo(g,e),To(e),null;case 5:ll(e);var n=Il(el.current);if(I=e.type,null!==g&&null!=e.stateNode)Ho(g,e,I,t,n),g.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!t){if(null===e.stateNode)throw Error(C(166));return To(e),null}if(g=Il($C.current),iC(e)){t=e.stateNode,I=e.type;var l=e.memoizedProps;switch(t[An]=e,t[sn]=l,g=0!==(1&e.mode),I){case"dialog":Ft("cancel",t),Ft("close",t);break;case"iframe":case"object":case"embed":Ft("load",t);break;case"video":case"audio":for(n=0;n<Ht.length;n++)Ft(Ht[n],t);break;case"source":Ft("error",t);break;case"img":case"image":case"link":Ft("error",t),Ft("load",t);break;case"details":Ft("toggle",t);break;case"input":P(t,l),Ft("invalid",t);break;case"select":t._wrapperState={wasMultiple:!!l.multiple},Ft("invalid",t);break;case"textarea":ng(t,l),Ft("invalid",t)}for(var a in Zg(I,l),n=null,l)if(l.hasOwnProperty(a)){var r=l[a];"children"===a?"string"===typeof r?t.textContent!==r&&(!0!==l.suppressHydrationWarning&&qt(t.textContent,r,g),n=["children",r]):"number"===typeof r&&t.textContent!==""+r&&(!0!==l.suppressHydrationWarning&&qt(t.textContent,r,g),n=["children",""+r]):o.hasOwnProperty(a)&&null!=r&&"onScroll"===a&&Ft("scroll",t)}switch(I){case"input":L(t),$(t,l,!0);break;case"textarea":L(t),lg(t);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(t.onclick=_t)}t=n,e.updateQueue=t,null!==t&&(e.flags|=4)}else{a=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===g&&(g=og(I)),"http://www.w3.org/1999/xhtml"===g?"script"===I?((g=a.createElement("div")).innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):"string"===typeof t.is?g=a.createElement(I,{is:t.is}):(g=a.createElement(I),"select"===I&&(a=g,t.multiple?a.multiple=!0:t.size&&(a.size=t.size))):g=a.createElementNS(g,I),g[An]=e,g[sn]=t,Jo(g,e,!1,!1),e.stateNode=g;g:{switch(a=hg(I,t),I){case"dialog":Ft("cancel",g),Ft("close",g),n=t;break;case"iframe":case"object":case"embed":Ft("load",g),n=t;break;case"video":case"audio":for(n=0;n<Ht.length;n++)Ft(Ht[n],g);n=t;break;case"source":Ft("error",g),n=t;break;case"img":case"image":case"link":Ft("error",g),Ft("load",g),n=t;break;case"details":Ft("toggle",g),n=t;break;case"input":P(g,t),n=O(g,t),Ft("invalid",g);break;case"option":default:n=t;break;case"select":g._wrapperState={wasMultiple:!!t.multiple},n=K({},t,{value:void 0}),Ft("invalid",g);break;case"textarea":ng(g,t),n=tg(g,t),Ft("invalid",g)}for(l in Zg(I,n),r=n)if(r.hasOwnProperty(l)){var c=r[l];"style"===l?mg(g,c):"dangerouslySetInnerHTML"===l?null!=(c=c?c.__html:void 0)&&ig(g,c):"children"===l?"string"===typeof c?("textarea"!==I||""!==c)&&Ag(g,c):"number"===typeof c&&Ag(g,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(o.hasOwnProperty(l)?null!=c&&"onScroll"===l&&Ft("scroll",g):null!=c&&h(g,l,c,a))}switch(I){case"input":L(g),$(g,t,!1);break;case"textarea":L(g),lg(g);break;case"option":null!=t.value&&g.setAttribute("value",""+D(t.value));break;case"select":g.multiple=!!t.multiple,null!=(l=t.value)?Ig(g,!!t.multiple,l,!1):null!=t.defaultValue&&Ig(g,!!t.multiple,t.defaultValue,!0);break;default:"function"===typeof n.onClick&&(g.onclick=_t)}switch(I){case"button":case"input":case"select":case"textarea":t=!!t.autoFocus;break g;case"img":t=!0;break g;default:t=!1}}t&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return To(e),null;case 6:if(g&&null!=e.stateNode)wo(g,e,g.memoizedProps,t);else{if("string"!==typeof t&&null===e.stateNode)throw Error(C(166));if(I=Il(el.current),Il($C.current),iC(e)){if(t=e.stateNode,I=e.memoizedProps,t[An]=e,(l=t.nodeValue!==I)&&null!==(g=IC))switch(g.tag){case 3:qt(t.nodeValue,I,0!==(1&g.mode));break;case 5:!0!==g.memoizedProps.suppressHydrationWarning&&qt(t.nodeValue,I,0!==(1&g.mode))}l&&(e.flags|=4)}else(t=(9===I.nodeType?I:I.ownerDocument).createTextNode(t))[An]=e,e.stateNode=t}return To(e),null;case 13:if(Sn(ol),t=e.memoizedState,null===g||null!==g.memoizedState&&null!==g.memoizedState.dehydrated){if(nC&&null!==tC&&0!==(1&e.mode)&&0===(128&e.flags))AC(),sC(),e.flags|=98560,l=!1;else if(l=iC(e),null!==t&&null!==t.dehydrated){if(null===g){if(!l)throw Error(C(318));if(!(l=null!==(l=e.memoizedState)?l.dehydrated:null))throw Error(C(317));l[An]=e}else sC(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;To(e),l=!1}else null!==CC&&(or(CC),CC=null),l=!0;if(!l)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=I,e):((t=null!==t)!==(null!==g&&null!==g.memoizedState)&&t&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===g||0!==(1&ol.current)?0===wa&&(wa=3):mr())),null!==e.updateQueue&&(e.flags|=4),To(e),null);case 4:return nl(),Yo(g,e),null===g&&zt(e.stateNode.containerInfo),To(e),null;case 10:return yC(e.type._context),To(e),null;case 19:if(Sn(ol),null===(l=e.memoizedState))return To(e),null;if(t=0!==(128&e.flags),null===(a=l.rendering))if(t)Lo(l,!1);else{if(0!==wa||null!==g&&0!==(128&g.flags))for(g=e.child;null!==g;){if(null!==(a=al(g))){for(e.flags|=128,Lo(l,!1),null!==(t=a.updateQueue)&&(e.updateQueue=t,e.flags|=4),e.subtreeFlags=0,t=I,I=e.child;null!==I;)g=t,(l=I).flags&=14680066,null===(a=l.alternate)?(l.childLanes=0,l.lanes=g,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,l.type=a.type,g=a.dependencies,l.dependencies=null===g?null:{lanes:g.lanes,firstContext:g.firstContext}),I=I.sibling;return Wn(ol,1&ol.current|2),e.child}g=g.sibling}null!==l.tail&&qg()>Ua&&(e.flags|=128,t=!0,Lo(l,!1),e.lanes=4194304)}else{if(!t)if(null!==(g=al(a))){if(e.flags|=128,t=!0,null!==(I=g.updateQueue)&&(e.updateQueue=I,e.flags|=4),Lo(l,!0),null===l.tail&&"hidden"===l.tailMode&&!a.alternate&&!nC)return To(e),null}else 2*qg()-l.renderingStartTime>Ua&&1073741824!==I&&(e.flags|=128,t=!0,Lo(l,!1),e.lanes=4194304);l.isBackwards?(a.sibling=e.child,e.child=a):(null!==(I=l.last)?I.sibling=a:e.child=a,l.last=a)}return null!==l.tail?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=qg(),e.sibling=null,I=ol.current,Wn(ol,t?1&I|2:1&I),e):(To(e),null);case 22:case 23:return Ar(),t=null!==e.memoizedState,null!==g&&null!==g.memoizedState!==t&&(e.flags|=8192),t&&0!==(1&e.mode)?0!==(1073741824&Ya)&&(To(e),6&e.subtreeFlags&&(e.flags|=8192)):To(e),null;case 24:case 25:return null}throw Error(C(156,e.tag))}function Oo(g,e){switch(eC(e),e.tag){case 1:return Jn(e.type)&&Yn(),65536&(g=e.flags)?(e.flags=-65537&g|128,e):null;case 3:return nl(),Sn(Rn),Sn(vn),cl(),0!==(65536&(g=e.flags))&&0===(128&g)?(e.flags=-65537&g|128,e):null;case 5:return ll(e),null;case 13:if(Sn(ol),null!==(g=e.memoizedState)&&null!==g.dehydrated){if(null===e.alternate)throw Error(C(340));sC()}return 65536&(g=e.flags)?(e.flags=-65537&g|128,e):null;case 19:return Sn(ol),null;case 4:return nl(),null;case 10:return yC(e.type._context),null;case 22:case 23:return Ar(),null;default:return null}}Jo=function(g,e){for(var I=e.child;null!==I;){if(5===I.tag||6===I.tag)g.appendChild(I.stateNode);else if(4!==I.tag&&null!==I.child){I.child.return=I,I=I.child;continue}if(I===e)break;for(;null===I.sibling;){if(null===I.return||I.return===e)return;I=I.return}I.sibling.return=I.return,I=I.sibling}},Yo=function(){},Ho=function(g,e,I,t){var n=g.memoizedProps;if(n!==t){g=e.stateNode,Il($C.current);var C,l=null;switch(I){case"input":n=O(g,n),t=O(g,t),l=[];break;case"select":n=K({},n,{value:void 0}),t=K({},t,{value:void 0}),l=[];break;case"textarea":n=tg(g,n),t=tg(g,t),l=[];break;default:"function"!==typeof n.onClick&&"function"===typeof t.onClick&&(g.onclick=_t)}for(c in Zg(I,t),I=null,n)if(!t.hasOwnProperty(c)&&n.hasOwnProperty(c)&&null!=n[c])if("style"===c){var a=n[c];for(C in a)a.hasOwnProperty(C)&&(I||(I={}),I[C]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(o.hasOwnProperty(c)?l||(l=[]):(l=l||[]).push(c,null));for(c in t){var r=t[c];if(a=null!=n?n[c]:void 0,t.hasOwnProperty(c)&&r!==a&&(null!=r||null!=a))if("style"===c)if(a){for(C in a)!a.hasOwnProperty(C)||r&&r.hasOwnProperty(C)||(I||(I={}),I[C]="");for(C in r)r.hasOwnProperty(C)&&a[C]!==r[C]&&(I||(I={}),I[C]=r[C])}else I||(l||(l=[]),l.push(c,I)),I=r;else"dangerouslySetInnerHTML"===c?(r=r?r.__html:void 0,a=a?a.__html:void 0,null!=r&&a!==r&&(l=l||[]).push(c,r)):"children"===c?"string"!==typeof r&&"number"!==typeof r||(l=l||[]).push(c,""+r):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(o.hasOwnProperty(c)?(null!=r&&"onScroll"===c&&Ft("scroll",g),l||a===r||(l=[])):(l=l||[]).push(c,r))}I&&(l=l||[]).push("style",I);var c=l;(e.updateQueue=c)&&(e.flags|=4)}},wo=function(g,e,I,t){I!==t&&(e.flags|=4)};var Po=!1,qo=!1,_o="function"===typeof WeakSet?WeakSet:Set,$o=null;function ga(g,e){var I=g.ref;if(null!==I)if("function"===typeof I)try{I(null)}catch(t){Sr(g,e,t)}else I.current=null}function ea(g,e,I){try{I()}catch(t){Sr(g,e,t)}}var Ia=!1;function ta(g,e,I){var t=e.updateQueue;if(null!==(t=null!==t?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&g)===g){var C=n.destroy;n.destroy=void 0,void 0!==C&&ea(e,I,C)}n=n.next}while(n!==t)}}function na(g,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var I=e=e.next;do{if((I.tag&g)===g){var t=I.create;I.destroy=t()}I=I.next}while(I!==e)}}function Ca(g){var e=g.ref;if(null!==e){var I=g.stateNode;g.tag,g=I,"function"===typeof e?e(g):e.current=g}}function la(g){var e=g.alternate;null!==e&&(g.alternate=null,la(e)),g.child=null,g.deletions=null,g.sibling=null,5===g.tag&&(null!==(e=g.stateNode)&&(delete e[An],delete e[sn],delete e[un],delete e[mn],delete e[bn])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function oa(g){return 5===g.tag||3===g.tag||4===g.tag}function aa(g){g:for(;;){for(;null===g.sibling;){if(null===g.return||oa(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;5!==g.tag&&6!==g.tag&&18!==g.tag;){if(2&g.flags)continue g;if(null===g.child||4===g.tag)continue g;g.child.return=g,g=g.child}if(!(2&g.flags))return g.stateNode}}function ra(g,e,I){var t=g.tag;if(5===t||6===t)g=g.stateNode,e?8===I.nodeType?I.parentNode.insertBefore(g,e):I.insertBefore(g,e):(8===I.nodeType?(e=I.parentNode).insertBefore(g,I):(e=I).appendChild(g),null!==(I=I._reactRootContainer)&&void 0!==I||null!==e.onclick||(e.onclick=_t));else if(4!==t&&null!==(g=g.child))for(ra(g,e,I),g=g.sibling;null!==g;)ra(g,e,I),g=g.sibling}function ca(g,e,I){var t=g.tag;if(5===t||6===t)g=g.stateNode,e?I.insertBefore(g,e):I.appendChild(g);else if(4!==t&&null!==(g=g.child))for(ca(g,e,I),g=g.sibling;null!==g;)ca(g,e,I),g=g.sibling}var ia=null,Aa=!1;function sa(g,e,I){for(I=I.child;null!==I;)da(g,e,I),I=I.sibling}function da(g,e,I){if(Ce&&"function"===typeof Ce.onCommitFiberUnmount)try{Ce.onCommitFiberUnmount(ne,I)}catch(o){}switch(I.tag){case 5:qo||ga(I,e);case 6:var t=ia,n=Aa;ia=null,sa(g,e,I),Aa=n,null!==(ia=t)&&(Aa?(g=ia,I=I.stateNode,8===g.nodeType?g.parentNode.removeChild(I):g.removeChild(I)):ia.removeChild(I.stateNode));break;case 18:null!==ia&&(Aa?(g=ia,I=I.stateNode,8===g.nodeType?on(g.parentNode,I):1===g.nodeType&&on(g,I),Me(g)):on(ia,I.stateNode));break;case 4:t=ia,n=Aa,ia=I.stateNode.containerInfo,Aa=!0,sa(g,e,I),ia=t,Aa=n;break;case 0:case 11:case 14:case 15:if(!qo&&(null!==(t=I.updateQueue)&&null!==(t=t.lastEffect))){n=t=t.next;do{var C=n,l=C.destroy;C=C.tag,void 0!==l&&(0!==(2&C)||0!==(4&C))&&ea(I,e,l),n=n.next}while(n!==t)}sa(g,e,I);break;case 1:if(!qo&&(ga(I,e),"function"===typeof(t=I.stateNode).componentWillUnmount))try{t.props=I.memoizedProps,t.state=I.memoizedState,t.componentWillUnmount()}catch(o){Sr(I,e,o)}sa(g,e,I);break;case 21:sa(g,e,I);break;case 22:1&I.mode?(qo=(t=qo)||null!==I.memoizedState,sa(g,e,I),qo=t):sa(g,e,I);break;default:sa(g,e,I)}}function ua(g){var e=g.updateQueue;if(null!==e){g.updateQueue=null;var I=g.stateNode;null===I&&(I=g.stateNode=new _o),e.forEach((function(e){var t=Rr.bind(null,g,e);I.has(e)||(I.add(e),e.then(t,t))}))}}function ma(g,e){var I=e.deletions;if(null!==I)for(var t=0;t<I.length;t++){var n=I[t];try{var l=g,o=e,a=o;g:for(;null!==a;){switch(a.tag){case 5:ia=a.stateNode,Aa=!1;break g;case 3:case 4:ia=a.stateNode.containerInfo,Aa=!0;break g}a=a.return}if(null===ia)throw Error(C(160));da(l,o,n),ia=null,Aa=!1;var r=n.alternate;null!==r&&(r.return=null),n.return=null}catch(c){Sr(n,e,c)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)ba(e,g),e=e.sibling}function ba(g,e){var I=g.alternate,t=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(ma(e,g),Za(g),4&t){try{ta(3,g,g.return),na(3,g)}catch(m){Sr(g,g.return,m)}try{ta(5,g,g.return)}catch(m){Sr(g,g.return,m)}}break;case 1:ma(e,g),Za(g),512&t&&null!==I&&ga(I,I.return);break;case 5:if(ma(e,g),Za(g),512&t&&null!==I&&ga(I,I.return),32&g.flags){var n=g.stateNode;try{Ag(n,"")}catch(m){Sr(g,g.return,m)}}if(4&t&&null!=(n=g.stateNode)){var l=g.memoizedProps,o=null!==I?I.memoizedProps:l,a=g.type,r=g.updateQueue;if(g.updateQueue=null,null!==r)try{"input"===a&&"radio"===l.type&&null!=l.name&&q(n,l),hg(a,o);var c=hg(a,l);for(o=0;o<r.length;o+=2){var i=r[o],A=r[o+1];"style"===i?mg(n,A):"dangerouslySetInnerHTML"===i?ig(n,A):"children"===i?Ag(n,A):h(n,i,A,c)}switch(a){case"input":_(n,l);break;case"textarea":Cg(n,l);break;case"select":var s=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!l.multiple;var d=l.value;null!=d?Ig(n,!!l.multiple,d,!1):s!==!!l.multiple&&(null!=l.defaultValue?Ig(n,!!l.multiple,l.defaultValue,!0):Ig(n,!!l.multiple,l.multiple?[]:"",!1))}n[sn]=l}catch(m){Sr(g,g.return,m)}}break;case 6:if(ma(e,g),Za(g),4&t){if(null===g.stateNode)throw Error(C(162));n=g.stateNode,l=g.memoizedProps;try{n.nodeValue=l}catch(m){Sr(g,g.return,m)}}break;case 3:if(ma(e,g),Za(g),4&t&&null!==I&&I.memoizedState.isDehydrated)try{Me(e.containerInfo)}catch(m){Sr(g,g.return,m)}break;case 4:default:ma(e,g),Za(g);break;case 13:ma(e,g),Za(g),8192&(n=g.child).flags&&(l=null!==n.memoizedState,n.stateNode.isHidden=l,!l||null!==n.alternate&&null!==n.alternate.memoizedState||(Ma=qg())),4&t&&ua(g);break;case 22:if(i=null!==I&&null!==I.memoizedState,1&g.mode?(qo=(c=qo)||i,ma(e,g),qo=c):ma(e,g),Za(g),8192&t){if(c=null!==g.memoizedState,(g.stateNode.isHidden=c)&&!i&&0!==(1&g.mode))for($o=g,i=g.child;null!==i;){for(A=$o=i;null!==$o;){switch(d=(s=$o).child,s.tag){case 0:case 11:case 14:case 15:ta(4,s,s.return);break;case 1:ga(s,s.return);var u=s.stateNode;if("function"===typeof u.componentWillUnmount){t=s,I=s.return;try{e=t,u.props=e.memoizedProps,u.state=e.memoizedState,u.componentWillUnmount()}catch(m){Sr(t,I,m)}}break;case 5:ga(s,s.return);break;case 22:if(null!==s.memoizedState){ya(A);continue}}null!==d?(d.return=s,$o=d):ya(A)}i=i.sibling}g:for(i=null,A=g;;){if(5===A.tag){if(null===i){i=A;try{n=A.stateNode,c?"function"===typeof(l=n.style).setProperty?l.setProperty("display","none","important"):l.display="none":(a=A.stateNode,o=void 0!==(r=A.memoizedProps.style)&&null!==r&&r.hasOwnProperty("display")?r.display:null,a.style.display=ug("display",o))}catch(m){Sr(g,g.return,m)}}}else if(6===A.tag){if(null===i)try{A.stateNode.nodeValue=c?"":A.memoizedProps}catch(m){Sr(g,g.return,m)}}else if((22!==A.tag&&23!==A.tag||null===A.memoizedState||A===g)&&null!==A.child){A.child.return=A,A=A.child;continue}if(A===g)break g;for(;null===A.sibling;){if(null===A.return||A.return===g)break g;i===A&&(i=null),A=A.return}i===A&&(i=null),A.sibling.return=A.return,A=A.sibling}}break;case 19:ma(e,g),Za(g),4&t&&ua(g);case 21:}}function Za(g){var e=g.flags;if(2&e){try{g:{for(var I=g.return;null!==I;){if(oa(I)){var t=I;break g}I=I.return}throw Error(C(160))}switch(t.tag){case 5:var n=t.stateNode;32&t.flags&&(Ag(n,""),t.flags&=-33),ca(g,aa(g),n);break;case 3:case 4:var l=t.stateNode.containerInfo;ra(g,aa(g),l);break;default:throw Error(C(161))}}catch(o){Sr(g,g.return,o)}g.flags&=-3}4096&e&&(g.flags&=-4097)}function ha(g,e,I){$o=g,pa(g,e,I)}function pa(g,e,I){for(var t=0!==(1&g.mode);null!==$o;){var n=$o,C=n.child;if(22===n.tag&&t){var l=null!==n.memoizedState||Po;if(!l){var o=n.alternate,a=null!==o&&null!==o.memoizedState||qo;o=Po;var r=qo;if(Po=l,(qo=a)&&!r)for($o=n;null!==$o;)a=(l=$o).child,22===l.tag&&null!==l.memoizedState?Ba(n):null!==a?(a.return=l,$o=a):Ba(n);for(;null!==C;)$o=C,pa(C,e,I),C=C.sibling;$o=n,Po=o,qo=r}Ga(g)}else 0!==(8772&n.subtreeFlags)&&null!==C?(C.return=n,$o=C):Ga(g)}}function Ga(g){for(;null!==$o;){var e=$o;if(0!==(8772&e.flags)){var I=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:qo||na(5,e);break;case 1:var t=e.stateNode;if(4&e.flags&&!qo)if(null===I)t.componentDidMount();else{var n=e.elementType===e.type?I.memoizedProps:mC(e.type,I.memoizedProps);t.componentDidUpdate(n,I.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;null!==l&&FC(e,l,t);break;case 3:var o=e.updateQueue;if(null!==o){if(I=null,null!==e.child)switch(e.child.tag){case 5:case 1:I=e.child.stateNode}FC(e,o,I)}break;case 5:var a=e.stateNode;if(null===I&&4&e.flags){I=a;var r=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":r.autoFocus&&I.focus();break;case"img":r.src&&(I.src=r.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var c=e.alternate;if(null!==c){var i=c.memoizedState;if(null!==i){var A=i.dehydrated;null!==A&&Me(A)}}}break;default:throw Error(C(163))}qo||512&e.flags&&Ca(e)}catch(s){Sr(e,e.return,s)}}if(e===g){$o=null;break}if(null!==(I=e.sibling)){I.return=e.return,$o=I;break}$o=e.return}}function ya(g){for(;null!==$o;){var e=$o;if(e===g){$o=null;break}var I=e.sibling;if(null!==I){I.return=e.return,$o=I;break}$o=e.return}}function Ba(g){for(;null!==$o;){var e=$o;try{switch(e.tag){case 0:case 11:case 15:var I=e.return;try{na(4,e)}catch(a){Sr(e,I,a)}break;case 1:var t=e.stateNode;if("function"===typeof t.componentDidMount){var n=e.return;try{t.componentDidMount()}catch(a){Sr(e,n,a)}}var C=e.return;try{Ca(e)}catch(a){Sr(e,C,a)}break;case 5:var l=e.return;try{Ca(e)}catch(a){Sr(e,l,a)}}}catch(a){Sr(e,e.return,a)}if(e===g){$o=null;break}var o=e.sibling;if(null!==o){o.return=e.return,$o=o;break}$o=e.return}}var fa,Sa=Math.ceil,Wa=p.ReactCurrentDispatcher,Va=p.ReactCurrentOwner,va=p.ReactCurrentBatchConfig,Ra=0,ka=null,Xa=null,Ja=0,Ya=0,Ha=fn(0),wa=0,Na=null,Ka=0,Fa=0,xa=0,Ea=null,za=null,Ma=0,Ua=1/0,Da=null,Qa=!1,La=null,Ta=null,ja=!1,Oa=null,Pa=0,qa=0,_a=null,$a=-1,gr=0;function er(){return 0!==(6&Ra)?qg():-1!==$a?$a:$a=qg()}function Ir(g){return 0===(1&g.mode)?1:0!==(2&Ra)&&0!==Ja?Ja&-Ja:null!==uC.transition?(0===gr&&(gr=ue()),gr):0!==(g=he)?g:g=void 0===(g=window.event)?16:Pe(g.type)}function tr(g,e,I,t){if(50<qa)throw qa=0,_a=null,Error(C(185));be(g,I,t),0!==(2&Ra)&&g===ka||(g===ka&&(0===(2&Ra)&&(Fa|=I),4===wa&&ar(g,Ja)),nr(g,t),1===I&&0===Ra&&0===(1&e.mode)&&(Ua=qg()+500,xn&&Mn()))}function nr(g,e){var I=g.callbackNode;!function(g,e){for(var I=g.suspendedLanes,t=g.pingedLanes,n=g.expirationTimes,C=g.pendingLanes;0<C;){var l=31-le(C),o=1<<l,a=n[l];-1===a?0!==(o&I)&&0===(o&t)||(n[l]=se(o,e)):a<=e&&(g.expiredLanes|=o),C&=~o}}(g,e);var t=Ae(g,g===ka?Ja:0);if(0===t)null!==I&&jg(I),g.callbackNode=null,g.callbackPriority=0;else if(e=t&-t,g.callbackPriority!==e){if(null!=I&&jg(I),1===e)0===g.tag?function(g){xn=!0,zn(g)}(rr.bind(null,g)):zn(rr.bind(null,g)),Cn((function(){0===(6&Ra)&&Mn()})),I=null;else{switch(pe(t)){case 1:I=$g;break;case 4:I=ge;break;case 16:default:I=ee;break;case 536870912:I=te}I=kr(I,Cr.bind(null,g))}g.callbackPriority=e,g.callbackNode=I}}function Cr(g,e){if($a=-1,gr=0,0!==(6&Ra))throw Error(C(327));var I=g.callbackNode;if(Br()&&g.callbackNode!==I)return null;var t=Ae(g,g===ka?Ja:0);if(0===t)return null;if(0!==(30&t)||0!==(t&g.expiredLanes)||e)e=br(g,t);else{e=t;var n=Ra;Ra|=2;var l=ur();for(ka===g&&Ja===e||(Da=null,Ua=qg()+500,sr(g,e));;)try{hr();break}catch(a){dr(g,a)}GC(),Wa.current=l,Ra=n,null!==Xa?e=0:(ka=null,Ja=0,e=wa)}if(0!==e){if(2===e&&(0!==(n=de(g))&&(t=n,e=lr(g,n))),1===e)throw I=Na,sr(g,0),ar(g,t),nr(g,qg()),I;if(6===e)ar(g,t);else{if(n=g.current.alternate,0===(30&t)&&!function(g){for(var e=g;;){if(16384&e.flags){var I=e.updateQueue;if(null!==I&&null!==(I=I.stores))for(var t=0;t<I.length;t++){var n=I[t],C=n.getSnapshot;n=n.value;try{if(!lt(C(),n))return!1}catch(o){return!1}}}if(I=e.child,16384&e.subtreeFlags&&null!==I)I.return=e,e=I;else{if(e===g)break;for(;null===e.sibling;){if(null===e.return||e.return===g)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(n)&&(2===(e=br(g,t))&&(0!==(l=de(g))&&(t=l,e=lr(g,l))),1===e))throw I=Na,sr(g,0),ar(g,t),nr(g,qg()),I;switch(g.finishedWork=n,g.finishedLanes=t,e){case 0:case 1:throw Error(C(345));case 2:case 5:yr(g,za,Da);break;case 3:if(ar(g,t),(130023424&t)===t&&10<(e=Ma+500-qg())){if(0!==Ae(g,0))break;if(((n=g.suspendedLanes)&t)!==t){er(),g.pingedLanes|=g.suspendedLanes&n;break}g.timeoutHandle=In(yr.bind(null,g,za,Da),e);break}yr(g,za,Da);break;case 4:if(ar(g,t),(4194240&t)===t)break;for(e=g.eventTimes,n=-1;0<t;){var o=31-le(t);l=1<<o,(o=e[o])>n&&(n=o),t&=~l}if(t=n,10<(t=(120>(t=qg()-t)?120:480>t?480:1080>t?1080:1920>t?1920:3e3>t?3e3:4320>t?4320:1960*Sa(t/1960))-t)){g.timeoutHandle=In(yr.bind(null,g,za,Da),t);break}yr(g,za,Da);break;default:throw Error(C(329))}}}return nr(g,qg()),g.callbackNode===I?Cr.bind(null,g):null}function lr(g,e){var I=Ea;return g.current.memoizedState.isDehydrated&&(sr(g,e).flags|=256),2!==(g=br(g,e))&&(e=za,za=I,null!==e&&or(e)),g}function or(g){null===za?za=g:za.push.apply(za,g)}function ar(g,e){for(e&=~xa,e&=~Fa,g.suspendedLanes|=e,g.pingedLanes&=~e,g=g.expirationTimes;0<e;){var I=31-le(e),t=1<<I;g[I]=-1,e&=~t}}function rr(g){if(0!==(6&Ra))throw Error(C(327));Br();var e=Ae(g,0);if(0===(1&e))return nr(g,qg()),null;var I=br(g,e);if(0!==g.tag&&2===I){var t=de(g);0!==t&&(e=t,I=lr(g,t))}if(1===I)throw I=Na,sr(g,0),ar(g,e),nr(g,qg()),I;if(6===I)throw Error(C(345));return g.finishedWork=g.current.alternate,g.finishedLanes=e,yr(g,za,Da),nr(g,qg()),null}function cr(g,e){var I=Ra;Ra|=1;try{return g(e)}finally{0===(Ra=I)&&(Ua=qg()+500,xn&&Mn())}}function ir(g){null!==Oa&&0===Oa.tag&&0===(6&Ra)&&Br();var e=Ra;Ra|=1;var I=va.transition,t=he;try{if(va.transition=null,he=1,g)return g()}finally{he=t,va.transition=I,0===(6&(Ra=e))&&Mn()}}function Ar(){Ya=Ha.current,Sn(Ha)}function sr(g,e){g.finishedWork=null,g.finishedLanes=0;var I=g.timeoutHandle;if(-1!==I&&(g.timeoutHandle=-1,tn(I)),null!==Xa)for(I=Xa.return;null!==I;){var t=I;switch(eC(t),t.tag){case 1:null!==(t=t.type.childContextTypes)&&void 0!==t&&Yn();break;case 3:nl(),Sn(Rn),Sn(vn),cl();break;case 5:ll(t);break;case 4:nl();break;case 13:case 19:Sn(ol);break;case 10:yC(t.type._context);break;case 22:case 23:Ar()}I=I.return}if(ka=g,Xa=g=Hr(g.current,null),Ja=Ya=e,wa=0,Na=null,xa=Fa=Ka=0,za=Ea=null,null!==WC){for(e=0;e<WC.length;e++)if(null!==(t=(I=WC[e]).interleaved)){I.interleaved=null;var n=t.next,C=I.pending;if(null!==C){var l=C.next;C.next=n,t.next=l}I.pending=t}WC=null}return g}function dr(g,e){for(;;){var I=Xa;try{if(GC(),il.current=Co,bl){for(var t=dl.memoizedState;null!==t;){var n=t.queue;null!==n&&(n.pending=null),t=t.next}bl=!1}if(sl=0,ml=ul=dl=null,Zl=!1,hl=0,Va.current=null,null===I||null===I.return){wa=1,Na=e,Xa=null;break}g:{var l=g,o=I.return,a=I,r=e;if(e=Ja,a.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){var c=r,i=a,A=i.tag;if(0===(1&i.mode)&&(0===A||11===A||15===A)){var s=i.alternate;s?(i.updateQueue=s.updateQueue,i.memoizedState=s.memoizedState,i.lanes=s.lanes):(i.updateQueue=null,i.memoizedState=null)}var d=bo(o);if(null!==d){d.flags&=-257,Zo(d,o,a,0,e),1&d.mode&&mo(l,c,e),r=c;var u=(e=d).updateQueue;if(null===u){var m=new Set;m.add(r),e.updateQueue=m}else u.add(r);break g}if(0===(1&e)){mo(l,c,e),mr();break g}r=Error(C(426))}else if(nC&&1&a.mode){var b=bo(o);if(null!==b){0===(65536&b.flags)&&(b.flags|=256),Zo(b,o,a,0,e),dC(ro(r,a));break g}}l=r=ro(r,a),4!==wa&&(wa=2),null===Ea?Ea=[l]:Ea.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e,NC(l,so(0,r,e));break g;case 1:a=r;var Z=l.type,h=l.stateNode;if(0===(128&l.flags)&&("function"===typeof Z.getDerivedStateFromError||null!==h&&"function"===typeof h.componentDidCatch&&(null===Ta||!Ta.has(h)))){l.flags|=65536,e&=-e,l.lanes|=e,NC(l,uo(l,a,e));break g}}l=l.return}while(null!==l)}Gr(I)}catch(p){e=p,Xa===I&&null!==I&&(Xa=I=I.return);continue}break}}function ur(){var g=Wa.current;return Wa.current=Co,null===g?Co:g}function mr(){0!==wa&&3!==wa&&2!==wa||(wa=4),null===ka||0===(268435455&Ka)&&0===(268435455&Fa)||ar(ka,Ja)}function br(g,e){var I=Ra;Ra|=2;var t=ur();for(ka===g&&Ja===e||(Da=null,sr(g,e));;)try{Zr();break}catch(n){dr(g,n)}if(GC(),Ra=I,Wa.current=t,null!==Xa)throw Error(C(261));return ka=null,Ja=0,wa}function Zr(){for(;null!==Xa;)pr(Xa)}function hr(){for(;null!==Xa&&!Og();)pr(Xa)}function pr(g){var e=fa(g.alternate,g,Ya);g.memoizedProps=g.pendingProps,null===e?Gr(g):Xa=e,Va.current=null}function Gr(g){var e=g;do{var I=e.alternate;if(g=e.return,0===(32768&e.flags)){if(null!==(I=jo(I,e,Ya)))return void(Xa=I)}else{if(null!==(I=Oo(I,e)))return I.flags&=32767,void(Xa=I);if(null===g)return wa=6,void(Xa=null);g.flags|=32768,g.subtreeFlags=0,g.deletions=null}if(null!==(e=e.sibling))return void(Xa=e);Xa=e=g}while(null!==e);0===wa&&(wa=5)}function yr(g,e,I){var t=he,n=va.transition;try{va.transition=null,he=1,function(g,e,I,t){do{Br()}while(null!==Oa);if(0!==(6&Ra))throw Error(C(327));I=g.finishedWork;var n=g.finishedLanes;if(null===I)return null;if(g.finishedWork=null,g.finishedLanes=0,I===g.current)throw Error(C(177));g.callbackNode=null,g.callbackPriority=0;var l=I.lanes|I.childLanes;if(function(g,e){var I=g.pendingLanes&~e;g.pendingLanes=e,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=e,g.mutableReadLanes&=e,g.entangledLanes&=e,e=g.entanglements;var t=g.eventTimes;for(g=g.expirationTimes;0<I;){var n=31-le(I),C=1<<n;e[n]=0,t[n]=-1,g[n]=-1,I&=~C}}(g,l),g===ka&&(Xa=ka=null,Ja=0),0===(2064&I.subtreeFlags)&&0===(2064&I.flags)||ja||(ja=!0,kr(ee,(function(){return Br(),null}))),l=0!==(15990&I.flags),0!==(15990&I.subtreeFlags)||l){l=va.transition,va.transition=null;var o=he;he=1;var a=Ra;Ra|=4,Va.current=null,function(g,e){if($t=De,At(g=it())){if("selectionStart"in g)var I={start:g.selectionStart,end:g.selectionEnd};else g:{var t=(I=(I=g.ownerDocument)&&I.defaultView||window).getSelection&&I.getSelection();if(t&&0!==t.rangeCount){I=t.anchorNode;var n=t.anchorOffset,l=t.focusNode;t=t.focusOffset;try{I.nodeType,l.nodeType}catch(G){I=null;break g}var o=0,a=-1,r=-1,c=0,i=0,A=g,s=null;e:for(;;){for(var d;A!==I||0!==n&&3!==A.nodeType||(a=o+n),A!==l||0!==t&&3!==A.nodeType||(r=o+t),3===A.nodeType&&(o+=A.nodeValue.length),null!==(d=A.firstChild);)s=A,A=d;for(;;){if(A===g)break e;if(s===I&&++c===n&&(a=o),s===l&&++i===t&&(r=o),null!==(d=A.nextSibling))break;s=(A=s).parentNode}A=d}I=-1===a||-1===r?null:{start:a,end:r}}else I=null}I=I||{start:0,end:0}}else I=null;for(gn={focusedElem:g,selectionRange:I},De=!1,$o=e;null!==$o;)if(g=(e=$o).child,0!==(1028&e.subtreeFlags)&&null!==g)g.return=e,$o=g;else for(;null!==$o;){e=$o;try{var u=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==u){var m=u.memoizedProps,b=u.memoizedState,Z=e.stateNode,h=Z.getSnapshotBeforeUpdate(e.elementType===e.type?m:mC(e.type,m),b);Z.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var p=e.stateNode.containerInfo;1===p.nodeType?p.textContent="":9===p.nodeType&&p.documentElement&&p.removeChild(p.documentElement);break;default:throw Error(C(163))}}catch(G){Sr(e,e.return,G)}if(null!==(g=e.sibling)){g.return=e.return,$o=g;break}$o=e.return}u=Ia,Ia=!1}(g,I),ba(I,g),st(gn),De=!!$t,gn=$t=null,g.current=I,ha(I,g,n),Pg(),Ra=a,he=o,va.transition=l}else g.current=I;if(ja&&(ja=!1,Oa=g,Pa=n),l=g.pendingLanes,0===l&&(Ta=null),function(g){if(Ce&&"function"===typeof Ce.onCommitFiberRoot)try{Ce.onCommitFiberRoot(ne,g,void 0,128===(128&g.current.flags))}catch(e){}}(I.stateNode),nr(g,qg()),null!==e)for(t=g.onRecoverableError,I=0;I<e.length;I++)n=e[I],t(n.value,{componentStack:n.stack,digest:n.digest});if(Qa)throw Qa=!1,g=La,La=null,g;0!==(1&Pa)&&0!==g.tag&&Br(),l=g.pendingLanes,0!==(1&l)?g===_a?qa++:(qa=0,_a=g):qa=0,Mn()}(g,e,I,t)}finally{va.transition=n,he=t}return null}function Br(){if(null!==Oa){var g=pe(Pa),e=va.transition,I=he;try{if(va.transition=null,he=16>g?16:g,null===Oa)var t=!1;else{if(g=Oa,Oa=null,Pa=0,0!==(6&Ra))throw Error(C(331));var n=Ra;for(Ra|=4,$o=g.current;null!==$o;){var l=$o,o=l.child;if(0!==(16&$o.flags)){var a=l.deletions;if(null!==a){for(var r=0;r<a.length;r++){var c=a[r];for($o=c;null!==$o;){var i=$o;switch(i.tag){case 0:case 11:case 15:ta(8,i,l)}var A=i.child;if(null!==A)A.return=i,$o=A;else for(;null!==$o;){var s=(i=$o).sibling,d=i.return;if(la(i),i===c){$o=null;break}if(null!==s){s.return=d,$o=s;break}$o=d}}}var u=l.alternate;if(null!==u){var m=u.child;if(null!==m){u.child=null;do{var b=m.sibling;m.sibling=null,m=b}while(null!==m)}}$o=l}}if(0!==(2064&l.subtreeFlags)&&null!==o)o.return=l,$o=o;else g:for(;null!==$o;){if(0!==(2048&(l=$o).flags))switch(l.tag){case 0:case 11:case 15:ta(9,l,l.return)}var Z=l.sibling;if(null!==Z){Z.return=l.return,$o=Z;break g}$o=l.return}}var h=g.current;for($o=h;null!==$o;){var p=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==p)p.return=o,$o=p;else g:for(o=h;null!==$o;){if(0!==(2048&(a=$o).flags))try{switch(a.tag){case 0:case 11:case 15:na(9,a)}}catch(y){Sr(a,a.return,y)}if(a===o){$o=null;break g}var G=a.sibling;if(null!==G){G.return=a.return,$o=G;break g}$o=a.return}}if(Ra=n,Mn(),Ce&&"function"===typeof Ce.onPostCommitFiberRoot)try{Ce.onPostCommitFiberRoot(ne,g)}catch(y){}t=!0}return t}finally{he=I,va.transition=e}}return!1}function fr(g,e,I){g=HC(g,e=so(0,e=ro(I,e),1),1),e=er(),null!==g&&(be(g,1,e),nr(g,e))}function Sr(g,e,I){if(3===g.tag)fr(g,g,I);else for(;null!==e;){if(3===e.tag){fr(e,g,I);break}if(1===e.tag){var t=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof t.componentDidCatch&&(null===Ta||!Ta.has(t))){e=HC(e,g=uo(e,g=ro(I,g),1),1),g=er(),null!==e&&(be(e,1,g),nr(e,g));break}}e=e.return}}function Wr(g,e,I){var t=g.pingCache;null!==t&&t.delete(e),e=er(),g.pingedLanes|=g.suspendedLanes&I,ka===g&&(Ja&I)===I&&(4===wa||3===wa&&(130023424&Ja)===Ja&&500>qg()-Ma?sr(g,0):xa|=I),nr(g,e)}function Vr(g,e){0===e&&(0===(1&g.mode)?e=1:(e=ce,0===(130023424&(ce<<=1))&&(ce=4194304)));var I=er();null!==(g=RC(g,e))&&(be(g,e,I),nr(g,I))}function vr(g){var e=g.memoizedState,I=0;null!==e&&(I=e.retryLane),Vr(g,I)}function Rr(g,e){var I=0;switch(g.tag){case 13:var t=g.stateNode,n=g.memoizedState;null!==n&&(I=n.retryLane);break;case 19:t=g.stateNode;break;default:throw Error(C(314))}null!==t&&t.delete(e),Vr(g,I)}function kr(g,e){return Tg(g,e)}function Xr(g,e,I,t){this.tag=g,this.key=I,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=t,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(g,e,I,t){return new Xr(g,e,I,t)}function Yr(g){return!(!(g=g.prototype)||!g.isReactComponent)}function Hr(g,e){var I=g.alternate;return null===I?((I=Jr(g.tag,e,g.key,g.mode)).elementType=g.elementType,I.type=g.type,I.stateNode=g.stateNode,I.alternate=g,g.alternate=I):(I.pendingProps=e,I.type=g.type,I.flags=0,I.subtreeFlags=0,I.deletions=null),I.flags=14680064&g.flags,I.childLanes=g.childLanes,I.lanes=g.lanes,I.child=g.child,I.memoizedProps=g.memoizedProps,I.memoizedState=g.memoizedState,I.updateQueue=g.updateQueue,e=g.dependencies,I.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},I.sibling=g.sibling,I.index=g.index,I.ref=g.ref,I}function wr(g,e,I,t,n,l){var o=2;if(t=g,"function"===typeof g)Yr(g)&&(o=1);else if("string"===typeof g)o=5;else g:switch(g){case B:return Nr(I.children,n,l,e);case f:o=8,n|=8;break;case S:return(g=Jr(12,I,e,2|n)).elementType=S,g.lanes=l,g;case R:return(g=Jr(13,I,e,n)).elementType=R,g.lanes=l,g;case k:return(g=Jr(19,I,e,n)).elementType=k,g.lanes=l,g;case Y:return Kr(I,n,l,e);default:if("object"===typeof g&&null!==g)switch(g.$$typeof){case W:o=10;break g;case V:o=9;break g;case v:o=11;break g;case X:o=14;break g;case J:o=16,t=null;break g}throw Error(C(130,null==g?g:typeof g,""))}return(e=Jr(o,I,e,n)).elementType=g,e.type=t,e.lanes=l,e}function Nr(g,e,I,t){return(g=Jr(7,g,t,e)).lanes=I,g}function Kr(g,e,I,t){return(g=Jr(22,g,t,e)).elementType=Y,g.lanes=I,g.stateNode={isHidden:!1},g}function Fr(g,e,I){return(g=Jr(6,g,null,e)).lanes=I,g}function xr(g,e,I){return(e=Jr(4,null!==g.children?g.children:[],g.key,e)).lanes=I,e.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},e}function Er(g,e,I,t,n){this.tag=e,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=t,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function zr(g,e,I,t,n,C,l,o,a){return g=new Er(g,e,I,o,a),1===e?(e=1,!0===C&&(e|=8)):e=0,C=Jr(3,null,null,e),g.current=C,C.stateNode=g,C.memoizedState={element:t,isDehydrated:I,cache:null,transitions:null,pendingSuspenseBoundaries:null},XC(C),g}function Mr(g){if(!g)return Vn;g:{if(Mg(g=g._reactInternals)!==g||1!==g.tag)throw Error(C(170));var e=g;do{switch(e.tag){case 3:e=e.stateNode.context;break g;case 1:if(Jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break g}}e=e.return}while(null!==e);throw Error(C(171))}if(1===g.tag){var I=g.type;if(Jn(I))return wn(g,I,e)}return e}function Ur(g,e,I,t,n,C,l,o,a){return(g=zr(I,t,!0,g,0,C,0,o,a)).context=Mr(null),I=g.current,(C=YC(t=er(),n=Ir(I))).callback=void 0!==e&&null!==e?e:null,HC(I,C,n),g.current.lanes=n,be(g,n,t),nr(g,t),g}function Dr(g,e,I,t){var n=e.current,C=er(),l=Ir(n);return I=Mr(I),null===e.context?e.context=I:e.pendingContext=I,(e=YC(C,l)).payload={element:g},null!==(t=void 0===t?null:t)&&(e.callback=t),null!==(g=HC(n,e,l))&&(tr(g,n,l,C),wC(g,n,l)),l}function Qr(g){return(g=g.current).child?(g.child.tag,g.child.stateNode):null}function Lr(g,e){if(null!==(g=g.memoizedState)&&null!==g.dehydrated){var I=g.retryLane;g.retryLane=0!==I&&I<e?I:e}}function Tr(g,e){Lr(g,e),(g=g.alternate)&&Lr(g,e)}fa=function(g,e,I){if(null!==g)if(g.memoizedProps!==e.pendingProps||Rn.current)po=!0;else{if(0===(g.lanes&I)&&0===(128&e.flags))return po=!1,function(g,e,I){switch(e.tag){case 3:ko(e),sC();break;case 5:Cl(e);break;case 1:Jn(e.type)&&Nn(e);break;case 4:tl(e,e.stateNode.containerInfo);break;case 10:var t=e.type._context,n=e.memoizedProps.value;Wn(bC,t._currentValue),t._currentValue=n;break;case 13:if(null!==(t=e.memoizedState))return null!==t.dehydrated?(Wn(ol,1&ol.current),e.flags|=128,null):0!==(I&e.child.childLanes)?Fo(g,e,I):(Wn(ol,1&ol.current),null!==(g=Qo(g,e,I))?g.sibling:null);Wn(ol,1&ol.current);break;case 19:if(t=0!==(I&e.childLanes),0!==(128&g.flags)){if(t)return Uo(g,e,I);e.flags|=128}if(null!==(n=e.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),Wn(ol,ol.current),t)break;return null;case 22:case 23:return e.lanes=0,So(g,e,I)}return Qo(g,e,I)}(g,e,I);po=0!==(131072&g.flags)}else po=!1,nC&&0!==(1048576&e.flags)&&$n(e,Ln,e.index);switch(e.lanes=0,e.tag){case 2:var t=e.type;Do(g,e),g=e.pendingProps;var n=Xn(e,vn.current);fC(e,I),n=Bl(null,e,t,g,n,I);var l=fl();return e.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jn(t)?(l=!0,Nn(e)):l=!1,e.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,XC(e),n.updater=zC,e.stateNode=n,n._reactInternals=e,QC(e,t,g,I),e=Ro(null,e,t,!0,l,I)):(e.tag=0,nC&&l&&gC(e),Go(null,e,n,I),e=e.child),e;case 16:t=e.elementType;g:{switch(Do(g,e),g=e.pendingProps,t=(n=t._init)(t._payload),e.type=t,n=e.tag=function(g){if("function"===typeof g)return Yr(g)?1:0;if(void 0!==g&&null!==g){if((g=g.$$typeof)===v)return 11;if(g===X)return 14}return 2}(t),g=mC(t,g),n){case 0:e=Vo(null,e,t,g,I);break g;case 1:e=vo(null,e,t,g,I);break g;case 11:e=yo(null,e,t,g,I);break g;case 14:e=Bo(null,e,t,mC(t.type,g),I);break g}throw Error(C(306,t,""))}return e;case 0:return t=e.type,n=e.pendingProps,Vo(g,e,t,n=e.elementType===t?n:mC(t,n),I);case 1:return t=e.type,n=e.pendingProps,vo(g,e,t,n=e.elementType===t?n:mC(t,n),I);case 3:g:{if(ko(e),null===g)throw Error(C(387));t=e.pendingProps,n=(l=e.memoizedState).element,JC(g,e),KC(e,t,null,I);var o=e.memoizedState;if(t=o.element,l.isDehydrated){if(l={element:t,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=l,e.memoizedState=l,256&e.flags){e=Xo(g,e,t,I,n=ro(Error(C(423)),e));break g}if(t!==n){e=Xo(g,e,t,I,n=ro(Error(C(424)),e));break g}for(tC=an(e.stateNode.containerInfo.firstChild),IC=e,nC=!0,CC=null,I=qC(e,null,t,I),e.child=I;I;)I.flags=-3&I.flags|4096,I=I.sibling}else{if(sC(),t===n){e=Qo(g,e,I);break g}Go(g,e,t,I)}e=e.child}return e;case 5:return Cl(e),null===g&&rC(e),t=e.type,n=e.pendingProps,l=null!==g?g.memoizedProps:null,o=n.children,en(t,n)?o=null:null!==l&&en(t,l)&&(e.flags|=32),Wo(g,e),Go(g,e,o,I),e.child;case 6:return null===g&&rC(e),null;case 13:return Fo(g,e,I);case 4:return tl(e,e.stateNode.containerInfo),t=e.pendingProps,null===g?e.child=PC(e,null,t,I):Go(g,e,t,I),e.child;case 11:return t=e.type,n=e.pendingProps,yo(g,e,t,n=e.elementType===t?n:mC(t,n),I);case 7:return Go(g,e,e.pendingProps,I),e.child;case 8:case 12:return Go(g,e,e.pendingProps.children,I),e.child;case 10:g:{if(t=e.type._context,n=e.pendingProps,l=e.memoizedProps,o=n.value,Wn(bC,t._currentValue),t._currentValue=o,null!==l)if(lt(l.value,o)){if(l.children===n.children&&!Rn.current){e=Qo(g,e,I);break g}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var a=l.dependencies;if(null!==a){o=l.child;for(var r=a.firstContext;null!==r;){if(r.context===t){if(1===l.tag){(r=YC(-1,I&-I)).tag=2;var c=l.updateQueue;if(null!==c){var i=(c=c.shared).pending;null===i?r.next=r:(r.next=i.next,i.next=r),c.pending=r}}l.lanes|=I,null!==(r=l.alternate)&&(r.lanes|=I),BC(l.return,I,e),a.lanes|=I;break}r=r.next}}else if(10===l.tag)o=l.type===e.type?null:l.child;else if(18===l.tag){if(null===(o=l.return))throw Error(C(341));o.lanes|=I,null!==(a=o.alternate)&&(a.lanes|=I),BC(o,I,e),o=l.sibling}else o=l.child;if(null!==o)o.return=l;else for(o=l;null!==o;){if(o===e){o=null;break}if(null!==(l=o.sibling)){l.return=o.return,o=l;break}o=o.return}l=o}Go(g,e,n.children,I),e=e.child}return e;case 9:return n=e.type,t=e.pendingProps.children,fC(e,I),t=t(n=SC(n)),e.flags|=1,Go(g,e,t,I),e.child;case 14:return n=mC(t=e.type,e.pendingProps),Bo(g,e,t,n=mC(t.type,n),I);case 15:return fo(g,e,e.type,e.pendingProps,I);case 17:return t=e.type,n=e.pendingProps,n=e.elementType===t?n:mC(t,n),Do(g,e),e.tag=1,Jn(t)?(g=!0,Nn(e)):g=!1,fC(e,I),UC(e,t,n),QC(e,t,n,I),Ro(null,e,t,!0,g,I);case 19:return Uo(g,e,I);case 22:return So(g,e,I)}throw Error(C(156,e.tag))};var jr="function"===typeof reportError?reportError:function(g){console.error(g)};function Or(g){this._internalRoot=g}function Pr(g){this._internalRoot=g}function qr(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType)}function _r(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType&&(8!==g.nodeType||" react-mount-point-unstable "!==g.nodeValue))}function $r(){}function gc(g,e,I,t,n){var C=I._reactRootContainer;if(C){var l=C;if("function"===typeof n){var o=n;n=function(){var g=Qr(l);o.call(g)}}Dr(e,l,g,n)}else l=function(g,e,I,t,n){if(n){if("function"===typeof t){var C=t;t=function(){var g=Qr(l);C.call(g)}}var l=Ur(e,t,g,0,null,!1,0,"",$r);return g._reactRootContainer=l,g[dn]=l.current,zt(8===g.nodeType?g.parentNode:g),ir(),l}for(;n=g.lastChild;)g.removeChild(n);if("function"===typeof t){var o=t;t=function(){var g=Qr(a);o.call(g)}}var a=zr(g,0,!1,null,0,!1,0,"",$r);return g._reactRootContainer=a,g[dn]=a.current,zt(8===g.nodeType?g.parentNode:g),ir((function(){Dr(e,a,I,t)})),a}(I,e,g,n,t);return Qr(l)}Pr.prototype.render=Or.prototype.render=function(g){var e=this._internalRoot;if(null===e)throw Error(C(409));Dr(g,e,null,null)},Pr.prototype.unmount=Or.prototype.unmount=function(){var g=this._internalRoot;if(null!==g){this._internalRoot=null;var e=g.containerInfo;ir((function(){Dr(null,g,null,null)})),e[dn]=null}},Pr.prototype.unstable_scheduleHydration=function(g){if(g){var e=fe();g={blockedOn:null,target:g,priority:e};for(var I=0;I<Ye.length&&0!==e&&e<Ye[I].priority;I++);Ye.splice(I,0,g),0===I&&Ke(g)}},Ge=function(g){switch(g.tag){case 3:var e=g.stateNode;if(e.current.memoizedState.isDehydrated){var I=ie(e.pendingLanes);0!==I&&(Ze(e,1|I),nr(e,qg()),0===(6&Ra)&&(Ua=qg()+500,Mn()))}break;case 13:ir((function(){var e=RC(g,1);if(null!==e){var I=er();tr(e,g,1,I)}})),Tr(g,1)}},ye=function(g){if(13===g.tag){var e=RC(g,134217728);if(null!==e)tr(e,g,134217728,er());Tr(g,134217728)}},Be=function(g){if(13===g.tag){var e=Ir(g),I=RC(g,e);if(null!==I)tr(I,g,e,er());Tr(g,e)}},fe=function(){return he},Se=function(g,e){var I=he;try{return he=g,e()}finally{he=I}},yg=function(g,e,I){switch(e){case"input":if(_(g,I),e=I.name,"radio"===I.type&&null!=e){for(I=g;I.parentNode;)I=I.parentNode;for(I=I.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<I.length;e++){var t=I[e];if(t!==g&&t.form===g.form){var n=Gn(t);if(!n)throw Error(C(90));T(t),_(t,n)}}}break;case"textarea":Cg(g,I);break;case"select":null!=(e=I.value)&&Ig(g,!!I.multiple,e,!1)}},vg=cr,Rg=ir;var ec={usingClientEntryPoint:!1,Events:[hn,pn,Gn,Wg,Vg,cr]},Ic={findFiberByHostInstance:Zn,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},tc={bundleType:Ic.bundleType,version:Ic.version,rendererPackageName:Ic.rendererPackageName,rendererConfig:Ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:p.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return null===(g=Qg(g))?null:g.stateNode},findFiberByHostInstance:Ic.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nc.isDisabled&&nc.supportsFiber)try{ne=nc.inject(tc),Ce=nc}catch(cg){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,e.createPortal=function(g,e){var I=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!qr(e))throw Error(C(200));return function(g,e,I){var t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:y,key:null==t?null:""+t,children:g,containerInfo:e,implementation:I}}(g,e,null,I)},e.createRoot=function(g,e){if(!qr(g))throw Error(C(299));var I=!1,t="",n=jr;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(I=!0),void 0!==e.identifierPrefix&&(t=e.identifierPrefix),void 0!==e.onRecoverableError&&(n=e.onRecoverableError)),e=zr(g,1,!1,null,0,I,0,t,n),g[dn]=e.current,zt(8===g.nodeType?g.parentNode:g),new Or(e)},e.findDOMNode=function(g){if(null==g)return null;if(1===g.nodeType)return g;var e=g._reactInternals;if(void 0===e){if("function"===typeof g.render)throw Error(C(188));throw g=Object.keys(g).join(","),Error(C(268,g))}return g=null===(g=Qg(e))?null:g.stateNode},e.flushSync=function(g){return ir(g)},e.hydrate=function(g,e,I){if(!_r(e))throw Error(C(200));return gc(null,g,e,!0,I)},e.hydrateRoot=function(g,e,I){if(!qr(g))throw Error(C(405));var t=null!=I&&I.hydratedSources||null,n=!1,l="",o=jr;if(null!==I&&void 0!==I&&(!0===I.unstable_strictMode&&(n=!0),void 0!==I.identifierPrefix&&(l=I.identifierPrefix),void 0!==I.onRecoverableError&&(o=I.onRecoverableError)),e=Ur(e,null,g,1,null!=I?I:null,n,0,l,o),g[dn]=e.current,zt(g),t)for(g=0;g<t.length;g++)n=(n=(I=t[g])._getVersion)(I._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[I,n]:e.mutableSourceEagerHydrationData.push(I,n);return new Pr(e)},e.render=function(g,e,I){if(!_r(e))throw Error(C(200));return gc(null,g,e,!1,I)},e.unmountComponentAtNode=function(g){if(!_r(g))throw Error(C(40));return!!g._reactRootContainer&&(ir((function(){gc(null,null,g,!1,(function(){g._reactRootContainer=null,g[dn]=null}))})),!0)},e.unstable_batchedUpdates=cr,e.unstable_renderSubtreeIntoContainer=function(g,e,I,t){if(!_r(I))throw Error(C(200));if(null==g||void 0===g._reactInternals)throw Error(C(38));return gc(g,e,I,!1,t)},e.version="18.2.0-next-9e3b772b8-20220608"},250:function(g,e,I){"use strict";var t=I(164);e.createRoot=t.createRoot,e.hydrateRoot=t.hydrateRoot},164:function(g,e,I){"use strict";!function g(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(e){console.error(e)}}(),g.exports=I(463)},688:function(g,e,I){"use strict";function t(){var g=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==g&&void 0!==g&&this.setState(g)}function n(g){this.setState(function(e){var I=this.constructor.getDerivedStateFromProps(g,e);return null!==I&&void 0!==I?I:null}.bind(this))}function C(g,e){try{var I=this.props,t=this.state;this.props=g,this.state=e,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(I,t)}finally{this.props=I,this.state=t}}function l(g){var e=g.prototype;if(!e||!e.isReactComponent)throw new Error("Can only polyfill class components");if("function"!==typeof g.getDerivedStateFromProps&&"function"!==typeof e.getSnapshotBeforeUpdate)return g;var I=null,l=null,o=null;if("function"===typeof e.componentWillMount?I="componentWillMount":"function"===typeof e.UNSAFE_componentWillMount&&(I="UNSAFE_componentWillMount"),"function"===typeof e.componentWillReceiveProps?l="componentWillReceiveProps":"function"===typeof e.UNSAFE_componentWillReceiveProps&&(l="UNSAFE_componentWillReceiveProps"),"function"===typeof e.componentWillUpdate?o="componentWillUpdate":"function"===typeof e.UNSAFE_componentWillUpdate&&(o="UNSAFE_componentWillUpdate"),null!==I||null!==l||null!==o){var a=g.displayName||g.name,r="function"===typeof g.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+a+" uses "+r+" but also contains the following legacy lifecycles:"+(null!==I?"\n  "+I:"")+(null!==l?"\n  "+l:"")+(null!==o?"\n  "+o:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"===typeof g.getDerivedStateFromProps&&(e.componentWillMount=t,e.componentWillReceiveProps=n),"function"===typeof e.getSnapshotBeforeUpdate){if("function"!==typeof e.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");e.componentWillUpdate=C;var c=e.componentDidUpdate;e.componentDidUpdate=function(g,e,I){var t=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:I;c.call(this,g,e,t)}}return g}I.r(e),I.d(e,{polyfill:function(){return l}}),t.__suppressDeprecationWarning=!0,n.__suppressDeprecationWarning=!0,C.__suppressDeprecationWarning=!0},240:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bodyOpenClassName=e.portalClassName=void 0;var t=Object.assign||function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},n=function(){function g(g,e){for(var I=0;I<e.length;I++){var t=e[I];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,t.key,t)}}return function(e,I,t){return I&&g(e.prototype,I),t&&g(e,t),e}}(),C=I(791),l=d(C),o=d(I(164)),a=d(I(7)),r=d(I(334)),c=function(g){if(g&&g.__esModule)return g;var e={};if(null!=g)for(var I in g)Object.prototype.hasOwnProperty.call(g,I)&&(e[I]=g[I]);return e.default=g,e}(I(858)),i=I(663),A=d(i),s=I(688);function d(g){return g&&g.__esModule?g:{default:g}}function u(g,e){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?g:e}var m=e.portalClassName="ReactModalPortal",b=e.bodyOpenClassName="ReactModal__Body--open",Z=i.canUseDOM&&void 0!==o.default.createPortal,h=function(g){return document.createElement(g)},p=function(){return Z?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function G(g){return g()}var y=function(g){function e(){var g,I,n;!function(g,e){if(!(g instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var C=arguments.length,a=Array(C),c=0;c<C;c++)a[c]=arguments[c];return I=n=u(this,(g=e.__proto__||Object.getPrototypeOf(e)).call.apply(g,[this].concat(a))),n.removePortal=function(){!Z&&o.default.unmountComponentAtNode(n.node);var g=G(n.props.parentSelector);g&&g.contains(n.node)?g.removeChild(n.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},n.portalRef=function(g){n.portal=g},n.renderPortal=function(g){var I=p()(n,l.default.createElement(r.default,t({defaultStyles:e.defaultStyles},g)),n.node);n.portalRef(I)},u(n,I)}return function(g,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);g.prototype=Object.create(e&&e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(g,e):g.__proto__=e)}(e,g),n(e,[{key:"componentDidMount",value:function(){i.canUseDOM&&(Z||(this.node=h("div")),this.node.className=this.props.portalClassName,G(this.props.parentSelector).appendChild(this.node),!Z&&this.renderPortal(this.props))}},{key:"getSnapshotBeforeUpdate",value:function(g){return{prevParent:G(g.parentSelector),nextParent:G(this.props.parentSelector)}}},{key:"componentDidUpdate",value:function(g,e,I){if(i.canUseDOM){var t=this.props,n=t.isOpen,C=t.portalClassName;g.portalClassName!==C&&(this.node.className=C);var l=I.prevParent,o=I.nextParent;o!==l&&(l.removeChild(this.node),o.appendChild(this.node)),(g.isOpen||n)&&!Z&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(i.canUseDOM&&this.node&&this.portal){var g=this.portal.state,e=Date.now(),I=g.isOpen&&this.props.closeTimeoutMS&&(g.closesAt||e+this.props.closeTimeoutMS);I?(g.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,I-e)):this.removePortal()}}},{key:"render",value:function(){return i.canUseDOM&&Z?(!this.node&&Z&&(this.node=h("div")),p()(l.default.createElement(r.default,t({ref:this.portalRef,defaultStyles:e.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(g){c.setElement(g)}}]),e}(C.Component);y.propTypes={isOpen:a.default.bool.isRequired,style:a.default.shape({content:a.default.object,overlay:a.default.object}),portalClassName:a.default.string,bodyOpenClassName:a.default.string,htmlOpenClassName:a.default.string,className:a.default.oneOfType([a.default.string,a.default.shape({base:a.default.string.isRequired,afterOpen:a.default.string.isRequired,beforeClose:a.default.string.isRequired})]),overlayClassName:a.default.oneOfType([a.default.string,a.default.shape({base:a.default.string.isRequired,afterOpen:a.default.string.isRequired,beforeClose:a.default.string.isRequired})]),appElement:a.default.oneOfType([a.default.instanceOf(A.default),a.default.instanceOf(i.SafeHTMLCollection),a.default.instanceOf(i.SafeNodeList),a.default.arrayOf(a.default.instanceOf(A.default))]),onAfterOpen:a.default.func,onRequestClose:a.default.func,closeTimeoutMS:a.default.number,ariaHideApp:a.default.bool,shouldFocusAfterRender:a.default.bool,shouldCloseOnOverlayClick:a.default.bool,shouldReturnFocusAfterClose:a.default.bool,preventScroll:a.default.bool,parentSelector:a.default.func,aria:a.default.object,data:a.default.object,role:a.default.string,contentLabel:a.default.string,shouldCloseOnEsc:a.default.bool,overlayRef:a.default.func,contentRef:a.default.func,id:a.default.string,overlayElement:a.default.func,contentElement:a.default.func},y.defaultProps={isOpen:!1,portalClassName:m,bodyOpenClassName:b,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(g,e){return l.default.createElement("div",g,e)},contentElement:function(g,e){return l.default.createElement("div",g,e)}},y.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,s.polyfill)(y),e.default=y},334:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=Object.assign||function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"===typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},C=function(){function g(g,e){for(var I=0;I<e.length;I++){var t=e[I];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,t.key,t)}}return function(e,I,t){return I&&g(e.prototype,I),t&&g(e,t),e}}(),l=I(791),o=m(I(7)),a=u(I(844)),r=m(I(870)),c=u(I(858)),i=u(I(942)),A=I(663),s=m(A),d=m(I(484));function u(g){if(g&&g.__esModule)return g;var e={};if(null!=g)for(var I in g)Object.prototype.hasOwnProperty.call(g,I)&&(e[I]=g[I]);return e.default=g,e}function m(g){return g&&g.__esModule?g:{default:g}}I(670);var b={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},Z=0,h=function(g){function e(g){!function(g,e){if(!(g instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var I=function(g,e){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?g:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,g));return I.setOverlayRef=function(g){I.overlay=g,I.props.overlayRef&&I.props.overlayRef(g)},I.setContentRef=function(g){I.content=g,I.props.contentRef&&I.props.contentRef(g)},I.afterClose=function(){var g=I.props,e=g.appElement,t=g.ariaHideApp,n=g.htmlOpenClassName,C=g.bodyOpenClassName,l=g.parentSelector,o=l&&l().ownerDocument||document;C&&i.remove(o.body,C),n&&i.remove(o.getElementsByTagName("html")[0],n),t&&Z>0&&0===(Z-=1)&&c.show(e),I.props.shouldFocusAfterRender&&(I.props.shouldReturnFocusAfterClose?(a.returnFocus(I.props.preventScroll),a.teardownScopedFocus()):a.popWithoutFocus()),I.props.onAfterClose&&I.props.onAfterClose(),d.default.deregister(I)},I.open=function(){I.beforeOpen(),I.state.afterOpen&&I.state.beforeClose?(clearTimeout(I.closeTimer),I.setState({beforeClose:!1})):(I.props.shouldFocusAfterRender&&(a.setupScopedFocus(I.node),a.markForFocusLater()),I.setState({isOpen:!0},(function(){I.openAnimationFrame=requestAnimationFrame((function(){I.setState({afterOpen:!0}),I.props.isOpen&&I.props.onAfterOpen&&I.props.onAfterOpen({overlayEl:I.overlay,contentEl:I.content})}))})))},I.close=function(){I.props.closeTimeoutMS>0?I.closeWithTimeout():I.closeWithoutTimeout()},I.focusContent=function(){return I.content&&!I.contentHasFocus()&&I.content.focus({preventScroll:!0})},I.closeWithTimeout=function(){var g=Date.now()+I.props.closeTimeoutMS;I.setState({beforeClose:!0,closesAt:g},(function(){I.closeTimer=setTimeout(I.closeWithoutTimeout,I.state.closesAt-Date.now())}))},I.closeWithoutTimeout=function(){I.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},I.afterClose)},I.handleKeyDown=function(g){(function(g){return"Tab"===g.code||9===g.keyCode})(g)&&(0,r.default)(I.content,g),I.props.shouldCloseOnEsc&&function(g){return"Escape"===g.code||27===g.keyCode}(g)&&(g.stopPropagation(),I.requestClose(g))},I.handleOverlayOnClick=function(g){null===I.shouldClose&&(I.shouldClose=!0),I.shouldClose&&I.props.shouldCloseOnOverlayClick&&(I.ownerHandlesClose()?I.requestClose(g):I.focusContent()),I.shouldClose=null},I.handleContentOnMouseUp=function(){I.shouldClose=!1},I.handleOverlayOnMouseDown=function(g){I.props.shouldCloseOnOverlayClick||g.target!=I.overlay||g.preventDefault()},I.handleContentOnClick=function(){I.shouldClose=!1},I.handleContentOnMouseDown=function(){I.shouldClose=!1},I.requestClose=function(g){return I.ownerHandlesClose()&&I.props.onRequestClose(g)},I.ownerHandlesClose=function(){return I.props.onRequestClose},I.shouldBeClosed=function(){return!I.state.isOpen&&!I.state.beforeClose},I.contentHasFocus=function(){return document.activeElement===I.content||I.content.contains(document.activeElement)},I.buildClassName=function(g,e){var t="object"===("undefined"===typeof e?"undefined":n(e))?e:{base:b[g],afterOpen:b[g]+"--after-open",beforeClose:b[g]+"--before-close"},C=t.base;return I.state.afterOpen&&(C=C+" "+t.afterOpen),I.state.beforeClose&&(C=C+" "+t.beforeClose),"string"===typeof e&&e?C+" "+e:C},I.attributesFromObject=function(g,e){return Object.keys(e).reduce((function(I,t){return I[g+"-"+t]=e[t],I}),{})},I.state={afterOpen:!1,beforeClose:!1},I.shouldClose=null,I.moveFromContentToOverlay=null,I}return function(g,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);g.prototype=Object.create(e&&e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(g,e):g.__proto__=e)}(e,g),C(e,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(g,e){this.props.isOpen&&!g.isOpen?this.open():!this.props.isOpen&&g.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!e.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var g=this.props,e=g.appElement,I=g.ariaHideApp,t=g.htmlOpenClassName,n=g.bodyOpenClassName,C=g.parentSelector,l=C&&C().ownerDocument||document;n&&i.add(l.body,n),t&&i.add(l.getElementsByTagName("html")[0],t),I&&(Z+=1,c.hide(e)),d.default.register(this)}},{key:"render",value:function(){var g=this.props,e=g.id,I=g.className,n=g.overlayClassName,C=g.defaultStyles,l=g.children,o=I?{}:C.content,a=n?{}:C.overlay;if(this.shouldBeClosed())return null;var r={ref:this.setOverlayRef,className:this.buildClassName("overlay",n),style:t({},a,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},c=t({id:e,ref:this.setContentRef,style:t({},o,this.props.style.content),className:this.buildClassName("content",I),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),i=this.props.contentElement(c,l);return this.props.overlayElement(r,i)}}]),e}(l.Component);h.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},h.propTypes={isOpen:o.default.bool.isRequired,defaultStyles:o.default.shape({content:o.default.object,overlay:o.default.object}),style:o.default.shape({content:o.default.object,overlay:o.default.object}),className:o.default.oneOfType([o.default.string,o.default.object]),overlayClassName:o.default.oneOfType([o.default.string,o.default.object]),parentSelector:o.default.func,bodyOpenClassName:o.default.string,htmlOpenClassName:o.default.string,ariaHideApp:o.default.bool,appElement:o.default.oneOfType([o.default.instanceOf(s.default),o.default.instanceOf(A.SafeHTMLCollection),o.default.instanceOf(A.SafeNodeList),o.default.arrayOf(o.default.instanceOf(s.default))]),onAfterOpen:o.default.func,onAfterClose:o.default.func,onRequestClose:o.default.func,closeTimeoutMS:o.default.number,shouldFocusAfterRender:o.default.bool,shouldCloseOnOverlayClick:o.default.bool,shouldReturnFocusAfterClose:o.default.bool,preventScroll:o.default.bool,role:o.default.string,contentLabel:o.default.string,aria:o.default.object,data:o.default.object,children:o.default.node,shouldCloseOnEsc:o.default.bool,overlayRef:o.default.func,contentRef:o.default.func,id:o.default.string,overlayElement:o.default.func,contentElement:o.default.func,testId:o.default.string},e.default=h,g.exports=e.default},858:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){o&&(o.removeAttribute?o.removeAttribute("aria-hidden"):null!=o.length?o.forEach((function(g){return g.removeAttribute("aria-hidden")})):document.querySelectorAll(o).forEach((function(g){return g.removeAttribute("aria-hidden")})));o=null},e.log=function(){0},e.assertNodeList=a,e.setElement=function(g){var e=g;if("string"===typeof e&&l.canUseDOM){var I=document.querySelectorAll(e);a(I,e),e=I}return o=e||o},e.validateElement=r,e.hide=function(g){var e=!0,I=!1,t=void 0;try{for(var n,C=r(g)[Symbol.iterator]();!(e=(n=C.next()).done);e=!0){n.value.setAttribute("aria-hidden","true")}}catch(l){I=!0,t=l}finally{try{!e&&C.return&&C.return()}finally{if(I)throw t}}},e.show=function(g){var e=!0,I=!1,t=void 0;try{for(var n,C=r(g)[Symbol.iterator]();!(e=(n=C.next()).done);e=!0){n.value.removeAttribute("aria-hidden")}}catch(l){I=!0,t=l}finally{try{!e&&C.return&&C.return()}finally{if(I)throw t}}},e.documentNotReadyOrSSRTesting=function(){o=null};var t,n=I(391),C=(t=n)&&t.__esModule?t:{default:t},l=I(663);var o=null;function a(g,e){if(!g||!g.length)throw new Error("react-modal: No elements were found for selector "+e+".")}function r(g){var e=g||o;return e?Array.isArray(e)||e instanceof HTMLCollection||e instanceof NodeList?e:[e]:((0,C.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}},670:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){for(var g=[l,o],e=0;e<g.length;e++){var I=g[e];I&&(I.parentNode&&I.parentNode.removeChild(I))}l=o=null,a=[]},e.log=function(){console.log("bodyTrap ----------"),console.log(a.length);for(var g=[l,o],e=0;e<g.length;e++){var I=g[e]||{};console.log(I.nodeName,I.className,I.id)}console.log("edn bodyTrap ----------")};var t,n=I(484),C=(t=n)&&t.__esModule?t:{default:t};var l=void 0,o=void 0,a=[];function r(){0!==a.length&&a[a.length-1].focusContent()}C.default.subscribe((function(g,e){l||o||((l=document.createElement("div")).setAttribute("data-react-modal-body-trap",""),l.style.position="absolute",l.style.opacity="0",l.setAttribute("tabindex","0"),l.addEventListener("focus",r),(o=l.cloneNode()).addEventListener("focus",r)),(a=e).length>0?(document.body.firstChild!==l&&document.body.insertBefore(l,document.body.firstChild),document.body.lastChild!==o&&document.body.appendChild(o)):(l.parentElement&&l.parentElement.removeChild(l),o.parentElement&&o.parentElement.removeChild(o))}))},942:function(g,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){var g=document.getElementsByTagName("html")[0];for(var e in I)n(g,I[e]);var C=document.body;for(var l in t)n(C,t[l]);I={},t={}},e.log=function(){0};var I={},t={};function n(g,e){g.classList.remove(e)}e.add=function(g,e){return n=g.classList,C="html"==g.nodeName.toLowerCase()?I:t,void e.split(" ").forEach((function(g){!function(g,e){g[e]||(g[e]=0),g[e]+=1}(C,g),n.add(g)}));var n,C},e.remove=function(g,e){return n=g.classList,C="html"==g.nodeName.toLowerCase()?I:t,void e.split(" ").forEach((function(g){!function(g,e){g[e]&&(g[e]-=1)}(C,g),0===C[g]&&n.remove(g)}));var n,C}},844:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){l=[]},e.log=function(){0},e.handleBlur=r,e.handleFocus=c,e.markForFocusLater=function(){l.push(document.activeElement)},e.returnFocus=function(){var g=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=null;try{return void(0!==l.length&&(e=l.pop()).focus({preventScroll:g}))}catch(I){console.warn(["You tried to return focus to",e,"but it is not in the DOM anymore"].join(" "))}},e.popWithoutFocus=function(){l.length>0&&l.pop()},e.setupScopedFocus=function(g){o=g,window.addEventListener?(window.addEventListener("blur",r,!1),document.addEventListener("focus",c,!0)):(window.attachEvent("onBlur",r),document.attachEvent("onFocus",c))},e.teardownScopedFocus=function(){o=null,window.addEventListener?(window.removeEventListener("blur",r),document.removeEventListener("focus",c)):(window.detachEvent("onBlur",r),document.detachEvent("onFocus",c))};var t,n=I(750),C=(t=n)&&t.__esModule?t:{default:t};var l=[],o=null,a=!1;function r(){a=!0}function c(){if(a){if(a=!1,!o)return;setTimeout((function(){o.contains(document.activeElement)||((0,C.default)(o)[0]||o).focus()}),0)}}},484:function(g,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.log=function(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach((function(g){return console.log(g)})),console.log("end portalOpenInstances ----------")},e.resetState=function(){t=new I};var I=function g(){var e=this;!function(g,e){if(!(g instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),this.register=function(g){-1===e.openInstances.indexOf(g)&&(e.openInstances.push(g),e.emit("register"))},this.deregister=function(g){var I=e.openInstances.indexOf(g);-1!==I&&(e.openInstances.splice(I,1),e.emit("deregister"))},this.subscribe=function(g){e.subscribers.push(g)},this.emit=function(g){e.subscribers.forEach((function(I){return I(g,e.openInstances.slice())}))},this.openInstances=[],this.subscribers=[]},t=new I;e.default=t},663:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.canUseDOM=e.SafeNodeList=e.SafeHTMLCollection=void 0;var t,n=I(618);var C=((t=n)&&t.__esModule?t:{default:t}).default,l=C.canUseDOM?window.HTMLElement:{};e.SafeHTMLCollection=C.canUseDOM?window.HTMLCollection:{},e.SafeNodeList=C.canUseDOM?window.NodeList:{},e.canUseDOM=C.canUseDOM;e.default=l},870:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(g,e){var I=(0,C.default)(g);if(!I.length)return void e.preventDefault();var t=void 0,n=e.shiftKey,o=I[0],a=I[I.length-1],r=l();if(g===r){if(!n)return;t=a}a!==r||n||(t=o);o===r&&n&&(t=a);if(t)return e.preventDefault(),void t.focus();var c=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null==c||"Chrome"==c[1]||null!=/\biPod\b|\biPad\b/g.exec(navigator.userAgent))return;var i=I.indexOf(r);i>-1&&(i+=n?-1:1);if("undefined"===typeof(t=I[i]))return e.preventDefault(),void(t=n?a:o).focus();e.preventDefault(),t.focus()};var t,n=I(750),C=(t=n)&&t.__esModule?t:{default:t};function l(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return g.activeElement.shadowRoot?l(g.activeElement.shadowRoot):g.activeElement}g.exports=e.default},750:function(g,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function g(e){var I=[].slice.call(e.querySelectorAll("*"),0).reduce((function(e,I){return e.concat(I.shadowRoot?g(I.shadowRoot):[I])}),[]);return I.filter(o)};var I="none",t="contents",n=/input|select|textarea|button|object|iframe/;function C(g){var e=g.offsetWidth<=0&&g.offsetHeight<=0;if(e&&!g.innerHTML)return!0;try{var n=window.getComputedStyle(g),C=n.getPropertyValue("display");return e?C!==t&&function(g,e){return"visible"!==e.getPropertyValue("overflow")||g.scrollWidth<=0&&g.scrollHeight<=0}(g,n):C===I}catch(l){return console.warn("Failed to inspect element style"),!1}}function l(g,e){var I=g.nodeName.toLowerCase();return(n.test(I)&&!g.disabled||"a"===I&&g.href||e)&&function(g){for(var e=g,I=g.getRootNode&&g.getRootNode();e&&e!==document.body;){if(I&&e===I&&(e=I.host.parentNode),C(e))return!1;e=e.parentNode}return!0}(g)}function o(g){var e=g.getAttribute("tabindex");null===e&&(e=void 0);var I=isNaN(e);return(I||e>=0)&&l(g,!I)}g.exports=e.default},948:function(g,e,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t,n=I(240),C=(t=n)&&t.__esModule?t:{default:t};e.default=C.default,g.exports=e.default},8:function(g,e,I){g.exports=function(g){"use strict";function e(g){if(g&&g.__esModule)return g;var e=Object.create(null);return g&&Object.keys(g).forEach((function(I){if("default"!==I){var t=Object.getOwnPropertyDescriptor(g,I);Object.defineProperty(e,I,t.get?t:{enumerable:!0,get:function(){return g[I]}})}})),e.default=g,Object.freeze(e)}var I=e(g);function t(){return t=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},t.apply(this,arguments)}function n(g,e,I){return e in g?Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}):g[e]=I,g}function C(g){if(Array.isArray(g))return g}function l(g,e){var I=null==g?null:"undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=I){var t,n,C=[],l=!0,o=!1;try{for(I=I.call(g);!(l=(t=I.next()).done)&&(C.push(t.value),!e||C.length!==e);l=!0);}catch(a){o=!0,n=a}finally{try{l||null==I.return||I.return()}finally{if(o)throw n}}return C}}function o(g,e){(null==e||e>g.length)&&(e=g.length);for(var I=0,t=new Array(e);I<e;I++)t[I]=g[I];return t}function a(g,e){if(g){if("string"===typeof g)return o(g,e);var I=Object.prototype.toString.call(g).slice(8,-1);return"Object"===I&&g.constructor&&(I=g.constructor.name),"Map"===I||"Set"===I?Array.from(g):"Arguments"===I||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I)?o(g,e):void 0}}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(g,e){return C(g)||l(g,e)||a(g,e)||r()}function i(g,e){if(null==g)return{};var I,t,n={},C=Object.keys(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||(n[I]=g[I]);return n}function A(g,e){if(null==g)return{};var I,t,n=i(g,e);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||Object.prototype.propertyIsEnumerable.call(g,I)&&(n[I]=g[I])}return n}var s={exports:{}},d={exports:{}},u={},m="function"===typeof Symbol&&Symbol.for,b=m?Symbol.for("react.element"):60103,Z=m?Symbol.for("react.portal"):60106,h=m?Symbol.for("react.fragment"):60107,p=m?Symbol.for("react.strict_mode"):60108,G=m?Symbol.for("react.profiler"):60114,y=m?Symbol.for("react.provider"):60109,B=m?Symbol.for("react.context"):60110,f=m?Symbol.for("react.async_mode"):60111,S=m?Symbol.for("react.concurrent_mode"):60111,W=m?Symbol.for("react.forward_ref"):60112,V=m?Symbol.for("react.suspense"):60113,v=m?Symbol.for("react.suspense_list"):60120,R=m?Symbol.for("react.memo"):60115,k=m?Symbol.for("react.lazy"):60116,X=m?Symbol.for("react.block"):60121,J=m?Symbol.for("react.fundamental"):60117,Y=m?Symbol.for("react.responder"):60118,H=m?Symbol.for("react.scope"):60119;function w(g){if("object"===typeof g&&null!==g){var e=g.$$typeof;switch(e){case b:switch(g=g.type){case f:case S:case h:case G:case p:case V:return g;default:switch(g=g&&g.$$typeof){case B:case W:case k:case R:case y:return g;default:return e}}case Z:return e}}}function N(g){return w(g)===S}u.AsyncMode=f,u.ConcurrentMode=S,u.ContextConsumer=B,u.ContextProvider=y,u.Element=b,u.ForwardRef=W,u.Fragment=h,u.Lazy=k,u.Memo=R,u.Portal=Z,u.Profiler=G,u.StrictMode=p,u.Suspense=V,u.isAsyncMode=function(g){return N(g)||w(g)===f},u.isConcurrentMode=N,u.isContextConsumer=function(g){return w(g)===B},u.isContextProvider=function(g){return w(g)===y},u.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===b},u.isForwardRef=function(g){return w(g)===W},u.isFragment=function(g){return w(g)===h},u.isLazy=function(g){return w(g)===k},u.isMemo=function(g){return w(g)===R},u.isPortal=function(g){return w(g)===Z},u.isProfiler=function(g){return w(g)===G},u.isStrictMode=function(g){return w(g)===p},u.isSuspense=function(g){return w(g)===V},u.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===h||g===S||g===G||g===p||g===V||g===v||"object"===typeof g&&null!==g&&(g.$$typeof===k||g.$$typeof===R||g.$$typeof===y||g.$$typeof===B||g.$$typeof===W||g.$$typeof===J||g.$$typeof===Y||g.$$typeof===H||g.$$typeof===X)},u.typeOf=w,d.exports=u;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function K(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de","5"===Object.getOwnPropertyNames(g)[0])return!1;for(var e={},I=0;I<10;I++)e["_"+String.fromCharCode(I)]=I;var t=Object.getOwnPropertyNames(e).map((function(g){return e[g]}));if("0123456789"!==t.join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(g){n[g]=g})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(C){return!1}}K()&&Object.assign;var F="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function x(g,e,I,t,n){}Function.call.bind(Object.prototype.hasOwnProperty),x.resetWarningCache=function(){},d.exports;var E=F;function z(){}function M(){}M.resetWarningCache=z;var U=function(){function g(g,e,I,t,n,C){if(C!==E){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function e(){return g}g.isRequired=g;var I={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:e,element:g,elementType:g,instanceOf:e,node:g,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:M,resetWarningCache:z};return I.PropTypes=I,I};s.exports=U();var D=s.exports;function Q(g,e){var I=atob(g);if(e){for(var t=new Uint8Array(I.length),n=0,C=I.length;n<C;++n)t[n]=I.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(t.buffer))}return I}function L(g,e,I){var t=void 0===e?null:e,n=Q(g,void 0!==I&&I),C=n.indexOf("\n",10)+1,l=n.substring(C)+(t?"//# sourceMappingURL="+t:""),o=new Blob([l],{type:"application/javascript"});return URL.createObjectURL(o)}function T(g,e,I){var t;return function(n){return t=t||L(g,e,I),new Worker(t,n)}}var j=T("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),O=["constraints","onError","onLoad","onScan","resolution","qrArea"];function P(g,e){var I=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(g,e).enumerable}))),I.push.apply(I,t)}return I}function q(g){for(var e=1;e<arguments.length;e++){var I=null!=arguments[e]?arguments[e]:{};e%2?P(Object(I),!0).forEach((function(e){n(g,e,I[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(I)):P(Object(I)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(I,e))}))}return g}var _=function(){return new j},$=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().forEach((function(e){g.removeTrack(e),e.stop()})),g.getAudioTracks().forEach((function(e){g.removeTrack(e),e.stop()}))):g.stop())},gg=function(g){var e=g.constraints,n=g.onError,C=g.onLoad,l=g.onScan,o=g.resolution,a=g.qrArea,r=A(g,O),i=I.useRef(null),s=I.useRef(null),d=I.useRef(document.createElement("canvas")),u=I.useRef(null),m=I.useRef(),b=c(I.useState(null),2),Z=b[0],h=b[1],p=I.useRef(!1),G=I.useRef();I.useEffect((function(){G.current=_();var g=G.current;return g.onmessage=function(g){l&&l(g.data?q(q({},g.data),{},{canvas:d.current}):null),p.current=!1},function(){g.terminate()}}),[l]);var y=JSON.stringify(a),B=I.useCallback((function(){var g=JSON.parse(y),e=G.current,I=s.current&&s.current.readyState===s.current.HAVE_ENOUGH_DATA;if(!p.current&&I){p.current=!0;var t,n=s.current.videoWidth,C=s.current.videoHeight,l=n>C?n:C,a=Math.floor(o/l*100)/100;C=Math.floor(a*C),n=Math.floor(a*n),d.current.width=n,d.current.height=C,u.current=d.current.getContext("2d"),u.current.drawImage(s.current,0,0,n,C),t=g&&2===g.length&&g[0]>0&&g[1]>0?u.current.getImageData(Math.floor((n-g[0])/2),Math.floor((C-g[1])/2),g[0],g[1]):u.current.getImageData(0,0,n,C),e.postMessage(t)}m.current=requestAnimationFrame(B)}),[o,y]),f=JSON.stringify(e);return I.useEffect((function(){var g=JSON.parse(f),e=!0;return navigator.mediaDevices.getUserMedia(g).then((function(g){if(e){i.current=g;try{s.current&&(s.current.srcObject=g,s.current.setAttribute("playsinline",!0))}catch(I){h(window.URL.createObjectURL(g))}C&&C(),m.current=requestAnimationFrame(B)}else $(g)})).catch((function(g){return e?n(g):null})),function(){cancelAnimationFrame(m.current),e=!1,$(i.current),Z&&window.URL.revokeObjectURL(Z)}}),[B,f,n,C,Z]),I.createElement("video",t({autoPlay:!0,playsInline:!0,src:Z,ref:s},r))};return gg.propTypes={constraints:D.object,onError:D.func.isRequired,onLoad:D.func,onScan:D.func.isRequired,resolution:D.number,qrArea:D.array},gg.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]},gg}(I(791))},374:function(g,e,I){"use strict";var t=I(791),n=Symbol.for("react.element"),C=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function r(g,e,I){var t,C={},r=null,c=null;for(t in void 0!==I&&(r=""+I),void 0!==e.key&&(r=""+e.key),void 0!==e.ref&&(c=e.ref),e)l.call(e,t)&&!a.hasOwnProperty(t)&&(C[t]=e[t]);if(g&&g.defaultProps)for(t in e=g.defaultProps)void 0===C[t]&&(C[t]=e[t]);return{$$typeof:n,type:g,key:r,ref:c,props:C,_owner:o.current}}e.Fragment=C,e.jsx=r,e.jsxs=r},117:function(g,e){"use strict";var I=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),r=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),i=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),s=Symbol.iterator;var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u=Object.assign,m={};function b(g,e,I){this.props=g,this.context=e,this.refs=m,this.updater=I||d}function Z(){}function h(g,e,I){this.props=g,this.context=e,this.refs=m,this.updater=I||d}b.prototype.isReactComponent={},b.prototype.setState=function(g,e){if("object"!==typeof g&&"function"!==typeof g&&null!=g)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,e,"setState")},b.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")},Z.prototype=b.prototype;var p=h.prototype=new Z;p.constructor=h,u(p,b.prototype),p.isPureReactComponent=!0;var G=Array.isArray,y=Object.prototype.hasOwnProperty,B={current:null},f={key:!0,ref:!0,__self:!0,__source:!0};function S(g,e,t){var n,C={},l=null,o=null;if(null!=e)for(n in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(l=""+e.key),e)y.call(e,n)&&!f.hasOwnProperty(n)&&(C[n]=e[n]);var a=arguments.length-2;if(1===a)C.children=t;else if(1<a){for(var r=Array(a),c=0;c<a;c++)r[c]=arguments[c+2];C.children=r}if(g&&g.defaultProps)for(n in a=g.defaultProps)void 0===C[n]&&(C[n]=a[n]);return{$$typeof:I,type:g,key:l,ref:o,props:C,_owner:B.current}}function W(g){return"object"===typeof g&&null!==g&&g.$$typeof===I}var V=/\/+/g;function v(g,e){return"object"===typeof g&&null!==g&&null!=g.key?function(g){var e={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,(function(g){return e[g]}))}(""+g.key):e.toString(36)}function R(g,e,n,C,l){var o=typeof g;"undefined"!==o&&"boolean"!==o||(g=null);var a=!1;if(null===g)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(g.$$typeof){case I:case t:a=!0}}if(a)return l=l(a=g),g=""===C?"."+v(a,0):C,G(l)?(n="",null!=g&&(n=g.replace(V,"$&/")+"/"),R(l,e,n,"",(function(g){return g}))):null!=l&&(W(l)&&(l=function(g,e){return{$$typeof:I,type:g.type,key:e,ref:g.ref,props:g.props,_owner:g._owner}}(l,n+(!l.key||a&&a.key===l.key?"":(""+l.key).replace(V,"$&/")+"/")+g)),e.push(l)),1;if(a=0,C=""===C?".":C+":",G(g))for(var r=0;r<g.length;r++){var c=C+v(o=g[r],r);a+=R(o,e,n,c,l)}else if(c=function(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=s&&g[s]||g["@@iterator"])?g:null}(g),"function"===typeof c)for(g=c.call(g),r=0;!(o=g.next()).done;)a+=R(o=o.value,e,n,c=C+v(o,r++),l);else if("object"===o)throw e=String(g),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(g).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function k(g,e,I){if(null==g)return g;var t=[],n=0;return R(g,t,"","",(function(g){return e.call(I,g,n++)})),t}function X(g){if(-1===g._status){var e=g._result;(e=e()).then((function(e){0!==g._status&&-1!==g._status||(g._status=1,g._result=e)}),(function(e){0!==g._status&&-1!==g._status||(g._status=2,g._result=e)})),-1===g._status&&(g._status=0,g._result=e)}if(1===g._status)return g._result.default;throw g._result}var J={current:null},Y={transition:null},H={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:Y,ReactCurrentOwner:B};e.Children={map:k,forEach:function(g,e,I){k(g,(function(){e.apply(this,arguments)}),I)},count:function(g){var e=0;return k(g,(function(){e++})),e},toArray:function(g){return k(g,(function(g){return g}))||[]},only:function(g){if(!W(g))throw Error("React.Children.only expected to receive a single React element child.");return g}},e.Component=b,e.Fragment=n,e.Profiler=l,e.PureComponent=h,e.StrictMode=C,e.Suspense=c,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,e.cloneElement=function(g,e,t){if(null===g||void 0===g)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var n=u({},g.props),C=g.key,l=g.ref,o=g._owner;if(null!=e){if(void 0!==e.ref&&(l=e.ref,o=B.current),void 0!==e.key&&(C=""+e.key),g.type&&g.type.defaultProps)var a=g.type.defaultProps;for(r in e)y.call(e,r)&&!f.hasOwnProperty(r)&&(n[r]=void 0===e[r]&&void 0!==a?a[r]:e[r])}var r=arguments.length-2;if(1===r)n.children=t;else if(1<r){a=Array(r);for(var c=0;c<r;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:I,type:g.type,key:C,ref:l,props:n,_owner:o}},e.createContext=function(g){return(g={$$typeof:a,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:g},g.Consumer=g},e.createElement=S,e.createFactory=function(g){var e=S.bind(null,g);return e.type=g,e},e.createRef=function(){return{current:null}},e.forwardRef=function(g){return{$$typeof:r,render:g}},e.isValidElement=W,e.lazy=function(g){return{$$typeof:A,_payload:{_status:-1,_result:g},_init:X}},e.memo=function(g,e){return{$$typeof:i,type:g,compare:void 0===e?null:e}},e.startTransition=function(g){var e=Y.transition;Y.transition={};try{g()}finally{Y.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(g,e){return J.current.useCallback(g,e)},e.useContext=function(g){return J.current.useContext(g)},e.useDebugValue=function(){},e.useDeferredValue=function(g){return J.current.useDeferredValue(g)},e.useEffect=function(g,e){return J.current.useEffect(g,e)},e.useId=function(){return J.current.useId()},e.useImperativeHandle=function(g,e,I){return J.current.useImperativeHandle(g,e,I)},e.useInsertionEffect=function(g,e){return J.current.useInsertionEffect(g,e)},e.useLayoutEffect=function(g,e){return J.current.useLayoutEffect(g,e)},e.useMemo=function(g,e){return J.current.useMemo(g,e)},e.useReducer=function(g,e,I){return J.current.useReducer(g,e,I)},e.useRef=function(g){return J.current.useRef(g)},e.useState=function(g){return J.current.useState(g)},e.useSyncExternalStore=function(g,e,I){return J.current.useSyncExternalStore(g,e,I)},e.useTransition=function(){return J.current.useTransition()},e.version="18.2.0"},791:function(g,e,I){"use strict";g.exports=I(117)},184:function(g,e,I){"use strict";g.exports=I(374)},813:function(g,e){"use strict";function I(g,e){var I=g.length;g.push(e);g:for(;0<I;){var t=I-1>>>1,n=g[t];if(!(0<C(n,e)))break g;g[t]=e,g[I]=n,I=t}}function t(g){return 0===g.length?null:g[0]}function n(g){if(0===g.length)return null;var e=g[0],I=g.pop();if(I!==e){g[0]=I;g:for(var t=0,n=g.length,l=n>>>1;t<l;){var o=2*(t+1)-1,a=g[o],r=o+1,c=g[r];if(0>C(a,I))r<n&&0>C(c,a)?(g[t]=c,g[r]=I,t=r):(g[t]=a,g[o]=I,t=o);else{if(!(r<n&&0>C(c,I)))break g;g[t]=c,g[r]=I,t=r}}}return e}function C(g,e){var I=g.sortIndex-e.sortIndex;return 0!==I?I:g.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var r=[],c=[],i=1,A=null,s=3,d=!1,u=!1,m=!1,b="function"===typeof setTimeout?setTimeout:null,Z="function"===typeof clearTimeout?clearTimeout:null,h="undefined"!==typeof setImmediate?setImmediate:null;function p(g){for(var e=t(c);null!==e;){if(null===e.callback)n(c);else{if(!(e.startTime<=g))break;n(c),e.sortIndex=e.expirationTime,I(r,e)}e=t(c)}}function G(g){if(m=!1,p(g),!u)if(null!==t(r))u=!0,Y(y);else{var e=t(c);null!==e&&H(G,e.startTime-g)}}function y(g,I){u=!1,m&&(m=!1,Z(W),W=-1),d=!0;var C=s;try{for(p(I),A=t(r);null!==A&&(!(A.expirationTime>I)||g&&!R());){var l=A.callback;if("function"===typeof l){A.callback=null,s=A.priorityLevel;var o=l(A.expirationTime<=I);I=e.unstable_now(),"function"===typeof o?A.callback=o:A===t(r)&&n(r),p(I)}else n(r);A=t(r)}if(null!==A)var a=!0;else{var i=t(c);null!==i&&H(G,i.startTime-I),a=!1}return a}finally{A=null,s=C,d=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var B,f=!1,S=null,W=-1,V=5,v=-1;function R(){return!(e.unstable_now()-v<V)}function k(){if(null!==S){var g=e.unstable_now();v=g;var I=!0;try{I=S(!0,g)}finally{I?B():(f=!1,S=null)}}else f=!1}if("function"===typeof h)B=function(){h(k)};else if("undefined"!==typeof MessageChannel){var X=new MessageChannel,J=X.port2;X.port1.onmessage=k,B=function(){J.postMessage(null)}}else B=function(){b(k,0)};function Y(g){S=g,f||(f=!0,B())}function H(g,I){W=b((function(){g(e.unstable_now())}),I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(g){g.callback=null},e.unstable_continueExecution=function(){u||d||(u=!0,Y(y))},e.unstable_forceFrameRate=function(g){0>g||125<g?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<g?Math.floor(1e3/g):5},e.unstable_getCurrentPriorityLevel=function(){return s},e.unstable_getFirstCallbackNode=function(){return t(r)},e.unstable_next=function(g){switch(s){case 1:case 2:case 3:var e=3;break;default:e=s}var I=s;s=e;try{return g()}finally{s=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(g,e){switch(g){case 1:case 2:case 3:case 4:case 5:break;default:g=3}var I=s;s=g;try{return e()}finally{s=I}},e.unstable_scheduleCallback=function(g,n,C){var l=e.unstable_now();switch("object"===typeof C&&null!==C?C="number"===typeof(C=C.delay)&&0<C?l+C:l:C=l,g){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return g={id:i++,callback:n,priorityLevel:g,startTime:C,expirationTime:o=C+o,sortIndex:-1},C>l?(g.sortIndex=C,I(c,g),null===t(r)&&g===t(c)&&(m?(Z(W),W=-1):m=!0,H(G,C-l))):(g.sortIndex=o,I(r,g),u||d||(u=!0,Y(y))),g},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(g){var e=s;return function(){var I=s;s=e;try{return g.apply(this,arguments)}finally{s=I}}}},296:function(g,e,I){"use strict";g.exports=I(813)},391:function(g){"use strict";var e=function(){};g.exports=e}},e={};function I(t){var n=e[t];if(void 0!==n)return n.exports;var C=e[t]={id:t,loaded:!1,exports:{}};return g[t].call(C.exports,C,C.exports,I),C.loaded=!0,C.exports}I.m=g,I.n=function(g){var e=g&&g.__esModule?function(){return g.default}:function(){return g};return I.d(e,{a:e}),e},function(){var g,e=Object.getPrototypeOf?function(g){return Object.getPrototypeOf(g)}:function(g){return g.__proto__};I.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"===typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"===typeof t.then)return t}var C=Object.create(null);I.r(C);var l={};g=g||[null,e({}),e([]),e(e)];for(var o=2&n&&t;"object"==typeof o&&!~g.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach((function(g){l[g]=function(){return t[g]}}));return l.default=function(){return t},I.d(C,l),C}}(),I.d=function(g,e){for(var t in e)I.o(e,t)&&!I.o(g,t)&&Object.defineProperty(g,t,{enumerable:!0,get:e[t]})},I.f={},I.e=function(g){return Promise.all(Object.keys(I.f).reduce((function(e,t){return I.f[t](g,e),e}),[]))},I.u=function(g){return"static/js/"+g+".f121dd1e.chunk.js"},I.miniCssF=function(g){},I.o=function(g,e){return Object.prototype.hasOwnProperty.call(g,e)},function(){var g={},e="school-booking-system:";I.l=function(t,n,C,l){if(g[t])g[t].push(n);else{var o,a;if(void 0!==C)for(var r=document.getElementsByTagName("script"),c=0;c<r.length;c++){var i=r[c];if(i.getAttribute("src")==t||i.getAttribute("data-webpack")==e+C){o=i;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,I.nc&&o.setAttribute("nonce",I.nc),o.setAttribute("data-webpack",e+C),o.src=t),g[t]=[n];var A=function(e,I){o.onerror=o.onload=null,clearTimeout(s);var n=g[t];if(delete g[t],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((function(g){return g(I)})),e)return e(I)},s=setTimeout(A.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=A.bind(null,o.onerror),o.onload=A.bind(null,o.onload),a&&document.head.appendChild(o)}}}(),I.r=function(g){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},I.nmd=function(g){return g.paths=[],g.children||(g.children=[]),g},I.p="/",function(){var g={179:0};I.f.j=function(e,t){var n=I.o(g,e)?g[e]:void 0;if(0!==n)if(n)t.push(n[2]);else{var C=new Promise((function(I,t){n=g[e]=[I,t]}));t.push(n[2]=C);var l=I.p+I.u(e),o=new Error;I.l(l,(function(t){if(I.o(g,e)&&(0!==(n=g[e])&&(g[e]=void 0),n)){var C=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;o.message="Loading chunk "+e+" failed.\n("+C+": "+l+")",o.name="ChunkLoadError",o.type=C,o.request=l,n[1](o)}}),"chunk-"+e,e)}};var e=function(e,t){var n,C,l=t[0],o=t[1],a=t[2],r=0;if(l.some((function(e){return 0!==g[e]}))){for(n in o)I.o(o,n)&&(I.m[n]=o[n]);if(a)a(I)}for(e&&e(t);r<l.length;r++)C=l[r],I.o(g,C)&&g[C]&&g[C][0](),g[C]=0},t=self.webpackChunkschool_booking_system=self.webpackChunkschool_booking_system||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))}(),function(){"use strict";var g,e=I(791),t=I.t(e,2),n=I(250);function C(g){if(Array.isArray(g))return g}function l(g,e){(null==e||e>g.length)&&(e=g.length);for(var I=0,t=new Array(e);I<e;I++)t[I]=g[I];return t}function o(g,e){if(g){if("string"===typeof g)return l(g,e);var I=Object.prototype.toString.call(g).slice(8,-1);return"Object"===I&&g.constructor&&(I=g.constructor.name),"Map"===I||"Set"===I?Array.from(g):"Arguments"===I||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I)?l(g,e):void 0}}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(g,e){return C(g)||function(g,e){var I=null==g?null:"undefined"!=typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=I){var t,n,C,l,o=[],a=!0,r=!1;try{if(C=(I=I.call(g)).next,0===e){if(Object(I)!==I)return;a=!1}else for(;!(a=(t=C.call(I)).done)&&(o.push(t.value),o.length!==e);a=!0);}catch(g){r=!0,n=g}finally{try{if(!a&&null!=I.return&&(l=I.return(),Object(l)!==l))return}finally{if(r)throw n}}return o}}(g,e)||o(g,e)||a()}function c(g){if("undefined"!==typeof Symbol&&null!=g[Symbol.iterator]||null!=g["@@iterator"])return Array.from(g)}function i(g){return function(g){if(Array.isArray(g))return l(g)}(g)||c(g)||o(g)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(g,e){if(!(g instanceof e))throw new TypeError("Cannot call a class as a function")}function s(g){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},s(g)}function d(g){var e=function(g,e){if("object"!==s(g)||null===g)return g;var I=g[Symbol.toPrimitive];if(void 0!==I){var t=I.call(g,e||"default");if("object"!==s(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(g)}(g,"string");return"symbol"===s(e)?e:String(e)}function u(g,e){for(var I=0;I<e.length;I++){var t=e[I];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,d(t.key),t)}}function m(g,e,I){return e&&u(g.prototype,e),I&&u(g,I),Object.defineProperty(g,"prototype",{writable:!1}),g}function b(g,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,e){return g.__proto__=e,g},b(g,e)}function Z(g,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(e&&e.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),Object.defineProperty(g,"prototype",{writable:!1}),e&&b(g,e)}function h(g){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(g){return g.__proto__||Object.getPrototypeOf(g)},h(g)}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Og){return!1}}function G(g){if(void 0===g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function y(g){var e=p();return function(){var I,t=h(g);if(e){var n=h(this).constructor;I=Reflect.construct(t,arguments,n)}else I=t.apply(this,arguments);return function(g,e){if(e&&("object"===s(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return G(g)}(this,I)}}function B(g,e,I){return B=p()?Reflect.construct.bind():function(g,e,I){var t=[null];t.push.apply(t,e);var n=new(Function.bind.apply(g,t));return I&&b(n,I.prototype),n},B.apply(null,arguments)}function f(g){var e="function"===typeof Map?new Map:void 0;return f=function(g){if(null===g||(I=g,-1===Function.toString.call(I).indexOf("[native code]")))return g;var I;if("function"!==typeof g)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(g))return e.get(g);e.set(g,t)}function t(){return B(g,arguments,h(this).constructor)}return t.prototype=Object.create(g.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),b(t,g)},f(g)}function S(g){return C(g)||c(g)||o(g)||a()}function W(){return W=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},W.apply(this,arguments)}!function(g){g.Pop="POP",g.Push="PUSH",g.Replace="REPLACE"}(g||(g={}));var V,v="popstate";function R(g,e){if(!1===g||null===g||"undefined"===typeof g)throw new Error(e)}function k(g,e){if(!g){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(Og){}}}function X(g,e){return{usr:g.state,key:g.key,idx:e}}function J(g,e,I,t){return void 0===I&&(I=null),W({pathname:"string"===typeof g?g:g.pathname,search:"",hash:""},"string"===typeof e?H(e):e,{state:I,key:e&&e.key||t||Math.random().toString(36).substr(2,8)})}function Y(g){var e=g.pathname,I=void 0===e?"/":e,t=g.search,n=void 0===t?"":t,C=g.hash,l=void 0===C?"":C;return n&&"?"!==n&&(I+="?"===n.charAt(0)?n:"?"+n),l&&"#"!==l&&(I+="#"===l.charAt(0)?l:"#"+l),I}function H(g){var e={};if(g){var I=g.indexOf("#");I>=0&&(e.hash=g.substr(I),g=g.substr(0,I));var t=g.indexOf("?");t>=0&&(e.search=g.substr(t),g=g.substr(0,t)),g&&(e.pathname=g)}return e}function w(e,I,t,n){void 0===n&&(n={});var C=n,l=C.window,o=void 0===l?document.defaultView:l,a=C.v5Compat,r=void 0!==a&&a,c=o.history,i=g.Pop,A=null,s=d();function d(){return(c.state||{idx:null}).idx}function u(){i=g.Pop;var e=d(),I=null==e?null:e-s;s=e,A&&A({action:i,location:b.location,delta:I})}function m(g){var e="null"!==o.location.origin?o.location.origin:o.location.href,I="string"===typeof g?g:Y(g);return R(e,"No window.location.(origin|href) available to create URL for href: "+I),new URL(I,e)}null==s&&(s=0,c.replaceState(W({},c.state,{idx:s}),""));var b={get action(){return i},get location(){return e(o,c)},listen:function(g){if(A)throw new Error("A history only accepts one active listener");return o.addEventListener(v,u),A=g,function(){o.removeEventListener(v,u),A=null}},createHref:function(g){return I(o,g)},createURL:m,encodeLocation:function(g){var e=m(g);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(e,I){i=g.Push;var n=J(b.location,e,I);t&&t(n,e);var C=X(n,s=d()+1),l=b.createHref(n);try{c.pushState(C,"",l)}catch(a){if(a instanceof DOMException&&"DataCloneError"===a.name)throw a;o.location.assign(l)}r&&A&&A({action:i,location:b.location,delta:1})},replace:function(e,I){i=g.Replace;var n=J(b.location,e,I);t&&t(n,e);var C=X(n,s=d()),l=b.createHref(n);c.replaceState(C,"",l),r&&A&&A({action:i,location:b.location,delta:0})},go:function(g){return c.go(g)}};return b}!function(g){g.data="data",g.deferred="deferred",g.redirect="redirect",g.error="error"}(V||(V={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function N(g,e,I){void 0===I&&(I="/");var t=P(("string"===typeof e?H(e):e).pathname||"/",I);if(null==t)return null;var n=K(g);!function(g){g.sort((function(g,e){return g.score!==e.score?e.score-g.score:function(g,e){var I=g.length===e.length&&g.slice(0,-1).every((function(g,I){return g===e[I]}));return I?g[g.length-1]-e[e.length-1]:0}(g.routesMeta.map((function(g){return g.childrenIndex})),e.routesMeta.map((function(g){return g.childrenIndex})))}))}(n);for(var C=null,l=0;null==C&&l<n.length;++l)C=T(n[l],O(t));return C}function K(g,e,I,t){void 0===e&&(e=[]),void 0===I&&(I=[]),void 0===t&&(t="");var n=function(g,n,C){var l={relativePath:void 0===C?g.path||"":C,caseSensitive:!0===g.caseSensitive,childrenIndex:n,route:g};l.relativePath.startsWith("/")&&(R(l.relativePath.startsWith(t),'Absolute route path "'+l.relativePath+'" nested under path "'+t+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),l.relativePath=l.relativePath.slice(t.length));var o=gg([t,l.relativePath]),a=I.concat(l);g.children&&g.children.length>0&&(R(!0!==g.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),K(g.children,e,a,o)),(null!=g.path||g.index)&&e.push({path:o,score:L(o,g.index),routesMeta:a})};return g.forEach((function(g,e){var I;if(""!==g.path&&null!=(I=g.path)&&I.includes("?")){var t,C=function(g,e){var I="undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(!I){if(Array.isArray(g)||(I=o(g))||e&&g&&"number"===typeof g.length){I&&(g=I);var t=0,n=function(){};return{s:n,n:function(){return t>=g.length?{done:!0}:{done:!1,value:g[t++]}},e:function(g){throw g},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var C,l=!0,a=!1;return{s:function(){I=I.call(g)},n:function(){var g=I.next();return l=g.done,g},e:function(g){a=!0,C=g},f:function(){try{l||null==I.return||I.return()}finally{if(a)throw C}}}}(F(g.path));try{for(C.s();!(t=C.n()).done;){var l=t.value;n(g,e,l)}}catch(a){C.e(a)}finally{C.f()}}else n(g,e)})),e}function F(g){var e=g.split("/");if(0===e.length)return[];var I=S(e),t=I[0],n=I.slice(1),C=t.endsWith("?"),l=t.replace(/\?$/,"");if(0===n.length)return C?[l,""]:[l];var o=F(n.join("/")),a=[];return a.push.apply(a,i(o.map((function(g){return""===g?l:[l,g].join("/")})))),C&&a.push.apply(a,i(o)),a.map((function(e){return g.startsWith("/")&&""===e?"/":e}))}var x=/^:\w+$/,E=3,z=2,M=1,U=10,D=-2,Q=function(g){return"*"===g};function L(g,e){var I=g.split("/"),t=I.length;return I.some(Q)&&(t+=D),e&&(t+=z),I.filter((function(g){return!Q(g)})).reduce((function(g,e){return g+(x.test(e)?E:""===e?M:U)}),t)}function T(g,e){for(var I=g.routesMeta,t={},n="/",C=[],l=0;l<I.length;++l){var o=I[l],a=l===I.length-1,r="/"===n?e:e.slice(n.length)||"/",c=j({path:o.relativePath,caseSensitive:o.caseSensitive,end:a},r);if(!c)return null;Object.assign(t,c.params);var i=o.route;C.push({params:t,pathname:gg([n,c.pathname]),pathnameBase:eg(gg([n,c.pathnameBase])),route:i}),"/"!==c.pathnameBase&&(n=gg([n,c.pathnameBase]))}return C}function j(g,e){"string"===typeof g&&(g={path:g,caseSensitive:!1,end:!0});var I=function(g,e,I){void 0===e&&(e=!1);void 0===I&&(I=!0);k("*"===g||!g.endsWith("*")||g.endsWith("/*"),'Route path "'+g+'" will be treated as if it were "'+g.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+g.replace(/\*$/,"/*")+'".');var t=[],n="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(g,e){return t.push(e),"/([^\\/]+)"}));g.endsWith("*")?(t.push("*"),n+="*"===g||"/*"===g?"(.*)$":"(?:\\/(.+)|\\/*)$"):I?n+="\\/*$":""!==g&&"/"!==g&&(n+="(?:(?=\\/|$))");var C=new RegExp(n,e?void 0:"i");return[C,t]}(g.path,g.caseSensitive,g.end),t=r(I,2),n=t[0],C=t[1],l=e.match(n);if(!l)return null;var o=l[0],a=o.replace(/(.)\/+$/,"$1"),c=l.slice(1);return{params:C.reduce((function(g,e,I){if("*"===e){var t=c[I]||"";a=o.slice(0,o.length-t.length).replace(/(.)\/+$/,"$1")}return g[e]=function(g,e){try{return decodeURIComponent(g)}catch(I){return k(!1,'The value for the URL param "'+e+'" will not be decoded because the string "'+g+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+I+")."),g}}(c[I]||"",e),g}),{}),pathname:o,pathnameBase:a,pattern:g}}function O(g){try{return decodeURI(g)}catch(e){return k(!1,'The URL path "'+g+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),g}}function P(g,e){if("/"===e)return g;if(!g.toLowerCase().startsWith(e.toLowerCase()))return null;var I=e.endsWith("/")?e.length-1:e.length,t=g.charAt(I);return t&&"/"!==t?null:g.slice(I)||"/"}function q(g,e,I,t){return"Cannot include a '"+g+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(t)+"].  Please separate it out to the `to."+I+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function _(g){return g.filter((function(g,e){return 0===e||g.route.path&&g.route.path.length>0}))}function $(g,e,I,t){var n;void 0===t&&(t=!1),"string"===typeof g?n=H(g):(R(!(n=W({},g)).pathname||!n.pathname.includes("?"),q("?","pathname","search",n)),R(!n.pathname||!n.pathname.includes("#"),q("#","pathname","hash",n)),R(!n.search||!n.search.includes("#"),q("#","search","hash",n)));var C,l=""===g||""===n.pathname,o=l?"/":n.pathname;if(t||null==o)C=I;else{var a=e.length-1;if(o.startsWith("..")){for(var r=o.split("/");".."===r[0];)r.shift(),a-=1;n.pathname=r.join("/")}C=a>=0?e[a]:"/"}var c=function(g,e){void 0===e&&(e="/");var I="string"===typeof g?H(g):g,t=I.pathname,n=I.search,C=void 0===n?"":n,l=I.hash,o=void 0===l?"":l,a=t?t.startsWith("/")?t:function(g,e){var I=e.replace(/\/+$/,"").split("/");return g.split("/").forEach((function(g){".."===g?I.length>1&&I.pop():"."!==g&&I.push(g)})),I.length>1?I.join("/"):"/"}(t,e):e;return{pathname:a,search:Ig(C),hash:tg(o)}}(n,C),i=o&&"/"!==o&&o.endsWith("/"),A=(l||"."===o)&&I.endsWith("/");return c.pathname.endsWith("/")||!i&&!A||(c.pathname+="/"),c}var gg=function(g){return g.join("/").replace(/\/\/+/g,"/")},eg=function(g){return g.replace(/\/+$/,"").replace(/^\/*/,"/")},Ig=function(g){return g&&"?"!==g?g.startsWith("?")?g:"?"+g:""},tg=function(g){return g&&"#"!==g?g.startsWith("#")?g:"#"+g:""},ng=function(g){Z(I,g);var e=y(I);function I(){return A(this,I),e.apply(this,arguments)}return m(I)}(f(Error));function Cg(g){return null!=g&&"number"===typeof g.status&&"string"===typeof g.statusText&&"boolean"===typeof g.internal&&"data"in g}var lg=["post","put","patch","delete"],og=(new Set(lg),["get"].concat(lg));new Set(og),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function ag(){return ag=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},ag.apply(this,arguments)}var rg=e.createContext(null);var cg=e.createContext(null);var ig=e.createContext(null);var Ag=e.createContext(null);var sg=e.createContext(null);var dg=e.createContext({outlet:null,matches:[],isDataRoute:!1});var ug=e.createContext(null);function mg(){return null!=e.useContext(sg)}function bg(){return mg()||R(!1),e.useContext(sg).location}function Zg(g){e.useContext(Ag).static||e.useLayoutEffect(g)}function hg(){return e.useContext(dg).isDataRoute?function(){var g=Rg(Bg.UseNavigateStable).router,I=Xg(fg.UseNavigateStable),t=e.useRef(!1);Zg((function(){t.current=!0}));var n=e.useCallback((function(e,n){void 0===n&&(n={}),t.current&&("number"===typeof e?g.navigate(e):g.navigate(e,ag({fromRouteId:I},n)))}),[g,I]);return n}():function(){mg()||R(!1);var g=e.useContext(rg),I=e.useContext(Ag),t=I.basename,n=I.navigator,C=e.useContext(dg).matches,l=bg().pathname,o=JSON.stringify(_(C).map((function(g){return g.pathnameBase}))),a=e.useRef(!1);Zg((function(){a.current=!0}));var r=e.useCallback((function(e,I){if(void 0===I&&(I={}),a.current)if("number"!==typeof e){var C=$(e,JSON.parse(o),l,"path"===I.relative);null==g&&"/"!==t&&(C.pathname="/"===C.pathname?t:gg([t,C.pathname])),(I.replace?n.replace:n.push)(C,I.state,I)}else n.go(e)}),[t,n,o,l,g]);return r}()}function pg(g,I){var t=(void 0===I?{}:I).relative,n=e.useContext(dg).matches,C=bg().pathname,l=JSON.stringify(_(n).map((function(g){return g.pathnameBase})));return e.useMemo((function(){return $(g,JSON.parse(l),C,"path"===t)}),[g,l,C,t])}function Gg(I,t,n){mg()||R(!1);var C,l=e.useContext(Ag).navigator,o=e.useContext(dg).matches,a=o[o.length-1],r=a?a.params:{},c=(a&&a.pathname,a?a.pathnameBase:"/"),i=(a&&a.route,bg());if(t){var A,s="string"===typeof t?H(t):t;"/"===c||(null==(A=s.pathname)?void 0:A.startsWith(c))||R(!1),C=s}else C=i;var d=C.pathname||"/",u=N(I,{pathname:"/"===c?d:d.slice(c.length)||"/"});var m=vg(u&&u.map((function(g){return Object.assign({},g,{params:Object.assign({},r,g.params),pathname:gg([c,l.encodeLocation?l.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:"/"===g.pathnameBase?c:gg([c,l.encodeLocation?l.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})})),o,n);return t&&m?e.createElement(sg.Provider,{value:{location:ag({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:g.Pop}},m):m}function yg(){var g=function(){var g,I=e.useContext(ug),t=kg(fg.UseRouteError),n=Xg(fg.UseRouteError);if(I)return I;return null==(g=t.errors)?void 0:g[n]}(),I=Cg(g)?g.status+" "+g.statusText:g instanceof Error?g.message:JSON.stringify(g),t=g instanceof Error?g.stack:null,n="rgba(200,200,200, 0.5)",C={padding:"0.5rem",backgroundColor:n};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},I),t?e.createElement("pre",{style:C},t):null,null)}var Bg,fg,Sg=e.createElement(yg,null),Wg=function(g){Z(t,g);var I=y(t);function t(g){var e;return A(this,t),(e=I.call(this,g)).state={location:g.location,revalidation:g.revalidation,error:g.error},e}return m(t,[{key:"componentDidCatch",value:function(g,e){console.error("React Router caught the following error during render",g,e)}},{key:"render",value:function(){return this.state.error?e.createElement(dg.Provider,{value:this.props.routeContext},e.createElement(ug.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(g){return{error:g}}},{key:"getDerivedStateFromProps",value:function(g,e){return e.location!==g.location||"idle"!==e.revalidation&&"idle"===g.revalidation?{error:g.error,location:g.location,revalidation:g.revalidation}:{error:g.error||e.error,location:e.location,revalidation:g.revalidation||e.revalidation}}}]),t}(e.Component);function Vg(g){var I=g.routeContext,t=g.match,n=g.children,C=e.useContext(rg);return C&&C.static&&C.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(C.staticContext._deepestRenderedBoundaryId=t.route.id),e.createElement(dg.Provider,{value:I},n)}function vg(g,I,t){var n;if(void 0===I&&(I=[]),void 0===t&&(t=null),null==g){var C;if(null==(C=t)||!C.errors)return null;g=t.matches}var l=g,o=null==(n=t)?void 0:n.errors;if(null!=o){var a=l.findIndex((function(g){return g.route.id&&(null==o?void 0:o[g.route.id])}));a>=0||R(!1),l=l.slice(0,Math.min(l.length,a+1))}return l.reduceRight((function(g,n,C){var a=n.route.id?null==o?void 0:o[n.route.id]:null,r=null;t&&(r=n.route.errorElement||Sg);var c=I.concat(l.slice(0,C+1)),i=function(){var I;return I=a?r:n.route.Component?e.createElement(n.route.Component,null):n.route.element?n.route.element:g,e.createElement(Vg,{match:n,routeContext:{outlet:g,matches:c,isDataRoute:null!=t},children:I})};return t&&(n.route.ErrorBoundary||n.route.errorElement||0===C)?e.createElement(Wg,{location:t.location,revalidation:t.revalidation,component:r,error:a,children:i(),routeContext:{outlet:null,matches:c,isDataRoute:!0}}):i()}),null)}function Rg(g){var I=e.useContext(rg);return I||R(!1),I}function kg(g){var I=e.useContext(cg);return I||R(!1),I}function Xg(g){var I=function(g){var I=e.useContext(dg);return I||R(!1),I}(),t=I.matches[I.matches.length-1];return t.route.id||R(!1),t.route.id}!function(g){g.UseBlocker="useBlocker",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate"}(Bg||(Bg={})),function(g){g.UseBlocker="useBlocker",g.UseLoaderData="useLoaderData",g.UseActionData="useActionData",g.UseRouteError="useRouteError",g.UseNavigation="useNavigation",g.UseRouteLoaderData="useRouteLoaderData",g.UseMatches="useMatches",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g.UseRouteId="useRouteId"}(fg||(fg={}));var Jg;t.startTransition;function Yg(g){var I=g.to,t=g.replace,n=g.state,C=g.relative;mg()||R(!1);var l=e.useContext(dg).matches,o=bg().pathname,a=hg(),r=$(I,_(l).map((function(g){return g.pathnameBase})),o,"path"===C),c=JSON.stringify(r);return e.useEffect((function(){return a(JSON.parse(c),{replace:t,state:n,relative:C})}),[a,c,C,t,n]),null}function Hg(g){R(!1)}function wg(I){var t=I.basename,n=void 0===t?"/":t,C=I.children,l=void 0===C?null:C,o=I.location,a=I.navigationType,r=void 0===a?g.Pop:a,c=I.navigator,i=I.static,A=void 0!==i&&i;mg()&&R(!1);var s=n.replace(/^\/*/,"/"),d=e.useMemo((function(){return{basename:s,navigator:c,static:A}}),[s,c,A]);"string"===typeof o&&(o=H(o));var u=o,m=u.pathname,b=void 0===m?"/":m,Z=u.search,h=void 0===Z?"":Z,p=u.hash,G=void 0===p?"":p,y=u.state,B=void 0===y?null:y,f=u.key,S=void 0===f?"default":f,W=e.useMemo((function(){var g=P(b,s);return null==g?null:{location:{pathname:g,search:h,hash:G,state:B,key:S},navigationType:r}}),[s,b,h,G,B,S,r]);return null==W?null:e.createElement(Ag.Provider,{value:d},e.createElement(sg.Provider,{children:l,value:W}))}function Ng(g){var e=g.children,I=g.location;return Gg(Fg(e),I)}!function(g){g[g.pending=0]="pending",g[g.success=1]="success",g[g.error=2]="error"}(Jg||(Jg={}));var Kg=new Promise((function(){}));e.Component;function Fg(g,I){void 0===I&&(I=[]);var t=[];return e.Children.forEach(g,(function(g,n){if(e.isValidElement(g)){var C=[].concat(i(I),[n]);if(g.type!==e.Fragment){g.type!==Hg&&R(!1),g.props.index&&g.props.children&&R(!1);var l={id:g.props.id||C.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:null!=g.props.ErrorBoundary||null!=g.props.errorElement,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(l.children=Fg(g.props.children,C)),t.push(l)}else t.push.apply(t,Fg(g.props.children,C))}})),t}function xg(){return xg=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},xg.apply(this,arguments)}function Eg(g,e){if(null==g)return{};var I,t,n={},C=Object.keys(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||(n[I]=g[I]);return n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);var zg=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];var Mg=t.startTransition;function Ug(g){var I=g.basename,t=g.children,n=g.future,C=g.window,l=e.useRef();null==l.current&&(l.current=function(g){return void 0===g&&(g={}),w((function(g,e){var I=H(g.location.hash.substr(1)),t=I.pathname,n=void 0===t?"/":t,C=I.search,l=void 0===C?"":C,o=I.hash;return J("",{pathname:n,search:l,hash:void 0===o?"":o},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(g,e){var I=g.document.querySelector("base"),t="";if(I&&I.getAttribute("href")){var n=g.location.href,C=n.indexOf("#");t=-1===C?n:n.slice(0,C)}return t+"#"+("string"===typeof e?e:Y(e))}),(function(g,e){k("/"===g.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(e)+")")}),g)}({window:C,v5Compat:!0}));var o=l.current,a=r(e.useState({action:o.action,location:o.location}),2),c=a[0],i=a[1],A=(n||{}).v7_startTransition,s=e.useCallback((function(g){A&&Mg?Mg((function(){return i(g)})):i(g)}),[i,A]);return e.useLayoutEffect((function(){return o.listen(s)}),[o,s]),e.createElement(wg,{basename:I,children:t,location:c.location,navigationType:c.action,navigator:o})}var Dg="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Qg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Lg=e.forwardRef((function(g,I){var t,n=g.onClick,C=g.relative,l=g.reloadDocument,o=g.replace,a=g.state,r=g.target,c=g.to,i=g.preventScrollReset,A=Eg(g,zg),s=e.useContext(Ag).basename,d=!1;if("string"===typeof c&&Qg.test(c)&&(t=c,Dg))try{var u=new URL(window.location.href),m=c.startsWith("//")?new URL(u.protocol+c):new URL(c),b=P(m.pathname,s);m.origin===u.origin&&null!=b?c=b+m.search+m.hash:d=!0}catch(Og){}var Z=function(g,I){var t=(void 0===I?{}:I).relative;mg()||R(!1);var n=e.useContext(Ag),C=n.basename,l=n.navigator,o=pg(g,{relative:t}),a=o.hash,r=o.pathname,c=o.search,i=r;return"/"!==C&&(i="/"===r?C:gg([C,r])),l.createHref({pathname:i,search:c,hash:a})}(c,{relative:C}),h=function(g,I){var t=void 0===I?{}:I,n=t.target,C=t.replace,l=t.state,o=t.preventScrollReset,a=t.relative,r=hg(),c=bg(),i=pg(g,{relative:a});return e.useCallback((function(e){if(function(g,e){return 0===g.button&&(!e||"_self"===e)&&!function(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}(g)}(e,n)){e.preventDefault();var I=void 0!==C?C:Y(c)===Y(i);r(g,{replace:I,state:l,preventScrollReset:o,relative:a})}}),[c,r,i,C,l,n,g,o,a])}(c,{replace:o,state:a,target:r,preventScrollReset:i,relative:C});return e.createElement("a",xg({},A,{href:t||Z,onClick:d||l?n:function(g){n&&n(g),g.defaultPrevented||h(g)},ref:I,target:r}))}));var Tg,jg;(function(g){g.UseScrollRestoration="useScrollRestoration",g.UseSubmit="useSubmit",g.UseSubmitFetcher="useSubmitFetcher",g.UseFetcher="useFetcher"})(Tg||(Tg={})),function(g){g.UseFetchers="useFetchers",g.UseScrollRestoration="useScrollRestoration"}(jg||(jg={}));function Og(g){this.message=g}Og.prototype=new Error,Og.prototype.name="InvalidCharacterError";var Pg="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(g){var e=String(g).replace(/=+$/,"");if(e.length%4==1)throw new Og("'atob' failed: The string to be decoded is not correctly encoded.");for(var I,t,n=0,C=0,l="";t=e.charAt(C++);~t&&(I=n%4?64*I+t:t,n++%4)?l+=String.fromCharCode(255&I>>(-2*n&6)):0)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t);return l};function qg(g){var e=g.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(g){return decodeURIComponent(Pg(g).replace(/(.)/g,(function(g,e){var I=e.charCodeAt(0).toString(16).toUpperCase();return I.length<2&&(I="0"+I),"%"+I})))}(e)}catch(g){return Pg(e)}}function _g(g){this.message=g}_g.prototype=new Error,_g.prototype.name="InvalidTokenError";var $g=function(g,e){if("string"!=typeof g)throw new _g("Invalid token specified");var I=!0===(e=e||{}).header?0:1;try{return JSON.parse(qg(g.split(".")[I]))}catch(g){throw new _g("Invalid token specified: "+g.message)}};function ge(){var g=localStorage.getItem("token");if(!g)return console.error("No token in local storage"),null;try{var e=$g(g);return console.log(e),e.role}catch(I){return console.error("Error decoding token",I),null}}function ee(){var g=localStorage.getItem("token");return g||(console.error("No token in local storage"),null)}function Ie(){var g=localStorage.getItem("token");return g?{headers:{Authorization:"Bearer ".concat(g)}}:(console.error("No token in local storage"),null)}function te(){var g=localStorage.getItem("token");if(!g)return console.error("No token in local storage"),null;try{return $g(g)._id}catch(e){return console.error("Error decoding token",e),null}}function ne(){var g=localStorage.getItem("token");if(!g)return console.error("No token in local storage"),null;try{return $g(g).name}catch(e){return console.error("Error decoding token",e),null}}function Ce(){var g=localStorage.getItem("token");if(!g)return console.error("No token in local storage"),null;try{var e=$g(g);return console.log(e),e.phone}catch(I){return console.error("Error decoding token",I),null}}function le(){var g=localStorage.getItem("token");if(!g)return console.error("No token in local storage"),null;try{var e=$g(g);return console.log(e),e.campus}catch(I){return console.error("Error decoding token",I),null}}function oe(){var g=localStorage.getItem("token");if(!g)return console.error("No token in local storage"),null;try{return $g(g).email}catch(e){return console.error("Error decoding token",e),null}}function ae(g,e,I){return(e=d(e))in g?Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}):g[e]=I,g}function re(g,e){var I=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(g,e).enumerable}))),I.push.apply(I,t)}return I}function ce(g){for(var e=1;e<arguments.length;e++){var I=null!=arguments[e]?arguments[e]:{};e%2?re(Object(I),!0).forEach((function(e){ae(g,e,I[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(I)):re(Object(I)).forEach((function(e){Object.defineProperty(g,e,Object.getOwnPropertyDescriptor(I,e))}))}return g}function ie(){ie=function(){return e};var g,e={},I=Object.prototype,t=I.hasOwnProperty,n=Object.defineProperty||function(g,e,I){g[e]=I.value},C="function"==typeof Symbol?Symbol:{},l=C.iterator||"@@iterator",o=C.asyncIterator||"@@asyncIterator",a=C.toStringTag||"@@toStringTag";function r(g,e,I){return Object.defineProperty(g,e,{value:I,enumerable:!0,configurable:!0,writable:!0}),g[e]}try{r({},"")}catch(g){r=function(g,e,I){return g[e]=I}}function c(g,e,I,t){var C=e&&e.prototype instanceof Z?e:Z,l=Object.create(C.prototype),o=new X(t||[]);return n(l,"_invoke",{value:V(g,I,o)}),l}function i(g,e,I){try{return{type:"normal",arg:g.call(e,I)}}catch(g){return{type:"throw",arg:g}}}e.wrap=c;var A="suspendedStart",d="suspendedYield",u="executing",m="completed",b={};function Z(){}function h(){}function p(){}var G={};r(G,l,(function(){return this}));var y=Object.getPrototypeOf,B=y&&y(y(J([])));B&&B!==I&&t.call(B,l)&&(G=B);var f=p.prototype=Z.prototype=Object.create(G);function S(g){["next","throw","return"].forEach((function(e){r(g,e,(function(g){return this._invoke(e,g)}))}))}function W(g,e){function I(n,C,l,o){var a=i(g[n],g,C);if("throw"!==a.type){var r=a.arg,c=r.value;return c&&"object"==s(c)&&t.call(c,"__await")?e.resolve(c.__await).then((function(g){I("next",g,l,o)}),(function(g){I("throw",g,l,o)})):e.resolve(c).then((function(g){r.value=g,l(r)}),(function(g){return I("throw",g,l,o)}))}o(a.arg)}var C;n(this,"_invoke",{value:function(g,t){function n(){return new e((function(e,n){I(g,t,e,n)}))}return C=C?C.then(n,n):n()}})}function V(e,I,t){var n=A;return function(C,l){if(n===u)throw new Error("Generator is already running");if(n===m){if("throw"===C)throw l;return{value:g,done:!0}}for(t.method=C,t.arg=l;;){var o=t.delegate;if(o){var a=v(o,t);if(a){if(a===b)continue;return a}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(n===A)throw n=m,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n=u;var r=i(e,I,t);if("normal"===r.type){if(n=t.done?m:d,r.arg===b)continue;return{value:r.arg,done:t.done}}"throw"===r.type&&(n=m,t.method="throw",t.arg=r.arg)}}}function v(e,I){var t=I.method,n=e.iterator[t];if(n===g)return I.delegate=null,"throw"===t&&e.iterator.return&&(I.method="return",I.arg=g,v(e,I),"throw"===I.method)||"return"!==t&&(I.method="throw",I.arg=new TypeError("The iterator does not provide a '"+t+"' method")),b;var C=i(n,e.iterator,I.arg);if("throw"===C.type)return I.method="throw",I.arg=C.arg,I.delegate=null,b;var l=C.arg;return l?l.done?(I[e.resultName]=l.value,I.next=e.nextLoc,"return"!==I.method&&(I.method="next",I.arg=g),I.delegate=null,b):l:(I.method="throw",I.arg=new TypeError("iterator result is not an object"),I.delegate=null,b)}function R(g){var e={tryLoc:g[0]};1 in g&&(e.catchLoc=g[1]),2 in g&&(e.finallyLoc=g[2],e.afterLoc=g[3]),this.tryEntries.push(e)}function k(g){var e=g.completion||{};e.type="normal",delete e.arg,g.completion=e}function X(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(R,this),this.reset(!0)}function J(e){if(e||""===e){var I=e[l];if(I)return I.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,C=function I(){for(;++n<e.length;)if(t.call(e,n))return I.value=e[n],I.done=!1,I;return I.value=g,I.done=!0,I};return C.next=C}}throw new TypeError(s(e)+" is not iterable")}return h.prototype=p,n(f,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:h,configurable:!0}),h.displayName=r(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(g){var e="function"==typeof g&&g.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,p):(g.__proto__=p,r(g,a,"GeneratorFunction")),g.prototype=Object.create(f),g},e.awrap=function(g){return{__await:g}},S(W.prototype),r(W.prototype,o,(function(){return this})),e.AsyncIterator=W,e.async=function(g,I,t,n,C){void 0===C&&(C=Promise);var l=new W(c(g,I,t,n),C);return e.isGeneratorFunction(I)?l:l.next().then((function(g){return g.done?g.value:l.next()}))},S(f),r(f,a,"Generator"),r(f,l,(function(){return this})),r(f,"toString",(function(){return"[object Generator]"})),e.keys=function(g){var e=Object(g),I=[];for(var t in e)I.push(t);return I.reverse(),function g(){for(;I.length;){var t=I.pop();if(t in e)return g.value=t,g.done=!1,g}return g.done=!0,g}},e.values=J,X.prototype={constructor:X,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(k),!e)for(var I in this)"t"===I.charAt(0)&&t.call(this,I)&&!isNaN(+I.slice(1))&&(this[I]=g)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var I=this;function n(t,n){return o.type="throw",o.arg=e,I.next=t,n&&(I.method="next",I.arg=g),!!n}for(var C=this.tryEntries.length-1;C>=0;--C){var l=this.tryEntries[C],o=l.completion;if("root"===l.tryLoc)return n("end");if(l.tryLoc<=this.prev){var a=t.call(l,"catchLoc"),r=t.call(l,"finallyLoc");if(a&&r){if(this.prev<l.catchLoc)return n(l.catchLoc,!0);if(this.prev<l.finallyLoc)return n(l.finallyLoc)}else if(a){if(this.prev<l.catchLoc)return n(l.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return n(l.finallyLoc)}}}},abrupt:function(g,e){for(var I=this.tryEntries.length-1;I>=0;--I){var n=this.tryEntries[I];if(n.tryLoc<=this.prev&&t.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var C=n;break}}C&&("break"===g||"continue"===g)&&C.tryLoc<=e&&e<=C.finallyLoc&&(C=null);var l=C?C.completion:{};return l.type=g,l.arg=e,C?(this.method="next",this.next=C.finallyLoc,b):this.complete(l)},complete:function(g,e){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&e&&(this.next=e),b},finish:function(g){for(var e=this.tryEntries.length-1;e>=0;--e){var I=this.tryEntries[e];if(I.finallyLoc===g)return this.complete(I.completion,I.afterLoc),k(I),b}},catch:function(g){for(var e=this.tryEntries.length-1;e>=0;--e){var I=this.tryEntries[e];if(I.tryLoc===g){var t=I.completion;if("throw"===t.type){var n=t.arg;k(I)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,I,t){return this.delegate={iterator:J(e),resultName:I,nextLoc:t},"next"===this.method&&(this.arg=g),b}},e}function Ae(g,e,I,t,n,C,l){try{var o=g[C](l),a=o.value}catch(r){return void I(r)}o.done?e(a):Promise.resolve(a).then(t,n)}function se(g){return function(){var e=this,I=arguments;return new Promise((function(t,n){var C=g.apply(e,I);function l(g){Ae(C,t,n,l,o,"next",g)}function o(g){Ae(C,t,n,l,o,"throw",g)}l(void 0)}))}}var de=I(948),ue=I.n(de),me={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},be=e.createContext&&e.createContext(me),Ze=function(){return Ze=Object.assign||function(g){for(var e,I=1,t=arguments.length;I<t;I++)for(var n in e=arguments[I])Object.prototype.hasOwnProperty.call(e,n)&&(g[n]=e[n]);return g},Ze.apply(this,arguments)},he=function(g,e){var I={};for(var t in g)Object.prototype.hasOwnProperty.call(g,t)&&e.indexOf(t)<0&&(I[t]=g[t]);if(null!=g&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(t=Object.getOwnPropertySymbols(g);n<t.length;n++)e.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(g,t[n])&&(I[t[n]]=g[t[n]])}return I};function pe(g){return g&&g.map((function(g,I){return e.createElement(g.tag,Ze({key:I},g.attr),pe(g.child))}))}function Ge(g){return function(I){return e.createElement(ye,Ze({attr:Ze({},g.attr)},I),pe(g.child))}}function ye(g){var I=function(I){var t,n=g.attr,C=g.size,l=g.title,o=he(g,["attr","size","title"]),a=C||I.size||"1em";return I.className&&(t=I.className),g.className&&(t=(t?t+" ":"")+g.className),e.createElement("svg",Ze({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},I.attr,n,o,{className:t,style:Ze(Ze({color:g.color||I.color},I.style),g.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),l&&e.createElement("title",null,l),g.children)};return void 0!==be?e.createElement(be.Consumer,null,(function(g){return I(g)})):I(me)}function Be(g){return Ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 002 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}}]})(g)}function fe(g){return Ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}}]})(g)}function Se(g){return Ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"}}]})(g)}function We(g){return Ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"}}]})(g)}function Ve(g){return Ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}},{tag:"path",attr:{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"}}]})(g)}function ve(g){return Ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}}]})(g)}function Re(g){return Ge({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 010-5 2.5 2.5 0 010 5z"}}]})(g)}function ke(g,e){return function(){return g.apply(e,arguments)}}var Xe,Je=Object.prototype.toString,Ye=Object.getPrototypeOf,He=(Xe=Object.create(null),function(g){var e=Je.call(g);return Xe[e]||(Xe[e]=e.slice(8,-1).toLowerCase())}),we=function(g){return g=g.toLowerCase(),function(e){return He(e)===g}},Ne=function(g){return function(e){return typeof e===g}},Ke=Array.isArray,Fe=Ne("undefined");var xe=we("ArrayBuffer");var Ee=Ne("string"),ze=Ne("function"),Me=Ne("number"),Ue=function(g){return null!==g&&"object"===typeof g},De=function(g){if("object"!==He(g))return!1;var e=Ye(g);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in g)&&!(Symbol.iterator in g)},Qe=we("Date"),Le=we("File"),Te=we("Blob"),je=we("FileList"),Oe=we("URLSearchParams");function Pe(g,e){var I,t,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allOwnKeys,C=void 0!==n&&n;if(null!==g&&"undefined"!==typeof g)if("object"!==typeof g&&(g=[g]),Ke(g))for(I=0,t=g.length;I<t;I++)e.call(null,g[I],I,g);else{var l,o=C?Object.getOwnPropertyNames(g):Object.keys(g),a=o.length;for(I=0;I<a;I++)l=o[I],e.call(null,g[l],l,g)}}function qe(g,e){e=e.toLowerCase();for(var I,t=Object.keys(g),n=t.length;n-- >0;)if(e===(I=t[n]).toLowerCase())return I;return null}var _e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,$e=function(g){return!Fe(g)&&g!==_e};var gI,eI=(gI="undefined"!==typeof Uint8Array&&Ye(Uint8Array),function(g){return gI&&g instanceof gI}),II=we("HTMLFormElement"),tI=function(g){var e=Object.prototype.hasOwnProperty;return function(g,I){return e.call(g,I)}}(),nI=we("RegExp"),CI=function(g,e){var I=Object.getOwnPropertyDescriptors(g),t={};Pe(I,(function(I,n){!1!==e(I,n,g)&&(t[n]=I)})),Object.defineProperties(g,t)},lI="abcdefghijklmnopqrstuvwxyz",oI="0123456789",aI={DIGIT:oI,ALPHA:lI,ALPHA_DIGIT:lI+lI.toUpperCase()+oI};var rI=we("AsyncFunction"),cI={isArray:Ke,isArrayBuffer:xe,isBuffer:function(g){return null!==g&&!Fe(g)&&null!==g.constructor&&!Fe(g.constructor)&&ze(g.constructor.isBuffer)&&g.constructor.isBuffer(g)},isFormData:function(g){var e;return g&&("function"===typeof FormData&&g instanceof FormData||ze(g.append)&&("formdata"===(e=He(g))||"object"===e&&ze(g.toString)&&"[object FormData]"===g.toString()))},isArrayBufferView:function(g){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(g):g&&g.buffer&&xe(g.buffer)},isString:Ee,isNumber:Me,isBoolean:function(g){return!0===g||!1===g},isObject:Ue,isPlainObject:De,isUndefined:Fe,isDate:Qe,isFile:Le,isBlob:Te,isRegExp:nI,isFunction:ze,isStream:function(g){return Ue(g)&&ze(g.pipe)},isURLSearchParams:Oe,isTypedArray:eI,isFileList:je,forEach:Pe,merge:function g(){for(var e=($e(this)&&this||{}).caseless,I={},t=function(t,n){var C=e&&qe(I,n)||n;De(I[C])&&De(t)?I[C]=g(I[C],t):De(t)?I[C]=g({},t):Ke(t)?I[C]=t.slice():I[C]=t},n=0,C=arguments.length;n<C;n++)arguments[n]&&Pe(arguments[n],t);return I},extend:function(g,e,I){return Pe(e,(function(e,t){I&&ze(e)?g[t]=ke(e,I):g[t]=e}),{allOwnKeys:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).allOwnKeys}),g},trim:function(g){return g.trim?g.trim():g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(g){return 65279===g.charCodeAt(0)&&(g=g.slice(1)),g},inherits:function(g,e,I,t){g.prototype=Object.create(e.prototype,t),g.prototype.constructor=g,Object.defineProperty(g,"super",{value:e.prototype}),I&&Object.assign(g.prototype,I)},toFlatObject:function(g,e,I,t){var n,C,l,o={};if(e=e||{},null==g)return e;do{for(C=(n=Object.getOwnPropertyNames(g)).length;C-- >0;)l=n[C],t&&!t(l,g,e)||o[l]||(e[l]=g[l],o[l]=!0);g=!1!==I&&Ye(g)}while(g&&(!I||I(g,e))&&g!==Object.prototype);return e},kindOf:He,kindOfTest:we,endsWith:function(g,e,I){g=String(g),(void 0===I||I>g.length)&&(I=g.length),I-=e.length;var t=g.indexOf(e,I);return-1!==t&&t===I},toArray:function(g){if(!g)return null;if(Ke(g))return g;var e=g.length;if(!Me(e))return null;for(var I=new Array(e);e-- >0;)I[e]=g[e];return I},forEachEntry:function(g,e){for(var I,t=(g&&g[Symbol.iterator]).call(g);(I=t.next())&&!I.done;){var n=I.value;e.call(g,n[0],n[1])}},matchAll:function(g,e){for(var I,t=[];null!==(I=g.exec(e));)t.push(I);return t},isHTMLForm:II,hasOwnProperty:tI,hasOwnProp:tI,reduceDescriptors:CI,freezeMethods:function(g){CI(g,(function(e,I){if(ze(g)&&-1!==["arguments","caller","callee"].indexOf(I))return!1;var t=g[I];ze(t)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=function(){throw Error("Can not rewrite read-only method '"+I+"'")}))}))},toObjectSet:function(g,e){var I={},t=function(g){g.forEach((function(g){I[g]=!0}))};return Ke(g)?t(g):t(String(g).split(e)),I},toCamelCase:function(g){return g.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(g,e,I){return e.toUpperCase()+I}))},noop:function(){},toFiniteNumber:function(g,e){return g=+g,Number.isFinite(g)?g:e},findKey:qe,global:_e,isContextDefined:$e,ALPHABET:aI,generateString:function(){for(var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aI.ALPHA_DIGIT,I="",t=e.length;g--;)I+=e[Math.random()*t|0];return I},isSpecCompliantForm:function(g){return!!(g&&ze(g.append)&&"FormData"===g[Symbol.toStringTag]&&g[Symbol.iterator])},toJSONObject:function(g){var e=new Array(10);return function g(I,t){if(Ue(I)){if(e.indexOf(I)>=0)return;if(!("toJSON"in I)){e[t]=I;var n=Ke(I)?[]:{};return Pe(I,(function(e,I){var C=g(e,t+1);!Fe(C)&&(n[I]=C)})),e[t]=void 0,n}}return I}(g,0)},isAsyncFn:rI,isThenable:function(g){return g&&(Ue(g)||ze(g))&&ze(g.then)&&ze(g.catch)}};function iI(g,e,I,t,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=g,this.name="AxiosError",e&&(this.code=e),I&&(this.config=I),t&&(this.request=t),n&&(this.response=n)}cI.inherits(iI,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:cI.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var AI=iI.prototype,sI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((function(g){sI[g]={value:g}})),Object.defineProperties(iI,sI),Object.defineProperty(AI,"isAxiosError",{value:!0}),iI.from=function(g,e,I,t,n,C){var l=Object.create(AI);return cI.toFlatObject(g,l,(function(g){return g!==Error.prototype}),(function(g){return"isAxiosError"!==g})),iI.call(l,g.message,e,I,t,n),l.cause=g,l.name=g.name,C&&Object.assign(l,C),l};var dI=iI;function uI(g){return cI.isPlainObject(g)||cI.isArray(g)}function mI(g){return cI.endsWith(g,"[]")?g.slice(0,-2):g}function bI(g,e,I){return g?g.concat(e).map((function(g,e){return g=mI(g),!I&&e?"["+g+"]":g})).join(I?".":""):e}var ZI=cI.toFlatObject(cI,{},null,(function(g){return/^is[A-Z]/.test(g)}));var hI=function(g,e,I){if(!cI.isObject(g))throw new TypeError("target must be an object");e=e||new FormData;var t=(I=cI.toFlatObject(I,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(g,e){return!cI.isUndefined(e[g])}))).metaTokens,n=I.visitor||r,C=I.dots,l=I.indexes,o=(I.Blob||"undefined"!==typeof Blob&&Blob)&&cI.isSpecCompliantForm(e);if(!cI.isFunction(n))throw new TypeError("visitor must be a function");function a(g){if(null===g)return"";if(cI.isDate(g))return g.toISOString();if(!o&&cI.isBlob(g))throw new dI("Blob is not supported. Use a Buffer instead.");return cI.isArrayBuffer(g)||cI.isTypedArray(g)?o&&"function"===typeof Blob?new Blob([g]):Buffer.from(g):g}function r(g,I,n){var o=g;if(g&&!n&&"object"===typeof g)if(cI.endsWith(I,"{}"))I=t?I:I.slice(0,-2),g=JSON.stringify(g);else if(cI.isArray(g)&&function(g){return cI.isArray(g)&&!g.some(uI)}(g)||(cI.isFileList(g)||cI.endsWith(I,"[]"))&&(o=cI.toArray(g)))return I=mI(I),o.forEach((function(g,t){!cI.isUndefined(g)&&null!==g&&e.append(!0===l?bI([I],t,C):null===l?I:I+"[]",a(g))})),!1;return!!uI(g)||(e.append(bI(n,I,C),a(g)),!1)}var c=[],i=Object.assign(ZI,{defaultVisitor:r,convertValue:a,isVisitable:uI});if(!cI.isObject(g))throw new TypeError("data must be an object");return function g(I,t){if(!cI.isUndefined(I)){if(-1!==c.indexOf(I))throw Error("Circular reference detected in "+t.join("."));c.push(I),cI.forEach(I,(function(I,C){!0===(!(cI.isUndefined(I)||null===I)&&n.call(e,I,cI.isString(C)?C.trim():C,t,i))&&g(I,t?t.concat(C):[C])})),c.pop()}}(g),e};function pI(g){var e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(g).replace(/[!'()~]|%20|%00/g,(function(g){return e[g]}))}function GI(g,e){this._pairs=[],g&&hI(g,this,e)}var yI=GI.prototype;yI.append=function(g,e){this._pairs.push([g,e])},yI.toString=function(g){var e=g?function(e){return g.call(this,e,pI)}:pI;return this._pairs.map((function(g){return e(g[0])+"="+e(g[1])}),"").join("&")};var BI=GI;function fI(g){return encodeURIComponent(g).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function SI(g,e,I){if(!e)return g;var t,n=I&&I.encode||fI,C=I&&I.serialize;if(t=C?C(e,I):cI.isURLSearchParams(e)?e.toString():new BI(e,I).toString(n)){var l=g.indexOf("#");-1!==l&&(g=g.slice(0,l)),g+=(-1===g.indexOf("?")?"?":"&")+t}return g}var WI=function(){function g(){A(this,g),this.handlers=[]}return m(g,[{key:"use",value:function(g,e,I){return this.handlers.push({fulfilled:g,rejected:e,synchronous:!!I&&I.synchronous,runWhen:I?I.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(g){this.handlers[g]&&(this.handlers[g]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(g){cI.forEach(this.handlers,(function(e){null!==e&&g(e)}))}}]),g}(),VI=WI,vI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RI={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:BI,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},isStandardBrowserEnv:function(){var g;return("undefined"===typeof navigator||"ReactNative"!==(g=navigator.product)&&"NativeScript"!==g&&"NS"!==g)&&("undefined"!==typeof window&&"undefined"!==typeof document)}(),isStandardBrowserWebWorkerEnv:"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};var kI=function(g){function e(g,I,t,n){var C=g[n++],l=Number.isFinite(+C),o=n>=g.length;return C=!C&&cI.isArray(t)?t.length:C,o?(cI.hasOwnProp(t,C)?t[C]=[t[C],I]:t[C]=I,!l):(t[C]&&cI.isObject(t[C])||(t[C]=[]),e(g,I,t[C],n)&&cI.isArray(t[C])&&(t[C]=function(g){var e,I,t={},n=Object.keys(g),C=n.length;for(e=0;e<C;e++)t[I=n[e]]=g[I];return t}(t[C])),!l)}if(cI.isFormData(g)&&cI.isFunction(g.entries)){var I={};return cI.forEachEntry(g,(function(g,t){e(function(g){return cI.matchAll(/\w+|\[(\w*)]/g,g).map((function(g){return"[]"===g[0]?"":g[1]||g[0]}))}(g),t,I,0)})),I}return null},XI={"Content-Type":void 0};var JI={transitional:vI,adapter:["xhr","http"],transformRequest:[function(g,e){var I,t=e.getContentType()||"",n=t.indexOf("application/json")>-1,C=cI.isObject(g);if(C&&cI.isHTMLForm(g)&&(g=new FormData(g)),cI.isFormData(g))return n&&n?JSON.stringify(kI(g)):g;if(cI.isArrayBuffer(g)||cI.isBuffer(g)||cI.isStream(g)||cI.isFile(g)||cI.isBlob(g))return g;if(cI.isArrayBufferView(g))return g.buffer;if(cI.isURLSearchParams(g))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),g.toString();if(C){if(t.indexOf("application/x-www-form-urlencoded")>-1)return function(g,e){return hI(g,new RI.classes.URLSearchParams,Object.assign({visitor:function(g,e,I,t){return RI.isNode&&cI.isBuffer(g)?(this.append(e,g.toString("base64")),!1):t.defaultVisitor.apply(this,arguments)}},e))}(g,this.formSerializer).toString();if((I=cI.isFileList(g))||t.indexOf("multipart/form-data")>-1){var l=this.env&&this.env.FormData;return hI(I?{"files[]":g}:g,l&&new l,this.formSerializer)}}return C||n?(e.setContentType("application/json",!1),function(g,e,I){if(cI.isString(g))try{return(e||JSON.parse)(g),cI.trim(g)}catch(Og){if("SyntaxError"!==Og.name)throw Og}return(I||JSON.stringify)(g)}(g)):g}],transformResponse:[function(g){var e=this.transitional||JI.transitional,I=e&&e.forcedJSONParsing,t="json"===this.responseType;if(g&&cI.isString(g)&&(I&&!this.responseType||t)){var n=!(e&&e.silentJSONParsing)&&t;try{return JSON.parse(g)}catch(Og){if(n){if("SyntaxError"===Og.name)throw dI.from(Og,dI.ERR_BAD_RESPONSE,this,null,this.response);throw Og}}}return g}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:RI.classes.FormData,Blob:RI.classes.Blob},validateStatus:function(g){return g>=200&&g<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};cI.forEach(["delete","get","head"],(function(g){JI.headers[g]={}})),cI.forEach(["post","put","patch"],(function(g){JI.headers[g]=cI.merge(XI)}));var YI=JI,HI=cI.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),wI=Symbol("internals");function NI(g){return g&&String(g).trim().toLowerCase()}function KI(g){return!1===g||null==g?g:cI.isArray(g)?g.map(KI):String(g)}function FI(g,e,I,t,n){return cI.isFunction(t)?t.call(this,e,I):(n&&(e=I),cI.isString(e)?cI.isString(t)?-1!==e.indexOf(t):cI.isRegExp(t)?t.test(e):void 0:void 0)}var xI=function(g,e){function I(g){A(this,I),g&&this.set(g)}return m(I,[{key:"set",value:function(g,e,I){var t=this;function n(g,e,I){var n=NI(e);if(!n)throw new Error("header name must be a non-empty string");var C=cI.findKey(t,n);(!C||void 0===t[C]||!0===I||void 0===I&&!1!==t[C])&&(t[C||e]=KI(g))}var C=function(g,e){return cI.forEach(g,(function(g,I){return n(g,I,e)}))};return cI.isPlainObject(g)||g instanceof this.constructor?C(g,e):cI.isString(g)&&(g=g.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(g.trim())?C(function(g){var e,I,t,n={};return g&&g.split("\n").forEach((function(g){t=g.indexOf(":"),e=g.substring(0,t).trim().toLowerCase(),I=g.substring(t+1).trim(),!e||n[e]&&HI[e]||("set-cookie"===e?n[e]?n[e].push(I):n[e]=[I]:n[e]=n[e]?n[e]+", "+I:I)})),n}(g),e):null!=g&&n(e,g,I),this}},{key:"get",value:function(g,e){if(g=NI(g)){var I=cI.findKey(this,g);if(I){var t=this[I];if(!e)return t;if(!0===e)return function(g){for(var e,I=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;e=t.exec(g);)I[e[1]]=e[2];return I}(t);if(cI.isFunction(e))return e.call(this,t,I);if(cI.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(g,e){if(g=NI(g)){var I=cI.findKey(this,g);return!(!I||void 0===this[I]||e&&!FI(0,this[I],I,e))}return!1}},{key:"delete",value:function(g,e){var I=this,t=!1;function n(g){if(g=NI(g)){var n=cI.findKey(I,g);!n||e&&!FI(0,I[n],n,e)||(delete I[n],t=!0)}}return cI.isArray(g)?g.forEach(n):n(g),t}},{key:"clear",value:function(g){for(var e=Object.keys(this),I=e.length,t=!1;I--;){var n=e[I];g&&!FI(0,this[n],n,g,!0)||(delete this[n],t=!0)}return t}},{key:"normalize",value:function(g){var e=this,I={};return cI.forEach(this,(function(t,n){var C=cI.findKey(I,n);if(C)return e[C]=KI(t),void delete e[n];var l=g?function(g){return g.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(function(g,e,I){return e.toUpperCase()+I}))}(n):String(n).trim();l!==n&&delete e[n],e[l]=KI(t),I[l]=!0})),this}},{key:"concat",value:function(){for(var g,e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];return(g=this.constructor).concat.apply(g,[this].concat(I))}},{key:"toJSON",value:function(g){var e=Object.create(null);return cI.forEach(this,(function(I,t){null!=I&&!1!==I&&(e[t]=g&&cI.isArray(I)?I.join(", "):I)})),e}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map((function(g){var e=r(g,2);return e[0]+": "+e[1]})).join("\n")}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],[{key:"from",value:function(g){return g instanceof this?g:new this(g)}},{key:"concat",value:function(g){for(var e=new this(g),I=arguments.length,t=new Array(I>1?I-1:0),n=1;n<I;n++)t[n-1]=arguments[n];return t.forEach((function(g){return e.set(g)})),e}},{key:"accessor",value:function(g){var e=(this[wI]=this[wI]={accessors:{}}).accessors,I=this.prototype;function t(g){var t=NI(g);e[t]||(!function(g,e){var I=cI.toCamelCase(" "+e);["get","set","has"].forEach((function(t){Object.defineProperty(g,t+I,{value:function(g,I,n){return this[t].call(this,e,g,I,n)},configurable:!0})}))}(I,g),e[t]=!0)}return cI.isArray(g)?g.forEach(t):t(g),this}}]),I}();xI.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),cI.freezeMethods(xI.prototype),cI.freezeMethods(xI);var EI=xI;function zI(g,e){var I=this||YI,t=e||I,n=EI.from(t.headers),C=t.data;return cI.forEach(g,(function(g){C=g.call(I,C,n.normalize(),e?e.status:void 0)})),n.normalize(),C}function MI(g){return!(!g||!g.__CANCEL__)}function UI(g,e,I){dI.call(this,null==g?"canceled":g,dI.ERR_CANCELED,e,I),this.name="CanceledError"}cI.inherits(UI,dI,{__CANCEL__:!0});var DI=UI;var QI=RI.isStandardBrowserEnv?{write:function(g,e,I,t,n,C){var l=[];l.push(g+"="+encodeURIComponent(e)),cI.isNumber(I)&&l.push("expires="+new Date(I).toGMTString()),cI.isString(t)&&l.push("path="+t),cI.isString(n)&&l.push("domain="+n),!0===C&&l.push("secure"),document.cookie=l.join("; ")},read:function(g){var e=document.cookie.match(new RegExp("(^|;\\s*)("+g+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(g){this.write(g,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function LI(g,e){return g&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(g,e){return e?g.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):g}(g,e):e}var TI=RI.isStandardBrowserEnv?function(){var g,e=/(msie|trident)/i.test(navigator.userAgent),I=document.createElement("a");function t(g){var t=g;return e&&(I.setAttribute("href",t),t=I.href),I.setAttribute("href",t),{href:I.href,protocol:I.protocol?I.protocol.replace(/:$/,""):"",host:I.host,search:I.search?I.search.replace(/^\?/,""):"",hash:I.hash?I.hash.replace(/^#/,""):"",hostname:I.hostname,port:I.port,pathname:"/"===I.pathname.charAt(0)?I.pathname:"/"+I.pathname}}return g=t(window.location.href),function(e){var I=cI.isString(e)?t(e):e;return I.protocol===g.protocol&&I.host===g.host}}():function(){return!0};var jI=function(g,e){g=g||10;var I,t=new Array(g),n=new Array(g),C=0,l=0;return e=void 0!==e?e:1e3,function(o){var a=Date.now(),r=n[l];I||(I=a),t[C]=o,n[C]=a;for(var c=l,i=0;c!==C;)i+=t[c++],c%=g;if((C=(C+1)%g)===l&&(l=(l+1)%g),!(a-I<e)){var A=r&&a-r;return A?Math.round(1e3*i/A):void 0}}};function OI(g,e){var I=0,t=jI(50,250);return function(n){var C=n.loaded,l=n.lengthComputable?n.total:void 0,o=C-I,a=t(o);I=C;var r={loaded:C,total:l,progress:l?C/l:void 0,bytes:o,rate:a||void 0,estimated:a&&l&&C<=l?(l-C)/a:void 0,event:n};r[e?"download":"upload"]=!0,g(r)}}var PI="undefined"!==typeof XMLHttpRequest&&function(g){return new Promise((function(e,I){var t,n=g.data,C=EI.from(g.headers).normalize(),l=g.responseType;function o(){g.cancelToken&&g.cancelToken.unsubscribe(t),g.signal&&g.signal.removeEventListener("abort",t)}cI.isFormData(n)&&(RI.isStandardBrowserEnv||RI.isStandardBrowserWebWorkerEnv?C.setContentType(!1):C.setContentType("multipart/form-data;",!1));var a=new XMLHttpRequest;if(g.auth){var r=g.auth.username||"",c=g.auth.password?unescape(encodeURIComponent(g.auth.password)):"";C.set("Authorization","Basic "+btoa(r+":"+c))}var i=LI(g.baseURL,g.url);function A(){if(a){var t=EI.from("getAllResponseHeaders"in a&&a.getAllResponseHeaders());!function(g,e,I){var t=I.config.validateStatus;I.status&&t&&!t(I.status)?e(new dI("Request failed with status code "+I.status,[dI.ERR_BAD_REQUEST,dI.ERR_BAD_RESPONSE][Math.floor(I.status/100)-4],I.config,I.request,I)):g(I)}((function(g){e(g),o()}),(function(g){I(g),o()}),{data:l&&"text"!==l&&"json"!==l?a.response:a.responseText,status:a.status,statusText:a.statusText,headers:t,config:g,request:a}),a=null}}if(a.open(g.method.toUpperCase(),SI(i,g.params,g.paramsSerializer),!0),a.timeout=g.timeout,"onloadend"in a?a.onloadend=A:a.onreadystatechange=function(){a&&4===a.readyState&&(0!==a.status||a.responseURL&&0===a.responseURL.indexOf("file:"))&&setTimeout(A)},a.onabort=function(){a&&(I(new dI("Request aborted",dI.ECONNABORTED,g,a)),a=null)},a.onerror=function(){I(new dI("Network Error",dI.ERR_NETWORK,g,a)),a=null},a.ontimeout=function(){var e=g.timeout?"timeout of "+g.timeout+"ms exceeded":"timeout exceeded",t=g.transitional||vI;g.timeoutErrorMessage&&(e=g.timeoutErrorMessage),I(new dI(e,t.clarifyTimeoutError?dI.ETIMEDOUT:dI.ECONNABORTED,g,a)),a=null},RI.isStandardBrowserEnv){var s=(g.withCredentials||TI(i))&&g.xsrfCookieName&&QI.read(g.xsrfCookieName);s&&C.set(g.xsrfHeaderName,s)}void 0===n&&C.setContentType(null),"setRequestHeader"in a&&cI.forEach(C.toJSON(),(function(g,e){a.setRequestHeader(e,g)})),cI.isUndefined(g.withCredentials)||(a.withCredentials=!!g.withCredentials),l&&"json"!==l&&(a.responseType=g.responseType),"function"===typeof g.onDownloadProgress&&a.addEventListener("progress",OI(g.onDownloadProgress,!0)),"function"===typeof g.onUploadProgress&&a.upload&&a.upload.addEventListener("progress",OI(g.onUploadProgress)),(g.cancelToken||g.signal)&&(t=function(e){a&&(I(!e||e.type?new DI(null,g,a):e),a.abort(),a=null)},g.cancelToken&&g.cancelToken.subscribe(t),g.signal&&(g.signal.aborted?t():g.signal.addEventListener("abort",t)));var d=function(g){var e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(g);return e&&e[1]||""}(i);d&&-1===RI.protocols.indexOf(d)?I(new dI("Unsupported protocol "+d+":",dI.ERR_BAD_REQUEST,g)):a.send(n||null)}))},qI={http:null,xhr:PI};cI.forEach(qI,(function(g,e){if(g){try{Object.defineProperty(g,"name",{value:e})}catch(Og){}Object.defineProperty(g,"adapterName",{value:e})}}));var _I=function(g){for(var e,I,t=(g=cI.isArray(g)?g:[g]).length,n=0;n<t&&(e=g[n],!(I=cI.isString(e)?qI[e.toLowerCase()]:e));n++);if(!I){if(!1===I)throw new dI("Adapter ".concat(e," is not supported by the environment"),"ERR_NOT_SUPPORT");throw new Error(cI.hasOwnProp(qI,e)?"Adapter '".concat(e,"' is not available in the build"):"Unknown adapter '".concat(e,"'"))}if(!cI.isFunction(I))throw new TypeError("adapter is not a function");return I};function $I(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new DI(null,g)}function gt(g){return $I(g),g.headers=EI.from(g.headers),g.data=zI.call(g,g.transformRequest),-1!==["post","put","patch"].indexOf(g.method)&&g.headers.setContentType("application/x-www-form-urlencoded",!1),_I(g.adapter||YI.adapter)(g).then((function(e){return $I(g),e.data=zI.call(g,g.transformResponse,e),e.headers=EI.from(e.headers),e}),(function(e){return MI(e)||($I(g),e&&e.response&&(e.response.data=zI.call(g,g.transformResponse,e.response),e.response.headers=EI.from(e.response.headers))),Promise.reject(e)}))}var et=function(g){return g instanceof EI?g.toJSON():g};function It(g,e){e=e||{};var I={};function t(g,e,I){return cI.isPlainObject(g)&&cI.isPlainObject(e)?cI.merge.call({caseless:I},g,e):cI.isPlainObject(e)?cI.merge({},e):cI.isArray(e)?e.slice():e}function n(g,e,I){return cI.isUndefined(e)?cI.isUndefined(g)?void 0:t(void 0,g,I):t(g,e,I)}function C(g,e){if(!cI.isUndefined(e))return t(void 0,e)}function l(g,e){return cI.isUndefined(e)?cI.isUndefined(g)?void 0:t(void 0,g):t(void 0,e)}function o(I,n,C){return C in e?t(I,n):C in g?t(void 0,I):void 0}var a={url:C,method:C,data:C,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:function(g,e){return n(et(g),et(e),!0)}};return cI.forEach(Object.keys(Object.assign({},g,e)),(function(t){var C=a[t]||n,l=C(g[t],e[t],t);cI.isUndefined(l)&&C!==o||(I[t]=l)})),I}var tt="1.4.0",nt={};["object","boolean","number","function","string","symbol"].forEach((function(g,e){nt[g]=function(I){return typeof I===g||"a"+(e<1?"n ":" ")+g}}));var Ct={};nt.transitional=function(g,e,I){function t(g,e){return"[Axios v1.4.0] Transitional option '"+g+"'"+e+(I?". "+I:"")}return function(I,n,C){if(!1===g)throw new dI(t(n," has been removed"+(e?" in "+e:"")),dI.ERR_DEPRECATED);return e&&!Ct[n]&&(Ct[n]=!0,console.warn(t(n," has been deprecated since v"+e+" and will be removed in the near future"))),!g||g(I,n,C)}};var lt={assertOptions:function(g,e,I){if("object"!==typeof g)throw new dI("options must be an object",dI.ERR_BAD_OPTION_VALUE);for(var t=Object.keys(g),n=t.length;n-- >0;){var C=t[n],l=e[C];if(l){var o=g[C],a=void 0===o||l(o,C,g);if(!0!==a)throw new dI("option "+C+" must be "+a,dI.ERR_BAD_OPTION_VALUE)}else if(!0!==I)throw new dI("Unknown option "+C,dI.ERR_BAD_OPTION)}},validators:nt},ot=lt.validators,at=function(){function g(e){A(this,g),this.defaults=e,this.interceptors={request:new VI,response:new VI}}return m(g,[{key:"request",value:function(g,e){"string"===typeof g?(e=e||{}).url=g:e=g||{};var I,t=e=It(this.defaults,e),n=t.transitional,C=t.paramsSerializer,l=t.headers;void 0!==n&&lt.assertOptions(n,{silentJSONParsing:ot.transitional(ot.boolean),forcedJSONParsing:ot.transitional(ot.boolean),clarifyTimeoutError:ot.transitional(ot.boolean)},!1),null!=C&&(cI.isFunction(C)?e.paramsSerializer={serialize:C}:lt.assertOptions(C,{encode:ot.function,serialize:ot.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase(),(I=l&&cI.merge(l.common,l[e.method]))&&cI.forEach(["delete","get","head","post","put","patch","common"],(function(g){delete l[g]})),e.headers=EI.concat(I,l);var o=[],a=!0;this.interceptors.request.forEach((function(g){"function"===typeof g.runWhen&&!1===g.runWhen(e)||(a=a&&g.synchronous,o.unshift(g.fulfilled,g.rejected))}));var r,c=[];this.interceptors.response.forEach((function(g){c.push(g.fulfilled,g.rejected)}));var i,A=0;if(!a){var s=[gt.bind(this),void 0];for(s.unshift.apply(s,o),s.push.apply(s,c),i=s.length,r=Promise.resolve(e);A<i;)r=r.then(s[A++],s[A++]);return r}i=o.length;var d=e;for(A=0;A<i;){var u=o[A++],m=o[A++];try{d=u(d)}catch(b){m.call(this,b);break}}try{r=gt.call(this,d)}catch(b){return Promise.reject(b)}for(A=0,i=c.length;A<i;)r=r.then(c[A++],c[A++]);return r}},{key:"getUri",value:function(g){return SI(LI((g=It(this.defaults,g)).baseURL,g.url),g.params,g.paramsSerializer)}}]),g}();cI.forEach(["delete","get","head","options"],(function(g){at.prototype[g]=function(e,I){return this.request(It(I||{},{method:g,url:e,data:(I||{}).data}))}})),cI.forEach(["post","put","patch"],(function(g){function e(e){return function(I,t,n){return this.request(It(n||{},{method:g,headers:e?{"Content-Type":"multipart/form-data"}:{},url:I,data:t}))}}at.prototype[g]=e(),at.prototype[g+"Form"]=e(!0)}));var rt=at,ct=function(){function g(e){if(A(this,g),"function"!==typeof e)throw new TypeError("executor must be a function.");var I;this.promise=new Promise((function(g){I=g}));var t=this;this.promise.then((function(g){if(t._listeners){for(var e=t._listeners.length;e-- >0;)t._listeners[e](g);t._listeners=null}})),this.promise.then=function(g){var e,I=new Promise((function(g){t.subscribe(g),e=g})).then(g);return I.cancel=function(){t.unsubscribe(e)},I},e((function(g,e,n){t.reason||(t.reason=new DI(g,e,n),I(t.reason))}))}return m(g,[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(g){this.reason?g(this.reason):this._listeners?this._listeners.push(g):this._listeners=[g]}},{key:"unsubscribe",value:function(g){if(this._listeners){var e=this._listeners.indexOf(g);-1!==e&&this._listeners.splice(e,1)}}}],[{key:"source",value:function(){var e;return{token:new g((function(g){e=g})),cancel:e}}}]),g}(),it=ct;var At={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(At).forEach((function(g){var e=r(g,2),I=e[0],t=e[1];At[t]=I}));var st=At;var dt=function g(e){var I=new rt(e),t=ke(rt.prototype.request,I);return cI.extend(t,rt.prototype,I,{allOwnKeys:!0}),cI.extend(t,I,null,{allOwnKeys:!0}),t.create=function(I){return g(It(e,I))},t}(YI);dt.Axios=rt,dt.CanceledError=DI,dt.CancelToken=it,dt.isCancel=MI,dt.VERSION=tt,dt.toFormData=hI,dt.AxiosError=dI,dt.Cancel=dt.CanceledError,dt.all=function(g){return Promise.all(g)},dt.spread=function(g){return function(e){return g.apply(null,e)}},dt.isAxiosError=function(g){return cI.isObject(g)&&!0===g.isAxiosError},dt.mergeConfig=It,dt.AxiosHeaders=EI,dt.formToJSON=function(g){return kI(cI.isHTMLForm(g)?new FormData(g):g)},dt.HttpStatusCode=st,dt.default=dt;var ut=dt;function mt(g,e){if(null==g)return{};var I,t,n={},C=Object.keys(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||(n[I]=g[I]);return n}function bt(g,e){if(null==g)return{};var I,t,n=mt(g,e);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(g);for(t=0;t<C.length;t++)I=C[t],e.indexOf(I)>=0||Object.prototype.propertyIsEnumerable.call(g,I)&&(n[I]=g[I])}return n}function Zt(g){var e,I,t="";if("string"==typeof g||"number"==typeof g)t+=g;else if("object"==typeof g)if(Array.isArray(g))for(e=0;e<g.length;e++)g[e]&&(I=Zt(g[e]))&&(t&&(t+=" "),t+=I);else for(e in g)g[e]&&(t&&(t+=" "),t+=e);return t}var ht=function(){for(var g,e,I=0,t="";I<arguments.length;)(g=arguments[I++])&&(e=Zt(g))&&(t&&(t+=" "),t+=e);return t},pt=["theme","type"],Gt=["delay","staleId"],yt=function(g){return"number"==typeof g&&!isNaN(g)},Bt=function(g){return"string"==typeof g},ft=function(g){return"function"==typeof g},St=function(g){return Bt(g)||ft(g)?g:null},Wt=function(g){return(0,e.isValidElement)(g)||Bt(g)||ft(g)||yt(g)};function Vt(g){var I=g.enter,t=g.exit,n=g.appendPosition,C=void 0!==n&&n,l=g.collapse,o=void 0===l||l,a=g.collapseDuration,r=void 0===a?300:a;return function(g){var n=g.children,l=g.position,a=g.preventExitTransition,c=g.done,A=g.nodeRef,s=g.isIn,d=C?"".concat(I,"--").concat(l):I,u=C?"".concat(t,"--").concat(l):t,m=(0,e.useRef)(0);return(0,e.useLayoutEffect)((function(){var g,e=A.current,I=d.split(" "),t=function g(t){var n;t.target===A.current&&(e.dispatchEvent(new Event("d")),e.removeEventListener("animationend",g),e.removeEventListener("animationcancel",g),0===m.current&&"animationcancel"!==t.type&&(n=e.classList).remove.apply(n,i(I)))};(g=e.classList).add.apply(g,i(I)),e.addEventListener("animationend",t),e.addEventListener("animationcancel",t)}),[]),(0,e.useEffect)((function(){var g=A.current,e=function e(){g.removeEventListener("animationend",e),o?function(g,e,I){void 0===I&&(I=300);var t=g.scrollHeight,n=g.style;requestAnimationFrame((function(){n.minHeight="initial",n.height=t+"px",n.transition="all ".concat(I,"ms"),requestAnimationFrame((function(){n.height="0",n.padding="0",n.margin="0",setTimeout(e,I)}))}))}(g,c,r):c()};s||(a?e():(m.current=1,g.className+=" ".concat(u),g.addEventListener("animationend",e)))}),[s]),e.createElement(e.Fragment,null,n)}}function vt(g,e){return null!=g?{content:g.content,containerId:g.props.containerId,id:g.props.toastId,theme:g.props.theme,type:g.props.type,data:g.props.data||{},isLoading:g.props.isLoading,icon:g.props.icon,status:e}:{}}var Rt={list:new Map,emitQueue:new Map,on:function(g,e){return this.list.has(g)||this.list.set(g,[]),this.list.get(g).push(e),this},off:function(g,e){if(e){var I=this.list.get(g).filter((function(g){return g!==e}));return this.list.set(g,I),this}return this.list.delete(g),this},cancelEmit:function(g){var e=this.emitQueue.get(g);return e&&(e.forEach(clearTimeout),this.emitQueue.delete(g)),this},emit:function(g){var e=arguments,I=this;this.list.has(g)&&this.list.get(g).forEach((function(t){var n=setTimeout((function(){t.apply(void 0,i([].slice.call(e,1)))}),0);I.emitQueue.has(g)||I.emitQueue.set(g,[]),I.emitQueue.get(g).push(n)}))}},kt=function(g){var I=g.theme,t=g.type,n=bt(g,pt);return e.createElement("svg",ce({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===I?"currentColor":"var(--toastify-icon-color-".concat(t,")")},n))},Xt={info:function(g){return e.createElement(kt,ce({},g),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(g){return e.createElement(kt,ce({},g),e.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(g){return e.createElement(kt,ce({},g),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(g){return e.createElement(kt,ce({},g),e.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return e.createElement("div",{className:"Toastify__spinner"})}};function Jt(g){var I=(0,e.useReducer)((function(g){return g+1}),0),t=r(I,2)[1],n=r((0,e.useState)([]),2),C=n[0],l=n[1],o=(0,e.useRef)(null),a=(0,e.useRef)(new Map).current,c=function(g){return-1!==C.indexOf(g)},A=(0,e.useRef)({toastKey:1,displayedToast:0,count:0,queue:[],props:g,containerId:null,isToastActive:c,getToast:function(g){return a.get(g)}}).current;function s(g){var e=g.containerId;!A.props.limit||e&&A.containerId!==e||(A.count-=A.queue.length,A.queue=[])}function d(g){l((function(e){return null==g?[]:e.filter((function(e){return e!==g}))}))}function u(){var g=A.queue.shift();b(g.toastContent,g.toastProps,g.staleId)}function m(g,I){var n=I.delay,C=I.staleId,l=bt(I,Gt);if(Wt(g)&&!function(g){return!o.current||A.props.enableMultiContainer&&g.containerId!==A.props.containerId||a.has(g.toastId)&&null==g.updateId}(l)){var c=l.toastId,i=l.updateId,s=l.data,m=A.props,Z=function(){return d(c)},h=null==i;h&&A.count++;var p,G,y=ce(ce(ce({},m),{},{style:m.toastStyle,key:A.toastKey++},Object.fromEntries(Object.entries(l).filter((function(g){var e=r(g,2);e[0];return null!=e[1]})))),{},{toastId:c,updateId:i,data:s,closeToast:Z,isIn:!1,className:St(l.className||m.toastClassName),bodyClassName:St(l.bodyClassName||m.bodyClassName),progressClassName:St(l.progressClassName||m.progressClassName),autoClose:!l.isLoading&&(p=l.autoClose,G=m.autoClose,!1===p||yt(p)&&p>0?p:G),deleteToast:function(){var g=vt(a.get(c),"removed");a.delete(c),Rt.emit(4,g);var e=A.queue.length;if(A.count=null==c?A.count-A.displayedToast:A.count-1,A.count<0&&(A.count=0),e>0){var I=null==c?A.props.limit:1;if(1===e||1===I)A.displayedToast++,u();else{var n=I>e?e:I;A.displayedToast=n;for(var C=0;C<n;C++)u()}}else t()}});y.iconOut=function(g){var I=g.theme,t=g.type,n=g.isLoading,C=g.icon,l=null,o={theme:I,type:t};return!1===C||(ft(C)?l=C(o):(0,e.isValidElement)(C)?l=(0,e.cloneElement)(C,o):Bt(C)||yt(C)?l=C:n?l=Xt.spinner():function(g){return g in Xt}(t)&&(l=Xt[t](o))),l}(y),ft(l.onOpen)&&(y.onOpen=l.onOpen),ft(l.onClose)&&(y.onClose=l.onClose),y.closeButton=m.closeButton,!1===l.closeButton||Wt(l.closeButton)?y.closeButton=l.closeButton:!0===l.closeButton&&(y.closeButton=!Wt(m.closeButton)||m.closeButton);var B=g;(0,e.isValidElement)(g)&&!Bt(g.type)?B=(0,e.cloneElement)(g,{closeToast:Z,toastProps:y,data:s}):ft(g)&&(B=g({closeToast:Z,toastProps:y,data:s})),m.limit&&m.limit>0&&A.count>m.limit&&h?A.queue.push({toastContent:B,toastProps:y,staleId:C}):yt(n)?setTimeout((function(){b(B,y,C)}),n):b(B,y,C)}}function b(g,e,I){var t=e.toastId;I&&a.delete(I);var n={content:g,props:e};a.set(t,n),l((function(g){return[].concat(i(g),[t]).filter((function(g){return g!==I}))})),Rt.emit(4,vt(n,null==n.props.updateId?"added":"updated"))}return(0,e.useEffect)((function(){return A.containerId=g.containerId,Rt.cancelEmit(3).on(0,m).on(1,(function(g){return o.current&&d(g)})).on(5,s).emit(2,A),function(){a.clear(),Rt.emit(3,A)}}),[]),(0,e.useEffect)((function(){A.props=g,A.isToastActive=c,A.displayedToast=C.length})),{getToastToRender:function(e){var I=new Map,t=Array.from(a.values());return g.newestOnTop&&t.reverse(),t.forEach((function(g){var e=g.props.position;I.has(e)||I.set(e,[]),I.get(e).push(g)})),Array.from(I,(function(g){return e(g[0],g[1])}))},containerRef:o,isToastActive:c}}function Yt(g){return g.targetTouches&&g.targetTouches.length>=1?g.targetTouches[0].clientX:g.clientX}function Ht(g){return g.targetTouches&&g.targetTouches.length>=1?g.targetTouches[0].clientY:g.clientY}function wt(g){var I=r((0,e.useState)(!1),2),t=I[0],n=I[1],C=r((0,e.useState)(!1),2),l=C[0],o=C[1],a=(0,e.useRef)(null),c=(0,e.useRef)({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,i=(0,e.useRef)(g),A=g.autoClose,s=g.pauseOnHover,d=g.closeToast,u=g.onClick,m=g.closeOnClick;function b(e){if(g.draggable){"touchstart"===e.nativeEvent.type&&e.nativeEvent.preventDefault(),c.didMove=!1,document.addEventListener("mousemove",G),document.addEventListener("mouseup",y),document.addEventListener("touchmove",G),document.addEventListener("touchend",y);var I=a.current;c.canCloseOnClick=!0,c.canDrag=!0,c.boundingRect=I.getBoundingClientRect(),I.style.transition="",c.x=Yt(e.nativeEvent),c.y=Ht(e.nativeEvent),"x"===g.draggableDirection?(c.start=c.x,c.removalDistance=I.offsetWidth*(g.draggablePercent/100)):(c.start=c.y,c.removalDistance=I.offsetHeight*(80===g.draggablePercent?1.5*g.draggablePercent:g.draggablePercent/100))}}function Z(e){if(c.boundingRect){var I=c.boundingRect,t=I.top,n=I.bottom,C=I.left,l=I.right;"touchend"!==e.nativeEvent.type&&g.pauseOnHover&&c.x>=C&&c.x<=l&&c.y>=t&&c.y<=n?p():h()}}function h(){n(!0)}function p(){n(!1)}function G(e){var I=a.current;c.canDrag&&I&&(c.didMove=!0,t&&p(),c.x=Yt(e),c.y=Ht(e),c.delta="x"===g.draggableDirection?c.x-c.start:c.y-c.start,c.start!==c.x&&(c.canCloseOnClick=!1),I.style.transform="translate".concat(g.draggableDirection,"(").concat(c.delta,"px)"),I.style.opacity=""+(1-Math.abs(c.delta/c.removalDistance)))}function y(){document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",G),document.removeEventListener("touchend",y);var e=a.current;if(c.canDrag&&c.didMove&&e){if(c.canDrag=!1,Math.abs(c.delta)>c.removalDistance)return o(!0),void g.closeToast();e.style.transition="transform 0.2s, opacity 0.2s",e.style.transform="translate".concat(g.draggableDirection,"(0)"),e.style.opacity="1"}}(0,e.useEffect)((function(){i.current=g})),(0,e.useEffect)((function(){return a.current&&a.current.addEventListener("d",h,{once:!0}),ft(g.onOpen)&&g.onOpen((0,e.isValidElement)(g.children)&&g.children.props),function(){var g=i.current;ft(g.onClose)&&g.onClose((0,e.isValidElement)(g.children)&&g.children.props)}}),[]),(0,e.useEffect)((function(){return g.pauseOnFocusLoss&&(document.hasFocus()||p(),window.addEventListener("focus",h),window.addEventListener("blur",p)),function(){g.pauseOnFocusLoss&&(window.removeEventListener("focus",h),window.removeEventListener("blur",p))}}),[g.pauseOnFocusLoss]);var B={onMouseDown:b,onTouchStart:b,onMouseUp:Z,onTouchEnd:Z};return A&&s&&(B.onMouseEnter=p,B.onMouseLeave=h),m&&(B.onClick=function(g){u&&u(g),c.canCloseOnClick&&d()}),{playToast:h,pauseToast:p,isRunning:t,preventExitTransition:l,toastRef:a,eventHandlers:B}}function Nt(g){var I=g.closeToast,t=g.theme,n=g.ariaLabel,C=void 0===n?"close":n;return e.createElement("button",{className:"Toastify__close-button Toastify__close-button--".concat(t),type:"button",onClick:function(g){g.stopPropagation(),I(g)},"aria-label":C},e.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},e.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Kt(g){var I=g.delay,t=g.isRunning,n=g.closeToast,C=g.type,l=void 0===C?"default":C,o=g.hide,a=g.className,r=g.style,c=g.controlledProgress,i=g.progress,A=g.rtl,s=g.isIn,d=g.theme,u=o||c&&0===i,m=ce(ce({},r),{},{animationDuration:"".concat(I,"ms"),animationPlayState:t?"running":"paused",opacity:u?0:1});c&&(m.transform="scaleX(".concat(i,")"));var b=ht("Toastify__progress-bar",c?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--".concat(d),"Toastify__progress-bar--".concat(l),{"Toastify__progress-bar--rtl":A}),Z=ft(a)?a({rtl:A,type:l,defaultClassName:b}):ht(b,a);return e.createElement("div",ae({role:"progressbar","aria-hidden":u?"true":"false","aria-label":"notification timer",className:Z,style:m},c&&i>=1?"onTransitionEnd":"onAnimationEnd",c&&i<1?null:function(){s&&n()}))}var Ft=function(g){var I=wt(g),t=I.isRunning,n=I.preventExitTransition,C=I.toastRef,l=I.eventHandlers,o=g.closeButton,a=g.children,r=g.autoClose,c=g.onClick,i=g.type,A=g.hideProgressBar,s=g.closeToast,d=g.transition,u=g.position,m=g.className,b=g.style,Z=g.bodyClassName,h=g.bodyStyle,p=g.progressClassName,G=g.progressStyle,y=g.updateId,B=g.role,f=g.progress,S=g.rtl,W=g.toastId,V=g.deleteToast,v=g.isIn,R=g.isLoading,k=g.iconOut,X=g.closeOnClick,J=g.theme,Y=ht("Toastify__toast","Toastify__toast-theme--".concat(J),"Toastify__toast--".concat(i),{"Toastify__toast--rtl":S},{"Toastify__toast--close-on-click":X}),H=ft(m)?m({rtl:S,position:u,type:i,defaultClassName:Y}):ht(Y,m),w=!!f||!r,N={closeToast:s,type:i,theme:J},K=null;return!1===o||(K=ft(o)?o(N):(0,e.isValidElement)(o)?(0,e.cloneElement)(o,N):Nt(N)),e.createElement(d,{isIn:v,done:V,position:u,preventExitTransition:n,nodeRef:C},e.createElement("div",ce(ce({id:W,onClick:c,className:H},l),{},{style:b,ref:C}),e.createElement("div",ce(ce({},v&&{role:B}),{},{className:ft(Z)?Z({type:i}):ht("Toastify__toast-body",Z),style:h}),null!=k&&e.createElement("div",{className:ht("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!R})},k),e.createElement("div",null,a)),K,e.createElement(Kt,ce(ce({},y&&!w?{key:"pb-".concat(y)}:{}),{},{rtl:S,theme:J,delay:r,isRunning:t,isIn:v,closeToast:s,hide:A,type:i,style:G,className:p,controlledProgress:w,progress:f||0}))))},xt=function(g,e){return void 0===e&&(e=!1),{enter:"Toastify--animate Toastify__".concat(g,"-enter"),exit:"Toastify--animate Toastify__".concat(g,"-exit"),appendPosition:e}},Et=Vt(xt("bounce",!0)),zt=(Vt(xt("slide",!0)),Vt(xt("zoom")),Vt(xt("flip")),(0,e.forwardRef)((function(g,I){var t=Jt(g),n=t.getToastToRender,C=t.containerRef,l=t.isToastActive,o=g.className,a=g.style,r=g.rtl,c=g.containerId;function i(g){var e=ht("Toastify__toast-container","Toastify__toast-container--".concat(g),{"Toastify__toast-container--rtl":r});return ft(o)?o({position:g,rtl:r,defaultClassName:e}):ht(e,St(o))}return(0,e.useEffect)((function(){I&&(I.current=C.current)}),[]),e.createElement("div",{ref:C,className:"Toastify",id:c},n((function(g,I){var t=I.length?ce({},a):ce(ce({},a),{},{pointerEvents:"none"});return e.createElement("div",{className:i(g),style:t,key:"container-".concat(g)},I.map((function(g,t){var n=g.content,C=g.props;return e.createElement(Ft,ce(ce({},C),{},{isIn:l(C.toastId),style:ce(ce({},C.style),{},{"--nth":t+1,"--len":I.length}),key:"toast-".concat(C.key)}),n)})))})))})));zt.displayName="ToastContainer",zt.defaultProps={position:"top-right",transition:Et,autoClose:5e3,closeButton:Nt,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};var Mt,Ut=new Map,Dt=[],Qt=1;function Lt(){return""+Qt++}function Tt(g){return g&&(Bt(g.toastId)||yt(g.toastId))?g.toastId:Lt()}function jt(g,e){return Ut.size>0?Rt.emit(0,g,e):Dt.push({content:g,options:e}),e.toastId}function Ot(g,e){return ce(ce({},e),{},{type:e&&e.type||g,toastId:Tt(e)})}function Pt(g){return function(e,I){return jt(e,Ot(g,I))}}function qt(g,e){return jt(g,Ot("default",e))}function _t(g){return Ge({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"}}]})(g)}function $t(g){return Ge({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M0 224v272c0 8.84 7.16 16 16 16h80V192H32c-17.67 0-32 14.33-32 32zm360-48h-24v-40c0-4.42-3.58-8-8-8h-16c-4.42 0-8 3.58-8 8v64c0 4.42 3.58 8 8 8h48c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zm137.75-63.96l-160-106.67a32.02 32.02 0 0 0-35.5 0l-160 106.67A32.002 32.002 0 0 0 128 138.66V512h128V368c0-8.84 7.16-16 16-16h96c8.84 0 16 7.16 16 16v144h128V138.67c0-10.7-5.35-20.7-14.25-26.63zM320 256c-44.18 0-80-35.82-80-80s35.82-80 80-80 80 35.82 80 80-35.82 80-80 80zm288-64h-64v320h80c8.84 0 16-7.16 16-16V224c0-17.67-14.33-32-32-32z"}}]})(g)}qt.loading=function(g,e){return jt(g,Ot("default",ce({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},e)))},qt.promise=function(g,e,I){var t,n=e.pending,C=e.error,l=e.success;n&&(t=Bt(n)?qt.loading(n,I):qt.loading(n.render,ce(ce({},I),n)));var o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=function(g,e,n){if(null!=e){var C=ce(ce(ce({type:g},o),I),{},{data:n}),l=Bt(e)?{render:e}:e;return t?qt.update(t,ce(ce({},C),l)):qt(l.render,ce(ce({},C),l)),n}qt.dismiss(t)},r=ft(g)?g():g;return r.then((function(g){return a("success",l,g)})).catch((function(g){return a("error",C,g)})),r},qt.success=Pt("success"),qt.info=Pt("info"),qt.error=Pt("error"),qt.warning=Pt("warning"),qt.warn=qt.warning,qt.dark=function(g,e){return jt(g,Ot("default",ce({theme:"dark"},e)))},qt.dismiss=function(g){Ut.size>0?Rt.emit(1,g):Dt=Dt.filter((function(e){return null!=g&&e.options.toastId!==g}))},qt.clearWaitingQueue=function(g){return void 0===g&&(g={}),Rt.emit(5,g)},qt.isActive=function(g){var e=!1;return Ut.forEach((function(I){I.isToastActive&&I.isToastActive(g)&&(e=!0)})),e},qt.update=function(g,e){void 0===e&&(e={}),setTimeout((function(){var I=function(g,e){var I=e.containerId,t=Ut.get(I||Mt);return t&&t.getToast(g)}(g,e);if(I){var t=I.props,n=I.content,C=ce(ce(ce({delay:100},t),e),{},{toastId:e.toastId||g,updateId:Lt()});C.toastId!==g&&(C.staleId=g);var l=C.render||n;delete C.render,jt(l,C)}}),0)},qt.done=function(g){qt.update(g,{progress:1})},qt.onChange=function(g){return Rt.on(4,g),function(){Rt.off(4,g)}},qt.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},qt.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},Rt.on(2,(function(g){Mt=g.containerId||g,Ut.set(Mt,g),Dt.forEach((function(g){Rt.emit(0,g.content,g.options)})),Dt=[]})).on(3,(function(g){Ut.delete(g.containerId||g),0===Ut.size&&Rt.off(0).off(1).off(5)}));var gn=I(184),en=function(g){var e=g.timeSlot,I=g.onBook,t=g.selectedChildId;return(0,gn.jsxs)("div",{className:"time-slot-card",children:[(0,gn.jsxs)("h5",{children:[(0,gn.jsx)($t,{})," ",e.campus+" \ucea0\ud37c\uc2a4"]}),(0,gn.jsxs)("p",{children:[(0,gn.jsx)(_t,{}),"\ub0a0\uc9dc: ",new Date(e.date).toLocaleDateString()]}),(0,gn.jsxs)("p",{children:["\uc2dc\uc791: ",e.startTime," - End: ",e.endTime]}),(0,gn.jsx)("button",{className:"book-button",onClick:function(){t?I(e._id,t):qt.error("\uc608\uc57d \uc804 \uc544\ub3d9\uc744 \u200b\u200b\uc120\ud0dd\ud574\uc8fc\uc138\uc694.")},children:"\ucc45"})]})},In=function(g){var I=g.onClose,t=localStorage.getItem("userCampus"),n=r((0,e.useState)([]),2),C=n[0],l=n[1],o=r((0,e.useState)(!1),2),a=o[0],c=o[1],i=r((0,e.useState)(null),2),A=i[0],s=i[1],d=r((0,e.useState)([]),2),u=d[0],m=d[1],b=r((0,e.useState)(t),2),Z=b[0];b[1];(0,e.useEffect)((function(){h(),p(),G()}),[]);var h=function(){var g=se(ie().mark((function g(){var e,I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/timeSlots"));case 4:e=g.sent,I=e.data.sort((function(g,e){return new Date(g.date)-new Date(e.date)})),l(I),g.next=12;break;case 9:g.prev=9,g.t0=g.catch(0),console.error("Error fetching time slots:",g.t0);case 12:case"end":return g.stop()}}),g,null,[[0,9]])})));return function(){return g.apply(this,arguments)}}(),p=function(){var g=se(ie().mark((function g(){var e,I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",e=Ie(),g.next=5,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/child"),e);case 5:I=g.sent,console.log(I.data),m(I.data),I.data.length>0&&s(I.data[0]._id),g.next=14;break;case 11:g.prev=11,g.t0=g.catch(0),console.error("Error fetching children:",g.t0);case 14:case"end":return g.stop()}}),g,null,[[0,11]])})));return function(){return g.apply(this,arguments)}}(),G=function(){var g=ge(),e=function(){var g=localStorage.getItem("token");if(!g)return console.error("No token in local storage"),null;try{var e=$g(g);return console.log(e),e.attendedPresentation}catch(I){return console.error("Error decoding token",I),null}}();c("parent"===g&&!0===e)},y=function(){var g=se(ie().mark((function g(e){var I,t;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",I=Ie(),g.next=5,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings/child/").concat(e),I);case 5:if(!(t=g.sent).data||!t.data.length){g.next=8;break}return g.abrupt("return",!0);case 8:return g.abrupt("return",!1);case 11:return g.prev=11,g.t0=g.catch(0),console.error("Error checking for child's bookings:",g.t0),g.abrupt("return",!1);case 15:case"end":return g.stop()}}),g,null,[[0,11]])})));return function(e){return g.apply(this,arguments)}}(),B=function(){var g=se(ie().mark((function g(e,t){var n,C,l;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(a){g.next=3;break}return qt.error("\uc9c0\uae08\uc740 \uc608\uc57d\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),g.abrupt("return");case 3:return g.next=5,y(t);case 5:if(!g.sent){g.next=9;break}return qt.error("\uc774 \uc544\uc774\ub294 \uc774\ubbf8 \uc2dc\ud5d8 \uc2dc\uac04\uc744 \uc608\uc57d\ud588\uc2b5\ub2c8\ub2e4."),g.abrupt("return");case 9:if(g.prev=9,n="https://palbackend-a8f4e5171ddb.herokuapp.com",(C=Ie())&&C.headers){g.next=15;break}return console.error("No token in local storage"),g.abrupt("return");case 15:return g.next=17,ut.post("".concat(n,"/api/bookings"),{testSlotId:e,childId:t},C);case 17:(l=g.sent).data&&l.data._id&&(qt.success("\uc608\uc57d\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4! SMS\uac00 \uc804\uc1a1\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),I()),g.next=25;break;case 21:g.prev=21,g.t0=g.catch(9),console.error(g.t0),g.t0.response&&"This test slot is fully booked."===g.t0.response.data&&qt.error("\uc774 \ud14c\uc2a4\ud2b8 \uc2ac\ub86f\uc740 \uc608\uc57d\uc774 \uaf49 \ucc3c\uc2b5\ub2c8\ub2e4. \ub2e4\ub978 \uc2ac\ub86f\uc744 \uc120\ud0dd\ud558\uc138\uc694.");case 25:case"end":return g.stop()}}),g,null,[[9,21]])})));return function(e,I){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{className:"time-slot-list",children:[(0,gn.jsx)("h1",{children:"\ud14c\uc2a4\ud2b8 \uc608\uc57d"}),(0,gn.jsx)("div",{className:"filters",children:(0,gn.jsxs)("div",{className:"filter child-selection",children:[(0,gn.jsx)("label",{htmlFor:"childSelect",children:"\uc5b4\ub9b0\uc774:"}),(0,gn.jsx)("select",{id:"childSelect",value:A,onChange:function(g){return s(g.target.value)},children:u.map((function(g){return(0,gn.jsx)("option",{value:g._id,children:g.name},g._id)}))})]})}),(0,gn.jsx)("div",{className:"slot-cards",children:C.length?C.filter((function(g){return g.campus===Z})).map((function(g){return(0,gn.jsx)(en,{timeSlot:g,onBook:B,selectedChildId:A},g._id)})):(0,gn.jsx)("p",{className:"no-slots",children:"\ud604\uc7ac \uc774\uc6a9 \uac00\ub2a5\ud55c \uc2dc\uac04\ub300\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ub098\uc911\uc5d0 \ub2e4\uc2dc \ud655\uc778\ud574 \uc8fc\uc138\uc694."})})]})},tn=I(426),nn=I.n(tn);var Cn=function(g){var I=g.presentations,t=g.closeModal,n=g.childData,C=g.onBookingCreated,l=r((0,e.useState)(I),2),o=l[0],a=l[1],c=r((0,e.useState)(null),2),A=c[0],s=c[1];(0,e.useEffect)((function(){var g=setInterval((function(){}),5e3);return function(){return clearInterval(g)}}),[]);var d=function(){var g=se(ie().mark((function g(e,I,l,r,c){var A,s,d,u,m,b,Z;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(A=o.find((function(g){return g._id===e})),s=n.find((function(g){return g.ageGroup===A.ageGroup}))){g.next=5;break}return qt.error("\uc774 \uc5f0\ub839\ub300\uc5d0\ub294 \uc790\ub140\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),g.abrupt("return");case 5:if(d="\n    \uc124\uba85\ud68c: ".concat(l,"\n    \ub0a0\uc9dc: ").concat(new Date(A.date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),"\n    \uc2dc\uac04:  ").concat(r,"\n    \ud559\uc0dd\uba85: ").concat(s.name,"\n    2024\ub144 \ud559\ub144: ").concat(s.testGrade,"\n"),window.confirm("\uc544\ub798\uc758 \uc785\ud559\uc124\uba85\ud68c \uc608\uc57d\uc815\ubcf4\ub97c \ud655\uc778\ud574\uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.\n\n       \u2605 \uc608\uc57d \ubcc0\uacbd \uc2dc \uc6d0\ud558\ub294 \uc2dc\uac04 \uc608\uc57d\uc774 \uc5b4\ub824\uc6b8 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n\n      \n".concat(d))){g.next=9;break}return g.abrupt("return");case 9:return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.prev=10,g.next=13,ut.patch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/").concat(e,"/slots/").concat(I,"/attendees"),{},Ie());case 13:200===(u=g.sent).status&&(C(u.data),m=o.findIndex((function(g){return g._id===e})),b=o[m].timeSlots.findIndex((function(g){return g._id===I})),(Z=i(o))[m].timeSlots[b].attendees.push(te()),a(Z),t(),qt.success("\uc608\uc57d \uc131\uacf5\ud588\uc5b4\uc694!")),g.next=20;break;case 17:g.prev=17,g.t0=g.catch(10),qt.error(g.t0.response.data.message||"\uc774\ubbf8 \uc608\uc57d\ud558\uc168\ub124\uc694!");case 20:case"end":return g.stop()}}),g,null,[[10,17]])})));return function(e,I,t,n,C){return g.apply(this,arguments)}}();return(0,gn.jsx)(gn.Fragment,{children:(0,gn.jsxs)("div",{className:"book-presentation-modal-new",children:[(0,gn.jsxs)("div",{className:"modal-header-new",children:[(0,gn.jsx)("h1",{style:{flex:1,textAlign:"center"},children:"J LEE \uc5b4\ud559\uc6d0 \uc124\uba85\ud68c \uc608\uc57d"}),(0,gn.jsx)("button",{className:"close-button",onClick:t,children:"\xd7"})]}),(0,gn.jsx)("div",{className:"presentation-grid",children:o.map((function(g){return(0,gn.jsxs)("div",{className:"presentation-card ".concat(A===g._id?"expanded":""),children:[(0,gn.jsx)("h3",{children:(0,gn.jsx)("strong",{children:g.name})}),(0,gn.jsxs)("div",{className:"presentation-meta",children:[(0,gn.jsx)("div",{children:(0,gn.jsxs)("h5",{children:[(0,gn.jsx)(Be,{})," \uc77c\uc2dc:"," ",new Date(g.date).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})]})}),(0,gn.jsx)("div",{children:(0,gn.jsxs)("h5",{children:[(0,gn.jsx)(Re,{}),"\uc7a5\uc18c: ",g.location]})})]}),(0,gn.jsx)("p",{children:A===g._id?g.description:"".concat(g.description.substring(0,100),"...")}),g.description.length>100&&(0,gn.jsx)("button",{className:"view-more",onClick:function(){return e=g._id,void s(A===e?null:e);var e},children:A===g._id?"\uac04\ub2e8\ud788 \ubcf4\uae30":"\ub354\ubcf4\uae30"}),(0,gn.jsxs)("h4",{children:[(0,gn.jsx)(Ve,{})," \uc2dc\uac04"]}),(0,gn.jsx)("div",{className:"time-slots",children:g.timeSlots?g.timeSlots.map((function(e){var I=e.attendees.includes(te());return(0,gn.jsxs)("div",{className:"time-slot",children:[(0,gn.jsx)("div",{className:"slot-time",children:nn()(e.startTime).format("HH:mm")}),(0,gn.jsx)("div",{className:"slot-info",children:(0,gn.jsx)("button",{className:"slotButton",onClick:function(){return d(g._id,e._id,g.name,nn()(e.startTime).format("HH:mm"))},disabled:e.attendees.length>=e.maxAttendees||I,children:"\uc608\uc57d"})})]},e._id)})):(0,gn.jsx)("p",{children:"\uc774 \ud504\ub9ac\uc820\ud14c\uc774\uc158\uc5d0 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \uc2dc\uac04\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})})]},g._id)}))})]})})};var ln=function(g){var I=g.closeModal,t=g.booking,n=g.onBookingUpdated,C=r((0,e.useState)(t.child.name),2),l=C[0],o=C[1],a=r((0,e.useState)(t.child.previousSchool),2),c=a[0],i=a[1],A=r((0,e.useState)(t.child.age),2),s=A[0],d=A[1],u=r((0,e.useState)(t.campus),2),m=u[0],b=u[1],Z=r((0,e.useState)(t.date),2),h=Z[0],p=Z[1],G=r((0,e.useState)(t.time),2),y=G[0],B=G[1],f=function(){var g=se(ie().mark((function g(e){var C;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e.preventDefault(),C={child:{name:l,previousSchool:c,age:s},campus:m,date:h,time:y},g.prev=2,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=6,ut.patch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings/").concat(t._id),C,Ie());case 6:200===g.sent.status?(qt.success("Booking updated successfully"),n(),I()):qt.error("Failed to update booking"),g.next=14;break;case 10:g.prev=10,g.t0=g.catch(2),console.error(g.t0),qt.error("Failed to update booking");case 14:case"end":return g.stop()}}),g,null,[[2,10]])})));return function(e){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{children:[(0,gn.jsx)("h2",{children:"Edit Booking"}),(0,gn.jsxs)("form",{onSubmit:f,children:[(0,gn.jsxs)("label",{children:["Child's Name:",(0,gn.jsx)("input",{type:"text",value:l,onChange:function(g){return o(g.target.value)},required:!0})]}),(0,gn.jsxs)("label",{children:["Previous School:",(0,gn.jsx)("input",{type:"text",value:c,onChange:function(g){return i(g.target.value)},required:!0})]}),(0,gn.jsxs)("label",{children:["Test Type:",(0,gn.jsxs)("select",{value:s,onChange:function(g){return d(g.target.value)},required:!0,children:[(0,gn.jsx)("option",{value:"",children:"--Please choose an option--"}),(0,gn.jsx)("option",{value:"5 Year Old",children:"5 Year Old"}),(0,gn.jsx)("option",{value:"6 Year Old",children:"6 Year Old"}),(0,gn.jsx)("option",{value:"7 Year Old",children:"7 Year Old"}),(0,gn.jsx)("option",{value:"1st Grade",children:"1st Grade"}),(0,gn.jsx)("option",{value:"2nd Grade",children:"2nd Grade"}),(0,gn.jsx)("option",{value:"3rd Grade",children:"3rd Grade"}),(0,gn.jsx)("option",{value:"4th Grade",children:"4th Grade"}),(0,gn.jsx)("option",{value:"5th Grade",children:"5th Grade"}),(0,gn.jsx)("option",{value:"6th Grade",children:"6th Grade"}),(0,gn.jsx)("option",{value:"7th Grade",children:"7th Grade"}),(0,gn.jsx)("option",{value:"8th Grade",children:"8th Grade"})]})]}),(0,gn.jsxs)("label",{children:["Campus:",(0,gn.jsxs)("select",{value:m,onChange:function(g){return b(g.target.value)},required:!0,children:[(0,gn.jsx)("option",{value:"",children:"--Please choose an option--"}),(0,gn.jsx)("option",{value:"Suji",children:"Suji"}),(0,gn.jsx)("option",{value:"Dongtan",children:"Dongtan"}),(0,gn.jsx)("option",{value:"Bundang",children:"Bundang"})]})]}),(0,gn.jsxs)("label",{children:["Date:",(0,gn.jsx)("input",{type:"date",value:h,onChange:function(g){return p(g.target.value)},required:!0})]}),(0,gn.jsxs)("label",{children:["Time:",(0,gn.jsxs)("select",{value:y,onChange:function(g){return B(g.target.value)},required:!0,children:[(0,gn.jsx)("option",{value:"",children:"--Please choose an option--"}),(0,gn.jsx)("option",{value:"14:30",children:"14:30"}),(0,gn.jsx)("option",{value:"15:30",children:"15:30"}),(0,gn.jsx)("option",{value:"16:30",children:"16:30"}),(0,gn.jsx)("option",{value:"17:30",children:"17:30"}),(0,gn.jsx)("option",{value:"18:30",children:"18:30"}),(0,gn.jsx)("option",{value:"19:30",children:"19:30"}),(0,gn.jsx)("option",{value:"20:30",children:"20:30"}),(0,gn.jsx)("option",{value:"21:30",children:"21:30"})]})]}),(0,gn.jsx)("input",{type:"submit",value:"Submit"})]})]})};var on=function(g){var I=g.closeModal,t=g.presentationId,n=g.oldSlotId,C=g.onTimeSlotChanged,l=r((0,e.useState)([]),2),o=l[0],a=l[1],c=r((0,e.useState)(""),2),i=c[0],A=c[1],s=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/").concat(t,"/timeSlots"),Ie());case 3:200===(e=g.sent).status?a(e.data):console.error("Error fetching time slots");case 5:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}();(0,e.useEffect)((function(){s()}),[t]);var d=function(){var g=se(ie().mark((function g(){var e,l,a,r,c;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(i){g.next=3;break}return console.error("No time slot selected"),g.abrupt("return");case 3:if(a=null===(e=o.find((function(g){return g._id===n})))||void 0===e?void 0:e.startTime,r=null===(l=o.find((function(g){return g._id===i})))||void 0===l?void 0:l.startTime,window.confirm("\ubcc0\uacbd \uc2dc \uc2e4\uc2dc\uac04 \uc608\uc57d\uc5d0 \ub530\ub77c \uc7ac\ubcc0\uacbd\uc774 \uc5b4\ub824\uc6b8 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc2dc\uac04 \ubcc0\uacbd\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? ".concat(new Date(a).toLocaleTimeString()," -> ").concat(new Date(r).toLocaleTimeString(),"?"))){g.next=8;break}return g.abrupt("return");case 8:return"https://palbackend-a8f4e5171ddb.herokuapp.com",c=te(),g.next=12,ut.patch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/").concat(t,"/changeSlot"),{userId:c,oldSlotId:n,newSlotId:i},Ie());case 12:200===g.sent.status?(qt.success("Timeslot successfully changed."),I(),C()):(console.error("Error changing time slot"),qt.error("Error changing timeslot."));case 14:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{children:[(0,gn.jsx)("button",{className:"close-button",onClick:I,children:"X"}),(0,gn.jsxs)("div",{className:"change-time-slot-modal",children:[(0,gn.jsx)("h2",{children:"\uc598\uc57d\uc2dc\uac04\ubcc0\uacbd"}),(0,gn.jsxs)("select",{value:i,onChange:function(g){return A(g.target.value)},style:{padding:"8px",borderRadius:"5px",border:"1px solid #ccc",marginBottom:"10px"},children:[(0,gn.jsx)("option",{value:"",children:"Select a new time slot"}),o.map((function(g){return(0,gn.jsx)("option",{value:g._id,children:new Date(g.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},g._id)}))]}),(0,gn.jsx)("button",{onClick:d,style:{backgroundColor:"#007BFF",color:"white",padding:"10px 20px",marginRight:"10px"},disabled:!i,children:"\uc608\uc57d\uc2dc\uac04\ubcc0\uacbd"})]})]})};var an=function(){var g=r((0,e.useState)(null),2),I=g[0],t=g[1],n=r((0,e.useState)([]),2),C=n[0],l=n[1],o=r((0,e.useState)(null),2),a=o[0],c=o[1],i=r((0,e.useState)([]),2),A=i[0],s=i[1],d=r((0,e.useState)(null),2),u=d[0],m=d[1],b=r((0,e.useState)([]),2),Z=b[0],h=b[1],p=r((0,e.useState)([]),2),G=p[0],y=p[1],B=le(),f=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings/parent?userId=").concat(te()),Ie());case 3:200===(e=g.sent).status?l(e.data):m("Error fetching bookings");case 5:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}();(0,e.useEffect)((function(){f()}),[C.length]);var S=function(){var g=se(ie().mark((function g(){var e,I,t,n,C,l,o,a,c,i;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e="https://palbackend-a8f4e5171ddb.herokuapp.com",I=te(),t=ee(),n={headers:{Authorization:"Bearer ".concat(t)}},g.next=6,Promise.all([ut.get("".concat(e,"/api/presentations/myBookings"),n),ut.get("".concat(e,"/api/users/").concat(I,"/children"),n)]);case 6:C=g.sent,l=r(C,2),o=l[0],a=l[1],200===o.status&&200===a.status?(c=a.data,y(c),i=o.data.map((function(g){var e=c.filter((function(e){return e.ageGroup===g.ageGroup})),I=e.map((function(g){return g.name})).join(", "),t=e.map((function(g){return g.testGrade})).join(", ");return ce(ce({},g),{},{childName:I,testGrade:t,oldSlotId:g.timeSlots[0]._id})})),h(i)):m("Error fetching my presentations");case 11:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}();(0,e.useEffect)((function(){S()}),[]),(0,e.useEffect)((function(){var g=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations?campus=").concat(B),Ie());case 3:200===(e=g.sent).status?s(e.data):m("Error fetching presentations");case 5:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}();g()}),[]);var W=function(){t(null),S()},V=function(){var g=se(ie().mark((function g(e){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!window.confirm("\uc815\ub9d0\ub85c \uc774 \uc608\uc57d\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){g.next=6;break}return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,ut.delete("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings/").concat(e),Ie());case 4:200===g.sent.status?(l((function(g){return g.filter((function(g){return g._id!==e}))})),qt.success("\uc608\uc57d\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")):qt.error("\uc608\uc57d\uc744 \uc0ad\uc81c\ud558\ub294 \uc911\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.");case 6:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}(),v=0===C.length,R=function(){var g=se(ie().mark((function g(){var e,I,t,n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",e=te(),g.next=5,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/").concat(e,"/qrcode"));case 5:return I=g.sent,g.next=8,I.blob();case 8:t=g.sent,(n=document.createElement("a")).href=URL.createObjectURL(t),n.download="qrcode.pdf",n.click(),URL.revokeObjectURL(n.href),g.next=20;break;case 16:g.prev=16,g.t0=g.catch(0),console.error("Error downloading QR code PDF:",g.t0),qt.error("QR \ucf54\ub4dc PDF\ub97c \ub2e4\uc6b4\ub85c\ub4dc\ud558\ub294 \uc911\uc5d0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.");case 20:case"end":return g.stop()}}),g,null,[[0,16]])})));return function(){return g.apply(this,arguments)}}(),k=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations?campus=").concat(B),Ie());case 3:200===(e=g.sent).status?s(e.data):m("Error fetching updated presentations");case 5:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}(),X=function(){var g=se(ie().mark((function g(e,I){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!window.confirm("\uc124\uba85\ud68c \uc608\uc57d \ucde8\uc18c \uc2dc \ucd5c\ucd08 \uc608\uc57d \uae30\ub85d\uc740 \uc0ad\uc81c\ub429\ub2c8\ub2e4. \uc815\ub9d0 \uc608\uc57d \ucde8\uc18c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?  \n      \u2605  \ucd5c\ucd08 \uc608\uc57d \uae30\ub85d\uc740 \ud14c\uc2a4\ud2b8 \ud6c4 \ub4f1\ub85d \uc21c\ubc88\uc5d0 \uc601\ud5a5\uc774 \uc788\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.")){g.next=6;break}return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,ut.delete("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/").concat(e,"/attendees/").concat(te()),Ie());case 4:200===g.sent.status?(S(),qt.success("\uc124\uba85\ud68c \uc608\uc57d \ucde8\uc18c\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")):qt.error("\uc124\uba85\ud68c \uc608\uc57d \ucde8\uc18c\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \uc644\ub8cc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");case 6:case"end":return g.stop()}}),g)})));return function(e,I){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{className:"dashboard-container",children:[u&&(0,gn.jsxs)("p",{className:"error-message",role:"alert",children:[(0,gn.jsx)(fe,{})," ",u]}),(0,gn.jsx)("h1",{className:"header",children:" J LEE \uc2e0\uc785\uc0dd \uc785\ud559\uc124\uba85\ud68c \uc608\uc57d"}),(0,gn.jsxs)("h4",{children:[B,"\ucea0\ud37c\uc2a4"]}),(0,gn.jsx)("div",{className:"header-text-new",children:(0,gn.jsxs)("ol",{children:[(0,gn.jsx)("li",{children:'\uc785\ud559 \ud76c\ub9dd\ud558\ub294 \ud615\uc81c,\uc790\ub9e4\uac00 \uc788\uc73c\uc2e0 \uacbd\uc6b0 "\ud559\uc0dd\ucd94\uac00"\ub97c \ud574\uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.'}),(0,gn.jsx)("li",{children:"\uc124\uba85\ud68c \uc608\uc57d\uc774 \uc644\ub8cc\ub418\uba74 \ud559\ubd80\ubaa8\ub2d8\uaed8 \uc608\uc57d\ud655\uc778 \ubb38\uc790\uac00 \ubc1c\uc1a1\ub429\ub2c8\ub2e4."})]})}),(0,gn.jsxs)("div",{className:"button-containerPD",children:[(0,gn.jsx)("button",{className:"button",onClick:function(){return t("presentation")},"aria-label":"Book Presentation",children:"\uc2e0\uc785\uc0dd \uc124\uba85\ud68c \uc608\uc57d"}),(0,gn.jsx)(Lg,{to:"/add-child",children:(0,gn.jsx)("button",{className:"button","aria-label":"Add Child",children:"\ud559\uc0dd \ucd94\uac00"})})]}),v&&0===Z.length?(0,gn.jsx)("p",{className:"no-booking",children:"\uc608\uc57d\ub0b4\uc5ed\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. [\uc2e0\uc785\uc0dd \uc124\uba85\ud68c \uc608\uc57d]\ub97c \ud074\ub9ad\ud558\uc5ec \uc608\uc57d\uc744 \uc9c4\ud589\ud574\uc8fc\uc138\uc694."}):(0,gn.jsxs)("div",{className:"card-container",children:[C.map((function(g){var e,I,t;return(0,gn.jsxs)("div",{className:"booking-card",style:{backgroundColor:"#f0f0f0",border:"2px solid #ccc"},children:[(0,gn.jsx)("h3",{children:g.child.name}),(0,gn.jsxs)("p",{children:["\uc774\uc804 \ud559\uad50: ",g.child.previousSchool]}),(0,gn.jsxs)("p",{children:["\uc2dc\ud5d8\ub4f1\uae09: ",g.child.testGrade]}),(0,gn.jsxs)("p",{children:["\uad50\uc815: ",null===g||void 0===g||null===(e=g.testSlot)||void 0===e?void 0:e.campus]}),(0,gn.jsxs)("p",{children:["\ub0a0\uc9dc: ",new Date(null===g||void 0===g||null===(I=g.testSlot)||void 0===I?void 0:I.date).toLocaleDateString()]}),(0,gn.jsxs)("p",{children:["\uc2dc\uac04: ",null===g||void 0===g||null===(t=g.testSlot)||void 0===t?void 0:t.startTime]}),(0,gn.jsx)("div",{className:"booking-actions",children:(0,gn.jsx)("button",{className:"button",onClick:function(){return V(g._id)},children:"\ucde8\uc18c"})})]},g._id)})),Z.map((function(g){return(0,gn.jsxs)("div",{className:"presentation-card",style:{backgroundColor:"#e0f7fa",border:"2px "},children:[(0,gn.jsx)("h3",{children:g.name}),(0,gn.jsxs)("h4",{children:["\ub0a0\uc9dc:"," ",new Date(g.date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})+" "+new Date(g.timeSlots[0].startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,gn.jsxs)("p",{children:["\uc7a5\uc18c : ",g.location]}),(0,gn.jsxs)("p",{children:["\ud559\uc0dd(\uc720\uc544)\uba85:",g.childName]}),(0,gn.jsxs)("p",{children:["2024\ub144 \uc608\ube44 \ud559\ub144(\uc5f0\ub839): ",g.testGrade]}),(0,gn.jsxs)("div",{className:"booking-actions",children:[(0,gn.jsx)("button",{className:"button-bookings",onClick:function(){return function(g){var e=Z.find((function(e){return e._id===g}));c(e),t("changeTimeSlot")}(g._id)},children:"\uc608\uc57d\uc2dc\uac04\ubcc0\uacbd"}),(0,gn.jsx)("button",{className:"button-bookings",onClick:function(){return X(g._id)},children:"\ucde8\uc18c"}),new Date(g.date)-new Date<=1728e5&&(0,gn.jsxs)("button",{className:"button-bookings",onClick:function(){return R()},"aria-label":"Download QR Code",children:[(0,gn.jsx)(ve,{})," QR \ub2e4\uc6b4\ub85c\ub4dc"]})]})]},g._id)}))]}),(0,gn.jsxs)(ue(),{isOpen:null!==I,onRequestClose:W,contentLabel:"Dynamic Modal",children:["booking"===I&&(0,gn.jsx)(In,{closeModal:W}),"presentation"===I&&(0,gn.jsx)(Cn,{presentations:A,closeModal:W,childData:G,onBookingCreated:k}),"editBooking"===I&&(0,gn.jsx)(ln,{closeModal:W,booking:a,onBookingUpdated:f}),"changeTimeSlot"===I&&(0,gn.jsx)(on,{closeModal:W,presentationId:a._id,oldSlotId:a.oldSlotId,onTimeSlotChanged:S})]})]})};var rn=function(){return"parent"===ge()?(0,gn.jsx)(Ng,{children:(0,gn.jsx)(Hg,{path:"/",element:(0,gn.jsx)(an,{})})}):(0,gn.jsx)(Yg,{to:"/login"})},cn=I.p+"static/media/logo.7e213964b8e99cfbface.png";var An=function(){var g=hg();return(0,gn.jsxs)("div",{className:"home-page-container",children:[(0,gn.jsx)("div",{className:"logo-container",children:(0,gn.jsx)("img",{src:cn,alt:"Logo",className:"logo-image"})}),(0,gn.jsxs)("div",{className:"content-container",children:[(0,gn.jsxs)("div",{className:"text-container",children:[(0,gn.jsx)("h1",{children:"J LEE \uc2e0\uc785\uc0dd \uc124\uba85\ud68c \uc608\uc57d"}),(0,gn.jsx)("h5",{children:"\ud68c\uc6d0\uac00\uc785 \ud6c4 \uc608\uc57d\uc744 \uc9c4\ud589\ud558\uc5ec \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4"})]}),(0,gn.jsxs)("div",{className:"button-container",children:[(0,gn.jsx)("button",{className:"login-button",onClick:function(){g("/login")},children:"\ub85c\uadf8\uc778"}),(0,gn.jsx)("button",{className:"register-button",onClick:function(){g("/register")},children:"\ud68c\uc6d0\uac00\uc785"})]}),(0,gn.jsxs)("p",{className:"terms",children:["\ud68c\uc6d0\uac00\uc785\uc744 \ud1b5\ud574 \ub2e4\uc74c\uc5d0 \ub3d9\uc758\ud558\uac8c \ub429\ub2c8\ub2e4. ",(0,gn.jsx)("br",{}),(0,gn.jsxs)("a",{href:"/\uac1c\uc778\uc815\ubcf4_\ubcf4\ud638\uc815\ucc45_\ubc0f_\uc774\uc6a9_\uc57d\uad00.pdf",target:"_blank",rel:"noopener noreferrer",children:[" ","\uac1c\uc778\uc815\ubcf4 \uc218\uc9d1 \ubc0f \uc774\uc6a9"]})]})]})]})},sn=(0,e.createContext)();function dn(){return(0,e.useContext)(sn)}function un(g){var I=g.children,t=r((0,e.useState)(localStorage.getItem("token")),2),n=t[0],C=t[1];(0,e.useEffect)((function(){var g=localStorage.getItem("token");C(g)}),[]);var l={isLoggedIn:!!n,token:n,login:function(g){localStorage.setItem("token",g),C(g)},logout:function(){localStorage.removeItem("token"),C(null)}};return(0,gn.jsx)(sn.Provider,{value:l,children:I})}var mn=function(){var g=hg(),I=dn().login,t=r((0,e.useState)(""),2),n=t[0],C=t[1],l=r((0,e.useState)(""),2),o=l[0],a=l[1],c=r((0,e.useState)(""),2),i=c[0],A=c[1],s=r((0,e.useState)(!1),2),d=s[0],u=s[1],m=r((0,e.useState)(!1),2),b=m[0],Z=m[1],h=function(){var e=se(ie().mark((function e(t){var C,l,a,r;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),A(""),u(!0),e.prev=3,C="https://palbackend-a8f4e5171ddb.herokuapp.com",console.log(C),e.next=8,fetch("".concat(C,"/api/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:n,password:o})});case 8:if(!(l=e.sent).ok){e.next=19;break}return e.next=12,l.json();case 12:a=e.sent,I(a.token),localStorage.setItem("userRole",a.role),localStorage.setItem("userCampus",a.campus),"parent"===a.role?g("/parent"):"admin"===a.role||"superadmin"===a.role?g("/admin"):A("Invalid role"),e.next=24;break;case 19:return e.next=21,l.json();case 21:r=e.sent,console.error(r),A("\uc804\ud654\ubc88\ud638 \ub610\ub294 \ube44\ubc00\ubc88\ud638\ub97c \ud655\uc778\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.");case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(3),console.error(e.t0),A("\uc804\ud654\ubc88\ud638 \ub610\ub294 \ube44\ubc00\ubc88\ud638\ub97c \ud655\uc778\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.");case 30:return e.prev=30,u(!1),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[3,26,30,33]])})));return function(g){return e.apply(this,arguments)}}();return(0,gn.jsxs)("div",{className:"form-container",children:[(0,gn.jsx)("div",{className:"logo-container",children:(0,gn.jsx)(Lg,{to:"/",children:(0,gn.jsx)("img",{src:cn,alt:"Logo",className:"logo-image"})})}),(0,gn.jsxs)("form",{className:"form",onSubmit:h,children:[(0,gn.jsx)("h1",{className:"form-title",children:"\ub85c\uadf8\uc778"}),i&&(0,gn.jsx)("div",{className:"error-message",children:i}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"email",children:"\uc804\ud654\ubc88\ud638"}),(0,gn.jsx)("input",{className:"form-input",type:"tel",id:"phone",value:n,onChange:function(g){return C(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"password",children:"\ube44\ubc00\ubc88\ud638:"}),(0,gn.jsxs)("div",{className:"password-container",children:[(0,gn.jsx)("input",{className:"form-input",type:b?"text":"password",id:"password",value:o,onChange:function(g){return a(g.target.value)},required:!0}),(0,gn.jsx)("div",{className:"toggle-password",onClick:function(){return Z(!b)},children:b?"\uc228\ub2e4":"\ubcf4\uae30"})]})]}),(0,gn.jsx)("div",{className:"form-field",children:(0,gn.jsx)("button",{className:"form-button",type:"submit",disabled:d,children:d?"\ub85c\uadf8\uc778 \uc911...":"\ub85c\uadf8\uc778"})}),(0,gn.jsxs)("p",{className:"link",children:["\uc544\uc9c1 \uacc4\uc815\uc774 \uc5c6\uc73c\uc2e0\uac00\uc694? ",(0,gn.jsx)(Lg,{to:"/register",children:"\ud68c\uc6d0\uac00\uc785"})]}),(0,gn.jsxs)("p",{className:"link",children:["\ube44\ubc00\ubc88\ud638\ub97c \uc78a\uc73c\uc168\ub098\uc694? ",(0,gn.jsx)(Lg,{to:"/change-password",children:"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"})]})]})]})};var bn=function(g){var I=g.parentId,t=r((0,e.useState)(""),2),n=t[0],C=t[1],l=r((0,e.useState)(""),2),o=l[0],a=l[1],c=r((0,e.useState)(""),2),i=c[0],A=c[1],s=r((0,e.useState)(""),2),d=s[0],u=s[1],m=hg(),b=function(){var g=se(ie().mark((function g(){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,h();case 2:g.sent&&m("/parent",{replace:!0});case 4:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}(),Z=function(){var g=se(ie().mark((function g(){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,h();case 2:g.sent&&p();case 4:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}(),h=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=3,ut.post("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/child"),{name:n,previousSchool:o,dateOfBirth:i,gender:d,parent:I},Ie());case 3:if(201!==(e=g.sent).status){g.next=9;break}return console.log("Child created:",e.data),g.abrupt("return",!0);case 9:return console.error("Failed to create child:",e.data),g.abrupt("return",!1);case 11:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}(),p=function(){C(""),a(""),A(""),u("")};return(0,gn.jsx)("div",{className:"form-container",children:(0,gn.jsxs)("form",{className:"form",onSubmit:function(g){return g.preventDefault()},children:[(0,gn.jsx)("h2",{className:"form-title",children:"\ud559\uc0dd\uc815\ubcf4"}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"name",children:"\ud559\uc0dd(\uc720\uc544)\ud55c\uae00\uba85:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",value:n,onChange:function(g){return C(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"previousSchool",children:"\ud604\uc7ac \uc7ac\uc6d0\uc911\uc778 \uae30\uad00\uba85:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",value:o,onChange:function(g){return a(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"dateOfBirth",children:"\uc0dd\ub144\uc6d4\uc77c:"}),(0,gn.jsx)("p",{className:"text-red",children:"*\uc0dd\ub144\uc6d4\uc77c\uc744 \uae30\uc785 \uc2dc \uc790\ub3d9\uc73c\ub85c \ud559\ub144\uc120\ud0dd\uc774 \ub418\ubbc0\ub85c \uc815\ud655\ud558\uac8c \uae30\uc785\ud574\uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4."}),(0,gn.jsx)("input",{className:"form-input",type:"date",value:i,onChange:function(g){return A(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"gender",children:"\uc131\ubcc4: :"}),(0,gn.jsxs)("select",{className:"form-input",value:d,onChange:function(g){return u(g.target.value)},required:!0,children:[(0,gn.jsx)("option",{value:"",children:"\uc131\ubcc4\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),(0,gn.jsx)("option",{value:"male",children:"\ub0a8\uc131"}),(0,gn.jsx)("option",{value:"female",children:"\uc5ec\uc131"})]})]}),(0,gn.jsx)("button",{className:"form-button",onClick:b,children:"\ub4f1\ub85d"}),(0,gn.jsx)("button",{className:"form-button secondary",onClick:Z,children:"\ud559\uc0dd \ucd94\uac00"})]})})};var Zn=function(){var g=hg(),I=r((0,e.useState)(""),2),t=I[0],n=I[1],C=r((0,e.useState)(""),2),l=C[0],o=C[1],a=r((0,e.useState)(""),2),c=a[0],i=a[1],A=r((0,e.useState)(""),2),s=A[0],d=A[1],u=r((0,e.useState)(""),2),m=u[0],b=u[1],Z=r((0,e.useState)(!1),2),h=Z[0],p=Z[1],G=r((0,e.useState)(""),2),y=G[0],B=G[1],f=r((0,e.useState)(!0),2),S=f[0],W=f[1],V=r((0,e.useState)(!1),2),v=V[0],R=V[1],k=r((0,e.useState)(""),2),X=k[0],J=k[1],Y=function(){var e=se(ie().mark((function e(I){var n,C,o;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.preventDefault(),R(!0),J(""),"https://palbackend-a8f4e5171ddb.herokuapp.com",e.next=6,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:l,password:c,phone:s,campus:m})});case 6:if(n=e.sent,R(!1),!n.ok){e.next=16;break}return e.next=11,n.json();case 11:C=e.sent,localStorage.setItem("token",C.token),"parent"===C.role?(B(C._id),p(!0),W(!1)):"admin"===C.role&&g("/admin",{replace:!0}),e.next=21;break;case 16:return e.next=18,n.json();case 18:o=e.sent,console.error(o),J(o.message||"An error occurred");case 21:case"end":return e.stop()}}),e)})));return function(g){return e.apply(this,arguments)}}();return(0,gn.jsxs)("div",{className:"form-container",children:[(0,gn.jsx)("div",{className:"logo-container",children:(0,gn.jsx)(Lg,{to:"/",children:(0,gn.jsx)("img",{src:cn,alt:"Logo",className:"logo-image"})})}),S?(0,gn.jsxs)("form",{className:"form",onSubmit:Y,children:[(0,gn.jsx)("h1",{className:"form-title",children:"\ud68c\uc6d0\uac00\uc785"}),X&&(0,gn.jsx)("p",{className:"error",children:X}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"name",children:"\ud559\ubd80\ubaa8\uc774\ub984:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",id:"name",value:t,onChange:function(g){return n(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"phone",children:"\uc804\ud654\ubc88\ud638"}),(0,gn.jsx)("input",{className:"form-input",type:"text",id:"phone",value:s,onChange:function(g){return d(g.target.value)},required:!0,pattern:"010[0-9]{8}",title:"Phone number must be in the format 010XXXXXXXX"})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"email",children:"\uc774\uba54\uc77c:"}),(0,gn.jsx)("input",{className:"form-input",type:"email",id:"email",value:l,onChange:function(g){return o(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"password",children:"\ube44\ubc00\ubc88\ud638:"}),(0,gn.jsx)("input",{className:"form-input",type:"password",id:"password",value:c,onChange:function(g){return i(g.target.value)},required:!0})]}),(0,gn.jsx)("label",{children:"\ucea0\ud37c\uc2a4 \uc120\ud0dd  "}),(0,gn.jsx)("p",{className:"text-red",children:"*\uc785\ud559 \ud76c\ub9dd\ud558\ub294 \ucea0\ud37c\uc2a4\ub97c \uc120\ud0dd\ud574 \uc8fc\uc138\uc694. \uc120\ud0dd\ud558\uc2e0 \ucea0\ud37c\uc2a4\ub85c \uc124\uba85\ud68c \uc608\uc57d\uc774 \uc9c4\ud589\ub418\uba70, \ucea0\ud37c\uc2a4 \uac04 \uc911\ubcf5\uc608\uc57d\uc740 \ubd88\uac00\ud569\ub2c8\ub2e4."}),(0,gn.jsxs)("select",{value:m,onChange:function(g){return b(g.target.value)},required:!0,children:[(0,gn.jsx)("option",{value:"",children:"--\uc635\uc158\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694--"}),(0,gn.jsx)("option",{value:"\uc218\uc9c0",children:"\uc218\uc9c0"}),(0,gn.jsx)("option",{value:"\ub3d9\ud0c4",children:"\ub3d9\ud0c4"}),(0,gn.jsx)("option",{value:"\ubd84\ub2f9",children:"\ubd84\ub2f9"})]}),(0,gn.jsx)("div",{className:"form-field",children:(0,gn.jsx)("button",{className:"form-button",type:"submit",disabled:v,children:v?"\uac00\uc785\ud558\uae30...":"\uac00\uc785\ud558\uae30"})}),(0,gn.jsxs)("p",{className:"link",children:["\uacc4\uc815\uc744 \uac16\uace0\uc788\ub2e4\uba74 ",(0,gn.jsx)(Lg,{to:"/login",children:"\uc5ec\uae30\uc5d0 \ub85c\uadf8\uc778\ud558\uc138\uc694"})]})]}):null,h&&(0,gn.jsx)(bn,{parentId:y})]})},hn=function(){var g,I=dn(),t=I.isLoggedIn,n=I.logout,C=(I.user,hg()),l=bg(),o=r((0,e.useState)(!1),2),a=o[0],c=o[1],i=(0,e.useRef)(null),A=(0,e.useRef)(null),s=ne(),d=le();if((0,e.useEffect)((function(){var g=function(g){A.current&&i.current&&!A.current.contains(g.target)&&!i.current.contains(g.target)&&c(!1)};return document.addEventListener("mousedown",g),function(){document.removeEventListener("mousedown",g)}}),[]),!t||"/"===l.pathname)return null;var u="admin"===(g=ge())||"superadmin"===g,m="superadmin"===g,b="parent"===g,Z=b?"/parent":"/admin",h={navbar:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1em",backgroundColor:m?"#364150":"#f5f5f5"},campusName:{marginRight:"10px",fontSize:"18px",color:"black"},logo:{height:"4em"},hamburger:{fontSize:"2em",background:"none",border:"none",cursor:"pointer",color:"#333333"},logoutButton:{backgroundColor:"#007BFF",color:"white",border:"none",cursor:"pointer",width:"120px",height:"40px",fontSize:"15px",borderRadius:"5px"},sidebar:{position:"fixed",top:"0",left:"0",height:"100%",width:"200px",backgroundColor:"#333",color:"white",padding:"1em",transition:"transform 0.3s",zIndex:1e3},sidebarLink:{display:"block",padding:"1em 0",color:"white",textDecoration:"none"}};return(0,gn.jsxs)("nav",{style:ce(ce({},h.navbar),{},{backgroundColor:m?"#2b3643":"#f5f5f5"}),children:[b&&(0,gn.jsx)("button",{ref:i,onClick:function(){a||c(!0)},style:h.hamburger,children:"\u2630"}),(0,gn.jsx)(Lg,{to:Z,children:(0,gn.jsx)("img",{src:cn,alt:"Logo",style:h.logo})}),m&&(0,gn.jsx)("span",{style:ce(ce({},h.campusName),{},{color:"white"}),children:"Super Admin"}),u&&!m&&d&&(0,gn.jsx)("span",{style:h.campusName,children:d}),(0,gn.jsx)("button",{onClick:function(){n(),C("/")},style:h.logoutButton,children:"\ub85c\uadf8 \uc544\uc6c3"}),b&&(0,gn.jsxs)("div",{ref:A,style:ce(ce({},h.sidebar),{},{transform:a?"translateX(0)":"translateX(-100%)"}),children:[(0,gn.jsxs)("div",{style:{padding:"1em 0",fontWeight:"bold",fontSize:"1.2em"},children:[s,"\ub2d8, \uc548\ub155\ud558\uc138\uc694"]}),(0,gn.jsx)(Lg,{to:"/parent",style:h.sidebarLink,onClick:function(){return c(!1)},children:"\uc608\uc57d \uc815\ubcf4"}),(0,gn.jsx)(Lg,{to:"/update-child",style:h.sidebarLink,children:"\ub4f1\ub85d\ud559\uc0dd\uc815\ubcf4"}),(0,gn.jsx)(Lg,{to:"/update-details",style:h.sidebarLink,children:"\ub0b4 \uc815\ubcf4"})]})]})},pn=function(g){var I=g.isOpen,t=g.onRequestClose,n=r((0,e.useState)({name:"",description:"",location:"",date:"",ageGroup:"",timeSlots:[],campus:""}),2),C=n[0],l=n[1],o=function(g){l(ce(ce({},C),{},ae({},g.target.name,g.target.value)))},a=function(g,e,I){l((function(t){var n=i(t.timeSlots);return n[g][e]=I,ce(ce({},t),{},{timeSlots:n})}))},c=function(){var g=se(ie().mark((function g(e){var I,n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e.preventDefault(),I=C.timeSlots.map((function(g){var e=new Date("".concat(C.date,"T").concat(g.startTime)),I=new Date("".concat(C.date,"T").concat(g.endTime));return ce(ce({},g),{},{startTime:e,endTime:I})})),n=ce(ce({},C),{},{ageGroup:C.ageGroup,timeSlots:I}),g.prev=3,console.log(n),g.next=7,ut.post("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations"),n);case 7:qt.success("Presentation created successfully!"),t(),g.next=14;break;case 11:g.prev=11,g.t0=g.catch(3),qt.error("Error creating presentation.");case 14:case"end":return g.stop()}}),g,null,[[3,11]])})));return function(e){return g.apply(this,arguments)}}();return(0,gn.jsxs)(ue(),{isOpen:I,onRequestClose:t,contentLabel:"Create Presentation",className:"presentation-modal",overlayClassName:"overlay",children:[(0,gn.jsxs)("div",{className:"modal-header",children:[(0,gn.jsx)("h2",{children:"Create Presentation"}),(0,gn.jsx)("button",{className:"close-button",onClick:t,children:"\xd7"})]}),(0,gn.jsx)("div",{className:"scrollable-content",children:(0,gn.jsxs)("form",{className:"modal-form",onSubmit:c,children:[(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)("label",{children:"Name:"}),(0,gn.jsx)("input",{type:"text",name:"name",value:C.name,onChange:o,required:!0})]}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)("label",{children:"Description:"}),(0,gn.jsx)("textarea",{className:"description-box",name:"description",value:C.description,onChange:o,required:!0})]}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)("label",{children:"Location:"}),(0,gn.jsx)("input",{type:"text",name:"location",value:C.location,onChange:o,required:!0})]}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)("label",{children:"Date:"}),(0,gn.jsx)("input",{type:"date",name:"date",value:C.date,onChange:o,required:!0})]}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)("label",{children:"Age Group:"}),(0,gn.jsxs)("select",{name:"ageGroup",value:C.ageGroup,onChange:o,required:!0,children:[(0,gn.jsx)("option",{value:"",children:"Select Age Group"}),(0,gn.jsx)("option",{value:"Kids",children:"J Lee Kids"}),(0,gn.jsx)("option",{value:"Elementary",children:"J Lee Elementary"})]})]}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)("label",{children:"Campus:"}),(0,gn.jsxs)("select",{name:"campus",value:C.campus,onChange:o,required:!0,children:[(0,gn.jsx)("option",{value:"",children:"Select Campus"}),(0,gn.jsx)("option",{value:"\uc804\uccb4",children:"\uc804\uccb4"}),(0,gn.jsx)("option",{value:"\ub3d9\ud0c4",children:"\ub3d9\ud0c4"})]})]}),(0,gn.jsx)("label",{children:"Time Slots:"}),C.timeSlots.map((function(g,e){return(0,gn.jsxs)("div",{className:"timeslot-group",children:[(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Start:"}),(0,gn.jsx)("input",{type:"time",value:g.startTime,onChange:function(g){return a(e,"startTime",g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"End:"}),(0,gn.jsx)("input",{type:"time",value:g.endTime,onChange:function(g){return a(e,"endTime",g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Max Attendees:"}),(0,gn.jsx)("input",{type:"number",placeholder:"Max Attendees",value:g.maxAttendees,onChange:function(g){return a(e,"maxAttendees",g.target.value)},required:!0})]}),(0,gn.jsx)("button",{type:"button",className:"remove-slot-btn",onClick:function(){return function(g){l((function(e){var I=i(e.timeSlots);return I.splice(g,1),ce(ce({},e),{},{timeSlots:I})}))}(e)},children:"X"})]},e)})),(0,gn.jsx)("button",{type:"button",className:"add-slot-btn",onClick:function(){l((function(g){return ce(ce({},g),{},{timeSlots:[].concat(i(g.timeSlots),[{startTime:"",endTime:"",maxAttendees:""}])})}))},children:"Add Time Slot"}),(0,gn.jsx)("button",{type:"submit",className:"submit-btn",children:"Create Presentation"})]})})]})},Gn=function(g){var I=g.presentationId,t=g.isOpen,n=g.onRequestClose,C=g.onUpdated,l=r((0,e.useState)(null),2),o=l[0],a=l[1],c=r((0,e.useState)([]),2),A=c[0],s=c[1];(0,e.useEffect)((function(){var g=function(){var g=se(ie().mark((function g(){var e,t;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(I){g.next=3;break}return console.error("Invalid presentationId:",I),g.abrupt("return");case 3:return g.prev=3,g.next=6,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/").concat(I));case 6:e=g.sent,t=e.data,a(t),s(t.timeSlots),g.next=15;break;case 12:g.prev=12,g.t0=g.catch(3),qt.error("Error fetching presentation.");case 15:case"end":return g.stop()}}),g,null,[[3,12]])})));return function(){return g.apply(this,arguments)}}();g()}),[I]);var d=function(g){var e=g.target,I=e.name,t=e.value;a((function(g){return ce(ce({},g),{},ae({},I,t))}))},u=function(g,e,I){var t=i(A);if("startTime"===e||"endTime"===e){var n=r(I.split(":"),2),C=n[0],l=n[1],o=new Date(t[g][e]);o.setUTCHours(C,l),t[g][e]=o.toISOString()}else t[g][e]=I;s(t)},m=function(){var g=se(ie().mark((function g(e){var t;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e.preventDefault(),t=ce(ce({},o),{},{timeSlots:A}),g.prev=2,g.next=5,ut.put("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/").concat(I),t);case 5:qt.success("Presentation updated successfully!"),n(),"function"===typeof C&&C(),g.next=13;break;case 10:g.prev=10,g.t0=g.catch(2),qt.error("Error updating presentation.");case 13:case"end":return g.stop()}}),g,null,[[2,10]])})));return function(e){return g.apply(this,arguments)}}();if(!o)return null;var b=function(g){var e=new Date(g),I=e.getUTCHours().toString().padStart(2,"0"),t=e.getUTCMinutes().toString().padStart(2,"0");return"".concat(I,":").concat(t)};return(0,gn.jsxs)(ue(),{isOpen:t,onRequestClose:n,contentLabel:"Update Presentation",children:[(0,gn.jsx)("h2",{children:"Update Presentation"}),(0,gn.jsxs)("form",{onSubmit:m,children:[(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Name:"}),(0,gn.jsx)("input",{type:"text",name:"name",value:o.name,onChange:d,required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Description:"}),(0,gn.jsx)("input",{type:"text",name:"description",value:o.description,onChange:d,required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Location:"}),(0,gn.jsx)("input",{type:"text",name:"location",value:o.location,onChange:d,required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Date:"}),(0,gn.jsx)("input",{type:"date",name:"date",value:o.date.slice(0,10),onChange:d,required:!0})]}),A.map((function(g,e){var I=b(g.startTime),t=b(g.endTime);return(0,gn.jsxs)("div",{children:[(0,gn.jsxs)("label",{children:["Time Slot ",e+1]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Start Time:"}),(0,gn.jsx)("input",{type:"time",value:I,onChange:function(g){return u(e,"startTime",g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"End Time:"}),(0,gn.jsx)("input",{type:"time",value:t,onChange:function(g){return u(e,"endTime",g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Max Attendees:"}),(0,gn.jsx)("input",{type:"number",value:g.maxAttendees,onChange:function(g){return u(e,"maxAttendees",g.target.value)},required:!0})]})]},e)})),(0,gn.jsx)("button",{type:"submit",children:"Update Presentation"})]}),(0,gn.jsx)(zt,{position:"top-center",autoClose:3e3})]})},yn=function(g){var I=g.isOpen,t=g.onRequestClose,n=g.phoneNumbers,C=r((0,e.useState)(""),2),l=C[0],o=C[1],a=r((0,e.useState)(""),2),c=a[0],i=a[1];(0,e.useEffect)((function(){I&&n&&n.length>0&&o(n.join(", "))}),[I,n]);var A=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",e={phoneNumbers:l.split(", "),message:c},g.next=5,ut.post("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/sms"),e,Ie());case 5:200===g.sent.status?(qt.success("SMS sent successfully!"),o(""),i(""),t("")):(console.log("Error sending SMS"),qt.error("Error sending SMS")),g.next=13;break;case 9:g.prev=9,g.t0=g.catch(0),console.error("Error sending SMS:",g.t0),qt.error("Error sending SMS");case 13:case"end":return g.stop()}}),g,null,[[0,9]])})));return function(){return g.apply(this,arguments)}}(),s=function(){o(""),i(""),t()};return(0,gn.jsx)(ue(),{isOpen:I,onRequestClose:s,contentLabel:"Send SMS Modal",overlayClassName:"ReactModal__Overlay",className:"modal-content",children:(0,gn.jsxs)("div",{className:"modal-header",children:[(0,gn.jsx)("h2",{children:"Send SMS"}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)(We,{className:"icon"}),(0,gn.jsx)("input",{className:"phone",type:"text",value:l,readOnly:!0,placeholder:"Phone number"})]}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)(Se,{className:"icon"}),(0,gn.jsx)("textarea",{className:"textarea",value:c,onChange:function(g){return i(g.target.value)},placeholder:"Message"})]}),(0,gn.jsxs)("div",{className:"buttons-group",children:[(0,gn.jsx)("button",{className:"button button-primary",onClick:A,children:"Send"}),(0,gn.jsx)("button",{className:"button button-secondary",onClick:s,children:"Cancel"})]})]})})},Bn=function(){var g=r((0,e.useState)([]),2),I=g[0],t=g[1],n=r((0,e.useState)(!1),2),C=n[0],l=n[1],o=r((0,e.useState)(null),2),a=o[0],c=o[1],i=r((0,e.useState)(!1),2),A=i[0],s=i[1],d=r((0,e.useState)([]),2),u=d[0],m=d[1],b=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/presentations"),{headers:Ie()});case 3:e=g.sent,t(e.data),g.next=10;break;case 7:g.prev=7,g.t0=g.catch(0),qt.error("Error fetching presentations.");case 10:case"end":return g.stop()}}),g,null,[[0,7]])})));return function(){return g.apply(this,arguments)}}();(0,e.useEffect)((function(){b()}),[]);var Z=function(){var g=se(ie().mark((function g(e){var I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(window.confirm("Are you sure you want to delete this presentation?")){g.next=2;break}return g.abrupt("return");case 2:return g.prev=2,I=Ie(),g.next=6,ut.delete("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/").concat(e),I);case 6:t((function(g){return g.filter((function(g){return g._id!==e}))})),qt.success("Presentation deleted successfully!"),g.next=13;break;case 10:g.prev=10,g.t0=g.catch(2),qt.error("Error deleting presentation: ".concat(g.t0.response.data.message));case 13:case"end":return g.stop()}}),g,null,[[2,10]])})));return function(e){return g.apply(this,arguments)}}(),h=function(g){var e=g.attendees?g.attendees.length:0,I=g.maxAttendees||0;return"".concat(e,"/").concat(I)};return(0,gn.jsxs)("div",{children:[(0,gn.jsx)("h2",{children:"Presentation List"}),(0,gn.jsxs)("table",{children:[(0,gn.jsx)("thead",{children:(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("th",{children:"Name"}),(0,gn.jsx)("th",{children:"Location"}),(0,gn.jsx)("th",{children:"Campus"}),(0,gn.jsx)("th",{children:"Date"}),(0,gn.jsx)("th",{children:"Start Time"}),(0,gn.jsx)("th",{children:"End Time"}),(0,gn.jsx)("th",{children:"Attendees"}),(0,gn.jsx)("th",{children:"Actions"})]})}),(0,gn.jsx)("tbody",{children:I.map((function(g){return(0,gn.jsx)(e.Fragment,{children:g.timeSlots&&g.timeSlots.map((function(e){return(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("td",{children:g.name}),(0,gn.jsx)("td",{children:g.location}),(0,gn.jsx)("td",{children:g.campus}),(0,gn.jsx)("td",{children:new Date(g.date).toLocaleDateString()}),(0,gn.jsx)("td",{children:new Date(e.startTime).toLocaleTimeString()}),(0,gn.jsx)("td",{children:new Date(e.endTime).toLocaleTimeString()}),(0,gn.jsx)("td",{children:h(e)}),(0,gn.jsxs)("td",{children:[(0,gn.jsx)("button",{onClick:function(){return Z(g._id)},children:"Delete"}),(0,gn.jsx)("button",{onClick:function(){return e=g._id,c(e),void l(!0);var e},children:"Edit"}),(0,gn.jsx)("button",{onClick:function(){return function(g){var e=I.find((function(e){return e._id===g})),t=e.timeSlots.flatMap((function(g){return g.attendees.map((function(g){var e;return null===(e=g._id)||void 0===e?void 0:e.phone}))}));m(t),s(!0)}(g._id)},children:"Send SMS"})]})]},e._id)}))},g._id)}))})]}),(0,gn.jsx)(Gn,{presentationId:a,isOpen:C,onRequestClose:function(){c(null),l(!1)},onUpdated:b}),(0,gn.jsx)(yn,{isOpen:A,onRequestClose:function(){return s(!1)},phoneNumbers:u})]})},fn=function(g){var I=g.isOpen,t=g.onRequestClose,n=localStorage.getItem("userCampus")||"",C=localStorage.getItem("userRole")||"",l=r((0,e.useState)({date:"",startTime:"",endTime:"",testGrade:"",campus:n,capacity:""}),2),o=l[0],a=l[1],c=function(g){a(ce(ce({},o),{},ae({},g.target.name,g.target.value)))},i=function(){var g=se(ie().mark((function g(e){var I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e.preventDefault(),g.prev=1,I=localStorage.getItem("token"),g.next=5,ut.post("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/timeSlots"),o,{headers:{Authorization:"Bearer ".concat(I)}});case 5:alert("Test slot created successfully!"),a({date:"",startTime:"",endTime:"",testGrade:"",campus:n,capacity:""}),g.next=12;break;case 9:g.prev=9,g.t0=g.catch(1),alert("Error creating test slot.");case 12:case"end":return g.stop()}}),g,null,[[1,9]])})));return function(e){return g.apply(this,arguments)}}();return(0,gn.jsx)(ue(),{isOpen:I,onRequestClose:t,contentLabel:"Create Test Slot",className:"testslot-modal",overlayClassName:"overlay",children:(0,gn.jsxs)("div",{className:"form-container",children:[(0,gn.jsx)("h2",{children:"Create Test Slot"}),(0,gn.jsxs)("form",{onSubmit:i,children:[(0,gn.jsxs)("div",{className:"label-input-group",children:[(0,gn.jsx)("label",{htmlFor:"date",children:"Date:"}),(0,gn.jsx)("input",{type:"date",id:"date",name:"date",value:o.date,onChange:c,required:!0})]}),(0,gn.jsxs)("div",{className:"label-input-group",children:[(0,gn.jsx)("label",{htmlFor:"startTime",children:"Start Time:"}),(0,gn.jsx)("input",{type:"time",id:"startTime",name:"startTime",value:o.startTime,onChange:c,required:!0})]}),(0,gn.jsxs)("div",{className:"label-input-group",children:[(0,gn.jsx)("label",{htmlFor:"endTime",children:"End Time:"}),(0,gn.jsx)("input",{type:"time",id:"endTime",name:"endTime",value:o.endTime,onChange:c,required:!0})]}),(0,gn.jsxs)("div",{className:"label-input-group",children:[(0,gn.jsx)("label",{htmlFor:"testGrade",children:"Age Group:"}),(0,gn.jsxs)("select",{id:"testGrade",name:"testGrade",value:o.testGrade,onChange:c,children:[(0,gn.jsx)("option",{value:"",children:"Select Grade"}),(0,gn.jsx)("option",{value:"\uc608\ube44 5\uc138",children:"\uc608\ube44 5\uc138"}),(0,gn.jsx)("option",{value:"\uc608\ube44 6\uc138",children:"\uc608\ube44 6\uc138"}),(0,gn.jsx)("option",{value:"\uc608\ube44 7\uc138",children:"\uc608\ube44 7\uc138"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \ucd08\ub4f1 1\ud559\ub144",children:"\uc608\ube44 \ucd08\ub4f1 1\ud559\ub144"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \ucd08\ub4f1 2\ud559\ub144",children:"\uc608\ube44 \ucd08\ub4f1 2\ud559\ub144"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \ucd08\ub4f1 3\ud559\ub144",children:"\uc608\ube44 \ucd08\ub4f1 3\ud559\ub144"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \ucd08\ub4f1 4\ud559\ub144",children:"\uc608\ube44 \ucd08\ub4f1 4\ud559\ub144"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \ucd08\ub4f1 5\ud559\ub144",children:"\uc608\ube44 \ucd08\ub4f1 5\ud559\ub144"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \ucd08\ub4f1 6\ud559\ub144",children:"\uc608\ube44 \ucd08\ub4f1 6\ud559\ub144"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \uc911\ub4f1 1\ud559\ub144",children:"\uc608\ube44 \uc911\ub4f1 1\ud559\ub144"}),(0,gn.jsx)("option",{value:"\uc608\ube44 \uc911\ub4f1 2\ud559\ub144",children:"\uc608\ube44 \uc911\ub4f1 2\ud559\ub144"})]})]}),(0,gn.jsxs)("div",{className:"label-input-group",children:[(0,gn.jsx)("label",{htmlFor:"campus",children:"Campus:"}),"superadmin"!==C?(0,gn.jsx)("input",{type:"text",id:"campus",name:"campus",value:o.campus,readOnly:!0}):(0,gn.jsxs)("select",{id:"campus",name:"campus",value:o.campus,onChange:c,children:[(0,gn.jsx)("option",{value:"",children:"Select Campus"}),(0,gn.jsx)("option",{value:"\ubd84\ub2f9",children:"\ubd84\ub2f9"}),(0,gn.jsx)("option",{value:"\ub3d9\ud0c4",children:"\ub3d9\ud0c4"}),(0,gn.jsx)("option",{value:"\uc218\uc9c0",children:"\uc218\uc9c0"})]})]}),(0,gn.jsxs)("div",{className:"label-input-group",children:[(0,gn.jsx)("label",{htmlFor:"capacity",children:"Capacity:"}),(0,gn.jsx)("input",{type:"number",id:"capacity",name:"capacity",value:o.capacity,onChange:c,required:!0})]}),(0,gn.jsx)("button",{type:"submit",children:"Create Slot"})]})]})})},Sn=function(g){var I=g.testSlotId,t=g.onClose,n=g.onUpdated,C=r((0,e.useState)({date:"",startTime:"",endTime:"",campus:"",capacity:""}),2),l=C[0],o=C[1];(0,e.useEffect)((function(){var g=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/timeSlots/").concat(I));case 3:e=g.sent,o(e.data),g.next=10;break;case 7:g.prev=7,g.t0=g.catch(0),alert("Error fetching test slot.");case 10:case"end":return g.stop()}}),g,null,[[0,7]])})));return function(){return g.apply(this,arguments)}}();g()}),[I]);var a=function(g){o(ce(ce({},l),{},ae({},g.target.name,g.target.value)))},c=function(){var g=se(ie().mark((function g(e){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e.preventDefault(),g.prev=1,g.next=4,ut.patch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/timeSlots/").concat(I),l);case 4:t(),n(),g.next=11;break;case 8:g.prev=8,g.t0=g.catch(1),alert("Error updating test slot.");case 11:case"end":return g.stop()}}),g,null,[[1,8]])})));return function(e){return g.apply(this,arguments)}}();return(0,gn.jsx)("div",{children:(0,gn.jsxs)(ue(),{isOpen:!0,onRequestClose:t,contentLabel:"Update Test Slot",children:[(0,gn.jsx)("h2",{children:"Update Test Slot"}),(0,gn.jsxs)("form",{onSubmit:c,children:[(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Date:"}),(0,gn.jsx)("input",{type:"date",name:"date",value:l.date,onChange:a,required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Start Time:"}),(0,gn.jsx)("input",{type:"time",name:"startTime",value:l.startTime,onChange:a,required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"End Time:"}),(0,gn.jsx)("input",{type:"time",name:"endTime",value:l.endTime,onChange:a,required:!0})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Campus:"}),(0,gn.jsxs)("select",{name:"campus",value:l.campus,onChange:a,children:[(0,gn.jsx)("option",{value:"Suji",children:"Suji"}),(0,gn.jsx)("option",{value:"Dongtan",children:"Dongtan"}),(0,gn.jsx)("option",{value:"Bundang",children:"Bundang"})]})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Capacity:"}),(0,gn.jsx)("input",{type:"number",name:"capacity",value:l.capacity,onChange:a,required:!0})]}),(0,gn.jsx)("button",{type:"submit",children:"Update Slot"})]})]})})},Wn=function(){var g=r((0,e.useState)([]),2),I=g[0],t=g[1],n=r((0,e.useState)(null),2),C=n[0],l=n[1];(0,e.useEffect)((function(){var g=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/timeSlots/admin"));case 3:e=g.sent,t(e.data),g.next=10;break;case 7:g.prev=7,g.t0=g.catch(0),qt.error("Error fetching test slots.");case 10:case"end":return g.stop()}}),g,null,[[0,7]])})));return function(){return g.apply(this,arguments)}}();g()}),[]);var o=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/timeSlots/admin"));case 3:e=g.sent,t(e.data),qt.success("Test slot list updated!"),g.next=11;break;case 8:g.prev=8,g.t0=g.catch(0),qt.error("Error updating test slot list.");case 11:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(){return g.apply(this,arguments)}}(),a=function(){var g=se(ie().mark((function g(e){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.delete("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/timeSlots/").concat(e));case 3:t((function(g){return g.filter((function(g){return g._id!==e}))})),qt.success("Test slot deleted successfully!"),g.next=10;break;case 7:g.prev=7,g.t0=g.catch(0),qt.error("Error deleting test slot.");case 10:case"end":return g.stop()}}),g,null,[[0,7]])})));return function(e){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{className:"timeslots",children:[(0,gn.jsx)("h2",{children:"Test Slot List"}),(0,gn.jsxs)("table",{children:[(0,gn.jsx)("thead",{children:(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("th",{children:"Campus"}),(0,gn.jsx)("th",{children:"Age Group"}),(0,gn.jsx)("th",{children:"Date"}),(0,gn.jsx)("th",{children:"Start Time"}),(0,gn.jsx)("th",{children:"End Time"}),(0,gn.jsx)("th",{children:"Capacity"}),(0,gn.jsx)("th",{children:"Actions"})]})}),(0,gn.jsx)("tbody",{children:I.map((function(g){return(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("td",{children:g.campus}),(0,gn.jsx)("td",{children:g.testGrade}),(0,gn.jsx)("td",{children:new Date(g.date).toLocaleDateString()}),(0,gn.jsx)("td",{children:g.startTime}),(0,gn.jsx)("td",{children:g.endTime}),(0,gn.jsxs)("td",{children:[g.booked||0,"/",g.capacity]}),(0,gn.jsxs)("td",{children:[(0,gn.jsx)("button",{onClick:function(){return function(g){l(g)}(g)},children:"Edit"}),(0,gn.jsx)("button",{onClick:function(){return a(g._id)},children:"Delete"})]})]},g._id)}))})]}),C&&(0,gn.jsx)(Sn,{testSlotId:C._id,onClose:function(){l(null)},onUpdated:o})]})},Vn=function(){var g=r((0,e.useState)([]),2),I=g[0],t=g[1],n=r((0,e.useState)([]),2),C=n[0],l=n[1],o=r((0,e.useState)(!1),2),a=o[0],c=o[1],A=r((0,e.useState)([]),2),s=A[0],d=A[1],u=r((0,e.useState)(""),2),m=u[0],b=u[1],Z=r((0,e.useState)(""),2),h=Z[0],p=Z[1];var G=function(){var g=se(ie().mark((function g(e){var n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,ut.delete("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings/admin/delete/").concat(e),Ie());case 4:200===g.sent.status?(n=I.filter((function(g){return g._id!==e})),t(n),qt.success("Booking successfully cancelled.")):(console.log("Error deleting booking"),qt.error("Error deleting booking.")),g.next=12;break;case 8:g.prev=8,g.t0=g.catch(0),console.error(g.t0),qt.error("Operation failed.");case 12:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(e){return g.apply(this,arguments)}}(),y=function(){var g=se(ie().mark((function g(e){var n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,ut.patch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings/payment/").concat(e),{},Ie());case 4:200===g.sent.status?(n=I.map((function(g){return g._id===e?ce(ce({},g),{},{paid:!0}):g})),t(n),qt.success("Booking marked as paid.")):(console.log("Error updating booking"),qt.error("Error updating booking.")),g.next=12;break;case 8:g.prev=8,g.t0=g.catch(0),console.log("Error updating booking:",g.t0),qt.error("Error updating the booking. ".concat(g.t0.message));case 12:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(e){return g.apply(this,arguments)}}();return(0,e.useEffect)((function(){b(localStorage.getItem("userCampus")),p(localStorage.getItem("userRole"));var g=function(){var g=se(ie().mark((function g(){var e,I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings"));case 3:e=g.sent,"superadmin"===h?t(e.data):(I=e.data.filter((function(g){return g.testSlot&&g.testSlot.campus===m})),t(I)),g.next=10;break;case 7:g.prev=7,g.t0=g.catch(0),console.log("Error fetching bookings:",g.t0);case 10:case"end":return g.stop()}}),g,null,[[0,7]])})));return function(){return g.apply(this,arguments)}}();g()}),[m,h]),(0,gn.jsxs)("div",{children:[(0,gn.jsx)(yn,{isOpen:a,onRequestClose:function(){c(!1),l([]),d([])},phoneNumber:C.length>0?C[0]:"",phoneNumbers:[].concat(i(C),i(s.map((function(g){return g.phone}))))},a),(0,gn.jsx)("h2",{children:"Booking List"}),(0,gn.jsxs)("table",{children:[(0,gn.jsx)("thead",{children:(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("th",{children:"Child"}),(0,gn.jsx)("th",{children:"Test Grade"}),(0,gn.jsx)("th",{children:"DOB"}),(0,gn.jsx)("th",{children:"Gender"}),(0,gn.jsx)("th",{children:"Campus"}),(0,gn.jsx)("th",{children:"Test Slot"}),(0,gn.jsx)("th",{children:"Date"}),(0,gn.jsx)("th",{children:"Parent Number"}),(0,gn.jsx)("th",{children:"Actions"}),(0,gn.jsx)("th",{children:"Paid"})]})}),(0,gn.jsx)("tbody",{children:I.map((function(g){return(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("td",{children:g.child&&g.child.name}),(0,gn.jsx)("td",{children:g.child&&g.child.testGrade}),(0,gn.jsx)("td",{children:g.child&&new Date(g.child.dateOfBirth).toLocaleDateString()}),(0,gn.jsx)("td",{children:g.child&&g.child.gender}),(0,gn.jsx)("td",{children:g.testSlot&&g.testSlot.campus}),(0,gn.jsx)("td",{children:g.testSlot&&"".concat(g.testSlot.startTime," - ").concat(g.testSlot.endTime)}),(0,gn.jsx)("td",{children:g.testSlot&&new Date(g.testSlot.date).toLocaleDateString()}),(0,gn.jsx)("td",{children:g.parent&&g.parent.phone}),(0,gn.jsx)("td",{children:(0,gn.jsxs)("select",{onChange:function(e){return function(g,e){switch(g.target.value){case"cancel":window.confirm("Are you sure you want to cancel this record?")&&G(e._id);break;case"paid":window.confirm("Are you sure you want to mark this as paid?")&&y(e._id);break;case"sms":l((function(g){return[].concat(i(g),[e.parent.phone])})),c(!0)}}(e,g)},children:[(0,gn.jsx)("option",{value:"",children:"Select an action"}),(0,gn.jsx)("option",{value:"cancel",children:"Cancel"}),(0,gn.jsx)("option",{value:"paid",children:"Paid"}),(0,gn.jsx)("option",{value:"sms",children:"Send SMS"})]})}),(0,gn.jsx)("td",{children:g&&g.paid?"Yes":"No"})]},g._id)}))})]})]})},vn=function(){var g=r((0,e.useState)([]),2),I=g[0],t=g[1],n=r((0,e.useState)(!1),2),C=n[0],l=n[1],o=r((0,e.useState)(null),2),a=o[0],c=o[1],i=localStorage.getItem("userCampus"),A=localStorage.getItem("userRole"),s=r((0,e.useState)({}),2),d=s[0],u=s[1],m=function(){var g=se(ie().mark((function g(){var e,I,t,n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/exportToExcel"),Ie());case 3:e=g.sent,I=new Blob([e.data],{type:"text/csv"}),t=window.URL.createObjectURL(I),(n=document.createElement("a")).href=t,n.setAttribute("download","attendees_data.csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n),g.next=18;break;case 14:g.prev=14,g.t0=g.catch(0),console.error("Error exporting data: ",g.t0),alert("Error exporting data. Please try again.");case 18:case"end":return g.stop()}}),g,null,[[0,14]])})));return function(){return g.apply(this,arguments)}}(),b=function(){var g=se(ie().mark((function g(e,I){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.patch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/").concat(e,"/attendedPresentation"),{attended:I});case 3:200!==g.sent.status?(u((function(g){return ce(ce({},g),{},ae({},e,!I))})),alert("There was an error updating the attendance status.")):qt.success("Attendance status updated successfully!"),g.next=11;break;case 7:g.prev=7,g.t0=g.catch(0),console.error("Error marking attendance: ",g.t0),alert("Error marking attendance. Please try again.");case 11:case"end":return g.stop()}}),g,null,[[0,7]])})));return function(e,I){return g.apply(this,arguments)}}();return(0,e.useEffect)((function(){var g=!0,e=function(){var e=se(ie().mark((function e(){var I,n,C;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ut.get("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/presentations/allAttendeesInTimeSlots"),Ie());case 3:I=e.sent,g&&(n=I.data.filter((function(g){return g.timeSlots.some((function(g){return g.attendees.some((function(g){return g.campus===i||"superadmin"===A}))}))})),t(n),C={},n.forEach((function(g){g.timeSlots.forEach((function(g){g.attendees.forEach((function(g){C[g._id]=g.attendedPresentation}))}))})),u(C)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g&&console.error("Error fetching data: ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){g=!1}}),[]),(0,gn.jsxs)("div",{className:"attendee-list",children:[(0,gn.jsx)("button",{onClick:m,children:"Export to Excel"}),(0,gn.jsxs)("table",{children:[(0,gn.jsx)("thead",{children:(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("th",{children:"Children Names"}),(0,gn.jsx)("th",{children:"Gender"}),(0,gn.jsx)("th",{children:"Children Test Grades"}),(0,gn.jsx)("th",{children:"Phone Number"}),(0,gn.jsx)("th",{children:"Campus"}),(0,gn.jsx)("th",{children:"Presentation Booked"}),(0,gn.jsx)("th",{children:"Booking Time"}),(0,gn.jsx)("th",{children:"Booking Creation Time"}),(0,gn.jsx)("th",{children:"Action"}),(0,gn.jsx)("th",{children:"Attendance"})]})}),(0,gn.jsx)("tbody",{children:I&&I.map((function(g){return g.timeSlots&&g.timeSlots.map((function(e){return e.attendees&&e.attendees.map((function(I){return I.children&&I.children.map((function(t,n){return(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("td",{children:t.name}),(0,gn.jsx)("td",{children:t.gender}),(0,gn.jsx)("td",{children:t.testGrade}),(0,gn.jsx)("td",{children:I.phone}),(0,gn.jsx)("td",{children:I.campus}),(0,gn.jsx)("td",{children:g.presentationName}),(0,gn.jsx)("td",{children:new Date(e.startTime).toLocaleTimeString()}),(0,gn.jsx)("td",{children:new Date(I.bookedAt).toLocaleString()}),(0,gn.jsx)("td",{children:(0,gn.jsx)("button",{onClick:function(){return g=I.phone,c(g),void l(!0);var g},children:"Send SMS"})}),(0,gn.jsx)("td",{children:(0,gn.jsx)("input",{type:"checkbox",checked:d[I._id]||!1,onChange:function(g){return function(g,e){var I=g.target.checked;u((function(g){return ce(ce({},g),{},ae({},e,I))})),b(e,I)}(g,I._id)}})})]},n)}))}))}))}))})]}),(0,gn.jsx)(yn,{isOpen:C,onRequestClose:function(){c(null),l(!1)},phoneNumbers:[a]})]})};var Rn=function(){var g=r((0,e.useState)(""),2),I=g[0],t=g[1],n=r((0,e.useState)(""),2),C=n[0],l=n[1],o=r((0,e.useState)(""),2),a=o[0],c=o[1],i=r((0,e.useState)(""),2),A=i[0],s=i[1],d=r((0,e.useState)("admin"),2),u=d[0],m=d[1],b=r((0,e.useState)(""),2),Z=b[0],h=b[1],p=function(){var g=se(ie().mark((function g(e){var t,n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e.preventDefault(),g.prev=1,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=5,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:I,email:C,password:a,phone:A,role:u,campus:Z})});case 5:if(!(t=g.sent).ok){g.next=10;break}qt.success("New admin created!"),g.next=14;break;case 10:return g.next=12,t.json();case 12:n=g.sent,console.error(n);case 14:g.next=19;break;case 16:g.prev=16,g.t0=g.catch(1),console.error(g.t0);case 19:case"end":return g.stop()}}),g,null,[[1,16]])})));return function(e){return g.apply(this,arguments)}}();return(0,gn.jsx)("div",{className:"form-container",children:(0,gn.jsxs)("form",{className:"form",onSubmit:p,children:[(0,gn.jsx)("h1",{className:"form-title",children:"Register"}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"name",children:"Name:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",id:"name",value:I,onChange:function(g){return t(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"email",children:"Email:"}),(0,gn.jsx)("input",{className:"form-input",type:"email",id:"email",value:C,onChange:function(g){return l(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"password",children:"Password:"}),(0,gn.jsx)("input",{className:"form-input",type:"password",id:"password",value:a,onChange:function(g){return c(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"phone",children:"Phone:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",id:"phone",value:A,onChange:function(g){return s(g.target.value)},required:!0})]}),(0,gn.jsxs)("label",{children:["Campus",(0,gn.jsxs)("select",{value:Z,onChange:function(g){return h(g.target.value)},required:!0,children:[(0,gn.jsx)("option",{value:"",children:"--\uc635\uc158\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694--"}),(0,gn.jsx)("option",{value:"\uc218\uc9c0",children:"\uc218\uc9c0"}),(0,gn.jsx)("option",{value:"\ub3d9\ud0c4",children:"\ub3d9\ud0c4"}),(0,gn.jsx)("option",{value:"\ubd84\ub2f9",children:"\ubd84\ub2f9"})]})]}),(0,gn.jsx)("label",{className:"form-label",htmlFor:"role",children:"Role:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",id:"role",value:u,onChange:function(g){return m(g.target.value)},disabled:!0}),(0,gn.jsx)("div",{className:"form-field",children:(0,gn.jsx)("button",{className:"form-button",type:"submit",children:"Add Admin"})})]})})};var kn=function(g){var I=g.admin,t=g.onClose,n=g.onSave,C=r((0,e.useState)({name:I.name,email:I.email,role:I.role,campus:I.campus}),2),l=C[0],o=C[1],a=function(g){var e=g.target,I=e.name,t=e.value;o((function(g){return ce(ce({},g),{},ae({},I,t))}))};return(0,gn.jsxs)("div",{children:[(0,gn.jsx)("div",{style:{position:"fixed",top:"0%",left:"0%",width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:999},onClick:t}),(0,gn.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",zIndex:1e3,width:"400px",borderRadius:"5px"},children:[(0,gn.jsx)("h2",{children:"Edit Admin"}),(0,gn.jsxs)("label",{children:["Name:",(0,gn.jsx)("input",{name:"name",value:l.name,onChange:a})]}),(0,gn.jsxs)("label",{children:["Email:",(0,gn.jsx)("input",{name:"email",value:l.email,onChange:a})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("button",{onClick:function(){return n(l)},children:"Save Changes"}),(0,gn.jsx)("button",{onClick:t,children:"Close"})]})]})]})};var Xn=function(){var g=r((0,e.useState)([]),2),I=g[0],t=g[1],n=r((0,e.useState)(null),2),C=n[0],l=n[1];(0,e.useEffect)((function(){function g(){return(g=se(ie().mark((function g(){var e,I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/admins"));case 2:return e=g.sent,g.next=5,e.json();case 5:I=g.sent,t(I);case 7:case"end":return g.stop()}}),g)})))).apply(this,arguments)}!function(){g.apply(this,arguments)}()}),[]);var o=function(){var g=se(ie().mark((function g(e){var I,n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/admin/").concat(C._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:if(!(I=g.sent).ok){g.next=12;break}return g.next=6,I.json();case 6:n=g.sent,qt.success("Admin data updated successfully!"),t((function(g){return g.map((function(g){return g._id===n._id?n:g}))})),l(null),g.next=12;break;case 12:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}(),a=function(){var g=se(ie().mark((function g(e){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!window.confirm("Are you sure you want to delete this admin?")){g.next=6;break}return g.next=4,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/admin/").concat(e),{method:"DELETE"});case 4:g.sent.ok?(t((function(g){return g.filter((function(g){return g._id!==e}))})),qt.success("Admin deleted successfully!")):qt.error("An error occurred while deleting the admin.");case 6:case"end":return g.stop()}}),g)})));return function(e){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{children:[(0,gn.jsx)("h2",{children:"Admin List"}),(0,gn.jsxs)("table",{children:[(0,gn.jsx)("thead",{children:(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("th",{children:"Name"}),(0,gn.jsx)("th",{children:"Email"}),(0,gn.jsx)("th",{children:"Role"}),(0,gn.jsx)("th",{children:"Campus"}),(0,gn.jsx)("th",{children:"Actions"})]})}),(0,gn.jsx)("tbody",{children:I.map((function(g){return(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("td",{children:g.name}),(0,gn.jsx)("td",{children:g.email}),(0,gn.jsx)("td",{children:g.role}),(0,gn.jsx)("td",{children:g.campus}),(0,gn.jsxs)("td",{children:[(0,gn.jsx)("button",{onClick:function(){return function(g){l(g)}(g)},children:"Edit"}),(0,gn.jsx)("button",{onClick:function(){return a(g._id)},children:"Delete"})]})]},g._id)}))})]}),C&&(0,gn.jsx)(kn,{admin:C,onClose:function(){l(null)},onSave:o})]})},Jn=function(g){var I=g.isOpen,t=g.onRequestClose,n=r((0,e.useState)(""),2),C=n[0],l=n[1],o=r((0,e.useState)(""),2),a=o[0],c=o[1],i=r((0,e.useState)(""),2),A=i[0],s=i[1],d=function(){var g=se(ie().mark((function g(){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,ut.post("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookingPriority"),{priorityStart:C,priorityEnd:a});case 4:g.sent.data&&(s("Booking priority times set successfully!"),setTimeout(t,2e3)),g.next=11;break;case 8:g.prev=8,g.t0=g.catch(0),s("Failed to set booking priority times. Please try again.");case 11:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(){return g.apply(this,arguments)}}();return(0,gn.jsxs)(ue(),{isOpen:I,onRequestClose:t,contentLabel:"Booking Priority Modal",className:"priority-modal",overlayClassName:"overlay",children:[(0,gn.jsxs)("div",{className:"modal-header",children:[(0,gn.jsx)("h2",{children:"Set Booking Priority Times"}),(0,gn.jsx)("button",{className:"close-button",onClick:t,children:"\xd7"})]}),(0,gn.jsxs)("div",{className:"modal-body",children:[(0,gn.jsxs)("label",{children:["Start Time:",(0,gn.jsx)("input",{type:"datetime-local",value:C,onChange:function(g){return l(g.target.value)}})]}),(0,gn.jsxs)("label",{children:["End Time:",(0,gn.jsx)("input",{type:"datetime-local",value:a,onChange:function(g){return c(g.target.value)}})]})]}),A&&(0,gn.jsx)("div",{className:"modal-message",children:A}),(0,gn.jsx)("div",{className:"modal-footer",children:(0,gn.jsx)("button",{className:"submit-button",onClick:d,children:"Submit"})})]})},Yn=I(176),Hn=I.n(Yn),wn=function(){};function Nn(g,e){return void 0!==g[e]}function Kn(g){return"default"+g.charAt(0).toUpperCase()+g.substr(1)}function Fn(){return Fn=Object.assign?Object.assign.bind():function(g){for(var e=1;e<arguments.length;e++){var I=arguments[e];for(var t in I)Object.prototype.hasOwnProperty.call(I,t)&&(g[t]=I[t])}return g},Fn.apply(this,arguments)}var xn=I(688);var En=I(7),zn=I.n(En),Mn="milliseconds",Un="seconds",Dn="minutes",Qn="hours",Ln="day",Tn="week",jn="month",On="year",Pn="decade",qn="century",_n={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,day:864e5,week:6048e5},$n={month:1,year:12,decade:120,century:1200};function gC(g){return g%4===0&&g%100!==0||g%400===0?29:28}function eC(g,e,I){switch(g=new Date(g),I){case Mn:case Un:case Dn:case Qn:case Ln:case Tn:return function(g,e){var I=new Date(+g+e);return function(g,e){var I=g.getTimezoneOffset(),t=e.getTimezoneOffset();return new Date(+e+(t-I)*_n.minutes)}(g,I)}(g,e*_n[I]);case jn:case On:case Pn:case qn:return function(g,e){var I=g.getFullYear(),t=g.getMonth(),n=g.getDate(),C=12*I+t+e,l=Math.trunc(C/12),o=C%12,a=Math.min(n,function(g){return[31,gC(g),31,30,31,30,31,31,30,31,30,31]}(l)[o]),r=new Date(g);return r.setFullYear(l),r.setDate(1),r.setMonth(o),r.setDate(a),r}(g,e*$n[I])}throw new TypeError('Invalid units: "'+I+'"')}function IC(g,e,I){return eC(g,-e,I)}function tC(g,e,I){switch(g=new Date(g),e){case qn:case Pn:case On:g=pC(g,0);case jn:g=hC(g,1);case Tn:case Ln:g=bC(g,0);case Qn:g=mC(g,0);case Dn:g=uC(g,0);case Un:g=dC(g,0)}return e===Pn&&(g=IC(g,GC(g)%10,"year")),e===qn&&(g=IC(g,GC(g)%100,"year")),e===Tn&&(g=function(g,e,I){var t=(ZC(g)+7-(I||0))%7;return void 0===e?t:eC(g,e-t,Ln)}(g,0,I)),g}function nC(g,e,I){switch(g=tC(g=new Date(g),e,I),e){case qn:case Pn:case On:case jn:case Tn:(g=IC(g=eC(g,1,e),1,Ln)).setHours(23,59,59,999);break;case Ln:g.setHours(23,59,59,999);break;case Qn:case Dn:case Un:g=IC(g=eC(g,1,e),1,Mn)}return g}var CC=BC((function(g,e){return g===e})),lC=BC((function(g,e){return g!==e})),oC=BC((function(g,e){return g>e})),aC=BC((function(g,e){return g>=e})),rC=BC((function(g,e){return g<e})),cC=BC((function(g,e){return g<=e}));function iC(){return new Date(Math.min.apply(Math,arguments))}function AC(){return new Date(Math.max.apply(Math,arguments))}function sC(g,e,I,t){return t=t||"day",(!e||aC(g,e,t))&&(!I||cC(g,I,t))}var dC=yC("Milliseconds"),uC=yC("Seconds"),mC=yC("Minutes"),bC=yC("Hours"),ZC=yC("Day"),hC=yC("Date"),pC=yC("Month"),GC=yC("FullYear");function yC(g){var e=function(g){switch(g){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(g);return function(I,t){if(void 0===t)return I["get"+g]();var n=new Date(I);return n["set"+g](t),e&&n["get"+g]()!=t&&("Hours"===g||t>=e&&n.getHours()-I.getHours()<Math.floor(t/e))&&n["set"+g](t+e),n}}function BC(g){return function(e,I,t){return g(+tC(e,t),+tC(I,t))}}var fC=function(g,e,I){var t=-1,n=g.length;e<0&&(e=-e>n?0:n+e),(I=I>n?n:I)<0&&(I+=n),n=e>I?0:I-e>>>0,e>>>=0;for(var C=Array(n);++t<n;)C[t]=g[t+e];return C};var SC=function(g,e){return g===e||g!==g&&e!==e},WC="object"==typeof global&&global&&global.Object===Object&&global,VC="object"==typeof self&&self&&self.Object===Object&&self,vC=WC||VC||Function("return this")(),RC=vC.Symbol,kC=Object.prototype,XC=kC.hasOwnProperty,JC=kC.toString,YC=RC?RC.toStringTag:void 0;var HC=function(g){var e=XC.call(g,YC),I=g[YC];try{g[YC]=void 0;var t=!0}catch(Og){}var n=JC.call(g);return t&&(e?g[YC]=I:delete g[YC]),n},wC=Object.prototype.toString;var NC=function(g){return wC.call(g)},KC=RC?RC.toStringTag:void 0;var FC=function(g){return null==g?void 0===g?"[object Undefined]":"[object Null]":KC&&KC in Object(g)?HC(g):NC(g)};var xC=function(g){var e=typeof g;return null!=g&&("object"==e||"function"==e)};var EC=function(g){if(!xC(g))return!1;var e=FC(g);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var zC=function(g){return"number"==typeof g&&g>-1&&g%1==0&&g<=9007199254740991};var MC=function(g){return null!=g&&zC(g.length)&&!EC(g)},UC=/^(?:0|[1-9]\d*)$/;var DC=function(g,e){var I=typeof g;return!!(e=null==e?9007199254740991:e)&&("number"==I||"symbol"!=I&&UC.test(g))&&g>-1&&g%1==0&&g<e};var QC=function(g,e,I){if(!xC(I))return!1;var t=typeof e;return!!("number"==t?MC(I)&&DC(e,I.length):"string"==t&&e in I)&&SC(I[e],g)},LC=/\s/;var TC=function(g){for(var e=g.length;e--&&LC.test(g.charAt(e)););return e},jC=/^\s+/;var OC=function(g){return g?g.slice(0,TC(g)+1).replace(jC,""):g};var PC=function(g){return null!=g&&"object"==typeof g};var qC=function(g){return"symbol"==typeof g||PC(g)&&"[object Symbol]"==FC(g)},_C=/^[-+]0x[0-9a-f]+$/i,$C=/^0b[01]+$/i,gl=/^0o[0-7]+$/i,el=parseInt;var Il=function(g){if("number"==typeof g)return g;if(qC(g))return NaN;if(xC(g)){var e="function"==typeof g.valueOf?g.valueOf():g;g=xC(e)?e+"":e}if("string"!=typeof g)return 0===g?g:+g;g=OC(g);var I=$C.test(g);return I||gl.test(g)?el(g.slice(2),I?2:8):_C.test(g)?NaN:+g},tl=1/0;var nl=function(g){return g?(g=Il(g))===tl||g===-1/0?17976931348623157e292*(g<0?-1:1):g===g?g:0:0===g?g:0};var Cl=function(g){var e=nl(g),I=e%1;return e===e?I?e-I:e:0},ll=Math.ceil,ol=Math.max;var al=function(g,e,I){e=(I?QC(g,e,I):void 0===e)?1:ol(Cl(e),0);var t=null==g?0:g.length;if(!t||e<1)return[];for(var n=0,C=0,l=Array(ll(t/e));n<t;)l[C++]=fC(g,n,n+=e);return l};function rl(g){return g&&g.ownerDocument||document}function cl(g,e){return function(g){var e=rl(g);return e&&e.defaultView||window}(g).getComputedStyle(g,e)}var il=/([A-Z])/g;var Al=/^ms-/;function sl(g){return function(g){return g.replace(il,"-$1").toLowerCase()}(g).replace(Al,"-ms-")}var dl=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;var ul=function(g,e){var I="",t="";if("string"===typeof e)return g.style.getPropertyValue(sl(e))||cl(g).getPropertyValue(sl(e));Object.keys(e).forEach((function(n){var C=e[n];C||0===C?!function(g){return!(!g||!dl.test(g))}(n)?I+=sl(n)+": "+C+";":t+=n+"("+C+") ":g.style.removeProperty(sl(n))})),t&&(I+="transform: "+t+";"),g.style.cssText+=";"+I};function ml(g,e){return g.contains?g.contains(e):g.compareDocumentPosition?g===e||!!(16&g.compareDocumentPosition(e)):void 0}function bl(g){return"window"in g&&g.window===g?g:"nodeType"in(e=g)&&e.nodeType===document.DOCUMENT_NODE&&g.defaultView||!1;var e}function Zl(g){var e="pageXOffset"===g?"scrollLeft":"scrollTop";return function(I,t){var n=bl(I);if(void 0===t)return n?n[g]:I[e];n?n.scrollTo(n[g],t):I[e]=t}}var hl=Zl("pageXOffset"),pl=Zl("pageYOffset");function Gl(g){var e=rl(g),I={top:0,left:0,height:0,width:0},t=e&&e.documentElement;return t&&ml(t,g)?(void 0!==g.getBoundingClientRect&&(I=g.getBoundingClientRect()),I={top:I.top+pl(t)-(t.clientTop||0),left:I.left+hl(t)-(t.clientLeft||0),width:I.width,height:I.height}):I}var yl=function(g){return!!g&&"offsetParent"in g};function Bl(g,e){var I,t={top:0,left:0};if("fixed"===ul(g,"position"))I=g.getBoundingClientRect();else{var n=e||function(g){for(var e=rl(g),I=g&&g.offsetParent;yl(I)&&"HTML"!==I.nodeName&&"static"===ul(I,"position");)I=I.offsetParent;return I||e.documentElement}(g);I=Gl(g),"html"!==function(g){return g.nodeName&&g.nodeName.toLowerCase()}(n)&&(t=Gl(n));var C=String(ul(n,"borderTopWidth")||0);t.top+=parseInt(C,10)-pl(n)||0;var l=String(ul(n,"borderLeftWidth")||0);t.left+=parseInt(l,10)-hl(n)||0}var o=String(ul(g,"marginTop")||0),a=String(ul(g,"marginLeft")||0);return Fn({},I,{top:I.top-t.top-(parseInt(o,10)||0),left:I.left-t.left-(parseInt(a,10)||0)})}var fl=!("undefined"===typeof window||!window.document||!window.document.createElement),Sl=(new Date).getTime();var Wl="clearTimeout",Vl=function(g){var e=(new Date).getTime(),I=Math.max(0,16-(e-Sl)),t=setTimeout(g,I);return Sl=e,t},vl=function(g,e){return g+(g?e[0].toUpperCase()+e.substr(1):e)+"AnimationFrame"};fl&&["","webkit","moz","o","ms"].some((function(g){var e=vl(g,"request");return e in window&&(Wl=vl(g,"cancel"),Vl=function(g){return window[e](g)}),!!Vl}));var Rl=function(g){"function"===typeof window[Wl]&&window[Wl](g)},kl=Vl,Xl=I(164);function Jl(){return(0,e.useState)(null)}var Yl=function(g){return g&&"function"!==typeof g?function(e){g.current=e}:g};var Hl=function(g,I){return(0,e.useMemo)((function(){return function(g,e){var I=Yl(g),t=Yl(e);return function(g){I&&I(g),t&&t(g)}}(g,I)}),[g,I])},wl="top",Nl="bottom",Kl="right",Fl="left",xl="auto",El=[wl,Nl,Kl,Fl],zl="start",Ml="end",Ul="clippingParents",Dl="viewport",Ql="popper",Ll="reference",Tl=El.reduce((function(g,e){return g.concat([e+"-"+zl,e+"-"+Ml])}),[]),jl=[].concat(El,[xl]).reduce((function(g,e){return g.concat([e,e+"-"+zl,e+"-"+Ml])}),[]),Ol=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];var Pl=function(g){var I=function(){var g=(0,e.useRef)(!0),I=(0,e.useRef)((function(){return g.current}));return(0,e.useEffect)((function(){return g.current=!0,function(){g.current=!1}}),[]),I.current}();return[g[0],(0,e.useCallback)((function(e){if(I())return g[1](e)}),[I,g[1]])]};function ql(g){return g.split("-")[0]}function _l(g){if(null==g)return window;if("[object Window]"!==g.toString()){var e=g.ownerDocument;return e&&e.defaultView||window}return g}function $l(g){return g instanceof _l(g).Element||g instanceof Element}function go(g){return g instanceof _l(g).HTMLElement||g instanceof HTMLElement}function eo(g){return"undefined"!==typeof ShadowRoot&&(g instanceof _l(g).ShadowRoot||g instanceof ShadowRoot)}var Io=Math.max,to=Math.min,no=Math.round;function Co(){var g=navigator.userAgentData;return null!=g&&g.brands&&Array.isArray(g.brands)?g.brands.map((function(g){return g.brand+"/"+g.version})).join(" "):navigator.userAgent}function lo(){return!/^((?!chrome|android).)*safari/i.test(Co())}function oo(g,e,I){void 0===e&&(e=!1),void 0===I&&(I=!1);var t=g.getBoundingClientRect(),n=1,C=1;e&&go(g)&&(n=g.offsetWidth>0&&no(t.width)/g.offsetWidth||1,C=g.offsetHeight>0&&no(t.height)/g.offsetHeight||1);var l=($l(g)?_l(g):window).visualViewport,o=!lo()&&I,a=(t.left+(o&&l?l.offsetLeft:0))/n,r=(t.top+(o&&l?l.offsetTop:0))/C,c=t.width/n,i=t.height/C;return{width:c,height:i,top:r,right:a+c,bottom:r+i,left:a,x:a,y:r}}function ao(g){var e=oo(g),I=g.offsetWidth,t=g.offsetHeight;return Math.abs(e.width-I)<=1&&(I=e.width),Math.abs(e.height-t)<=1&&(t=e.height),{x:g.offsetLeft,y:g.offsetTop,width:I,height:t}}function ro(g,e){var I=e.getRootNode&&e.getRootNode();if(g.contains(e))return!0;if(I&&eo(I)){var t=e;do{if(t&&g.isSameNode(t))return!0;t=t.parentNode||t.host}while(t)}return!1}function co(g){return g?(g.nodeName||"").toLowerCase():null}function io(g){return _l(g).getComputedStyle(g)}function Ao(g){return["table","td","th"].indexOf(co(g))>=0}function so(g){return(($l(g)?g.ownerDocument:g.document)||window.document).documentElement}function uo(g){return"html"===co(g)?g:g.assignedSlot||g.parentNode||(eo(g)?g.host:null)||so(g)}function mo(g){return go(g)&&"fixed"!==io(g).position?g.offsetParent:null}function bo(g){for(var e=_l(g),I=mo(g);I&&Ao(I)&&"static"===io(I).position;)I=mo(I);return I&&("html"===co(I)||"body"===co(I)&&"static"===io(I).position)?e:I||function(g){var e=/firefox/i.test(Co());if(/Trident/i.test(Co())&&go(g)&&"fixed"===io(g).position)return null;var I=uo(g);for(eo(I)&&(I=I.host);go(I)&&["html","body"].indexOf(co(I))<0;){var t=io(I);if("none"!==t.transform||"none"!==t.perspective||"paint"===t.contain||-1!==["transform","perspective"].indexOf(t.willChange)||e&&"filter"===t.willChange||e&&t.filter&&"none"!==t.filter)return I;I=I.parentNode}return null}(g)||e}function Zo(g){return["top","bottom"].indexOf(g)>=0?"x":"y"}function ho(g,e,I){return Io(g,to(e,I))}function po(g){return Object.assign({},{top:0,right:0,bottom:0,left:0},g)}function Go(g,e){return e.reduce((function(e,I){return e[I]=g,e}),{})}var yo={name:"arrow",enabled:!0,phase:"main",fn:function(g){var e,I=g.state,t=g.name,n=g.options,C=I.elements.arrow,l=I.modifiersData.popperOffsets,o=ql(I.placement),a=Zo(o),r=[Fl,Kl].indexOf(o)>=0?"height":"width";if(C&&l){var c=function(g,e){return po("number"!==typeof(g="function"===typeof g?g(Object.assign({},e.rects,{placement:e.placement})):g)?g:Go(g,El))}(n.padding,I),i=ao(C),A="y"===a?wl:Fl,s="y"===a?Nl:Kl,d=I.rects.reference[r]+I.rects.reference[a]-l[a]-I.rects.popper[r],u=l[a]-I.rects.reference[a],m=bo(C),b=m?"y"===a?m.clientHeight||0:m.clientWidth||0:0,Z=d/2-u/2,h=c[A],p=b-i[r]-c[s],G=b/2-i[r]/2+Z,y=ho(h,G,p),B=a;I.modifiersData[t]=((e={})[B]=y,e.centerOffset=y-G,e)}},effect:function(g){var e=g.state,I=g.options.element,t=void 0===I?"[data-popper-arrow]":I;null!=t&&("string"!==typeof t||(t=e.elements.popper.querySelector(t)))&&ro(e.elements.popper,t)&&(e.elements.arrow=t)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Bo(g){return g.split("-")[1]}var fo={top:"auto",right:"auto",bottom:"auto",left:"auto"};function So(g){var e,I=g.popper,t=g.popperRect,n=g.placement,C=g.variation,l=g.offsets,o=g.position,a=g.gpuAcceleration,r=g.adaptive,c=g.roundOffsets,i=g.isFixed,A=l.x,s=void 0===A?0:A,d=l.y,u=void 0===d?0:d,m="function"===typeof c?c({x:s,y:u}):{x:s,y:u};s=m.x,u=m.y;var b=l.hasOwnProperty("x"),Z=l.hasOwnProperty("y"),h=Fl,p=wl,G=window;if(r){var y=bo(I),B="clientHeight",f="clientWidth";if(y===_l(I)&&"static"!==io(y=so(I)).position&&"absolute"===o&&(B="scrollHeight",f="scrollWidth"),n===wl||(n===Fl||n===Kl)&&C===Ml)p=Nl,u-=(i&&y===G&&G.visualViewport?G.visualViewport.height:y[B])-t.height,u*=a?1:-1;if(n===Fl||(n===wl||n===Nl)&&C===Ml)h=Kl,s-=(i&&y===G&&G.visualViewport?G.visualViewport.width:y[f])-t.width,s*=a?1:-1}var S,W=Object.assign({position:o},r&&fo),V=!0===c?function(g,e){var I=g.x,t=g.y,n=e.devicePixelRatio||1;return{x:no(I*n)/n||0,y:no(t*n)/n||0}}({x:s,y:u},_l(I)):{x:s,y:u};return s=V.x,u=V.y,a?Object.assign({},W,((S={})[p]=Z?"0":"",S[h]=b?"0":"",S.transform=(G.devicePixelRatio||1)<=1?"translate("+s+"px, "+u+"px)":"translate3d("+s+"px, "+u+"px, 0)",S)):Object.assign({},W,((e={})[p]=Z?u+"px":"",e[h]=b?s+"px":"",e.transform="",e))}var Wo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(g){var e=g.state,I=g.options,t=I.gpuAcceleration,n=void 0===t||t,C=I.adaptive,l=void 0===C||C,o=I.roundOffsets,a=void 0===o||o,r={placement:ql(e.placement),variation:Bo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,So(Object.assign({},r,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:a})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,So(Object.assign({},r,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:a})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},Vo={passive:!0};var vo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(g){var e=g.state,I=g.instance,t=g.options,n=t.scroll,C=void 0===n||n,l=t.resize,o=void 0===l||l,a=_l(e.elements.popper),r=[].concat(e.scrollParents.reference,e.scrollParents.popper);return C&&r.forEach((function(g){g.addEventListener("scroll",I.update,Vo)})),o&&a.addEventListener("resize",I.update,Vo),function(){C&&r.forEach((function(g){g.removeEventListener("scroll",I.update,Vo)})),o&&a.removeEventListener("resize",I.update,Vo)}},data:{}},Ro={left:"right",right:"left",bottom:"top",top:"bottom"};function ko(g){return g.replace(/left|right|bottom|top/g,(function(g){return Ro[g]}))}var Xo={start:"end",end:"start"};function Jo(g){return g.replace(/start|end/g,(function(g){return Xo[g]}))}function Yo(g){var e=_l(g);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ho(g){return oo(so(g)).left+Yo(g).scrollLeft}function wo(g){var e=io(g),I=e.overflow,t=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(I+n+t)}function No(g){return["html","body","#document"].indexOf(co(g))>=0?g.ownerDocument.body:go(g)&&wo(g)?g:No(uo(g))}function Ko(g,e){var I;void 0===e&&(e=[]);var t=No(g),n=t===(null==(I=g.ownerDocument)?void 0:I.body),C=_l(t),l=n?[C].concat(C.visualViewport||[],wo(t)?t:[]):t,o=e.concat(l);return n?o:o.concat(Ko(uo(l)))}function Fo(g){return Object.assign({},g,{left:g.x,top:g.y,right:g.x+g.width,bottom:g.y+g.height})}function xo(g,e,I){return e===Dl?Fo(function(g,e){var I=_l(g),t=so(g),n=I.visualViewport,C=t.clientWidth,l=t.clientHeight,o=0,a=0;if(n){C=n.width,l=n.height;var r=lo();(r||!r&&"fixed"===e)&&(o=n.offsetLeft,a=n.offsetTop)}return{width:C,height:l,x:o+Ho(g),y:a}}(g,I)):$l(e)?function(g,e){var I=oo(g,!1,"fixed"===e);return I.top=I.top+g.clientTop,I.left=I.left+g.clientLeft,I.bottom=I.top+g.clientHeight,I.right=I.left+g.clientWidth,I.width=g.clientWidth,I.height=g.clientHeight,I.x=I.left,I.y=I.top,I}(e,I):Fo(function(g){var e,I=so(g),t=Yo(g),n=null==(e=g.ownerDocument)?void 0:e.body,C=Io(I.scrollWidth,I.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),l=Io(I.scrollHeight,I.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),o=-t.scrollLeft+Ho(g),a=-t.scrollTop;return"rtl"===io(n||I).direction&&(o+=Io(I.clientWidth,n?n.clientWidth:0)-C),{width:C,height:l,x:o,y:a}}(so(g)))}function Eo(g,e,I,t){var n="clippingParents"===e?function(g){var e=Ko(uo(g)),I=["absolute","fixed"].indexOf(io(g).position)>=0&&go(g)?bo(g):g;return $l(I)?e.filter((function(g){return $l(g)&&ro(g,I)&&"body"!==co(g)})):[]}(g):[].concat(e),C=[].concat(n,[I]),l=C[0],o=C.reduce((function(e,I){var n=xo(g,I,t);return e.top=Io(n.top,e.top),e.right=to(n.right,e.right),e.bottom=to(n.bottom,e.bottom),e.left=Io(n.left,e.left),e}),xo(g,l,t));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function zo(g){var e,I=g.reference,t=g.element,n=g.placement,C=n?ql(n):null,l=n?Bo(n):null,o=I.x+I.width/2-t.width/2,a=I.y+I.height/2-t.height/2;switch(C){case wl:e={x:o,y:I.y-t.height};break;case Nl:e={x:o,y:I.y+I.height};break;case Kl:e={x:I.x+I.width,y:a};break;case Fl:e={x:I.x-t.width,y:a};break;default:e={x:I.x,y:I.y}}var r=C?Zo(C):null;if(null!=r){var c="y"===r?"height":"width";switch(l){case zl:e[r]=e[r]-(I[c]/2-t[c]/2);break;case Ml:e[r]=e[r]+(I[c]/2-t[c]/2)}}return e}function Mo(g,e){void 0===e&&(e={});var I=e,t=I.placement,n=void 0===t?g.placement:t,C=I.strategy,l=void 0===C?g.strategy:C,o=I.boundary,a=void 0===o?Ul:o,r=I.rootBoundary,c=void 0===r?Dl:r,i=I.elementContext,A=void 0===i?Ql:i,s=I.altBoundary,d=void 0!==s&&s,u=I.padding,m=void 0===u?0:u,b=po("number"!==typeof m?m:Go(m,El)),Z=A===Ql?Ll:Ql,h=g.rects.popper,p=g.elements[d?Z:A],G=Eo($l(p)?p:p.contextElement||so(g.elements.popper),a,c,l),y=oo(g.elements.reference),B=zo({reference:y,element:h,strategy:"absolute",placement:n}),f=Fo(Object.assign({},h,B)),S=A===Ql?f:y,W={top:G.top-S.top+b.top,bottom:S.bottom-G.bottom+b.bottom,left:G.left-S.left+b.left,right:S.right-G.right+b.right},V=g.modifiersData.offset;if(A===Ql&&V){var v=V[n];Object.keys(W).forEach((function(g){var e=[Kl,Nl].indexOf(g)>=0?1:-1,I=[wl,Nl].indexOf(g)>=0?"y":"x";W[g]+=v[I]*e}))}return W}var Uo={name:"flip",enabled:!0,phase:"main",fn:function(g){var e=g.state,I=g.options,t=g.name;if(!e.modifiersData[t]._skip){for(var n=I.mainAxis,C=void 0===n||n,l=I.altAxis,o=void 0===l||l,a=I.fallbackPlacements,r=I.padding,c=I.boundary,i=I.rootBoundary,A=I.altBoundary,s=I.flipVariations,d=void 0===s||s,u=I.allowedAutoPlacements,m=e.options.placement,b=ql(m),Z=a||(b===m||!d?[ko(m)]:function(g){if(ql(g)===xl)return[];var e=ko(g);return[Jo(g),e,Jo(e)]}(m)),h=[m].concat(Z).reduce((function(g,I){return g.concat(ql(I)===xl?function(g,e){void 0===e&&(e={});var I=e,t=I.placement,n=I.boundary,C=I.rootBoundary,l=I.padding,o=I.flipVariations,a=I.allowedAutoPlacements,r=void 0===a?jl:a,c=Bo(t),i=c?o?Tl:Tl.filter((function(g){return Bo(g)===c})):El,A=i.filter((function(g){return r.indexOf(g)>=0}));0===A.length&&(A=i);var s=A.reduce((function(e,I){return e[I]=Mo(g,{placement:I,boundary:n,rootBoundary:C,padding:l})[ql(I)],e}),{});return Object.keys(s).sort((function(g,e){return s[g]-s[e]}))}(e,{placement:I,boundary:c,rootBoundary:i,padding:r,flipVariations:d,allowedAutoPlacements:u}):I)}),[]),p=e.rects.reference,G=e.rects.popper,y=new Map,B=!0,f=h[0],S=0;S<h.length;S++){var W=h[S],V=ql(W),v=Bo(W)===zl,R=[wl,Nl].indexOf(V)>=0,k=R?"width":"height",X=Mo(e,{placement:W,boundary:c,rootBoundary:i,altBoundary:A,padding:r}),J=R?v?Kl:Fl:v?Nl:wl;p[k]>G[k]&&(J=ko(J));var Y=ko(J),H=[];if(C&&H.push(X[V]<=0),o&&H.push(X[J]<=0,X[Y]<=0),H.every((function(g){return g}))){f=W,B=!1;break}y.set(W,H)}if(B)for(var w=function(g){var e=h.find((function(e){var I=y.get(e);if(I)return I.slice(0,g).every((function(g){return g}))}));if(e)return f=e,"break"},N=d?3:1;N>0;N--){if("break"===w(N))break}e.placement!==f&&(e.modifiersData[t]._skip=!0,e.placement=f,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Do(g,e,I){return void 0===I&&(I={x:0,y:0}),{top:g.top-e.height-I.y,right:g.right-e.width+I.x,bottom:g.bottom-e.height+I.y,left:g.left-e.width-I.x}}function Qo(g){return[wl,Kl,Nl,Fl].some((function(e){return g[e]>=0}))}var Lo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(g){var e=g.state,I=g.options,t=g.name,n=I.offset,C=void 0===n?[0,0]:n,l=jl.reduce((function(g,I){return g[I]=function(g,e,I){var t=ql(g),n=[Fl,wl].indexOf(t)>=0?-1:1,C="function"===typeof I?I(Object.assign({},e,{placement:g})):I,l=C[0],o=C[1];return l=l||0,o=(o||0)*n,[Fl,Kl].indexOf(t)>=0?{x:o,y:l}:{x:l,y:o}}(I,e.rects,C),g}),{}),o=l[e.placement],a=o.x,r=o.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=a,e.modifiersData.popperOffsets.y+=r),e.modifiersData[t]=l}};var To={name:"preventOverflow",enabled:!0,phase:"main",fn:function(g){var e=g.state,I=g.options,t=g.name,n=I.mainAxis,C=void 0===n||n,l=I.altAxis,o=void 0!==l&&l,a=I.boundary,r=I.rootBoundary,c=I.altBoundary,i=I.padding,A=I.tether,s=void 0===A||A,d=I.tetherOffset,u=void 0===d?0:d,m=Mo(e,{boundary:a,rootBoundary:r,padding:i,altBoundary:c}),b=ql(e.placement),Z=Bo(e.placement),h=!Z,p=Zo(b),G="x"===p?"y":"x",y=e.modifiersData.popperOffsets,B=e.rects.reference,f=e.rects.popper,S="function"===typeof u?u(Object.assign({},e.rects,{placement:e.placement})):u,W="number"===typeof S?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),V=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,v={x:0,y:0};if(y){if(C){var R,k="y"===p?wl:Fl,X="y"===p?Nl:Kl,J="y"===p?"height":"width",Y=y[p],H=Y+m[k],w=Y-m[X],N=s?-f[J]/2:0,K=Z===zl?B[J]:f[J],F=Z===zl?-f[J]:-B[J],x=e.elements.arrow,E=s&&x?ao(x):{width:0,height:0},z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},M=z[k],U=z[X],D=ho(0,B[J],E[J]),Q=h?B[J]/2-N-D-M-W.mainAxis:K-D-M-W.mainAxis,L=h?-B[J]/2+N+D+U+W.mainAxis:F+D+U+W.mainAxis,T=e.elements.arrow&&bo(e.elements.arrow),j=T?"y"===p?T.clientTop||0:T.clientLeft||0:0,O=null!=(R=null==V?void 0:V[p])?R:0,P=Y+L-O,q=ho(s?to(H,Y+Q-O-j):H,Y,s?Io(w,P):w);y[p]=q,v[p]=q-Y}if(o){var _,$="x"===p?wl:Fl,gg="x"===p?Nl:Kl,eg=y[G],Ig="y"===G?"height":"width",tg=eg+m[$],ng=eg-m[gg],Cg=-1!==[wl,Fl].indexOf(b),lg=null!=(_=null==V?void 0:V[G])?_:0,og=Cg?tg:eg-B[Ig]-f[Ig]-lg+W.altAxis,ag=Cg?eg+B[Ig]+f[Ig]-lg-W.altAxis:ng,rg=s&&Cg?function(g,e,I){var t=ho(g,e,I);return t>I?I:t}(og,eg,ag):ho(s?og:tg,eg,s?ag:ng);y[G]=rg,v[G]=rg-eg}e.modifiersData[t]=v}},requiresIfExists:["offset"]};function jo(g,e,I){void 0===I&&(I=!1);var t=go(e),n=go(e)&&function(g){var e=g.getBoundingClientRect(),I=no(e.width)/g.offsetWidth||1,t=no(e.height)/g.offsetHeight||1;return 1!==I||1!==t}(e),C=so(e),l=oo(g,n,I),o={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(t||!t&&!I)&&(("body"!==co(e)||wo(C))&&(o=function(g){return g!==_l(g)&&go(g)?{scrollLeft:(e=g).scrollLeft,scrollTop:e.scrollTop}:Yo(g);var e}(e)),go(e)?((a=oo(e,!0)).x+=e.clientLeft,a.y+=e.clientTop):C&&(a.x=Ho(C))),{x:l.left+o.scrollLeft-a.x,y:l.top+o.scrollTop-a.y,width:l.width,height:l.height}}function Oo(g){var e=new Map,I=new Set,t=[];function n(g){I.add(g.name),[].concat(g.requires||[],g.requiresIfExists||[]).forEach((function(g){if(!I.has(g)){var t=e.get(g);t&&n(t)}})),t.push(g)}return g.forEach((function(g){e.set(g.name,g)})),g.forEach((function(g){I.has(g.name)||n(g)})),t}function Po(g){var e;return function(){return e||(e=new Promise((function(I){Promise.resolve().then((function(){e=void 0,I(g())}))}))),e}}var qo={placement:"bottom",modifiers:[],strategy:"absolute"};function _o(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];return!e.some((function(g){return!(g&&"function"===typeof g.getBoundingClientRect)}))}function $o(g){void 0===g&&(g={});var e=g,I=e.defaultModifiers,t=void 0===I?[]:I,n=e.defaultOptions,C=void 0===n?qo:n;return function(g,e,I){void 0===I&&(I=C);var n={placement:"bottom",orderedModifiers:[],options:Object.assign({},qo,C),modifiersData:{},elements:{reference:g,popper:e},attributes:{},styles:{}},l=[],o=!1,a={state:n,setOptions:function(I){var o="function"===typeof I?I(n.options):I;r(),n.options=Object.assign({},C,n.options,o),n.scrollParents={reference:$l(g)?Ko(g):g.contextElement?Ko(g.contextElement):[],popper:Ko(e)};var c=function(g){var e=Oo(g);return Ol.reduce((function(g,I){return g.concat(e.filter((function(g){return g.phase===I})))}),[])}(function(g){var e=g.reduce((function(g,e){var I=g[e.name];return g[e.name]=I?Object.assign({},I,e,{options:Object.assign({},I.options,e.options),data:Object.assign({},I.data,e.data)}):e,g}),{});return Object.keys(e).map((function(g){return e[g]}))}([].concat(t,n.options.modifiers)));return n.orderedModifiers=c.filter((function(g){return g.enabled})),n.orderedModifiers.forEach((function(g){var e=g.name,I=g.options,t=void 0===I?{}:I,C=g.effect;if("function"===typeof C){var o=C({state:n,name:e,instance:a,options:t}),r=function(){};l.push(o||r)}})),a.update()},forceUpdate:function(){if(!o){var g=n.elements,e=g.reference,I=g.popper;if(_o(e,I)){n.rects={reference:jo(e,bo(I),"fixed"===n.options.strategy),popper:ao(I)},n.reset=!1,n.placement=n.options.placement,n.orderedModifiers.forEach((function(g){return n.modifiersData[g.name]=Object.assign({},g.data)}));for(var t=0;t<n.orderedModifiers.length;t++)if(!0!==n.reset){var C=n.orderedModifiers[t],l=C.fn,r=C.options,c=void 0===r?{}:r,i=C.name;"function"===typeof l&&(n=l({state:n,options:c,name:i,instance:a})||n)}else n.reset=!1,t=-1}}},update:Po((function(){return new Promise((function(g){a.forceUpdate(),g(n)}))})),destroy:function(){r(),o=!0}};if(!_o(g,e))return a;function r(){l.forEach((function(g){return g()})),l=[]}return a.setOptions(I).then((function(g){!o&&I.onFirstUpdate&&I.onFirstUpdate(g)})),a}}var ga=$o({defaultModifiers:[{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(g){var e=g.state,I=g.name,t=e.rects.reference,n=e.rects.popper,C=e.modifiersData.preventOverflow,l=Mo(e,{elementContext:"reference"}),o=Mo(e,{altBoundary:!0}),a=Do(l,t),r=Do(o,n,C),c=Qo(a),i=Qo(r);e.modifiersData[I]={referenceClippingOffsets:a,popperEscapeOffsets:r,isReferenceHidden:c,hasPopperEscaped:i},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":i})}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(g){var e=g.state,I=g.name;e.modifiersData[I]=zo({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},Wo,vo,Lo,Uo,To,yo]}),ea=function(g){return{position:g,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},Ia={name:"applyStyles",enabled:!1},ta={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(g){var e=g.state;return function(){var g=e.elements,I=g.reference,t=g.popper;if("removeAttribute"in I){var n=(I.getAttribute("aria-describedby")||"").split(",").filter((function(g){return g.trim()!==t.id}));n.length?I.setAttribute("aria-describedby",n.join(",")):I.removeAttribute("aria-describedby")}}},fn:function(g){var e,I=g.state.elements,t=I.popper,n=I.reference,C=null==(e=t.getAttribute("role"))?void 0:e.toLowerCase();if(t.id&&"tooltip"===C&&"setAttribute"in n){var l=n.getAttribute("aria-describedby");if(l&&-1!==l.split(",").indexOf(t.id))return;n.setAttribute("aria-describedby",l?l+","+t.id:t.id)}}},na=[];var Ca=function(g,I,t){var n=void 0===t?{}:t,C=n.enabled,l=void 0===C||C,o=n.placement,a=void 0===o?"bottom":o,r=n.strategy,c=void 0===r?"absolute":r,i=n.modifiers,A=void 0===i?na:i,s=mt(n,["enabled","placement","strategy","modifiers"]),d=(0,e.useRef)(),u=(0,e.useCallback)((function(){var g;null==(g=d.current)||g.update()}),[]),m=(0,e.useCallback)((function(){var g;null==(g=d.current)||g.forceUpdate()}),[]),b=Pl((0,e.useState)({placement:a,update:u,forceUpdate:m,attributes:{},styles:{popper:ea(c),arrow:{}}})),Z=b[0],h=b[1],p=(0,e.useMemo)((function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(g){var e=g.state,I={},t={};Object.keys(e.elements).forEach((function(g){I[g]=e.styles[g],t[g]=e.attributes[g]})),h({state:e,styles:I,attributes:t,update:u,forceUpdate:m,placement:e.placement})}}}),[u,m,h]);return(0,e.useEffect)((function(){d.current&&l&&d.current.setOptions({placement:a,strategy:c,modifiers:[].concat(A,[p,Ia])})}),[c,a,p,l]),(0,e.useEffect)((function(){if(l&&null!=g&&null!=I)return d.current=ga(g,I,Fn({},s,{placement:a,strategy:c,modifiers:[].concat(A,[ta,p])})),function(){null!=d.current&&(d.current.destroy(),d.current=void 0,h((function(g){return Fn({},g,{attributes:{},styles:{popper:ea(c)}})})))}}),[l,g,I]),Z},la=!1,oa=!1;try{var aa={get passive(){return la=!0},get once(){return oa=la=!0}};fl&&(window.addEventListener("test",aa,aa),window.removeEventListener("test",aa,!0))}catch(Og){}var ra=function(g,e,I,t){if(t&&"boolean"!==typeof t&&!oa){var n=t.once,C=t.capture,l=I;!oa&&n&&(l=I.__once||function g(t){this.removeEventListener(e,g,C),I.call(this,t)},I.__once=l),g.addEventListener(e,l,la?t:C)}g.addEventListener(e,I,t)};var ca=function(g,e,I,t){var n=t&&"boolean"!==typeof t?t.capture:t;g.removeEventListener(e,I,n),I.__once&&g.removeEventListener(e,I.__once,n)};var ia=function(g,e,I,t){return ra(g,e,I,t),function(){ca(g,e,I,t)}};var Aa=function(g){var I=(0,e.useRef)(g);return(0,e.useEffect)((function(){I.current=g}),[g]),I};function sa(g){var I=Aa(g);return(0,e.useCallback)((function(){return I.current&&I.current.apply(I,arguments)}),[I])}var da=I(391),ua=I.n(da);var ma=function(g){return rl(function(g){return g&&"setState"in g?Xl.findDOMNode(g):null!=g?g:null}(g))},ba=function(){};var Za=function(g){return g&&("current"in g?g.current:g)};var ha=function(g,I,t){var n=void 0===t?{}:t,C=n.disabled,l=n.clickTrigger,o=void 0===l?"click":l,a=(0,e.useRef)(!1),r=I||ba,c=(0,e.useCallback)((function(e){var I,t,n=Za(g);ua()(!!n,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),a.current=!n||!!((t=e).metaKey||t.altKey||t.ctrlKey||t.shiftKey)||!function(g){return 0===g.button}(e)||!!ml(n,null!=(I=null==e.composedPath?void 0:e.composedPath()[0])?I:e.target)}),[g]),i=sa((function(g){a.current||r(g)})),A=sa((function(g){27===g.keyCode&&r(g)}));(0,e.useEffect)((function(){if(!C&&null!=g){var e=window.event,I=ma(Za(g)),t=ia(I,o,c,!0),n=ia(I,o,(function(g){g!==e?i(g):e=void 0})),l=ia(I,"keyup",(function(g){g!==e?A(g):e=void 0})),a=[];return"ontouchstart"in I.documentElement&&(a=[].slice.call(I.body.children).map((function(g){return ia(g,"mousemove",ba)}))),function(){t(),n(),l(),a.forEach((function(g){return g()}))}}}),[g,C,o,c,i,A])},pa=function(g){var e;return"undefined"===typeof document?null:null==g?rl().body:("function"===typeof g&&(g=g()),g&&"current"in g&&(g=g.current),null!=(e=g)&&e.nodeType&&g||null)};function Ga(g,I){var t=(0,e.useState)((function(){return pa(g)})),n=t[0],C=t[1];if(!n){var l=pa(g);l&&C(l)}return(0,e.useEffect)((function(){I&&n&&I(n)}),[I,n]),(0,e.useEffect)((function(){var e=pa(g);e!==n&&C(e)}),[g,n]),n}function ya(g){var e,I,t,n,C,l=g.enabled,o=g.enableEvents,a=g.placement,r=g.flip,c=g.offset,i=g.fixed,A=g.containerPadding,s=g.arrowElement,d=g.popperConfig,u=void 0===d?{}:d,m=function(g){var e={};return Array.isArray(g)?(null==g||g.forEach((function(g){e[g.name]=g})),e):g||e}(u.modifiers);return Fn({},u,{placement:a,enabled:l,strategy:i?"fixed":u.strategy,modifiers:(C=Fn({},m,{eventListeners:{enabled:o},preventOverflow:Fn({},m.preventOverflow,{options:A?Fn({padding:A},null==(e=m.preventOverflow)?void 0:e.options):null==(I=m.preventOverflow)?void 0:I.options}),offset:{options:Fn({offset:c},null==(t=m.offset)?void 0:t.options)},arrow:Fn({},m.arrow,{enabled:!!s,options:Fn({},null==(n=m.arrow)?void 0:n.options,{element:s})}),flip:Fn({enabled:!!r},m.flip)}),void 0===C&&(C={}),Array.isArray(C)?C:Object.keys(C).map((function(g){return C[g].name=g,C[g]})))})}var Ba=e.forwardRef((function(g,I){var t=g.flip,n=g.offset,C=g.placement,l=g.containerPadding,o=void 0===l?5:l,a=g.popperConfig,r=void 0===a?{}:a,c=g.transition,i=Jl(),A=i[0],s=i[1],d=Jl(),u=d[0],m=d[1],b=Hl(s,I),Z=Ga(g.container),h=Ga(g.target),p=(0,e.useState)(!g.show),G=p[0],y=p[1],B=Ca(h,A,ya({placement:C,enableEvents:!!g.show,containerPadding:o||5,flip:t,offset:n,arrowElement:u,popperConfig:r})),f=B.styles,S=B.attributes,W=mt(B,["styles","attributes"]);g.show?G&&y(!1):g.transition||G||y(!0);var V=g.show||c&&!G;if(ha(A,g.onHide,{disabled:!g.rootClose||g.rootCloseDisabled,clickTrigger:g.rootCloseEvent}),!V)return null;var v=g.children(Fn({},W,{show:!!g.show,props:Fn({},S.popper,{style:f.popper,ref:b}),arrowProps:Fn({},S.arrow,{style:f.arrow,ref:m})}));if(c){var R=g.onExit,k=g.onExiting,X=g.onEnter,J=g.onEntering,Y=g.onEntered;v=e.createElement(c,{in:g.show,appear:!0,onExit:R,onExiting:k,onExited:function(){y(!0),g.onExited&&g.onExited.apply(g,arguments)},onEnter:X,onEntering:J,onEntered:Y},v)}return Z?Xl.createPortal(v,Z):null}));Ba.displayName="Overlay",Ba.propTypes={show:zn().bool,placement:zn().oneOf(jl),target:zn().any,container:zn().any,flip:zn().bool,children:zn().func.isRequired,containerPadding:zn().number,popperConfig:zn().object,rootClose:zn().bool,rootCloseEvent:zn().oneOf(["click","mousedown"]),rootCloseDisabled:zn().bool,onHide:function(g){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];var n;return g.rootClose?(n=zn().func).isRequired.apply(n,[g].concat(I)):zn().func.apply(zn(),[g].concat(I))},transition:zn().elementType,onEnter:zn().func,onEntering:zn().func,onEntered:zn().func,onExit:zn().func,onExiting:zn().func,onExited:zn().func};var fa=Ba;var Sa=function(){this.__data__=[],this.size=0};var Wa=function(g,e){for(var I=g.length;I--;)if(SC(g[I][0],e))return I;return-1},Va=Array.prototype.splice;var va=function(g){var e=this.__data__,I=Wa(e,g);return!(I<0)&&(I==e.length-1?e.pop():Va.call(e,I,1),--this.size,!0)};var Ra=function(g){var e=this.__data__,I=Wa(e,g);return I<0?void 0:e[I][1]};var ka=function(g){return Wa(this.__data__,g)>-1};var Xa=function(g,e){var I=this.__data__,t=Wa(I,g);return t<0?(++this.size,I.push([g,e])):I[t][1]=e,this};function Ja(g){var e=-1,I=null==g?0:g.length;for(this.clear();++e<I;){var t=g[e];this.set(t[0],t[1])}}Ja.prototype.clear=Sa,Ja.prototype.delete=va,Ja.prototype.get=Ra,Ja.prototype.has=ka,Ja.prototype.set=Xa;var Ya=Ja;var Ha=function(){this.__data__=new Ya,this.size=0};var wa=function(g){var e=this.__data__,I=e.delete(g);return this.size=e.size,I};var Na=function(g){return this.__data__.get(g)};var Ka=function(g){return this.__data__.has(g)},Fa=vC["__core-js_shared__"],xa=function(){var g=/[^.]+$/.exec(Fa&&Fa.keys&&Fa.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}();var Ea=function(g){return!!xa&&xa in g},za=Function.prototype.toString;var Ma=function(g){if(null!=g){try{return za.call(g)}catch(Og){}try{return g+""}catch(Og){}}return""},Ua=/^\[object .+?Constructor\]$/,Da=Function.prototype,Qa=Object.prototype,La=Da.toString,Ta=Qa.hasOwnProperty,ja=RegExp("^"+La.call(Ta).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Oa=function(g){return!(!xC(g)||Ea(g))&&(EC(g)?ja:Ua).test(Ma(g))};var Pa=function(g,e){return null==g?void 0:g[e]};var qa=function(g,e){var I=Pa(g,e);return Oa(I)?I:void 0},_a=qa(vC,"Map"),$a=qa(Object,"create");var gr=function(){this.__data__=$a?$a(null):{},this.size=0};var er=function(g){var e=this.has(g)&&delete this.__data__[g];return this.size-=e?1:0,e},Ir=Object.prototype.hasOwnProperty;var tr=function(g){var e=this.__data__;if($a){var I=e[g];return"__lodash_hash_undefined__"===I?void 0:I}return Ir.call(e,g)?e[g]:void 0},nr=Object.prototype.hasOwnProperty;var Cr=function(g){var e=this.__data__;return $a?void 0!==e[g]:nr.call(e,g)};var lr=function(g,e){var I=this.__data__;return this.size+=this.has(g)?0:1,I[g]=$a&&void 0===e?"__lodash_hash_undefined__":e,this};function or(g){var e=-1,I=null==g?0:g.length;for(this.clear();++e<I;){var t=g[e];this.set(t[0],t[1])}}or.prototype.clear=gr,or.prototype.delete=er,or.prototype.get=tr,or.prototype.has=Cr,or.prototype.set=lr;var ar=or;var rr=function(){this.size=0,this.__data__={hash:new ar,map:new(_a||Ya),string:new ar}};var cr=function(g){var e=typeof g;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==g:null===g};var ir=function(g,e){var I=g.__data__;return cr(e)?I["string"==typeof e?"string":"hash"]:I.map};var Ar=function(g){var e=ir(this,g).delete(g);return this.size-=e?1:0,e};var sr=function(g){return ir(this,g).get(g)};var dr=function(g){return ir(this,g).has(g)};var ur=function(g,e){var I=ir(this,g),t=I.size;return I.set(g,e),this.size+=I.size==t?0:1,this};function mr(g){var e=-1,I=null==g?0:g.length;for(this.clear();++e<I;){var t=g[e];this.set(t[0],t[1])}}mr.prototype.clear=rr,mr.prototype.delete=Ar,mr.prototype.get=sr,mr.prototype.has=dr,mr.prototype.set=ur;var br=mr;var Zr=function(g,e){var I=this.__data__;if(I instanceof Ya){var t=I.__data__;if(!_a||t.length<199)return t.push([g,e]),this.size=++I.size,this;I=this.__data__=new br(t)}return I.set(g,e),this.size=I.size,this};function hr(g){var e=this.__data__=new Ya(g);this.size=e.size}hr.prototype.clear=Ha,hr.prototype.delete=wa,hr.prototype.get=Na,hr.prototype.has=Ka,hr.prototype.set=Zr;var pr=hr;var Gr=function(g){return this.__data__.set(g,"__lodash_hash_undefined__"),this};var yr=function(g){return this.__data__.has(g)};function Br(g){var e=-1,I=null==g?0:g.length;for(this.__data__=new br;++e<I;)this.add(g[e])}Br.prototype.add=Br.prototype.push=Gr,Br.prototype.has=yr;var fr=Br;var Sr=function(g,e){for(var I=-1,t=null==g?0:g.length;++I<t;)if(e(g[I],I,g))return!0;return!1};var Wr=function(g,e){return g.has(e)};var Vr=function(g,e,I,t,n,C){var l=1&I,o=g.length,a=e.length;if(o!=a&&!(l&&a>o))return!1;var r=C.get(g),c=C.get(e);if(r&&c)return r==e&&c==g;var i=-1,A=!0,s=2&I?new fr:void 0;for(C.set(g,e),C.set(e,g);++i<o;){var d=g[i],u=e[i];if(t)var m=l?t(u,d,i,e,g,C):t(d,u,i,g,e,C);if(void 0!==m){if(m)continue;A=!1;break}if(s){if(!Sr(e,(function(g,e){if(!Wr(s,e)&&(d===g||n(d,g,I,t,C)))return s.push(e)}))){A=!1;break}}else if(d!==u&&!n(d,u,I,t,C)){A=!1;break}}return C.delete(g),C.delete(e),A},vr=vC.Uint8Array;var Rr=function(g){var e=-1,I=Array(g.size);return g.forEach((function(g,t){I[++e]=[t,g]})),I};var kr=function(g){var e=-1,I=Array(g.size);return g.forEach((function(g){I[++e]=g})),I},Xr=RC?RC.prototype:void 0,Jr=Xr?Xr.valueOf:void 0;var Yr=function(g,e,I,t,n,C,l){switch(I){case"[object DataView]":if(g.byteLength!=e.byteLength||g.byteOffset!=e.byteOffset)return!1;g=g.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(g.byteLength!=e.byteLength||!C(new vr(g),new vr(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return SC(+g,+e);case"[object Error]":return g.name==e.name&&g.message==e.message;case"[object RegExp]":case"[object String]":return g==e+"";case"[object Map]":var o=Rr;case"[object Set]":var a=1&t;if(o||(o=kr),g.size!=e.size&&!a)return!1;var r=l.get(g);if(r)return r==e;t|=2,l.set(g,e);var c=Vr(o(g),o(e),t,n,C,l);return l.delete(g),c;case"[object Symbol]":if(Jr)return Jr.call(g)==Jr.call(e)}return!1};var Hr=function(g,e){for(var I=-1,t=e.length,n=g.length;++I<t;)g[n+I]=e[I];return g},wr=Array.isArray;var Nr=function(g,e,I){var t=e(g);return wr(g)?t:Hr(t,I(g))};var Kr=function(g,e){for(var I=-1,t=null==g?0:g.length,n=0,C=[];++I<t;){var l=g[I];e(l,I,g)&&(C[n++]=l)}return C};var Fr=function(){return[]},xr=Object.prototype.propertyIsEnumerable,Er=Object.getOwnPropertySymbols,zr=Er?function(g){return null==g?[]:(g=Object(g),Kr(Er(g),(function(e){return xr.call(g,e)})))}:Fr;var Mr=function(g,e){for(var I=-1,t=Array(g);++I<g;)t[I]=e(I);return t};var Ur=function(g){return PC(g)&&"[object Arguments]"==FC(g)},Dr=Object.prototype,Qr=Dr.hasOwnProperty,Lr=Dr.propertyIsEnumerable,Tr=Ur(function(){return arguments}())?Ur:function(g){return PC(g)&&Qr.call(g,"callee")&&!Lr.call(g,"callee")},jr=Tr;var Or=function(){return!1},Pr="object"==typeof exports&&exports&&!exports.nodeType&&exports,qr=Pr&&"object"==typeof module&&module&&!module.nodeType&&module,_r=qr&&qr.exports===Pr?vC.Buffer:void 0,$r=(_r?_r.isBuffer:void 0)||Or,gc={};gc["[object Float32Array]"]=gc["[object Float64Array]"]=gc["[object Int8Array]"]=gc["[object Int16Array]"]=gc["[object Int32Array]"]=gc["[object Uint8Array]"]=gc["[object Uint8ClampedArray]"]=gc["[object Uint16Array]"]=gc["[object Uint32Array]"]=!0,gc["[object Arguments]"]=gc["[object Array]"]=gc["[object ArrayBuffer]"]=gc["[object Boolean]"]=gc["[object DataView]"]=gc["[object Date]"]=gc["[object Error]"]=gc["[object Function]"]=gc["[object Map]"]=gc["[object Number]"]=gc["[object Object]"]=gc["[object RegExp]"]=gc["[object Set]"]=gc["[object String]"]=gc["[object WeakMap]"]=!1;var ec=function(g){return PC(g)&&zC(g.length)&&!!gc[FC(g)]};var Ic=function(g){return function(e){return g(e)}},tc="object"==typeof exports&&exports&&!exports.nodeType&&exports,nc=tc&&"object"==typeof module&&module&&!module.nodeType&&module,Cc=nc&&nc.exports===tc&&WC.process,lc=function(){try{var g=nc&&nc.require&&nc.require("util").types;return g||Cc&&Cc.binding&&Cc.binding("util")}catch(Og){}}(),oc=lc&&lc.isTypedArray,ac=oc?Ic(oc):ec,rc=Object.prototype.hasOwnProperty;var cc=function(g,e){var I=wr(g),t=!I&&jr(g),n=!I&&!t&&$r(g),C=!I&&!t&&!n&&ac(g),l=I||t||n||C,o=l?Mr(g.length,String):[],a=o.length;for(var r in g)!e&&!rc.call(g,r)||l&&("length"==r||n&&("offset"==r||"parent"==r)||C&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||DC(r,a))||o.push(r);return o},ic=Object.prototype;var Ac=function(g){var e=g&&g.constructor;return g===("function"==typeof e&&e.prototype||ic)};var sc=function(g,e){return function(I){return g(e(I))}},dc=sc(Object.keys,Object),uc=Object.prototype.hasOwnProperty;var mc=function(g){if(!Ac(g))return dc(g);var e=[];for(var I in Object(g))uc.call(g,I)&&"constructor"!=I&&e.push(I);return e};var bc=function(g){return MC(g)?cc(g):mc(g)};var Zc=function(g){return Nr(g,bc,zr)},hc=Object.prototype.hasOwnProperty;var pc=function(g,e,I,t,n,C){var l=1&I,o=Zc(g),a=o.length;if(a!=Zc(e).length&&!l)return!1;for(var r=a;r--;){var c=o[r];if(!(l?c in e:hc.call(e,c)))return!1}var i=C.get(g),A=C.get(e);if(i&&A)return i==e&&A==g;var s=!0;C.set(g,e),C.set(e,g);for(var d=l;++r<a;){var u=g[c=o[r]],m=e[c];if(t)var b=l?t(m,u,c,e,g,C):t(u,m,c,g,e,C);if(!(void 0===b?u===m||n(u,m,I,t,C):b)){s=!1;break}d||(d="constructor"==c)}if(s&&!d){var Z=g.constructor,h=e.constructor;Z==h||!("constructor"in g)||!("constructor"in e)||"function"==typeof Z&&Z instanceof Z&&"function"==typeof h&&h instanceof h||(s=!1)}return C.delete(g),C.delete(e),s},Gc=qa(vC,"DataView"),yc=qa(vC,"Promise"),Bc=qa(vC,"Set"),fc=qa(vC,"WeakMap"),Sc="[object Map]",Wc="[object Promise]",Vc="[object Set]",vc="[object WeakMap]",Rc="[object DataView]",kc=Ma(Gc),Xc=Ma(_a),Jc=Ma(yc),Yc=Ma(Bc),Hc=Ma(fc),wc=FC;(Gc&&wc(new Gc(new ArrayBuffer(1)))!=Rc||_a&&wc(new _a)!=Sc||yc&&wc(yc.resolve())!=Wc||Bc&&wc(new Bc)!=Vc||fc&&wc(new fc)!=vc)&&(wc=function(g){var e=FC(g),I="[object Object]"==e?g.constructor:void 0,t=I?Ma(I):"";if(t)switch(t){case kc:return Rc;case Xc:return Sc;case Jc:return Wc;case Yc:return Vc;case Hc:return vc}return e});var Nc=wc,Kc="[object Arguments]",Fc="[object Array]",xc="[object Object]",Ec=Object.prototype.hasOwnProperty;var zc=function(g,e,I,t,n,C){var l=wr(g),o=wr(e),a=l?Fc:Nc(g),r=o?Fc:Nc(e),c=(a=a==Kc?xc:a)==xc,i=(r=r==Kc?xc:r)==xc,A=a==r;if(A&&$r(g)){if(!$r(e))return!1;l=!0,c=!1}if(A&&!c)return C||(C=new pr),l||ac(g)?Vr(g,e,I,t,n,C):Yr(g,e,a,I,t,n,C);if(!(1&I)){var s=c&&Ec.call(g,"__wrapped__"),d=i&&Ec.call(e,"__wrapped__");if(s||d){var u=s?g.value():g,m=d?e.value():e;return C||(C=new pr),n(u,m,I,t,C)}}return!!A&&(C||(C=new pr),pc(g,e,I,t,n,C))};var Mc=function g(e,I,t,n,C){return e===I||(null==e||null==I||!PC(e)&&!PC(I)?e!==e&&I!==I:zc(e,I,t,n,g,C))};var Uc=function(g,e){return Mc(g,e)};function Dc(g,e){var I=bl(g);return I?I.innerHeight:e?g.clientHeight:Gl(g).height}var Qc,Lc=Function.prototype.bind.call(Function.prototype.call,[].slice);function Tc(g,e){if(!Qc){var I=document.body,t=I.matches||I.matchesSelector||I.webkitMatchesSelector||I.mozMatchesSelector||I.msMatchesSelector;Qc=function(g,e){return t.call(g,e)}}return Qc(g,e)}function jc(g,e,I){g.closest&&!I&&g.closest(e);var t=g;do{if(Tc(t,e))return t;t=t.parentElement}while(t&&t!==I&&t.nodeType===document.ELEMENT_NODE);return null}var Oc=function(g,e,I,t){for(var n=g.length,C=I+(t?1:-1);t?C--:++C<n;)if(e(g[C],C,g))return C;return-1};var Pc=function(g,e,I,t){var n=I.length,C=n,l=!t;if(null==g)return!C;for(g=Object(g);n--;){var o=I[n];if(l&&o[2]?o[1]!==g[o[0]]:!(o[0]in g))return!1}for(;++n<C;){var a=(o=I[n])[0],r=g[a],c=o[1];if(l&&o[2]){if(void 0===r&&!(a in g))return!1}else{var i=new pr;if(t)var A=t(r,c,a,g,e,i);if(!(void 0===A?Mc(c,r,3,t,i):A))return!1}}return!0};var qc=function(g){return g===g&&!xC(g)};var _c=function(g){for(var e=bc(g),I=e.length;I--;){var t=e[I],n=g[t];e[I]=[t,n,qc(n)]}return e};var $c=function(g,e){return function(I){return null!=I&&(I[g]===e&&(void 0!==e||g in Object(I)))}};var gi=function(g){var e=_c(g);return 1==e.length&&e[0][2]?$c(e[0][0],e[0][1]):function(I){return I===g||Pc(I,g,e)}},ei=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ii=/^\w*$/;var ti=function(g,e){if(wr(g))return!1;var I=typeof g;return!("number"!=I&&"symbol"!=I&&"boolean"!=I&&null!=g&&!qC(g))||(Ii.test(g)||!ei.test(g)||null!=e&&g in Object(e))};function ni(g,e){if("function"!=typeof g||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var I=function I(){var t=arguments,n=e?e.apply(this,t):t[0],C=I.cache;if(C.has(n))return C.get(n);var l=g.apply(this,t);return I.cache=C.set(n,l)||C,l};return I.cache=new(ni.Cache||br),I}ni.Cache=br;var Ci=ni;var li=function(g){var e=Ci(g,(function(g){return 500===I.size&&I.clear(),g})),I=e.cache;return e},oi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ai=/\\(\\)?/g,ri=li((function(g){var e=[];return 46===g.charCodeAt(0)&&e.push(""),g.replace(oi,(function(g,I,t,n){e.push(t?n.replace(ai,"$1"):I||g)})),e}));var ci=function(g,e){for(var I=-1,t=null==g?0:g.length,n=Array(t);++I<t;)n[I]=e(g[I],I,g);return n},ii=RC?RC.prototype:void 0,Ai=ii?ii.toString:void 0;var si=function g(e){if("string"==typeof e)return e;if(wr(e))return ci(e,g)+"";if(qC(e))return Ai?Ai.call(e):"";var I=e+"";return"0"==I&&1/e==-Infinity?"-0":I};var di=function(g){return null==g?"":si(g)};var ui=function(g,e){return wr(g)?g:ti(g,e)?[g]:ri(di(g))};var mi=function(g){if("string"==typeof g||qC(g))return g;var e=g+"";return"0"==e&&1/g==-Infinity?"-0":e};var bi=function(g,e){for(var I=0,t=(e=ui(e,g)).length;null!=g&&I<t;)g=g[mi(e[I++])];return I&&I==t?g:void 0};var Zi=function(g,e,I){var t=null==g?void 0:bi(g,e);return void 0===t?I:t};var hi=function(g,e){return null!=g&&e in Object(g)};var pi=function(g,e,I){for(var t=-1,n=(e=ui(e,g)).length,C=!1;++t<n;){var l=mi(e[t]);if(!(C=null!=g&&I(g,l)))break;g=g[l]}return C||++t!=n?C:!!(n=null==g?0:g.length)&&zC(n)&&DC(l,n)&&(wr(g)||jr(g))};var Gi=function(g,e){return null!=g&&pi(g,e,hi)};var yi=function(g,e){return ti(g)&&qc(e)?$c(mi(g),e):function(I){var t=Zi(I,g);return void 0===t&&t===e?Gi(I,g):Mc(e,t,3)}};var Bi=function(g){return g};var fi=function(g){return function(e){return null==e?void 0:e[g]}};var Si=function(g){return function(e){return bi(e,g)}};var Wi=function(g){return ti(g)?fi(mi(g)):Si(g)};var Vi=function(g){return"function"==typeof g?g:null==g?Bi:"object"==typeof g?wr(g)?yi(g[0],g[1]):gi(g):Wi(g)},vi=Math.max;var Ri=function(g,e,I){var t=null==g?0:g.length;if(!t)return-1;var n=null==I?0:Cl(I);return n<0&&(n=vi(t+n,0)),Oc(g,Vi(e,3),n)},ki=Math.ceil,Xi=Math.max;var Ji=function(g,e,I,t){for(var n=-1,C=Xi(ki((e-g)/(I||1)),0),l=Array(C);C--;)l[t?C:++n]=g,g+=I;return l};var Yi=function(g){return function(e,I,t){return t&&"number"!=typeof t&&QC(e,I,t)&&(I=t=void 0),e=nl(e),void 0===I?(I=e,e=0):I=nl(I),t=void 0===t?e<I?1:-1:nl(t),Ji(e,I,t,g)}},Hi=Yi(),wi=Number.isNaN||function(g){return"number"===typeof g&&g!==g};function Ni(g,e){if(g.length!==e.length)return!1;for(var I=0;I<g.length;I++)if(t=g[I],n=e[I],!(t===n||wi(t)&&wi(n)))return!1;var t,n;return!0}function Ki(g,e){void 0===e&&(e=Ni);var I=null;function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(I&&I.lastThis===this&&e(t,I.lastArgs))return I.lastResult;var C=g.apply(this,t);return I={lastResult:C,lastArgs:t,lastThis:this},C}return t.clear=function(){I=null},t}var Fi=RC?RC.isConcatSpreadable:void 0;var xi=function(g){return wr(g)||jr(g)||!!(Fi&&g&&g[Fi])};var Ei=function g(e,I,t,n,C){var l=-1,o=e.length;for(t||(t=xi),C||(C=[]);++l<o;){var a=e[l];I>0&&t(a)?I>1?g(a,I-1,t,n,C):Hr(C,a):n||(C[C.length]=a)}return C};var zi=function(g){return function(e,I,t){for(var n=-1,C=Object(e),l=t(e),o=l.length;o--;){var a=l[g?o:++n];if(!1===I(C[a],a,C))break}return e}}();var Mi=function(g,e){return g&&zi(g,e,bc)};var Ui=function(g,e){return function(I,t){if(null==I)return I;if(!MC(I))return g(I,t);for(var n=I.length,C=e?n:-1,l=Object(I);(e?C--:++C<n)&&!1!==t(l[C],C,l););return I}}(Mi);var Di=function(g,e){var I=-1,t=MC(g)?Array(g.length):[];return Ui(g,(function(g,n,C){t[++I]=e(g,n,C)})),t};var Qi=function(g,e){var I=g.length;for(g.sort(e);I--;)g[I]=g[I].value;return g};var Li=function(g,e){if(g!==e){var I=void 0!==g,t=null===g,n=g===g,C=qC(g),l=void 0!==e,o=null===e,a=e===e,r=qC(e);if(!o&&!r&&!C&&g>e||C&&l&&a&&!o&&!r||t&&l&&a||!I&&a||!n)return 1;if(!t&&!C&&!r&&g<e||r&&I&&n&&!t&&!C||o&&I&&n||!l&&n||!a)return-1}return 0};var Ti=function(g,e,I){for(var t=-1,n=g.criteria,C=e.criteria,l=n.length,o=I.length;++t<l;){var a=Li(n[t],C[t]);if(a)return t>=o?a:a*("desc"==I[t]?-1:1)}return g.index-e.index};var ji=function(g,e,I){e=e.length?ci(e,(function(g){return wr(g)?function(e){return bi(e,1===g.length?g[0]:g)}:g})):[Bi];var t=-1;e=ci(e,Ic(Vi));var n=Di(g,(function(g,I,n){return{criteria:ci(e,(function(e){return e(g)})),index:++t,value:g}}));return Qi(n,(function(g,e){return Ti(g,e,I)}))};var Oi=function(g,e,I){switch(I.length){case 0:return g.call(e);case 1:return g.call(e,I[0]);case 2:return g.call(e,I[0],I[1]);case 3:return g.call(e,I[0],I[1],I[2])}return g.apply(e,I)},Pi=Math.max;var qi=function(g,e,I){return e=Pi(void 0===e?g.length-1:e,0),function(){for(var t=arguments,n=-1,C=Pi(t.length-e,0),l=Array(C);++n<C;)l[n]=t[e+n];n=-1;for(var o=Array(e+1);++n<e;)o[n]=t[n];return o[e]=I(l),Oi(g,this,o)}};var _i=function(g){return function(){return g}},$i=function(){try{var g=qa(Object,"defineProperty");return g({},"",{}),g}catch(Og){}}(),gA=$i?function(g,e){return $i(g,"toString",{configurable:!0,enumerable:!1,value:_i(e),writable:!0})}:Bi,eA=Date.now;var IA=function(g){var e=0,I=0;return function(){var t=eA(),n=16-(t-I);if(I=t,n>0){if(++e>=800)return arguments[0]}else e=0;return g.apply(void 0,arguments)}},tA=IA(gA);var nA,CA=function(g,e){return tA(qi(g,e,Bi),g+"")},lA=CA((function(g,e){if(null==g)return[];var I=e.length;return I>1&&QC(g,e[0],e[1])?e=[]:I>2&&QC(e[0],e[1],e[2])&&(e=[e[0]]),ji(g,Ei(e,1),[])}));function oA(g){if((!nA&&0!==nA||g)&&fl){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),nA=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return nA}function aA(g,e){var I=bl(g);return I?I.innerWidth:e?g.clientWidth:Gl(g).width}function rA(g,e){return g.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var cA=function(g,e){for(var I=-1,t=null==g?0:g.length;++I<t&&!1!==e(g[I],I,g););return g};var iA=function(g,e,I){"__proto__"==e&&$i?$i(g,e,{configurable:!0,enumerable:!0,value:I,writable:!0}):g[e]=I},AA=Object.prototype.hasOwnProperty;var sA=function(g,e,I){var t=g[e];AA.call(g,e)&&SC(t,I)&&(void 0!==I||e in g)||iA(g,e,I)};var dA=function(g,e,I,t){var n=!I;I||(I={});for(var C=-1,l=e.length;++C<l;){var o=e[C],a=t?t(I[o],g[o],o,I,g):void 0;void 0===a&&(a=g[o]),n?iA(I,o,a):sA(I,o,a)}return I};var uA=function(g,e){return g&&dA(e,bc(e),g)};var mA=function(g){var e=[];if(null!=g)for(var I in Object(g))e.push(I);return e},bA=Object.prototype.hasOwnProperty;var ZA=function(g){if(!xC(g))return mA(g);var e=Ac(g),I=[];for(var t in g)("constructor"!=t||!e&&bA.call(g,t))&&I.push(t);return I};var hA=function(g){return MC(g)?cc(g,!0):ZA(g)};var pA=function(g,e){return g&&dA(e,hA(e),g)},GA="object"==typeof exports&&exports&&!exports.nodeType&&exports,yA=GA&&"object"==typeof module&&module&&!module.nodeType&&module,BA=yA&&yA.exports===GA?vC.Buffer:void 0,fA=BA?BA.allocUnsafe:void 0;var SA=function(g,e){if(e)return g.slice();var I=g.length,t=fA?fA(I):new g.constructor(I);return g.copy(t),t};var WA=function(g,e){var I=-1,t=g.length;for(e||(e=Array(t));++I<t;)e[I]=g[I];return e};var VA=function(g,e){return dA(g,zr(g),e)},vA=sc(Object.getPrototypeOf,Object),RA=Object.getOwnPropertySymbols?function(g){for(var e=[];g;)Hr(e,zr(g)),g=vA(g);return e}:Fr;var kA=function(g,e){return dA(g,RA(g),e)};var XA=function(g){return Nr(g,hA,RA)},JA=Object.prototype.hasOwnProperty;var YA=function(g){var e=g.length,I=new g.constructor(e);return e&&"string"==typeof g[0]&&JA.call(g,"index")&&(I.index=g.index,I.input=g.input),I};var HA=function(g){var e=new g.constructor(g.byteLength);return new vr(e).set(new vr(g)),e};var wA=function(g,e){var I=e?HA(g.buffer):g.buffer;return new g.constructor(I,g.byteOffset,g.byteLength)},NA=/\w*$/;var KA=function(g){var e=new g.constructor(g.source,NA.exec(g));return e.lastIndex=g.lastIndex,e},FA=RC?RC.prototype:void 0,xA=FA?FA.valueOf:void 0;var EA=function(g){return xA?Object(xA.call(g)):{}};var zA=function(g,e){var I=e?HA(g.buffer):g.buffer;return new g.constructor(I,g.byteOffset,g.length)};var MA=function(g,e,I){var t=g.constructor;switch(e){case"[object ArrayBuffer]":return HA(g);case"[object Boolean]":case"[object Date]":return new t(+g);case"[object DataView]":return wA(g,I);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return zA(g,I);case"[object Map]":case"[object Set]":return new t;case"[object Number]":case"[object String]":return new t(g);case"[object RegExp]":return KA(g);case"[object Symbol]":return EA(g)}},UA=Object.create,DA=function(){function g(){}return function(e){if(!xC(e))return{};if(UA)return UA(e);g.prototype=e;var I=new g;return g.prototype=void 0,I}}();var QA=function(g){return"function"!=typeof g.constructor||Ac(g)?{}:DA(vA(g))};var LA=function(g){return PC(g)&&"[object Map]"==Nc(g)},TA=lc&&lc.isMap,jA=TA?Ic(TA):LA;var OA=function(g){return PC(g)&&"[object Set]"==Nc(g)},PA=lc&&lc.isSet,qA=PA?Ic(PA):OA,_A="[object Arguments]",$A="[object Function]",gs="[object Object]",es={};es[_A]=es["[object Array]"]=es["[object ArrayBuffer]"]=es["[object DataView]"]=es["[object Boolean]"]=es["[object Date]"]=es["[object Float32Array]"]=es["[object Float64Array]"]=es["[object Int8Array]"]=es["[object Int16Array]"]=es["[object Int32Array]"]=es["[object Map]"]=es["[object Number]"]=es[gs]=es["[object RegExp]"]=es["[object Set]"]=es["[object String]"]=es["[object Symbol]"]=es["[object Uint8Array]"]=es["[object Uint8ClampedArray]"]=es["[object Uint16Array]"]=es["[object Uint32Array]"]=!0,es["[object Error]"]=es[$A]=es["[object WeakMap]"]=!1;var Is=function g(e,I,t,n,C,l){var o,a=1&I,r=2&I,c=4&I;if(t&&(o=C?t(e,n,C,l):t(e)),void 0!==o)return o;if(!xC(e))return e;var i=wr(e);if(i){if(o=YA(e),!a)return WA(e,o)}else{var A=Nc(e),s=A==$A||"[object GeneratorFunction]"==A;if($r(e))return SA(e,a);if(A==gs||A==_A||s&&!C){if(o=r||s?{}:QA(e),!a)return r?kA(e,pA(o,e)):VA(e,uA(o,e))}else{if(!es[A])return C?e:{};o=MA(e,A,a)}}l||(l=new pr);var d=l.get(e);if(d)return d;l.set(e,o),qA(e)?e.forEach((function(n){o.add(g(n,I,t,n,e,l))})):jA(e)&&e.forEach((function(n,C){o.set(C,g(n,I,t,C,e,l))}));var u=i?void 0:(c?r?XA:Zc:r?hA:bc)(e);return cA(u||e,(function(n,C){u&&(n=e[C=n]),sA(o,C,g(n,I,t,C,e,l))})),o};var ts=function(g){var e=null==g?0:g.length;return e?g[e-1]:void 0};var ns=function(g,e){return e.length<2?g:bi(g,fC(e,0,-1))};var Cs=function(g,e){return e=ui(e,g),null==(g=ns(g,e))||delete g[mi(ts(e))]},ls=Function.prototype,os=Object.prototype,as=ls.toString,rs=os.hasOwnProperty,cs=as.call(Object);var is=function(g){if(!PC(g)||"[object Object]"!=FC(g))return!1;var e=vA(g);if(null===e)return!0;var I=rs.call(e,"constructor")&&e.constructor;return"function"==typeof I&&I instanceof I&&as.call(I)==cs};var As=function(g){return is(g)?void 0:g};var ss=function(g){return(null==g?0:g.length)?Ei(g,1):[]};var ds=function(g){return tA(qi(g,void 0,ss),g+"")}((function(g,e){var I={};if(null==g)return I;var t=!1;e=ci(e,(function(e){return e=ui(e,g),t||(t=e.length>1),e})),dA(g,XA(g),I),t&&(I=Is(I,7,As));for(var n=e.length;n--;)Cs(I,e[n]);return I})),us=Object.prototype,ms=us.hasOwnProperty,bs=CA((function(g,e){g=Object(g);var I=-1,t=e.length,n=t>2?e[2]:void 0;for(n&&QC(e[0],e[1],n)&&(t=1);++I<t;)for(var C=e[I],l=hA(C),o=-1,a=l.length;++o<a;){var r=l[o],c=g[r];(void 0===c||SC(c,us[r])&&!ms.call(g,r))&&(g[r]=C[r])}return g}));var Zs=function(g,e,I){var t=wr(g),n=t||$r(g)||ac(g);if(e=Vi(e,4),null==I){var C=g&&g.constructor;I=n?t?new C:[]:xC(g)&&EC(C)?DA(vA(g)):{}}return(n?cA:Mi)(g,(function(g,t,n){return e(I,g,t,n)})),I};var hs=function(g,e){var I={};return e=Vi(e,3),Mi(g,(function(g,t,n){iA(I,t,e(g,t,n))})),I};I(818),I(253),I(320),I(36),I(893),I(26),I(27);function ps(g){return g.children}var Gs="PREV",ys="NEXT",Bs="TODAY",fs="DATE",Ss={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},Ws=Object.keys(Ss).map((function(g){return Ss[g]}));function Vs(g,e){g&&g.apply(null,[].concat(e))}zn().oneOfType([zn().string,zn().func]),zn().any,zn().func,zn().oneOfType([zn().arrayOf(zn().oneOf(Ws)),zn().objectOf((function(g,e){if(-1!==Ws.indexOf(e)&&"boolean"===typeof g[e])return null;for(var I=arguments.length,t=new Array(I>2?I-2:0),n=2;n<I;n++)t[n-2]=arguments[n];return zn().elementType.apply(zn(),[g,e].concat(t))}))]),zn().oneOfType([zn().oneOf(["overlap","no-overlap"]),zn().func]);var vs={seconds:1e3,minutes:6e4,hours:36e5,day:864e5};function Rs(g,e){var I=tC(g,"month");return tC(I,"week",e.startOfWeek())}function ks(g,e){var I=nC(g,"month");return nC(I,"week",e.startOfWeek())}function Xs(g,e){for(var I=Rs(g,e),t=ks(g,e),n=[];cC(I,t,"day");)n.push(I),I=eC(I,1,"day");return n}function Js(g,e){var I=tC(g,e);return CC(I,g)?I:eC(I,1,e)}function Ys(g,e){for(var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day",t=g,n=[];cC(t,e,I);)n.push(t),t=eC(t,1,I);return n}function Hs(g,e){return null==e&&null==g?null:(null==e&&(e=new Date),null==g&&(g=new Date),g=tC(g,"day"),g=bC(g,bC(e)),g=mC(g,mC(e)),g=uC(g,uC(e)),dC(g,dC(e)))}function ws(g){return 0===bC(g)&&0===mC(g)&&0===uC(g)&&0===dC(g)}function Ns(g,e,I){return I&&"milliseconds"!==I?Math.round(Math.abs(+tC(g,I)/vs[I]-+tC(e,I)/vs[I])):Math.abs(+g-+e)}var Ks=zn().oneOfType([zn().string,zn().func]);function Fs(g,e,I,t,n){var C="function"===typeof t?t(I,n,g):e.call(g,I,t,n);return Hn()(null==C||"string"===typeof C,"`localizer format(..)` must return a string, null, or undefined"),C}function xs(g,e,I){return new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,e+I,0,0)}function Es(g,e){return g.getTimezoneOffset()-e.getTimezoneOffset()}function zs(g,e){return Ns(g,e,"minutes")+Es(g,e)}function Ms(g){var e=tC(g,"day");return Ns(e,g,"minutes")+Es(e,g)}function Us(g,e){return rC(g,e,"day")}function Ds(g,e,I){return CC(g,e,"minutes")?aC(e,I,"minutes"):oC(e,I,"minutes")}function Qs(g){var e=g.evtA,I=e.start,t=e.end,n=e.allDay,C=g.evtB,l=C.start,o=C.end,a=C.allDay,r=+tC(I,"day")-+tC(l,"day"),c=Ns(I,Js(t,"day"),"day"),i=Ns(l,Js(o,"day"),"day");return r||Math.max(i,1)-Math.max(c,1)||!!a-!!n||+I-+l||+t-+o}function Ls(g){var e=g.event,I=e.start,t=e.end,n=g.range,C=n.start,l=n.end,o=tC(I,"day"),a=cC(o,l,"day"),r=lC(o,t,"minutes")?oC(t,C,"minutes"):aC(t,C,"minutes");return a&&r}function Ts(g,e){return CC(g,e,"day")}function js(g,e){return ws(g)&&ws(e)}var Os=m((function g(e){var I=this;A(this,g),Hn()("function"===typeof e.format,"date localizer `format(..)` must be a function"),Hn()("function"===typeof e.firstOfWeek,"date localizer `firstOfWeek(..)` must be a function"),this.propType=e.propType||Ks,this.formats=e.formats,this.format=function(){for(var g=arguments.length,t=new Array(g),n=0;n<g;n++)t[n]=arguments[n];return Fs.apply(void 0,[I,e.format].concat(t))},this.startOfWeek=e.firstOfWeek,this.merge=e.merge||Hs,this.inRange=e.inRange||sC,this.lt=e.lt||rC,this.lte=e.lte||cC,this.gt=e.gt||oC,this.gte=e.gte||aC,this.eq=e.eq||CC,this.neq=e.neq||lC,this.startOf=e.startOf||tC,this.endOf=e.endOf||nC,this.add=e.add||eC,this.range=e.range||Ys,this.diff=e.diff||Ns,this.ceil=e.ceil||Js,this.min=e.min||iC,this.max=e.max||AC,this.minutes=e.minutes||mC,this.firstVisibleDay=e.firstVisibleDay||Rs,this.lastVisibleDay=e.lastVisibleDay||ks,this.visibleDays=e.visibleDays||Xs,this.getSlotDate=e.getSlotDate||xs,this.getTimezoneOffset=e.getTimezoneOffset||function(g){return g.getTimezoneOffset()},this.getDstOffset=e.getDstOffset||Es,this.getTotalMin=e.getTotalMin||zs,this.getMinutesFromMidnight=e.getMinutesFromMidnight||Ms,this.continuesPrior=e.continuesPrior||Us,this.continuesAfter=e.continuesAfter||Ds,this.sortEvents=e.sortEvents||Qs,this.inEventRange=e.inEventRange||Ls,this.isSameDate=e.isSameDate||Ts,this.startAndEndAreDateOnly=e.startAndEndAreDateOnly||js,this.segmentOffset=e.browserTZOffset?e.browserTZOffset():0}));function Ps(g,e,I,t){var n=ce(ce({},g.formats),I);return ce(ce({},g),{},{messages:t,startOfWeek:function(){return g.startOfWeek(e)},format:function(I,t){return g.format(I,n[t]||t,e)}})}var qs={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(g){return"+".concat(g," more")}};var _s=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],$s=function(g){Z(t,g);var I=y(t);function t(){return A(this,t),I.apply(this,arguments)}return m(t,[{key:"render",value:function(){var g=this.props,I=g.style,t=g.className,n=g.event,C=g.selected,l=g.isAllDay,o=g.onSelect,a=g.onDoubleClick,r=g.onKeyPress,c=g.localizer,i=g.continuesPrior,A=g.continuesAfter,s=g.accessors,d=g.getters,u=g.children,m=g.components,b=m.event,Z=m.eventWrapper,h=g.slotStart,p=g.slotEnd,G=bt(g,_s);delete G.resizable;var y=s.title(n),B=s.tooltip(n),f=s.end(n),S=s.start(n),W=s.allDay(n),V=l||W||c.diff(S,c.ceil(f,"day"),"day")>1,v=d.eventProp(n,S,f,C),R=e.createElement("div",{className:"rbc-event-content",title:B||void 0},b?e.createElement(b,{event:n,continuesPrior:i,continuesAfter:A,title:y,isAllDay:W,localizer:c,slotStart:h,slotEnd:p}):y);return e.createElement(Z,Object.assign({},this.props,{type:"date"}),e.createElement("div",Object.assign({},G,{tabIndex:0,style:ce(ce({},v.style),I),className:ht("rbc-event",t,v.className,{"rbc-selected":C,"rbc-event-allday":V,"rbc-event-continues-prior":i,"rbc-event-continues-after":A}),onClick:function(g){return o&&o(n,g)},onDoubleClick:function(g){return a&&a(n,g)},onKeyPress:function(g){return r&&r(n,g)}}),"function"===typeof u?u(R):R))}}]),t}(e.Component);function gd(g,e){return!(!g||null==e)&&Uc(g,e)}function ed(g,e){return(g.right-g.left)/e}function Id(g,e,I,t){var n=ed(g,t);return I?t-1-Math.floor((e-g.left)/n):Math.floor((e-g.left)/n)}function td(g){var I=g.containerRef,t=g.accessors,n=g.getters,C=g.selected,l=g.components,o=g.localizer,a=g.position,r=g.show,c=g.events,i=g.slotStart,A=g.slotEnd,s=g.onSelect,d=g.onDoubleClick,u=g.onKeyPress,m=g.handleDragStart,b=g.popperRef,Z=g.target,h=g.offset;!function(g){var I=g.ref,t=g.callback;(0,e.useEffect)((function(){var g=function(g){I.current&&!I.current.contains(g.target)&&t()};return document.addEventListener("mousedown",g),function(){document.removeEventListener("mousedown",g)}}),[I,t])}({ref:b,callback:r}),(0,e.useLayoutEffect)((function(){var g=function(g){var e=g.target,I=g.offset,t=g.container,n=g.box,C=Gl(e),l=C.top,o=C.left,a=C.width,r=C.height,c=Gl(t),i=c.top,A=c.left,s=c.width,d=c.height,u=Gl(n),m=u.width,b=u.height,Z=i+d,h=A+s,p=l+b,G=o+m,y=I.x,B=I.y;return{topOffset:p>Z?l-b-B:l+B+r,leftOffset:G>h?o+y-m+a:o+y}}({target:Z,offset:h,container:I.current,box:b.current}),e=g.topOffset,t=g.leftOffset;b.current.style.top="".concat(e,"px"),b.current.style.left="".concat(t,"px")}),[h.x,h.y,Z]);var p=a.width,G={minWidth:p+p/2};return e.createElement("div",{style:G,className:"rbc-overlay",ref:b},e.createElement("div",{className:"rbc-overlay-header"},o.format(i,"dayHeaderFormat")),c.map((function(g,I){return e.createElement($s,{key:I,type:"popup",localizer:o,event:g,getters:n,onSelect:s,accessors:t,components:l,onDoubleClick:d,onKeyPress:u,continuesPrior:o.lt(t.end(g),i,"day"),continuesAfter:o.gte(t.start(g),A,"day"),slotStart:i,slotEnd:A,selected:gd(g,C),draggable:!0,onDragStart:function(){return m(g)},onDragEnd:function(){return r()}})})))}var nd=e.forwardRef((function(g,I){return e.createElement(td,Object.assign({},g,{popperRef:I}))}));function Cd(g){var I=g.containerRef,t=g.popupOffset,n=void 0===t?5:t,C=g.overlay,l=g.accessors,o=g.localizer,a=g.components,r=g.getters,c=g.selected,i=g.handleSelectEvent,A=g.handleDoubleClickEvent,s=g.handleKeyPressEvent,d=g.handleDragStart,u=g.onHide,m=g.overlayDisplay,b=(0,e.useRef)(null);if(!C.position)return null;var Z=n;isNaN(n)||(Z={x:n,y:n});var h=C.position,p=C.events,G=C.date,y=C.end;return e.createElement(fa,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:u,target:C.target},(function(g){var t=g.props;return e.createElement(nd,Object.assign({},t,{containerRef:I,ref:b,target:C.target,offset:Z,accessors:l,getters:r,selected:c,components:a,localizer:o,position:h,show:m,events:p,slotStart:G,slotEnd:y,onSelect:i,onDoubleClick:A,onKeyPress:s,handleDragStart:d}))}))}nd.propTypes={accessors:zn().object.isRequired,getters:zn().object.isRequired,selected:zn().object,components:zn().object.isRequired,localizer:zn().object.isRequired,position:zn().object.isRequired,show:zn().func.isRequired,events:zn().array.isRequired,slotStart:zn().instanceOf(Date).isRequired,slotEnd:zn().instanceOf(Date),onSelect:zn().func,onDoubleClick:zn().func,onKeyPress:zn().func,handleDragStart:zn().func,style:zn().object,offset:zn().shape({x:zn().number,y:zn().number})};var ld=e.forwardRef((function(g,I){return e.createElement(Cd,Object.assign({},g,{containerRef:I}))}));function od(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;return ia(I,g,e,{passive:!1})}function ad(g,e){return!!function(g,e){var I=e.clientX,t=e.clientY;return jc(document.elementFromPoint(I,t),".rbc-event",g)}(g,e)}function rd(g,e){return!!function(g,e){var I=e.clientX,t=e.clientY;return jc(document.elementFromPoint(I,t),".rbc-show-more",g)}(g,e)}function cd(g){var e=g;return g.touches&&g.touches.length&&(e=g.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}ld.propTypes={popupOffset:zn().oneOfType([zn().number,zn().shape({x:zn().number,y:zn().number})]),overlay:zn().shape({position:zn().object,events:zn().array,date:zn().instanceOf(Date),end:zn().instanceOf(Date)}),accessors:zn().object.isRequired,localizer:zn().object.isRequired,components:zn().object.isRequired,getters:zn().object.isRequired,selected:zn().object,handleSelectEvent:zn().func,handleDoubleClickEvent:zn().func,handleKeyPressEvent:zn().func,handleDragStart:zn().func,onHide:zn().func,overlayDisplay:zn().func};var id=function(){function g(e){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=I.global,n=void 0!==t&&t,C=I.longPressThreshold,l=void 0===C?250:C,o=I.validContainers,a=void 0===o?[]:o;A(this,g),this.isDetached=!1,this.container=e,this.globalMouse=!e||n,this.longPressThreshold=l,this.validContainers=a,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=od("touchmove",(function(){}),window),this._removeKeyDownListener=od("keydown",this._keyListener),this._removeKeyUpListener=od("keyup",this._keyListener),this._removeDropFromOutsideListener=od("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=od("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return m(g,[{key:"on",value:function(g,e){var I=this._listeners[g]||(this._listeners[g]=[]);return I.push(e),{remove:function(){var g=I.indexOf(e);-1!==g&&I.splice(g,1)}}}},{key:"emit",value:function(g){for(var e=arguments.length,I=new Array(e>1?e-1:0),t=1;t<e;t++)I[t-1]=arguments[t];var n;return(this._listeners[g]||[]).forEach((function(g){void 0===n&&(n=g.apply(void 0,I))})),n}},{key:"teardown",value:function(){this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(g){var e=this._selectRect;return!(!e||!this.selecting)&&Ad(e,sd(g))}},{key:"filter",value:function(g){return this._selectRect&&this.selecting?g.filter(this.isSelected,this):[]}},{key:"_addLongPressListener",value:function(g,e){var I=this,t=null,n=null,C=null,l=function(e){t=setTimeout((function(){a(),g(e)}),I.longPressThreshold),n=od("touchmove",(function(){return a()})),C=od("touchend",(function(){return a()}))},o=od("touchstart",l),a=function(){t&&clearTimeout(t),n&&n(),C&&C(),t=null,n=null,C=null};return e&&l(e),function(){a(),o()}}},{key:"_addInitialEventListener",value:function(){var g=this,e=od("mousedown",(function(e){g._removeInitialEventListener(),g._handleInitialEvent(e),g._removeInitialEventListener=od("mousedown",g._handleInitialEvent)})),I=od("touchstart",(function(e){g._removeInitialEventListener(),g._removeInitialEventListener=g._addLongPressListener(g._handleInitialEvent,e)}));this._removeInitialEventListener=function(){e(),I()}}},{key:"_dropFromOutsideListener",value:function(g){var e=cd(g),I=e.pageX,t=e.pageY,n=e.clientX,C=e.clientY;this.emit("dropFromOutside",{x:I,y:t,clientX:n,clientY:C}),g.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(g){var e=cd(g),I=e.pageX,t=e.pageY,n=e.clientX,C=e.clientY;this.emit("dragOverFromOutside",{x:I,y:t,clientX:n,clientY:C}),g.preventDefault()}},{key:"_handleInitialEvent",value:function(g){if(!this.isDetached){var e,I=cd(g),t=I.clientX,n=I.clientY,C=I.pageX,l=I.pageY,o=this.container();if(3!==g.which&&2!==g.button&&function(g,e,I){return!g||ml(g,document.elementFromPoint(e,I))}(o,t,n)){if(!this.globalMouse&&o&&!ml(o,g.target)){var a=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;"object"!==s(g)&&(g={top:g,left:g,right:g,bottom:g});return g}(0),r=a.top,c=a.left,i=a.bottom,A=a.right;if(!Ad({top:(e=sd(o)).top-r,left:e.left-c,bottom:e.bottom+i,right:e.right+A},{top:l,left:C}))return}if(!1!==this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(g.type),x:C,y:l,clientX:t,clientY:n}))switch(g.type){case"mousedown":this._removeEndListener=od("mouseup",this._handleTerminatingEvent),this._onEscListener=od("keydown",this._handleTerminatingEvent),this._removeMoveListener=od("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(g),this._removeEndListener=od("touchend",this._handleTerminatingEvent),this._removeMoveListener=od("touchmove",this._handleMoveEvent)}}}}},{key:"_isWithinValidContainer",value:function(g){var e=g.target,I=this.validContainers;return!(I&&I.length&&e)||I.some((function(g){return!!e.closest(g)}))}},{key:"_handleTerminatingEvent",value:function(g){var e=cd(g),I=e.pageX,t=e.pageY;if(this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._initialEventData){var n=!this.container||ml(this.container(),g.target),C=this._isWithinValidContainer(g),l=this._selectRect,o=this.isClick(I,t);return this._initialEventData=null,"Escape"!==g.key&&C?o&&n?this._handleClickEvent(g):o?this.emit("reset"):this.emit("select",l):this.emit("reset")}}},{key:"_handleClickEvent",value:function(g){var e=cd(g),I=e.pageX,t=e.pageY,n=e.clientX,C=e.clientY,l=(new Date).getTime();return this._lastClickData&&l-this._lastClickData.timestamp<250?(this._lastClickData=null,this.emit("doubleClick",{x:I,y:t,clientX:n,clientY:C})):(this._lastClickData={timestamp:l},this.emit("click",{x:I,y:t,clientX:n,clientY:C}))}},{key:"_handleMoveEvent",value:function(g){if(null!==this._initialEventData&&!this.isDetached){var e=this._initialEventData,I=e.x,t=e.y,n=cd(g),C=n.pageX,l=n.pageY,o=Math.abs(I-C),a=Math.abs(t-l),r=Math.min(C,I),c=Math.min(l,t),i=this.selecting;(!this.isClick(C,l)||i||o||a)&&(this.selecting=!0,this._selectRect={top:c,left:r,x:C,y:l,right:r+o,bottom:c+a},i||this.emit("selectStart",this._initialEventData),this.isClick(C,l)||this.emit("selecting",this._selectRect),g.preventDefault())}}},{key:"_keyListener",value:function(g){this.ctrl=g.metaKey||g.ctrlKey}},{key:"isClick",value:function(g,e){var I=this._initialEventData,t=I.x,n=I.y;return!I.isTouch&&Math.abs(g-t)<=5&&Math.abs(e-n)<=5}}]),g}();function Ad(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,t=sd(g),n=t.top,C=t.left,l=t.right,o=void 0===l?C:l,a=t.bottom,r=void 0===a?n:a,c=sd(e),i=c.top,A=c.left,s=c.right,d=void 0===s?A:s,u=c.bottom;return!(r-I<i||n+I>(void 0===u?i:u)||o-I<A||C+I>d)}function sd(g){if(!g.getBoundingClientRect)return g;var e=g.getBoundingClientRect(),I=e.left+dd("left"),t=e.top+dd("top");return{top:t,left:I,right:(g.offsetWidth||0)+I,bottom:(g.offsetHeight||0)+t}}function dd(g){return"left"===g?window.pageXOffset||document.body.scrollLeft||0:"top"===g?window.pageYOffset||document.body.scrollTop||0:void 0}var ud=function(g){Z(t,g);var I=y(t);function t(g,n){var C;return A(this,t),(C=I.call(this,g,n)).state={selecting:!1},C.containerRef=(0,e.createRef)(),C}return m(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(g){!g.selectable&&this.props.selectable&&this._selectable(),g.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var g=this.props,I=g.range,t=g.getNow,n=g.getters,C=g.date,l=g.components.dateCellWrapper,o=g.localizer,a=this.state,r=a.selecting,c=a.startIdx,i=a.endIdx,A=t();return e.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},I.map((function(g,t){var a=r&&t>=c&&t<=i,s=n.dayProp(g),d=s.className,u=s.style;return e.createElement(l,{key:t,value:g,range:I},e.createElement("div",{style:u,className:ht("rbc-day-bg",d,a&&"rbc-selected-cell",o.isSameDate(g,A)&&"rbc-today",C&&o.neq(C,g,"month")&&"rbc-off-range-bg")}))})))}},{key:"_selectable",value:function(){var g=this,e=this.containerRef.current,I=this._selector=new id(this.props.container,{longPressThreshold:this.props.longPressThreshold}),t=function(I,t){if(!ad(e,I)&&!rd(e,I)){var n=sd(e),C=g.props,l=C.range,o=C.rtl;if(function(g,e){var I=e.x,t=e.y;return t>=g.top&&t<=g.bottom&&I>=g.left&&I<=g.right}(n,I)){var a=Id(n,I.x,o,l.length);g._selectSlot({startIdx:a,endIdx:a,action:t,box:I})}}g._initial={},g.setState({selecting:!1})};I.on("selecting",(function(t){var n=g.props,C=n.range,l=n.rtl,o=-1,a=-1;if(g.state.selecting||(Vs(g.props.onSelectStart,[t]),g._initial={x:t.x,y:t.y}),I.isSelected(e)){var r=sd(e),c=function(g,e,I,t,n){var C=-1,l=-1,o=t-1,a=ed(e,t),r=Id(e,I.x,n,t),c=e.top<I.y&&e.bottom>I.y,i=e.top<g.y&&e.bottom>g.y,A=g.y>e.bottom,s=e.top>g.y;return I.top<e.top&&I.bottom>e.bottom&&(C=0,l=o),c&&(s?(C=0,l=r):A&&(C=r,l=o)),i&&(C=l=n?o-Math.floor((g.x-e.left)/a):Math.floor((g.x-e.left)/a),c?r<C?C=r:l=r:g.y<I.y?l=o:C=0),{startIdx:C,endIdx:l}}(g._initial,r,t,C.length,l);o=c.startIdx,a=c.endIdx}g.setState({selecting:!0,startIdx:o,endIdx:a})})),I.on("beforeSelect",(function(e){if("ignoreEvents"===g.props.selectable)return!ad(g.containerRef.current,e)})),I.on("click",(function(g){return t(g,"click")})),I.on("doubleClick",(function(g){return t(g,"doubleClick")})),I.on("select",(function(e){g._selectSlot(ce(ce({},g.state),{},{action:"select",bounds:e})),g._initial={},g.setState({selecting:!1}),Vs(g.props.onSelectEnd,[g.state])}))}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(g){var e=g.endIdx,I=g.startIdx,t=g.action,n=g.bounds,C=g.box;-1!==e&&-1!==I&&this.props.onSelectSlot&&this.props.onSelectSlot({start:I,end:e,action:t,bounds:n,box:C,resourceId:this.props.resourceId})}}]),t}(e.Component),md=(zn().object.isRequired,zn().object,zn().bool,zn().object.isRequired,zn().object.isRequired,zn().object.isRequired,zn().object.isRequired,zn().func,zn().func,zn().func,{segments:[],selected:{}}),bd=function(g,I){var t=g.selected;g.isAllDay;var n=g.accessors,C=g.getters,l=g.onSelect,o=g.onDoubleClick,a=g.onKeyPress,r=g.localizer,c=g.slotMetrics,i=g.components,A=g.resizable,s=c.continuesPrior(I),d=c.continuesAfter(I);return e.createElement($s,{event:I,getters:C,localizer:r,accessors:n,components:i,onSelect:l,onDoubleClick:o,onKeyPress:a,continuesPrior:s,continuesAfter:d,slotStart:c.first,slotEnd:c.last,selected:gd(I,t),resizable:A})},Zd=function(g,I,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",C=Math.abs(I)/g*100+"%";return e.createElement("div",{key:t,className:"rbc-row-segment",style:{WebkitFlexBasis:C,flexBasis:C,maxWidth:C}},n)},hd=function(g){Z(t,g);var I=y(t);function t(){return A(this,t),I.apply(this,arguments)}return m(t,[{key:"render",value:function(){var g=this,I=this.props,t=I.segments,n=I.slotMetrics.slots,C=I.className,l=1;return e.createElement("div",{className:ht(C,"rbc-row")},t.reduce((function(e,I,t){var C=I.event,o=I.left,a=I.right,r=I.span,c="_lvl_"+t,i=o-l,A=bd(g.props,C);return i&&e.push(Zd(n,i,"".concat(c,"_gap"))),e.push(Zd(n,r,c,A)),l=a+1,e}),[]))}}]),t}(e.Component);function pd(g){var e=g.dateRange,I=g.unit,t=void 0===I?"day":I,n=g.localizer;return{first:e[0],last:n.add(e[e.length-1],1,t)}}function Gd(g){var e,I,t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,C=[],l=[];for(e=0;e<g.length;e++){for(t=g[e],I=0;I<C.length&&Bd(t,C[I]);I++);I>=n?l.push(t):(C[I]||(C[I]=[])).push(t)}for(e=0;e<C.length;e++)C[e].sort((function(g,e){return g.left-e.left}));return{levels:C,extra:l}}function yd(g,e,I,t,n){var C={start:t.start(g),end:t.end(g)},l={start:e,end:I};return n.inEventRange({event:C,range:l})}function Bd(g,e){return e.some((function(e){return e.left<=g.right&&e.right>=g.left}))}function fd(g,e,I,t){var n={start:I.start(g),end:I.end(g),allDay:I.allDay(g)},C={start:I.start(e),end:I.end(e),allDay:I.allDay(e)};return t.sortEvents({evtA:n,evtB:C})}hd.defaultProps=ce({},md);var Sd=function(g,e){return g.left<=e&&g.right>=e},Wd=function(g,e){return g.filter((function(g){return Sd(g,e)})).length},Vd=function(g){Z(t,g);var I=y(t);function t(){return A(this,t),I.apply(this,arguments)}return m(t,[{key:"render",value:function(){for(var g=this.props,I=g.segments,t=g.slotMetrics.slots,n=Gd(I).levels[0],C=1,l=1,o=[];C<=t;){var a="_lvl_"+C,r=n.filter((function(g){return Sd(g,C)}))[0]||{},c=r.event,i=r.left,A=r.right,s=r.span;if(c){var d=Math.max(0,i-l);if(this.canRenderSlotEvent(i,s)){var u=bd(this.props,c);d&&o.push(Zd(t,d,a+"_gap")),o.push(Zd(t,s,a,u)),l=C=A+1}else d&&o.push(Zd(t,d,a+"_gap")),o.push(Zd(t,1,a,this.renderShowMore(I,C))),l=C+=1}else C++}return e.createElement("div",{className:"rbc-row"},o)}},{key:"canRenderSlotEvent",value:function(g,e){var I=this.props.segments;return Hi(g,g+e).every((function(g){return 1===Wd(I,g)}))}},{key:"renderShowMore",value:function(g,I){var t=this,n=this.props.localizer,C=Wd(g,I);return!!C&&e.createElement("button",{type:"button",key:"sm_"+I,className:ht("rbc-button-link","rbc-show-more"),onClick:function(g){return t.showMore(I,g)}},n.messages.showMore(C))}},{key:"showMore",value:function(g,e){e.preventDefault(),e.stopPropagation(),this.props.onShowMore(g,e.target)}}]),t}(e.Component);Vd.defaultProps=ce({},md);var vd=function(g){var I=g.children;return e.createElement("div",{className:"rbc-row-content-scroll-container"},I)},Rd=function(g,e){return g[0].range===e[0].range&&g[0].events===e[0].events};function kd(){return Ki((function(g){for(var e=g.range,I=g.events,t=g.maxRows,n=g.minRows,C=g.accessors,l=g.localizer,o=pd({dateRange:e,localizer:l}),a=o.first,r=o.last,c=I.map((function(g){return function(g,e,I,t){var n=pd({dateRange:e,localizer:t}),C=n.first,l=n.last,o=t.diff(C,l,"day"),a=t.max(t.startOf(I.start(g),"day"),C),r=t.min(t.ceil(I.end(g),"day"),l),c=Ri(e,(function(g){return t.isSameDate(g,a)})),i=t.diff(a,r,"day");return i=Math.min(i,o),{event:g,span:i=Math.max(i-t.segmentOffset,1),left:c+1,right:Math.max(c+i,1)}}(g,e,C,l)})),i=Gd(c,Math.max(t-1,1)),A=i.levels,s=i.extra,d=s.length>0?n-1:n;A.length<d;)A.push([]);return{first:a,last:r,levels:A,extra:s,range:e,slots:e.length,clone:function(e){return kd()(ce(ce({},g),e))},getDateForSlot:function(g){return e[g]},getSlotForDate:function(g){return e.find((function(e){return l.isSameDate(e,g)}))},getEventsForSlot:function(g){return c.filter((function(e){return function(g,e){return g.left<=e&&g.right>=e}(e,g)})).map((function(g){return g.event}))},continuesPrior:function(g){return l.continuesPrior(C.start(g),a)},continuesAfter:function(g){var e=C.start(g),I=C.end(g);return l.continuesAfter(e,I,r)}}}),Rd)}var Xd=function(g){Z(t,g);var I=y(t);function t(){var g;A(this,t);for(var n=arguments.length,C=new Array(n),l=0;l<n;l++)C[l]=arguments[l];return(g=I.call.apply(I,[this].concat(C))).handleSelectSlot=function(e){var I=g.props,t=I.range;(0,I.onSelectSlot)(t.slice(e.start,e.end+1),e)},g.handleShowMore=function(e,I){var t,n,C,l=g.props,o=l.range,a=l.onShowMore,r=g.slotMetrics(g.props),c=(t=g.containerRef.current,n=".rbc-row-bg",Lc(t.querySelectorAll(n)))[0];c&&(C=c.children[e-1]),a(r.getEventsForSlot(e),o[e-1],C,e,I)},g.getContainer=function(){var e=g.props.container;return e?e():g.containerRef.current},g.renderHeadingCell=function(e,I){var t=g.props,n=t.renderHeader,C=t.getNow,l=t.localizer;return n({date:e,key:"header_".concat(I),className:ht("rbc-date-cell",l.isSameDate(e,C())&&"rbc-now")})},g.renderDummy=function(){var I=g.props,t=I.className,n=I.range,C=I.renderHeader,l=I.showAllEvents;return e.createElement("div",{className:t,ref:g.containerRef},e.createElement("div",{className:ht("rbc-row-content",l&&"rbc-row-content-scrollable")},C&&e.createElement("div",{className:"rbc-row",ref:g.headingRowRef},n.map(g.renderHeadingCell)),e.createElement("div",{className:"rbc-row",ref:g.eventRowRef},e.createElement("div",{className:"rbc-row-segment"},e.createElement("div",{className:"rbc-event"},e.createElement("div",{className:"rbc-event-content"},"\xa0"))))))},g.containerRef=(0,e.createRef)(),g.headingRowRef=(0,e.createRef)(),g.eventRowRef=(0,e.createRef)(),g.slotMetrics=kd(),g}return m(t,[{key:"getRowLimit",value:function(){var g,e=Dc(this.eventRowRef.current),I=null!==(g=this.headingRowRef)&&void 0!==g&&g.current?Dc(this.headingRowRef.current):0,t=Dc(this.containerRef.current)-I;return Math.max(Math.floor(t/e),1)}},{key:"render",value:function(){var g=this.props,I=g.date,t=g.rtl,n=g.range,C=g.className,l=g.selected,o=g.selectable,a=g.renderForMeasure,r=g.accessors,c=g.getters,i=g.components,A=g.getNow,s=g.renderHeader,d=g.onSelect,u=g.localizer,m=g.onSelectStart,b=g.onSelectEnd,Z=g.onDoubleClick,h=g.onKeyPress,p=g.resourceId,G=g.longPressThreshold,y=g.isAllDay,B=g.resizable,f=g.showAllEvents;if(a)return this.renderDummy();var S=this.slotMetrics(this.props),W=S.levels,V=S.extra,v=f?vd:ps,R=i.weekWrapper,k={selected:l,accessors:r,getters:c,localizer:u,components:i,onSelect:d,onDoubleClick:Z,onKeyPress:h,resourceId:p,slotMetrics:S,resizable:B};return e.createElement("div",{className:C,role:"rowgroup",ref:this.containerRef},e.createElement(ud,{localizer:u,date:I,getNow:A,rtl:t,range:n,selectable:o,container:this.getContainer,getters:c,onSelectStart:m,onSelectEnd:b,onSelectSlot:this.handleSelectSlot,components:i,longPressThreshold:G,resourceId:p}),e.createElement("div",{className:ht("rbc-row-content",f&&"rbc-row-content-scrollable"),role:"row"},s&&e.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},n.map(this.renderHeadingCell)),e.createElement(v,null,e.createElement(R,Object.assign({isAllDay:y},k,{rtl:this.props.rtl}),W.map((function(g,I){return e.createElement(hd,Object.assign({key:I,segments:g},k))})),!!V.length&&e.createElement(Vd,Object.assign({segments:V,onShowMore:this.handleShowMore},k))))))}}]),t}(e.Component);Xd.defaultProps={minRows:0,maxRows:1/0};var Jd=function(g){var I=g.label;return e.createElement("span",{role:"columnheader","aria-sort":"none"},I)},Yd=function(g){var I=g.label,t=g.drilldownView,n=g.onDrillDown;return t?e.createElement("button",{type:"button",className:"rbc-button-link",onClick:n,role:"cell"},I):e.createElement("span",null,I)},Hd=["date","className"],wd=function(g){Z(t,g);var I=y(t);function t(){var g;A(this,t);for(var n=arguments.length,C=new Array(n),l=0;l<n;l++)C[l]=arguments[l];return(g=I.call.apply(I,[this].concat(C))).getContainer=function(){return g.containerRef.current},g.renderWeek=function(I,t){var n=g.props,C=n.events,l=n.components,o=n.selectable,a=n.getNow,r=n.selected,c=n.date,A=n.localizer,s=n.longPressThreshold,d=n.accessors,u=n.getters,m=n.showAllEvents,b=g.state,Z=b.needLimitMeasure,h=b.rowLimit,p=function(g,e,I,t,n){return g.filter((function(g){return yd(g,e,I,t,n)}))}(i(C),I[0],I[I.length-1],d,A);return p.sort((function(g,e){return fd(g,e,d,A)})),e.createElement(Xd,{key:t,ref:0===t?g.slotRowRef:void 0,container:g.getContainer,className:"rbc-month-row",getNow:a,date:c,range:I,events:p,maxRows:m?1/0:h,selected:r,selectable:o,components:l,accessors:d,getters:u,localizer:A,renderHeader:g.readerDateHeading,renderForMeasure:Z,onShowMore:g.handleShowMore,onSelect:g.handleSelectEvent,onDoubleClick:g.handleDoubleClickEvent,onKeyPress:g.handleKeyPressEvent,onSelectSlot:g.handleSelectSlot,longPressThreshold:s,rtl:g.props.rtl,resizable:g.props.resizable,showAllEvents:m})},g.readerDateHeading=function(I){var t=I.date,n=I.className,C=bt(I,Hd),l=g.props,o=l.date,a=l.getDrilldownView,r=l.localizer,c=r.neq(t,o,"month"),i=r.isSameDate(t,o),A=a(t),s=r.format(t,"dateFormat"),d=g.props.components.dateHeader||Yd;return e.createElement("div",Object.assign({},C,{className:ht(n,c&&"rbc-off-range",i&&"rbc-current"),role:"cell"}),e.createElement(d,{label:s,date:t,drilldownView:A,isOffRange:c,onDrillDown:function(e){return g.handleHeadingClick(t,A,e)}}))},g.handleSelectSlot=function(e,I){g._pendingSelection=g._pendingSelection.concat(e),clearTimeout(g._selectTimer),g._selectTimer=setTimeout((function(){return g.selectDates(I)}))},g.handleHeadingClick=function(e,I,t){t.preventDefault(),g.clearSelection(),Vs(g.props.onDrillDown,[e,I])},g.handleSelectEvent=function(){g.clearSelection();for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onSelectEvent,I)},g.handleDoubleClickEvent=function(){g.clearSelection();for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onDoubleClickEvent,I)},g.handleKeyPressEvent=function(){g.clearSelection();for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onKeyPressEvent,I)},g.handleShowMore=function(e,I,t,n,C){var l=g.props,o=l.popup,a=l.onDrillDown,r=l.onShowMore,c=l.getDrilldownView,i=l.doShowMoreDrillDown;if(g.clearSelection(),o){var A=Bl(t,g.containerRef.current);g.setState({overlay:{date:I,events:e,position:A,target:C}})}else i&&Vs(a,[I,c(I)||Ss.DAY]);Vs(r,[e,I,n])},g.overlayDisplay=function(){g.setState({overlay:null})},g.state={rowLimit:5,needLimitMeasure:!0,date:null},g.containerRef=(0,e.createRef)(),g.slotRowRef=(0,e.createRef)(),g._bgRows=[],g._pendingSelection=[],g}return m(t,[{key:"componentDidMount",value:function(){var g,e=this;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){g||kl((function(){g=!1,e.setState({needLimitMeasure:!0})}))},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var g=this.props,I=g.date,t=g.localizer,n=g.className,C=t.visibleDays(I,t),l=al(C,7);return this._weekCount=l.length,e.createElement("div",{className:ht("rbc-month-view",n),role:"table","aria-label":"Month View",ref:this.containerRef},e.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(l[0])),l.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(g){var I=this.props,t=I.localizer,n=I.components,C=g[0],l=g[g.length-1],o=n.header||Jd;return t.range(C,l,"day").map((function(g,I){return e.createElement("div",{key:"header_"+I,className:"rbc-header"},e.createElement(o,{date:g,localizer:t,label:t.format(g,"weekdayFormat")}))}))}},{key:"renderOverlay",value:function(){var g,I,t=this,n=null!==(g=null===(I=this.state)||void 0===I?void 0:I.overlay)&&void 0!==g?g:{},C=this.props,l=C.accessors,o=C.localizer,a=C.components,r=C.getters,c=C.selected,i=C.popupOffset,A=C.handleDragStart;return e.createElement(ld,{overlay:n,accessors:l,localizer:o,components:a,getters:r,selected:c,popupOffset:i,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:A,show:!!n.position,overlayDisplay:this.overlayDisplay,onHide:function(){return t.setState({overlay:null})}})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(g){var e=this._pendingSelection.slice();this._pendingSelection=[],e.sort((function(g,e){return+g-+e}));var I=new Date(e[0]),t=new Date(e[e.length-1]);t.setDate(e[e.length-1].getDate()+1),Vs(this.props.onSelectSlot,{slots:e,start:I,end:t,action:g.action,bounds:g.bounds,box:g.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(g,e){var I=g.date;return{date:I,needLimitMeasure:g.localizer.neq(I,e.date,"month")}}}]),t}(e.Component);wd.range=function(g,e){var I=e.localizer;return{start:I.firstVisibleDay(g,I),end:I.lastVisibleDay(g,I)}},wd.navigate=function(g,e,I){var t=I.localizer;switch(e){case Gs:return t.add(g,-1,"month");case ys:return t.add(g,1,"month");default:return g}},wd.title=function(g,e){return e.localizer.format(g,"monthHeaderFormat")};var Nd=function(g){var e=g.min,I=g.max,t=g.step,n=g.slots,C=g.localizer;return"".concat(+C.startOf(e,"minutes"))+"".concat(+C.startOf(I,"minutes"))+"".concat(t,"-").concat(n)};function Kd(g){for(var e=g.min,I=g.max,t=g.step,n=g.timeslots,C=g.localizer,l=Nd({start:e,end:I,step:t,timeslots:n,localizer:C}),o=1+C.getTotalMin(e,I),a=C.getMinutesFromMidnight(e),r=Math.ceil((o-1)/(t*n)),c=r*n,i=new Array(r),A=new Array(c),s=0;s<r;s++){i[s]=new Array(n);for(var d=0;d<n;d++){var u=s*n+d,m=u*t;A[u]=i[s][d]=C.getSlotDate(e,a,m)}}var b=A.length*t;function Z(g){var I=C.diff(e,g,"minutes")+C.getDstOffset(e,g);return Math.min(I,o)}return A.push(C.getSlotDate(e,a,b)),{groups:i,update:function(g){return Nd(g)!==l?Kd(g):this},dateIsInGroup:function(g,e){var t=i[e+1];return C.inRange(g,i[e][0],t?t[0]:I,"minutes")},nextSlot:function(g){var e=A[Math.min(A.indexOf(g)+1,A.length-1)];return e===g&&(e=C.add(g,t,"minutes")),e},closestSlotToPosition:function(g){var e=Math.min(A.length-1,Math.max(0,Math.floor(g*c)));return A[e]},closestSlotFromPoint:function(g,e){var I=Math.abs(e.top-e.bottom);return this.closestSlotToPosition((g.y-e.top)/I)},closestSlotFromDate:function(g){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(C.lt(g,e,"minutes"))return A[0];if(C.gt(g,I,"minutes"))return A[A.length-1];var l=C.diff(e,g,"minutes");return A[(l-l%t)/t+n]},startsBeforeDay:function(g){return C.lt(g,e,"day")},startsAfterDay:function(g){return C.gt(g,I,"day")},startsBefore:function(g){return C.lt(C.merge(e,g),e,"minutes")},startsAfter:function(g){return C.gt(C.merge(I,g),I,"minutes")},getRange:function(g,n,l,o){l||(g=C.min(I,C.max(e,g))),o||(n=C.min(I,C.max(e,n)));var a=Z(g),r=Z(n),i=r>t*c&&!C.eq(I,n)?(a-t)/(t*c)*100:a/(t*c)*100;return{top:i,height:r/(t*c)*100-i,start:Z(g),startDate:g,end:Z(n),endDate:n}},getCurrentTimePosition:function(g){return Z(g)/(t*c)*100}}}var Fd=function(){function g(e,I){var t=I.accessors,n=I.slotMetrics;A(this,g);var C=n.getRange(t.start(e),t.end(e)),l=C.start,o=C.startDate,a=C.end,r=C.endDate,c=C.top,i=C.height;this.start=l,this.end=a,this.startMs=+o,this.endMs=+r,this.top=c,this.height=i,this.data=e}return m(g,[{key:"_width",get:function(){if(this.rows){var g=this.rows.reduce((function(g,e){return Math.max(g,e.leaves.length+1)}),0)+1;return 100/g}return this.leaves?(100-this.container._width)/(this.leaves.length+1):this.row._width}},{key:"width",get:function(){var g=this._width,e=Math.min(100,1.7*this._width);if(this.rows)return e;if(this.leaves)return this.leaves.length>0?e:g;var I=this.row.leaves;return I.indexOf(this)===I.length-1?g:e}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var g=this.row,e=g.leaves,I=g.xOffset,t=g._width;return I+(e.indexOf(this)+1)*t}}]),g}();function xd(g,e,I){return Math.abs(e.start-g.start)<I||e.start>g.start&&e.start<g.end}function Ed(g){for(var e=g.events,I=g.minimumStartDifference,t=g.slotMetrics,n=g.accessors,C=function(g){for(var e=lA(g,["startMs",function(g){return-g.endMs}]),I=[];e.length>0;){var t=e.shift();I.push(t);for(var n=0;n<e.length;n++){var C=e[n];if(!(t.endMs>C.startMs)){if(n>0){var l=e.splice(n,1)[0];I.push(l)}break}}}return I}(e.map((function(g){return new Fd(g,{slotMetrics:t,accessors:n})}))),l=[],o=function(){var g=C[a],e=l.find((function(e){return e.end>g.start||Math.abs(g.start-e.start)<I}));if(!e)return g.rows=[],l.push(g),"continue";g.container=e;for(var t=null,n=e.rows.length-1;!t&&n>=0;n--)xd(e.rows[n],g,I)&&(t=e.rows[n]);t?(t.leaves.push(g),g.row=t):(g.leaves=[],e.rows.push(g))},a=0;a<C.length;a++)o();return C.map((function(g){return{event:g.data,style:{top:g.top,height:g.height,width:g.width,xOffset:Math.max(0,g.xOffset)}}}))}function zd(g,e,I){for(var t=0;t<g.friends.length;++t)if(!(I.indexOf(g.friends[t])>-1)){e=e>g.friends[t].idx?e:g.friends[t].idx,I.push(g.friends[t]);var n=zd(g.friends[t],e,I);e=e>n?e:n}return e}var Md={overlap:Ed,"no-overlap":function(g){var e=Ed({events:g.events,minimumStartDifference:g.minimumStartDifference,slotMetrics:g.slotMetrics,accessors:g.accessors});e.sort((function(g,e){return g=g.style,e=e.style,g.top!==e.top?g.top>e.top?1:-1:g.top+g.height<e.top+e.height?1:-1}));for(var I=0;I<e.length;++I)e[I].friends=[],delete e[I].style.left,delete e[I].style.left,delete e[I].idx,delete e[I].size;for(var t=0;t<e.length-1;++t)for(var n=e[t],C=n.style.top,l=n.style.top+n.style.height,o=t+1;o<e.length;++o){var a=e[o],r=a.style.top,c=a.style.top+a.style.height;(r>=C&&c<=l||c>C&&c<=l||r>=C&&r<l)&&(n.friends.push(a),a.friends.push(n))}for(var i=0;i<e.length;++i){for(var A=e[i],s=[],d=0;d<100;++d)s.push(1);for(var u=0;u<A.friends.length;++u)void 0!==A.friends[u].idx&&(s[A.friends[u].idx]=0);A.idx=s.indexOf(1)}for(var m=0;m<e.length;++m){var b;if(!e[m].size){var Z=[];b=100/(zd(e[m],0,Z)+1),e[m].size=b;for(var h=0;h<Z.length;++h)Z[h].size=b}}for(var p=0;p<e.length;++p){var G=e[p];G.style.left=G.idx*G.size;for(var y=0,B=0;B<G.friends.length;++B){var f=G.friends[B].idx;y=y>f?y:f}y<=G.idx&&(G.size=100-G.idx*G.size);var S=0===G.idx?0:3;G.style.width="calc(".concat(G.size,"% - ").concat(S,"px)"),G.style.height="calc(".concat(G.style.height,"% - 2px)"),G.style.xOffset="calc(".concat(G.style.left,"% + ").concat(S,"px)")}return e}};var Ud=function(g){Z(t,g);var I=y(t);function t(){return A(this,t),I.apply(this,arguments)}return m(t,[{key:"render",value:function(){var g=this.props,I=g.renderSlot,t=g.resource,n=g.group,C=g.getters,l=g.components,o=(void 0===l?{}:l).timeSlotWrapper,a=void 0===o?ps:o,r=C?C.slotGroupProp(n):{};return e.createElement("div",Object.assign({className:"rbc-timeslot-group"},r),n.map((function(g,n){var l=C?C.slotProp(g,t):{};return e.createElement(a,{key:n,value:g,resource:t},e.createElement("div",Object.assign({},l,{className:ht("rbc-time-slot",l.className)}),I&&I(g,n)))})))}}]),t}(e.Component);function Dd(g){return"string"===typeof g?g:g+"%"}function Qd(g){var I=g.style,t=g.className,n=g.event,C=g.accessors,l=g.rtl,o=g.selected,a=g.label,r=g.continuesPrior,c=g.continuesAfter,i=g.getters,A=g.onClick,s=g.onDoubleClick,d=g.isBackgroundEvent,u=g.onKeyPress,m=g.components,b=m.event,Z=m.eventWrapper,h=C.title(n),p=C.tooltip(n),G=C.end(n),y=C.start(n),B=i.eventProp(n,y,G,o),f=I.height,S=I.top,W=I.width,V=I.xOffset,v=[e.createElement("div",{key:"1",className:"rbc-event-label"},a),e.createElement("div",{key:"2",className:"rbc-event-content"},b?e.createElement(b,{event:n,title:h}):h)],R=ce(ce({},B.style),{},d?ae({top:Dd(S),height:Dd(f),width:"calc(".concat(W," + 10px)")},l?"right":"left",Dd(Math.max(0,V))):ae({top:Dd(S),width:Dd(W),height:Dd(f)},l?"right":"left",Dd(V)));return e.createElement(Z,Object.assign({type:"time"},g),e.createElement("div",{onClick:A,onDoubleClick:s,style:R,onKeyPress:u,title:p?("string"===typeof a?a+": ":"")+p:void 0,className:ht(d?"rbc-background-event":"rbc-event",t,B.className,{"rbc-selected":o,"rbc-event-continues-earlier":r,"rbc-event-continues-later":c})},v))}var Ld=function(g){var I=g.children,t=g.className,n=g.style,C=g.innerRef;return e.createElement("div",{className:t,style:n,ref:C},I)},Td=e.forwardRef((function(g,I){return e.createElement(Ld,Object.assign({},g,{innerRef:I}))})),jd=["dayProp"],Od=["eventContainerWrapper"],Pd=function(g){Z(t,g);var I=y(t);function t(){var g;A(this,t);for(var n=arguments.length,C=new Array(n),l=0;l<n;l++)C[l]=arguments[l];return(g=I.call.apply(I,[this].concat(C))).state={selecting:!1,timeIndicatorPosition:null},g.intervalTriggered=!1,g.renderEvents=function(I){var t=I.events,n=I.isBackgroundEvent,C=g.props,l=C.rtl,o=C.selected,a=C.accessors,r=C.localizer,c=C.getters,i=C.components,A=C.step,s=C.timeslots,d=C.dayLayoutAlgorithm,u=C.resizable,m=G(g).slotMetrics,b=r.messages,Z=function(g){g.events,g.minimumStartDifference,g.slotMetrics,g.accessors;var e,I=g.dayLayoutAlgorithm,t=I;return I in Md&&(t=Md[I]),(e=t)&&e.constructor&&e.call&&e.apply?t.apply(this,arguments):[]}({events:t,accessors:a,slotMetrics:m,minimumStartDifference:Math.ceil(A*s/2),dayLayoutAlgorithm:d});return Z.map((function(I,t){var C,A=I.event,s=I.style,d=a.end(A),Z=a.start(A),h="eventTimeRangeFormat",p=m.startsBeforeDay(Z),G=m.startsAfterDay(d);p?h="eventTimeRangeEndFormat":G&&(h="eventTimeRangeStartFormat"),C=p&&G?b.allDay:r.format({start:Z,end:d},h);var y=p||m.startsBefore(Z),B=G||m.startsAfter(d);return e.createElement(Qd,{style:s,event:A,label:C,key:"evt_"+t,getters:c,rtl:l,components:i,continuesPrior:y,continuesAfter:B,accessors:a,resource:g.props.resource,selected:gd(A,o),onClick:function(e){return g._select(ce(ce({},A),{},{sourceResource:g.props.resource}),e)},onDoubleClick:function(e){return g._doubleClick(A,e)},isBackgroundEvent:n,onKeyPress:function(e){return g._keyPress(A,e)},resizable:u})}))},g._selectable=function(){var e=g.containerRef.current,I=g.props,t=I.longPressThreshold,n=I.localizer,C=g._selector=new id((function(){return e}),{longPressThreshold:t}),l=function(e){var I=g.props.onSelecting,t=g.state||{},C=o(e),l=C.startDate,a=C.endDate;I&&(n.eq(t.startDate,l,"minutes")&&n.eq(t.endDate,a,"minutes")||!1===I({start:l,end:a,resourceId:g.props.resource}))||g.state.start===C.start&&g.state.end===C.end&&g.state.selecting===C.selecting||g.setState(C)},o=function(I){var t=g.slotMetrics.closestSlotFromPoint(I,sd(e));g.state.selecting||(g._initialSlot=t);var C=g._initialSlot;n.lte(C,t)?t=g.slotMetrics.nextSlot(t):n.gt(C,t)&&(C=g.slotMetrics.nextSlot(C));var l=g.slotMetrics.getRange(n.min(C,t),n.max(C,t));return ce(ce({},l),{},{selecting:!0,top:"".concat(l.top,"%"),height:"".concat(l.height,"%")})},a=function(e,I){if(!ad(g.containerRef.current,e)){var t=o(e),n=t.startDate,C=t.endDate;g._selectSlot({startDate:n,endDate:C,action:I,box:e})}g.setState({selecting:!1})};C.on("selecting",l),C.on("selectStart",l),C.on("beforeSelect",(function(e){if("ignoreEvents"===g.props.selectable)return!ad(g.containerRef.current,e)})),C.on("click",(function(g){return a(g,"click")})),C.on("doubleClick",(function(g){return a(g,"doubleClick")})),C.on("select",(function(e){g.state.selecting&&(g._selectSlot(ce(ce({},g.state),{},{action:"select",bounds:e})),g.setState({selecting:!1}))})),C.on("reset",(function(){g.state.selecting&&g.setState({selecting:!1})}))},g._teardownSelectable=function(){g._selector&&(g._selector.teardown(),g._selector=null)},g._selectSlot=function(e){for(var I=e.startDate,t=e.endDate,n=e.action,C=e.bounds,l=e.box,o=I,a=[];g.props.localizer.lte(o,t);)a.push(o),o=new Date(+o+60*g.props.step*1e3);Vs(g.props.onSelectSlot,{slots:a,start:I,end:t,resourceId:g.props.resource,action:n,bounds:C,box:l})},g._select=function(){for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onSelectEvent,I)},g._doubleClick=function(){for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onDoubleClickEvent,I)},g._keyPress=function(){for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onKeyPressEvent,I)},g.slotMetrics=Kd(g.props),g.containerRef=(0,e.createRef)(),g}return m(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"UNSAFE_componentWillReceiveProps",value:function(g){g.selectable&&!this.props.selectable&&this._selectable(),!g.selectable&&this.props.selectable&&this._teardownSelectable(),this.slotMetrics=this.slotMetrics.update(g)}},{key:"componentDidUpdate",value:function(g,e){var I=this.props,t=I.getNow,n=I.isNow,C=I.localizer,l=I.date,o=I.min,a=I.max,r=C.neq(g.getNow(),t(),"minutes");if(g.isNow!==n||r){if(this.clearTimeIndicatorInterval(),n){var c=!r&&C.eq(g.date,l,"minutes")&&e.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(c)}}else n&&(C.neq(g.min,o,"minutes")||C.neq(g.max,a,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var g=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.intervalTriggered||e||this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout((function(){g.intervalTriggered=!0,g.positionTimeIndicator(),g.setTimeIndicatorPositionUpdateInterval()}),6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var g=this.props,e=g.min,I=g.max,t=(0,g.getNow)();if(t>=e&&t<=I){var n=this.slotMetrics.getCurrentTimePosition(t);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:n})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var g=this.props,I=g.date,t=g.max,n=g.rtl,C=g.isNow,l=g.resource,o=g.accessors,a=g.localizer,r=g.getters,c=r.dayProp,i=bt(r,jd),A=g.components,s=A.eventContainerWrapper,d=bt(A,Od),u=this.slotMetrics,m=this.state,b=m.selecting,Z=m.top,h=m.height,p={start:m.startDate,end:m.endDate},G=c(t),y=G.className,B=G.style,f=d.dayColumnWrapper||Td;return e.createElement(f,{ref:this.containerRef,date:I,style:B,className:ht(y,"rbc-day-slot","rbc-time-column",C&&"rbc-now",C&&"rbc-today",b&&"rbc-slot-selecting"),slotMetrics:u},u.groups.map((function(g,I){return e.createElement(Ud,{key:I,group:g,resource:l,getters:i,components:d})})),e.createElement(s,{localizer:a,resource:l,accessors:o,getters:i,components:d,slotMetrics:u},e.createElement("div",{className:ht("rbc-events-container",n&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),b&&e.createElement("div",{className:"rbc-slot-selection",style:{top:Z,height:h}},e.createElement("span",null,a.format(p,"selectRangeFormat"))),C&&this.intervalTriggered&&e.createElement("div",{className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}}))}}]),t}(e.Component);Pd.defaultProps={dragThroughEvents:!0,timeslots:2};var qd=function(g){var I=g.min,t=g.max,n=g.timeslots,C=g.step,l=g.localizer,o=g.getNow,a=g.resource,c=g.components,i=g.getters,A=g.gutterRef,s=c.timeGutterWrapper,d=(0,e.useMemo)((function(){return function(g){var e=g.min,I=g.max,t=g.localizer;return t.getTimezoneOffset(e)!==t.getTimezoneOffset(I)?{start:t.add(e,-1,"day"),end:t.add(I,-1,"day")}:{start:e,end:I}}({min:I,max:t,localizer:l})}),[null===I||void 0===I?void 0:I.toISOString(),null===t||void 0===t?void 0:t.toISOString(),l]),u=d.start,m=d.end,b=r((0,e.useState)(Kd({min:u,max:m,timeslots:n,step:C,localizer:l})),2),Z=b[0],h=b[1];(0,e.useEffect)((function(){Z&&h(Z.update({min:u,max:m,timeslots:n,step:C,localizer:l}))}),[null===u||void 0===u?void 0:u.toISOString(),null===m||void 0===m?void 0:m.toISOString(),n,C]);var p=(0,e.useCallback)((function(g,I){if(I)return null;var t=Z.dateIsInGroup(o(),I);return e.createElement("span",{className:ht("rbc-label",t&&"rbc-now")},l.format(g,"timeGutterFormat"))}),[Z,l,o]);return e.createElement(s,{slotMetrics:Z},e.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:A},Z.groups.map((function(g,I){return e.createElement(Ud,{key:I,group:g,resource:a,components:c,renderSlot:p,getters:i})}))))},_d=e.forwardRef((function(g,I){return e.createElement(qd,Object.assign({gutterRef:I},g))})),$d=function(g){var I=g.label;return e.createElement(e.Fragment,null,I)},gu=function(g){Z(t,g);var I=y(t);function t(){var g;A(this,t);for(var n=arguments.length,C=new Array(n),l=0;l<n;l++)C[l]=arguments[l];return(g=I.call.apply(I,[this].concat(C))).handleHeaderClick=function(e,I,t){t.preventDefault(),Vs(g.props.onDrillDown,[e,I])},g.renderRow=function(I){var t=g.props,n=t.events,C=t.rtl,l=t.selectable,o=t.getNow,a=t.range,r=t.getters,c=t.localizer,i=t.accessors,A=t.components,s=t.resizable,d=i.resourceId(I),u=I?n.filter((function(g){return i.resource(g)===d})):n;return e.createElement(Xd,{isAllDay:!0,rtl:C,getNow:o,minRows:2,maxRows:g.props.allDayMaxRows+1,range:a,events:u,resourceId:d,className:"rbc-allday-cell",selectable:l,selected:g.props.selected,components:A,accessors:i,getters:r,localizer:c,onSelect:g.props.onSelectEvent,onShowMore:g.props.onShowMore,onDoubleClick:g.props.onDoubleClickEvent,onKeyPress:g.props.onKeyPressEvent,onSelectSlot:g.props.onSelectSlot,longPressThreshold:g.props.longPressThreshold,resizable:s})},g}return m(t,[{key:"renderHeaderCells",value:function(g){var I=this,t=this.props,n=t.localizer,C=t.getDrilldownView,l=t.getNow,o=t.getters.dayProp,a=t.components.header,r=void 0===a?Jd:a,c=l();return g.map((function(g,t){var l=C(g),a=n.format(g,"dayFormat"),i=o(g),A=i.className,s=i.style,d=e.createElement(r,{date:g,label:a,localizer:n});return e.createElement("div",{key:t,style:s,className:ht("rbc-header",A,n.isSameDate(g,c)&&"rbc-today")},l?e.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(e){return I.handleHeaderClick(g,l,e)}},d):e.createElement("span",null,d))}))}},{key:"render",value:function(){var g=this,I=this.props,t=I.width,n=I.rtl,C=I.resources,l=I.range,o=I.events,a=I.getNow,c=I.accessors,i=I.selectable,A=I.components,s=I.getters,d=I.scrollRef,u=I.localizer,m=I.isOverflowing,b=I.components,Z=b.timeGutterHeader,h=b.resourceHeader,p=void 0===h?$d:h,G=I.resizable,y={};m&&(y[n?"marginLeft":"marginRight"]="".concat(oA()-1,"px"));var B=C.groupEvents(o);return e.createElement("div",{style:y,ref:d,className:ht("rbc-time-header",m&&"rbc-overflowing")},e.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:t,minWidth:t,maxWidth:t}},Z&&e.createElement(Z,null)),C.map((function(I,t){var C=r(I,2),o=C[0],d=C[1];return e.createElement("div",{className:"rbc-time-header-content",key:o||t},d&&e.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(t)},e.createElement("div",{className:"rbc-header"},e.createElement(p,{index:t,label:c.resourceTitle(d),resource:d}))),e.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(l.length<=1?" rbc-time-header-cell-single-day":"")},g.renderHeaderCells(l)),e.createElement(Xd,{isAllDay:!0,rtl:n,getNow:a,minRows:2,maxRows:g.props.allDayMaxRows+1,range:l,events:B.get(o)||[],resourceId:d&&o,className:"rbc-allday-cell",selectable:i,selected:g.props.selected,components:A,accessors:c,getters:s,localizer:u,onSelect:g.props.onSelectEvent,onShowMore:g.props.onShowMore,onDoubleClick:g.props.onDoubleClickEvent,onKeyPress:g.props.onKeyPressEvent,onSelectSlot:g.props.onSelectSlot,longPressThreshold:g.props.longPressThreshold,resizable:G}))})))}}]),t}(e.Component),eu={};var Iu=function(g){Z(t,g);var I=y(t);function t(g){var n;return A(this,t),(n=I.call(this,g)).handleScroll=function(g){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=g.target.scrollLeft)},n.handleResize=function(){Rl(n.rafHandle),n.rafHandle=kl(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];Vs(n.props.onKeyPressEvent,e)},n.handleSelectEvent=function(){n.clearSelection();for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];Vs(n.props.onSelectEvent,e)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];Vs(n.props.onDoubleClickEvent,e)},n.handleShowMore=function(g,e,I,t,C){var l=n.props,o=l.popup,a=l.onDrillDown,r=l.onShowMore,c=l.getDrilldownView,i=l.doShowMoreDrillDown;if(n.clearSelection(),o){var A=Bl(I,n.containerRef.current);n.setState({overlay:{date:e,events:g,position:ce(ce({},A),{},{width:"200px"}),target:C}})}else i&&Vs(a,[e,c(e)||Ss.DAY]);Vs(r,[g,e,t])},n.handleSelectAllDaySlot=function(g,e){var I=n.props.onSelectSlot,t=new Date(g[0]),C=new Date(g[g.length-1]);C.setDate(g[g.length-1].getDate()+1),Vs(I,{slots:g,start:t,end:C,action:e.action,resourceId:e.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var g=n.contentRef.current,e=g.scrollHeight>g.clientHeight;n.state.isOverflowing!==e&&(n._updatingOverflow=!0,n.setState({isOverflowing:e},(function(){n._updatingOverflow=!1})))}},n.memoizedResources=Ki((function(g,e){return function(g,e){return{map:function(I){return g?g.map((function(g,t){return I([e.resourceId(g),g],t)})):[I([eu,null],0)]},groupEvents:function(I){var t=new Map;return g?(I.forEach((function(g){var I=e.resource(g)||eu;if(Array.isArray(I))I.forEach((function(e){var I=t.get(e)||[];I.push(g),t.set(e,I)}));else{var n=t.get(I)||[];n.push(g),t.set(I,n)}})),t):(t.set(eu,I),t)}}}(g,e)})),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=e.createRef(),n.contentRef=e.createRef(),n.containerRef=e.createRef(),n._scrollRatio=null,n.gutterRef=(0,e.createRef)(),n}return m(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){null==this.props.width&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),Rl(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderEvents",value:function(g,I,t,n){var C=this,l=this.props,o=l.min,a=l.max,c=l.components,i=l.accessors,A=l.localizer,s=l.dayLayoutAlgorithm,d=this.memoizedResources(this.props.resources,i),u=d.groupEvents(I),m=d.groupEvents(t);return d.map((function(I,t){var l=r(I,2),d=l[0],b=l[1];return g.map((function(g,I){var l=(u.get(d)||[]).filter((function(e){return A.inRange(g,i.start(e),i.end(e),"day")})),r=(m.get(d)||[]).filter((function(e){return A.inRange(g,i.start(e),i.end(e),"day")}));return e.createElement(Pd,Object.assign({},C.props,{localizer:A,min:A.merge(g,o),max:A.merge(g,a),resource:b&&d,components:c,isNow:A.isSameDate(g,n),key:t+"-"+I,date:g,events:l,backgroundEvents:r,dayLayoutAlgorithm:s}))}))}))}},{key:"render",value:function(){var g,I=this.props,t=I.events,n=I.backgroundEvents,C=I.range,l=I.width,o=I.rtl,a=I.selected,r=I.getNow,c=I.resources,i=I.components,A=I.accessors,s=I.getters,d=I.localizer,u=I.min,m=I.max,b=I.showMultiDayTimes,Z=I.longPressThreshold,h=I.resizable;l=l||this.state.gutterWidth;var p=C[0],G=C[C.length-1];this.slots=C.length;var y=[],B=[],f=[];return t.forEach((function(g){if(yd(g,p,G,A,d)){var e=A.start(g),I=A.end(g);A.allDay(g)||d.startAndEndAreDateOnly(e,I)||!b&&!d.isSameDate(e,I)?y.push(g):B.push(g)}})),n.forEach((function(g){yd(g,p,G,A,d)&&f.push(g)})),y.sort((function(g,e){return fd(g,e,A,d)})),e.createElement("div",{className:ht("rbc-time-view",c&&"rbc-time-view-resources"),ref:this.containerRef},e.createElement(gu,{range:C,events:y,width:l,rtl:o,getNow:r,localizer:d,selected:a,allDayMaxRows:this.props.showAllEvents?1/0:null!==(g=this.props.allDayMaxRows)&&void 0!==g?g:1/0,resources:this.memoizedResources(c,A),selectable:this.props.selectable,accessors:A,getters:s,components:i,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:Z,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:h}),this.props.popup&&this.renderOverlay(),e.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},e.createElement(_d,{date:p,ref:this.gutterRef,localizer:d,min:d.merge(p,u),max:d.merge(p,m),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:i,className:"rbc-time-gutter",getters:s}),this.renderEvents(C,B,f,r())))}},{key:"renderOverlay",value:function(){var g,I,t=this,n=null!==(g=null===(I=this.state)||void 0===I?void 0:I.overlay)&&void 0!==g?g:{},C=this.props,l=C.accessors,o=C.localizer,a=C.components,r=C.getters,c=C.selected,i=C.popupOffset,A=C.handleDragStart;return e.createElement(ld,{overlay:n,accessors:l,localizer:o,components:a,getters:r,selected:c,popupOffset:i,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:A,show:!!n.position,overlayDisplay:this.overlayDisplay,onHide:function(){return t.setState({overlay:null})}})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var g=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame((function(){var e,I=null!==(e=g.gutterRef)&&void 0!==e&&e.current?aA(g.gutterRef.current):void 0;I&&g.state.gutterWidth!==I&&g.setState({gutterWidth:I})}))}},{key:"applyScroll",value:function(){if(null!=this._scrollRatio&&!0===this.props.enableAutoScroll){var g=this.contentRef.current;g.scrollTop=g.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,e=g.min,I=g.max,t=g.scrollToTime,n=g.localizer,C=n.diff(n.merge(t,e),t,"milliseconds"),l=n.diff(e,I,"milliseconds");this._scrollRatio=C/l}}]),t}(e.Component);Iu.defaultProps={step:30,timeslots:2};var tu=["date","localizer","min","max","scrollToTime","enableAutoScroll"],nu=function(g){Z(t,g);var I=y(t);function t(){return A(this,t),I.apply(this,arguments)}return m(t,[{key:"render",value:function(){var g=this.props,I=g.date,n=g.localizer,C=g.min,l=void 0===C?n.startOf(new Date,"day"):C,o=g.max,a=void 0===o?n.endOf(new Date,"day"):o,r=g.scrollToTime,c=void 0===r?n.startOf(new Date,"day"):r,i=g.enableAutoScroll,A=void 0===i||i,s=bt(g,tu),d=t.range(I,{localizer:n});return e.createElement(Iu,Object.assign({},s,{range:d,eventOffset:10,localizer:n,min:l,max:a,scrollToTime:c,enableAutoScroll:A}))}}]),t}(e.Component);nu.range=function(g,e){return[e.localizer.startOf(g,"day")]},nu.navigate=function(g,e,I){var t=I.localizer;switch(e){case Gs:return t.add(g,-1,"day");case ys:return t.add(g,1,"day");default:return g}},nu.title=function(g,e){return e.localizer.format(g,"dayHeaderFormat")};var Cu=["date","localizer","min","max","scrollToTime","enableAutoScroll"],lu=function(g){Z(t,g);var I=y(t);function t(){return A(this,t),I.apply(this,arguments)}return m(t,[{key:"render",value:function(){var g=this.props,I=g.date,n=g.localizer,C=g.min,l=void 0===C?n.startOf(new Date,"day"):C,o=g.max,a=void 0===o?n.endOf(new Date,"day"):o,r=g.scrollToTime,c=void 0===r?n.startOf(new Date,"day"):r,i=g.enableAutoScroll,A=void 0===i||i,s=bt(g,Cu),d=t.range(I,this.props);return e.createElement(Iu,Object.assign({},s,{range:d,eventOffset:15,localizer:n,min:l,max:a,scrollToTime:c,enableAutoScroll:A}))}}]),t}(e.Component);lu.defaultProps=Iu.defaultProps,lu.navigate=function(g,e,I){var t=I.localizer;switch(e){case Gs:return t.add(g,-1,"week");case ys:return t.add(g,1,"week");default:return g}},lu.range=function(g,e){var I=e.localizer,t=I.startOfWeek(),n=I.startOf(g,"week",t),C=I.endOf(g,"week",t);return I.range(n,C)},lu.title=function(g,e){var I=e.localizer,t=S(lu.range(g,{localizer:I})),n=t[0],C=t.slice(1);return I.format({start:n,end:C.pop()},"dayRangeHeaderFormat")};var ou=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function au(g,e){return lu.range(g,e).filter((function(g){return-1===[6,0].indexOf(g.getDay())}))}var ru,cu=function(g){Z(t,g);var I=y(t);function t(){return A(this,t),I.apply(this,arguments)}return m(t,[{key:"render",value:function(){var g=this.props,I=g.date,t=g.localizer,n=g.min,C=void 0===n?t.startOf(new Date,"day"):n,l=g.max,o=void 0===l?t.endOf(new Date,"day"):l,a=g.scrollToTime,r=void 0===a?t.startOf(new Date,"day"):a,c=g.enableAutoScroll,i=void 0===c||c,A=bt(g,ou),s=au(I,this.props);return e.createElement(Iu,Object.assign({},A,{range:s,eventOffset:15,localizer:t,min:C,max:o,scrollToTime:r,enableAutoScroll:i}))}}]),t}(e.Component);function iu(g){var I=g.accessors,t=g.components,n=g.date,C=g.events,l=g.getters,o=g.length,a=g.localizer,r=g.onDoubleClickEvent,c=g.onSelectEvent,i=g.selected,A=(0,e.useRef)(null),s=(0,e.useRef)(null),d=(0,e.useRef)(null),u=(0,e.useRef)(null),m=(0,e.useRef)(null);(0,e.useEffect)((function(){Z()}));var b=function(g,n){var C="",l=t.time,o=a.messages.allDay,r=I.end(n),c=I.start(n);return I.allDay(n)||(a.eq(c,r)?o=a.format(c,"agendaTimeFormat"):a.isSameDate(c,r)?o=a.format({start:c,end:r},"agendaTimeRangeFormat"):a.isSameDate(g,c)?o=a.format(c,"agendaTimeFormat"):a.isSameDate(g,r)&&(o=a.format(r,"agendaTimeFormat"))),a.gt(g,c,"day")&&(C="rbc-continues-prior"),a.lt(g,r,"day")&&(C+=" rbc-continues-after"),e.createElement("span",{className:C.trim()},l?e.createElement(l,{event:n,day:g,label:o}):o)},Z=function(){if(m.current){var g=A.current,e=m.current.firstChild;if(e){var I,t,n=u.current.scrollHeight>u.current.clientHeight,C=[],l=C;C=[aA(e.children[0]),aA(e.children[1])],l[0]===C[0]&&l[1]===C[1]||(s.current.style.width=C[0]+"px",d.current.style.width=C[1]+"px"),n?(t="rbc-header-overflowing",(I=g).classList?I.classList.add(t):function(g,e){return g.classList?!!e&&g.classList.contains(e):-1!==(" "+(g.className.baseVal||g.className)+" ").indexOf(" "+e+" ")}(I,t)||("string"===typeof I.className?I.className=I.className+" "+t:I.setAttribute("class",(I.className&&I.className.baseVal||"")+" "+t)),g.style.marginRight=oA()+"px"):function(g,e){g.classList?g.classList.remove(e):"string"===typeof g.className?g.className=rA(g.className,e):g.setAttribute("class",rA(g.className&&g.className.baseVal||"",e))}(g,"rbc-header-overflowing")}}},h=a.messages,p=a.add(n,o,"day"),G=a.range(n,p,"day");return(C=C.filter((function(g){return yd(g,a.startOf(n,"day"),a.endOf(p,"day"),I,a)}))).sort((function(g,e){return+I.start(g)-+I.start(e)})),e.createElement("div",{className:"rbc-agenda-view"},0!==C.length?e.createElement(e.Fragment,null,e.createElement("table",{ref:A,className:"rbc-agenda-table"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",{className:"rbc-header",ref:s},h.date),e.createElement("th",{className:"rbc-header",ref:d},h.time),e.createElement("th",{className:"rbc-header"},h.event)))),e.createElement("div",{className:"rbc-agenda-content",ref:u},e.createElement("table",{className:"rbc-agenda-table"},e.createElement("tbody",{ref:m},G.map((function(g,n){return function(g,n,C){var o=t.event,A=t.date;return n=n.filter((function(e){return yd(e,a.startOf(g,"day"),a.endOf(g,"day"),I,a)})),n.map((function(t,s){var d=I.title(t),u=I.end(t),m=I.start(t),Z=l.eventProp(t,m,u,gd(t,i)),h=0===s&&a.format(g,"agendaDateFormat"),p=0===s&&e.createElement("td",{rowSpan:n.length,className:"rbc-agenda-date-cell"},A?e.createElement(A,{day:g,label:h}):h);return e.createElement("tr",{key:C+"_"+s,className:Z.className,style:Z.style},p,e.createElement("td",{className:"rbc-agenda-time-cell"},b(g,t)),e.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(g){return c&&c(t,g)},onDoubleClick:function(g){return r&&r(t,g)}},o?e.createElement(o,{event:t,title:d}):d))}),[])}(g,C,n)})))))):e.createElement("span",{className:"rbc-agenda-empty"},h.noEventsInRange))}cu.defaultProps=Iu.defaultProps,cu.range=au,cu.navigate=lu.navigate,cu.title=function(g,e){var I=e.localizer,t=S(au(g,{localizer:I})),n=t[0],C=t.slice(1);return I.format({start:n,end:C.pop()},"dayRangeHeaderFormat")},iu.defaultProps={length:30},iu.range=function(g,e){var I=e.length,t=void 0===I?iu.defaultProps.length:I;return{start:g,end:e.localizer.add(g,t,"day")}},iu.navigate=function(g,e,I){var t=I.length,n=void 0===t?iu.defaultProps.length:t,C=I.localizer;switch(e){case Gs:return C.add(g,-n,"day");case ys:return C.add(g,n,"day");default:return g}},iu.title=function(g,e){var I=e.length,t=void 0===I?iu.defaultProps.length:I,n=e.localizer,C=n.add(g,t,"day");return n.format({start:g,end:C},"agendaHeaderFormat")};var Au=(ae(ru={},Ss.MONTH,wd),ae(ru,Ss.WEEK,lu),ae(ru,Ss.WORK_WEEK,cu),ae(ru,Ss.DAY,nu),ae(ru,Ss.AGENDA,iu),ru),su=["action","date","today"];var du=function(g){Z(t,g);var I=y(t);function t(){var g;A(this,t);for(var e=arguments.length,n=new Array(e),C=0;C<e;C++)n[C]=arguments[C];return(g=I.call.apply(I,[this].concat(n))).navigate=function(e){g.props.onNavigate(e)},g.view=function(e){g.props.onView(e)},g}return m(t,[{key:"render",value:function(){var g=this.props,I=g.localizer.messages,t=g.label;return e.createElement("div",{className:"rbc-toolbar"},e.createElement("span",{className:"rbc-btn-group"},e.createElement("button",{type:"button",onClick:this.navigate.bind(null,Bs)},I.today),e.createElement("button",{type:"button",onClick:this.navigate.bind(null,Gs)},I.previous),e.createElement("button",{type:"button",onClick:this.navigate.bind(null,ys)},I.next)),e.createElement("span",{className:"rbc-toolbar-label"},t),e.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(I)))}},{key:"viewNamesGroup",value:function(g){var I=this,t=this.props.views,n=this.props.view;if(t.length>1)return t.map((function(t){return e.createElement("button",{type:"button",key:t,className:ht({"rbc-active":n===t}),onClick:I.view.bind(null,t)},g[t])}))}}]),t}(e.Component);var uu=function(g){return function(e){return function(g,e){var I=null;return"function"===typeof e?I=e(g):"string"===typeof e&&"object"===s(g)&&null!=g&&e in g&&(I=g[e]),I}(e,g)}},mu=["view","date","getNow","onNavigate"],bu=["view","toolbar","events","backgroundEvents","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function Zu(g){if(Array.isArray(g))return g;for(var e=[],I=0,t=Object.entries(g);I<t.length;I++){var n=r(t[I],2),C=n[0];n[1]&&e.push(C)}return e}var hu=function(g){Z(t,g);var I=y(t);function t(){var g;A(this,t);for(var e=arguments.length,n=new Array(e),C=0;C<e;C++)n[C]=arguments[C];return(g=I.call.apply(I,[this].concat(n))).getViews=function(){var e=g.props.views;return Array.isArray(e)?Zs(e,(function(g,e){return g[e]=Au[e]}),{}):"object"===s(e)?hs(e,(function(g,e){return!0===g?Au[e]:g})):Au},g.getView=function(){return g.getViews()[g.props.view]},g.getDrilldownView=function(e){var I=g.props,t=I.view,n=I.drilldownView,C=I.getDrilldownView;return C?C(e,t,Object.keys(g.getViews())):n},g.handleRangeChange=function(e,I,t){var n=g.props,C=n.onRangeChange,l=n.localizer;C&&I.range&&C(I.range(e,{localizer:l}),t)},g.handleNavigate=function(e,I){var t=g.props,n=t.view,C=t.date,l=t.getNow,o=t.onNavigate,a=bt(t,mu),r=g.getView(),c=l();C=function(g,e){var I=e.action,t=e.date,n=e.today,C=bt(e,su);switch(g="string"===typeof g?Au[g]:g,I){case Bs:t=n||new Date;break;case fs:break;default:Hn()(g&&"function"===typeof g.navigate,"Calendar View components must implement a static `.navigate(date, action)` method.s"),t=g.navigate(t,I,C)}return t}(r,ce(ce({},a),{},{action:e,date:I||C||c,today:c})),o(C,n,e),g.handleRangeChange(C,r)},g.handleViewChange=function(e){e!==g.props.view&&function(g,e){return-1!==Zu(e.views).indexOf(g)}(e,g.props)&&g.props.onView(e);var I=g.getViews();g.handleRangeChange(g.props.date||g.props.getNow(),I[e],e)},g.handleSelectEvent=function(){for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onSelectEvent,I)},g.handleDoubleClickEvent=function(){for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onDoubleClickEvent,I)},g.handleKeyPressEvent=function(){for(var e=arguments.length,I=new Array(e),t=0;t<e;t++)I[t]=arguments[t];Vs(g.props.onKeyPressEvent,I)},g.handleSelectSlot=function(e){Vs(g.props.onSelectSlot,e)},g.handleDrillDown=function(e,I){var t=g.props.onDrillDown;t?t(e,I,g.drilldownView):(I&&g.handleViewChange(I),g.handleNavigate(fs,e))},g.state={context:t.getContext(g.props)},g}return m(t,[{key:"render",value:function(){var g=this.props,I=g.view,t=g.toolbar,n=g.events,C=g.backgroundEvents,l=g.style,o=g.className,a=g.elementProps,r=g.date,c=g.getNow,i=g.length,A=g.showMultiDayTimes,s=g.onShowMore,d=g.doShowMoreDrillDown;g.components,g.formats,g.messages,g.culture;var u=bt(g,bu);r=r||c();var m=this.getView(),b=this.state.context,Z=b.accessors,h=b.components,p=b.getters,G=b.localizer,y=b.viewNames,B=h.toolbar||du,f=m.title(r,{localizer:G,length:i});return e.createElement("div",Object.assign({},a,{className:ht(o,"rbc-calendar",u.rtl&&"rbc-rtl"),style:l}),t&&e.createElement(B,{date:r,view:I,views:y,label:f,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:G}),e.createElement(m,Object.assign({},u,{events:n,backgroundEvents:C,date:r,getNow:c,length:i,localizer:G,getters:p,components:h,accessors:Z,showMultiDayTimes:A,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:s,doShowMoreDrillDown:d})))}}],[{key:"getDerivedStateFromProps",value:function(g){return{context:t.getContext(g)}}},{key:"getContext",value:function(g){var e=g.startAccessor,I=g.endAccessor,t=g.allDayAccessor,n=g.tooltipAccessor,C=g.titleAccessor,l=g.resourceAccessor,o=g.resourceIdAccessor,a=g.resourceTitleAccessor,r=g.eventPropGetter,c=g.backgroundEventPropGetter,i=g.slotPropGetter,A=g.slotGroupPropGetter,s=g.dayPropGetter,d=g.view,u=g.views,m=g.localizer,b=g.culture,Z=g.messages,h=void 0===Z?{}:Z,p=g.components,G=void 0===p?{}:p,y=g.formats,B=void 0===y?{}:y,f=Zu(u);return{viewNames:f,localizer:Ps(m,b,B,function(g){return ce(ce({},qs),g)}(h)),getters:{eventProp:function(){return r&&r.apply(void 0,arguments)||{}},backgroundEventProp:function(){return c&&c.apply(void 0,arguments)||{}},slotProp:function(){return i&&i.apply(void 0,arguments)||{}},slotGroupProp:function(){return A&&A.apply(void 0,arguments)||{}},dayProp:function(){return s&&s.apply(void 0,arguments)||{}}},components:bs(G[d]||{},ds(G,f),{eventWrapper:ps,backgroundEventWrapper:ps,eventContainerWrapper:ps,dateCellWrapper:ps,weekWrapper:ps,timeSlotWrapper:ps,timeGutterWrapper:ps}),accessors:{start:uu(e),end:uu(I),allDay:uu(t),tooltip:uu(n),title:uu(C),resource:uu(l),resourceId:uu(o),resourceTitle:uu(a)}}}}]),t}(e.Component);hu.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:Ss.MONTH,views:[Ss.MONTH,Ss.WEEK,Ss.DAY,Ss.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:Ss.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var pu=function g(I,t,n){void 0===n&&(n=[]);var C,l=I.displayName||I.name||"Component",o=!!(C=I)&&("function"!==typeof C||C.prototype&&C.prototype.isReactComponent),a=Object.keys(t),r=a.map(Kn);!o&&n.length&&Hn()(!1);var c=function(g){var C,l;function o(){for(var e,I=arguments.length,C=new Array(I),l=0;l<I;l++)C[l]=arguments[l];(e=g.call.apply(g,[this].concat(C))||this).handlers=Object.create(null),a.forEach((function(g){var I=t[g];e.handlers[I]=function(t){if(e.props[I]){var n;e._notifying=!0;for(var C=arguments.length,l=new Array(C>1?C-1:0),o=1;o<C;o++)l[o-1]=arguments[o];(n=e.props)[I].apply(n,[t].concat(l)),e._notifying=!1}e.unmounted||e.setState((function(e){var I,n=e.values;return{values:Fn(Object.create(null),n,(I={},I[g]=t,I))}}))}})),n.length&&(e.attachRef=function(g){e.inner=g});var o=Object.create(null);return a.forEach((function(g){o[g]=e.props[Kn(g)]})),e.state={values:o,prevProps:{}},e}l=g,(C=o).prototype=Object.create(l.prototype),C.prototype.constructor=C,b(C,l);var c=o.prototype;return c.shouldComponentUpdate=function(){return!this._notifying},o.getDerivedStateFromProps=function(g,e){var I=e.values,t=e.prevProps,n={values:Fn(Object.create(null),I),prevProps:{}};return a.forEach((function(e){n.prevProps[e]=g[e],!Nn(g,e)&&Nn(t,e)&&(n.values[e]=g[Kn(e)])})),n},c.componentWillUnmount=function(){this.unmounted=!0},c.render=function(){var g=this,t=this.props,n=t.innerRef,C=mt(t,["innerRef"]);r.forEach((function(g){delete C[g]}));var l={};return a.forEach((function(e){var I=g.props[e];l[e]=void 0!==I?I:g.state.values[e]})),e.createElement(I,Fn({},C,l,this.handlers,{ref:n||this.attachRef}))},o}(e.Component);(0,xn.polyfill)(c),c.displayName="Uncontrolled("+l+")",c.propTypes=Fn({innerRef:function(){}},function(g,e){var I={};return Object.keys(g).forEach((function(g){I[Kn(g)]=wn})),I}(t)),n.forEach((function(g){c.prototype[g]=function(){var e;return(e=this.inner)[g].apply(e,arguments)}}));var i=c;return e.forwardRef&&((i=e.forwardRef((function(g,I){return e.createElement(c,Fn({},g,{innerRef:I,__source:{fileName:"/Users/jquense/src/uncontrollable/src/uncontrollable.js",lineNumber:128},__self:this}))}))).propTypes=c.propTypes),i.ControlledComponent=I,i.deferControlTo=function(e,I,n){return void 0===I&&(I={}),g(e,Fn({},t,I),n)},i}(hu,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),Gu=function(g,e,I){var t=g.start,n=g.end;return I.format(t,"LT",e)+" \u2013 "+I.format(n,"LT",e)},yu={dateFormat:"DD",dayFormat:"DD ddd",weekdayFormat:"ddd",selectRangeFormat:Gu,eventTimeRangeFormat:Gu,eventTimeRangeStartFormat:function(g,e,I){var t=g.start;return I.format(t,"LT",e)+" \u2013 "},eventTimeRangeEndFormat:function(g,e,I){var t=g.end;return" \u2013 "+I.format(t,"LT",e)},timeGutterFormat:"LT",monthHeaderFormat:"MMMM YYYY",dayHeaderFormat:"dddd MMM DD",dayRangeHeaderFormat:function(g,e,I){var t=g.start,n=g.end;return I.format(t,"MMMM DD",e)+" \u2013 "+I.format(n,I.eq(t,n,"month")?"DD":"MMMM DD",e)},agendaHeaderFormat:function(g,e,I){var t=g.start,n=g.end;return I.format(t,"L",e)+" \u2013 "+I.format(n,"L",e)},agendaDateFormat:"ddd MMM DD",agendaTimeFormat:"LT",agendaTimeRangeFormat:Gu};function Bu(g){var e=g?g.toLowerCase():g;return"FullYear"===e?e="year":e||(e=void 0),e}var fu=function(g){var e=g.isOpen,I=g.booking,t=g.onClose;return e?(0,gn.jsx)("div",{className:"modalOverlay",children:(0,gn.jsxs)("div",{className:"modalContent",children:[(0,gn.jsx)("h2",{children:"Booking Details"}),I&&(0,gn.jsxs)("div",{children:[(0,gn.jsxs)("p",{children:[(0,gn.jsx)("strong",{children:"Child:"})," ",I.child?I.child.name:"No Name"]}),(0,gn.jsxs)("p",{children:[(0,gn.jsx)("strong",{children:"Test:"})," ",I.child?I.child.testGrade:"No Name"]}),(0,gn.jsxs)("p",{children:[(0,gn.jsx)("strong",{children:"Date:"})," ",new Date(I.testSlot.date).toLocaleDateString()]}),(0,gn.jsxs)("p",{children:[(0,gn.jsx)("strong",{children:"Start Time:"})," ",I.testSlot.startTime]}),(0,gn.jsxs)("p",{children:[(0,gn.jsx)("strong",{children:"End Time:"})," ",I.testSlot.endTime]}),(0,gn.jsxs)("p",{children:[(0,gn.jsx)("strong",{children:"Fee:"})," ",I.price?"\u20a9".concat(new Intl.NumberFormat("ko-KR").format(I.price)):"N/A"]})]}),(0,gn.jsx)("button",{onClick:t,children:"Close"})]})}):null},Su=function(g){function e(e,I){var t,n,C=g(e).local(),l=g(I).local();if(!g.tz)return C.toDate().getTimezoneOffset()-l.toDate().getTimezoneOffset();var o=null!==(t=null===C||void 0===C||null===(n=C._z)||void 0===n?void 0:n.name)&&void 0!==t?t:g.tz.guess();return g.tz.zone(o).utcOffset(+C)-g.tz.zone(o).utcOffset(+l)}function I(e,I,t){var n=Bu(t);return[n?g(e).startOf(n):g(e),n?g(I).startOf(n):g(I),n]}function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,I=Bu(arguments.length>1?arguments[1]:void 0);return I?g(e).startOf(I).toDate():g(e).toDate()}function n(g,e,t){var n=r(I(g,e,t),3),C=n[0],l=n[1],o=n[2];return C.isSame(l,o)}function C(g,e,t){var n=r(I(g,e,t),3),C=n[0],l=n[1],o=n[2];return C.isSameOrBefore(l,o)}function l(e,I,t){var n=Bu(t);return g(e).add(I,n).toDate()}function o(g,e){var I=Bu(e),C=t(g,I);return n(C,g)?C:l(C,1,I)}function a(e,I){var t=Bu(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day"),n=g(e);return g(I).diff(n,t)}function c(e){return g(e).startOf("month").startOf("week").toDate()}function i(e){return g(e).endOf("month").endOf("week").toDate()}return new Os({formats:yu,firstOfWeek:function(e){var I=e?g.localeData(e):g.localeData();return I?I.firstDayOfWeek():0},firstVisibleDay:c,lastVisibleDay:i,visibleDays:function(g){for(var e=c(g),I=i(g),t=[];C(e,I);)t.push(e),e=l(e,1,"d");return t},format:function(e,I,t){return function(g,e){return e?g.locale(e):g}(g(e),t).format(I)},lt:function(g,e,t){var n=r(I(g,e,t),3),C=n[0],l=n[1],o=n[2];return C.isBefore(l,o)},lte:C,gt:function(g,e,t){var n=r(I(g,e,t),3),C=n[0],l=n[1],o=n[2];return C.isAfter(l,o)},gte:function(g,e,t){var n=r(I(g,e,t),3),C=n[0],l=n[1],o=n[2];return C.isSameOrBefore(l,o)},eq:n,neq:function(g,e,I){return!n(g,e,I)},merge:function(e,I){if(!e&&!I)return null;var t=g(I).format("HH:mm:ss"),n=g(e).startOf("day").format("MM/DD/YYYY");return g("".concat(n," ").concat(t),"MM/DD/YYYY HH:mm:ss").toDate()},inRange:function(e,I,t){var n=Bu(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"day"),C=g(e),l=g(I),o=g(t);return C.isBetween(l,o,n,"[]")},startOf:t,endOf:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,I=Bu(arguments.length>1?arguments[1]:void 0);return I?g(e).endOf(I).toDate():g(e).toDate()},range:function(e,I){for(var t=Bu(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day"),n=g(e).toDate(),o=[];C(n,I);)o.push(n),n=l(n,1,t);return o},add:l,diff:a,ceil:o,min:function(e,I){var t=g(e),n=g(I);return g.min(t,n).toDate()},max:function(e,I){var t=g(e),n=g(I);return g.max(t,n).toDate()},minutes:function(e){return g(e).minutes()},getSlotDate:function(e,I,t){return g(e).startOf("day").minute(I+t).toDate()},getTimezoneOffset:function(e){return g(e).toDate().getTimezoneOffset()},getDstOffset:e,getTotalMin:function(g,e){return a(g,e,"minutes")},getMinutesFromMidnight:function(I){var t=g(I).startOf("day");return g(I).diff(t,"minutes")+function(I){return e(g(I).startOf("day"),I)}(I)},continuesPrior:function(e,I){var t=g(e),n=g(I);return t.isBefore(n,"day")},continuesAfter:function(e,I,t){var n=g(I),C=g(t);return n.isSameOrAfter(C,"minutes")},sortEvents:function(g){var e=g.evtA,I=e.start,n=e.end,C=e.allDay,l=g.evtB,r=l.start,c=l.end,i=l.allDay,A=+t(I,"day")-+t(r,"day"),s=a(I,o(n,"day"),"day"),d=a(r,o(c,"day"),"day");return A||Math.max(d,1)-Math.max(s,1)||!!i-!!C||+I-+r||+n-+c},inEventRange:function(e){var I=e.event,t=I.start,n=I.end,C=e.range,l=C.start,o=C.end,a=g(t).startOf("day"),r=g(n),c=g(l),i=g(o),A=a.isSameOrBefore(i,"day"),s=!a.isSame(r,"minutes")?r.isAfter(c,"minutes"):r.isSameOrAfter(c,"minutes");return A&&s},isSameDate:function(e,I){var t=g(e),n=g(I);return t.isSame(n,"day")},browserTZOffset:function(){var e=new Date,I=/-/.test(e.toString())?"-":"",t=e.getTimezoneOffset(),n=Number("".concat(I).concat(Math.abs(t)));return g().utcOffset()>n?1:0}})}(nn()),Wu="".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/bookings"),Vu={height:500},vu=function(g){var e,I,t;if(console.log("Booking's child:",g.child),!g.testSlot)return null;var n=new Date(g.testSlot.date),C=new Date(g.testSlot.date),l=r(g.testSlot.startTime.split(":"),2),o=l[0],a=l[1],c=r(g.testSlot.endTime.split(":"),2),i=c[0],A=c[1];return n.setHours(parseInt(o),parseInt(a)),C.setHours(parseInt(i),parseInt(A)),{title:null!==g&&void 0!==g&&g.child?null===g||void 0===g||null===(e=g.child)||void 0===e?void 0:e.name:"No Name",start:n,end:C,resource:g,desc:g.child?"Additional info: ".concat((null===g||void 0===g||null===(I=g.child)||void 0===I?void 0:I.gender)||"No Gender"," ").concat((null===g||void 0===g||null===(t=g.child)||void 0===t?void 0:t.testGrade)||"No TestGrade"):"No Child Data"}},Ru=function(){var g=r((0,e.useState)([]),2),I=g[0],t=g[1],n=r((0,e.useState)(null),2),C=n[0],l=n[1],o=r((0,e.useState)(!1),2),a=o[0],c=o[1];(0,e.useEffect)((function(){var g=function(){var g=se(ie().mark((function g(){var e,I,n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,ut.get(Wu);case 3:e=g.sent,console.log("Fetched Bookings:",e.data),I=e.data.map(vu),t(I),g.next=13;break;case 9:g.prev=9,g.t0=g.catch(0),console.error("Error fetching bookings:",(null===(n=g.t0.response)||void 0===n?void 0:n.data)||g.t0.message),qt.error("Failed to fetch bookings.");case 13:case"end":return g.stop()}}),g,null,[[0,9]])})));return function(){return g.apply(this,arguments)}}();g()}),[]);return(0,gn.jsxs)("div",{style:Vu,children:[(0,gn.jsx)(pu,{localizer:Su,events:I,startAccessor:"start",endAccessor:"end",style:Vu,onSelectEvent:function(g){l(g.resource),console.log("Current selectedBooking after click:",C),c(!0)}}),(0,gn.jsx)(fu,{isOpen:a,booking:C,onClose:function(){l(null),c(!1)}})]})};var ku=function(g){var I=g.isOpen,t=g.onRequestClose,n=g.onParentUpdated,C=g.parent,l=r((0,e.useState)(ce(ce({},C),{},{children:C.children.map((function(g){return ce(ce({},g),{},{dateOfBirth:g.dateOfBirth?new Date(g.dateOfBirth).toISOString().split("T")[0]:""})}))})),2),o=l[0],a=l[1],c=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/parent/").concat(C._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:if(!(e=g.sent).ok){g.next=14;break}return qt.success("Parent updated successfully"),g.t0=n,g.next=9,e.json();case 9:g.t1=g.sent,(0,g.t0)(g.t1),t(),g.next=15;break;case 14:qt.error("Failed to update parent");case 15:g.next=21;break;case 17:g.prev=17,g.t2=g.catch(0),console.error(g.t2),qt.error("Failed to update parent");case 21:case"end":return g.stop()}}),g,null,[[0,17]])})));return function(){return g.apply(this,arguments)}}(),i=function(){var g=se(ie().mark((function g(e){var I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,I=o.children[e],g.next=4,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/child/").concat(I._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});case 4:g.sent.ok?qt.success("Child updated successfully"):qt.error("Failed to update child"),g.next=12;break;case 8:g.prev=8,g.t0=g.catch(0),console.error(g.t0),qt.error("Failed to update child");case 12:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(e){return g.apply(this,arguments)}}(),A=function(g,e,I){a((function(t){return ce(ce({},t),{},{children:t.children.map((function(t,n){return n===g?ce(ce({},t),{},ae({},e,I)):t}))})}))};return(0,gn.jsx)(ue(),{isOpen:I,onRequestClose:t,className:"edit-parent-modal",style:{content:{overflow:"auto"}},children:(0,gn.jsxs)("div",{className:"content",children:[(0,gn.jsx)("h3",{children:"Edit Parent Details"}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Name:"}),(0,gn.jsx)("input",{value:o.name,onChange:function(g){return a(ce(ce({},o),{},{name:g.target.value}))}})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Phone Number:"}),(0,gn.jsx)("input",{value:o.phone,onChange:function(g){return a(ce(ce({},o),{},{phone:g.target.value}))}})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:"Email:"}),(0,gn.jsx)("input",{value:o.email,onChange:function(g){return a(ce(ce({},o),{},{email:g.target.value}))}})]})]}),(0,gn.jsx)("h4",{children:"Children:"}),(0,gn.jsx)("div",{className:"input-group",children:o.children&&o.children.map((function(g,e){return(0,gn.jsxs)("div",{className:"child-details-card",children:[(0,gn.jsxs)("h5",{children:["Child ",e+1]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"Name:"}),(0,gn.jsx)("input",{value:g.name,onChange:function(g){return A(e,"name",g.target.value)}})]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"Previous School:"}),(0,gn.jsx)("input",{value:g.previousSchool,onChange:function(g){return A(e,"previousSchool",g.target.value)}})]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"Date of Birth:"}),(0,gn.jsx)("input",{type:"date",value:g.dateOfBirth,onChange:function(g){return A(e,"dateOfBirth",g.target.value)}})]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"Gender:"}),(0,gn.jsxs)("select",{value:g.gender,onChange:function(g){return A(e,"gender",g.target.value)},children:[(0,gn.jsx)("option",{value:"Male",children:"Male"}),(0,gn.jsx)("option",{value:"Female",children:"Female"})]})]}),(0,gn.jsx)("div",{className:"child-actions",children:(0,gn.jsx)("button",{className:"save-button",onClick:function(){return i(e)},children:"Save Child"})})]},e)}))}),(0,gn.jsxs)("div",{className:"actions",children:[(0,gn.jsx)("button",{className:"save-button",onClick:c,children:"Save"}),(0,gn.jsx)("button",{className:"cancel-button",onClick:t,children:"Cancel"})]})]})})};var Xu=function(){var g=r((0,e.useState)([]),2),I=g[0],t=g[1],n=r((0,e.useState)(""),2),C=n[0],l=n[1],o=r((0,e.useState)(null),2),a=o[0],c=o[1],i=r((0,e.useState)(!1),2),A=i[0],s=i[1],d=localStorage.getItem("userRole"),u=localStorage.getItem("userCampus");(0,e.useEffect)((function(){function g(){return(g=se(ie().mark((function g(){var e,I;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/parents"));case 2:return e=g.sent,g.next=5,e.json();case 5:I=g.sent,"admin"===d&&(I=I.filter((function(g){return g.campus===u}))),t(I);case 8:case"end":return g.stop()}}),g)})))).apply(this,arguments)}!function(){g.apply(this,arguments)}()}),[d,u]);var m=Array.isArray(I)?I.filter((function(g){return g.children.some((function(g){return g.name.toLowerCase().includes(C.toLowerCase())}))})):[];return(0,gn.jsxs)("div",{children:[(0,gn.jsx)("h2",{children:"Parent List"}),(0,gn.jsx)("div",{children:(0,gn.jsx)("input",{type:"text",placeholder:"Search by child name...",value:C,onChange:function(g){return l(g.target.value)}})}),(0,gn.jsxs)("table",{children:[(0,gn.jsx)("thead",{children:(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("th",{children:"Email"}),(0,gn.jsx)("th",{children:"Phone"}),(0,gn.jsx)("th",{children:"Campus"}),(0,gn.jsx)("th",{children:"Children's Names"}),(0,gn.jsx)("th",{children:"Test Grades"}),(0,gn.jsx)("th",{children:"Action"})]})}),(0,gn.jsx)("tbody",{children:m.map((function(g){return(0,gn.jsxs)("tr",{children:[(0,gn.jsx)("td",{children:g.email}),(0,gn.jsx)("td",{children:g.phone}),(0,gn.jsx)("td",{children:g.campus}),(0,gn.jsx)("td",{children:g.children.map((function(g){return g.name})).join(", ")}),(0,gn.jsx)("td",{children:g.children.map((function(g){return g.testGrade})).join(", ")}),(0,gn.jsx)("td",{children:(0,gn.jsx)("button",{onClick:function(){c(g),s(!0)},children:"Edit"})})]},g._id)}))})]}),a&&(0,gn.jsx)(ku,{isOpen:A,onRequestClose:function(){c(null),s(!1)},onParentUpdated:function(g){t(I.map((function(e){return e._id===g._id?g:e})))},parent:a})]})},Ju=I(8),Yu=I.n(Ju),Hu=function(g){var I=g.isOpen,t=g.onRequestClose,n=r((0,e.useState)(""),2),C=n[0],l=n[1],o=function(){var g=se(ie().mark((function g(e){var I,t,n;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!e){g.next=15;break}return I=e.text,console.log(I),l(I),t=I.split(",")[3].trim(),g.prev=5,g.next=8,ut.patch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/qr/").concat(t,"/attendedPresentation"),{attended:!0});case 8:n=g.sent,console.log("Attendance updated successfully:",n.data),g.next=15;break;case 12:g.prev=12,g.t0=g.catch(5),console.error("An error occurred while updating attendance:",g.t0);case 15:case"end":return g.stop()}}),g,null,[[5,12]])})));return function(e){return g.apply(this,arguments)}}(),a=C.split(","),c=a[0],i=a[1],A=a[2],s=a[3];return I&&(0,gn.jsx)("div",{className:"modal",children:(0,gn.jsxs)("div",{className:"modal-content",children:[(0,gn.jsx)("button",{className:"close-modal",onClick:t,children:"\xd7"}),(0,gn.jsx)(Yu(),{onScan:o}),(0,gn.jsxs)("p",{children:["Name: ",c]}),(0,gn.jsxs)("p",{children:["Phone Number: ",i]}),(0,gn.jsxs)("p",{children:["Slot Booked: ",A]}),(0,gn.jsxs)("p",{children:["User ID: ",s]})]})})},wu=function(){var g=r((0,e.useState)(null),2),I=g[0],t=g[1],n=r((0,e.useState)(null),2),C=n[0],l=n[1],o=r((0,e.useState)(null),2),a=o[0],c=o[1],i=r((0,e.useState)(!0),2),A=i[0],s=i[1],d=r((0,e.useState)(""),2),u=d[0],m=d[1],b=r((0,e.useState)(!1),2),Z=(b[0],b[1]);(0,e.useEffect)((function(){var g=localStorage.getItem("userRole");g&&m(g)}),[]);var h=function(g){s(!1),c(g)},p=function(){c(null),l(null),t(null)};return(0,gn.jsxs)("div",{className:"admin-dashboard",children:[(0,gn.jsx)("h1",{children:"Admin Dashboard"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("QRScanner")},children:"Open QR Scanner"}),(0,gn.jsxs)("div",{className:"filter-container",children:[(0,gn.jsx)("button",{className:"nav-button",onClick:function(){A&&c(null),s(!A)},children:A?"Hide Calendar":"Show Calendar"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("createTest")},children:"Create Test"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("presentationList")},children:"Presentations"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("testList")},children:"Tests"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("bookingList")},children:"Test Takers"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("attendeeList")},children:"Attendees"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("viewParents")},children:"Parents"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("createBookingPriority")},children:"Set Booking Priority Times"}),"superadmin"===u&&(0,gn.jsxs)(gn.Fragment,{children:[(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("createPresentation")},children:"Create Presentation"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("addAdmin")},children:"Add Admin"}),(0,gn.jsx)("button",{className:"nav-button",onClick:function(){h("editAdmins")},children:"View/Edit Admins"})]})]}),A&&(0,gn.jsx)(Ru,{}),"createBookingPriority"===a&&(0,gn.jsx)(Jn,{isOpen:!0,onRequestClose:p}),"createPresentation"===a&&(0,gn.jsx)(pn,{isOpen:!0,onRequestClose:p}),"updatePresentation"===a&&I&&(0,gn.jsx)(Gn,{presentationId:I,isOpen:!0,onRequestClose:p}),"createTest"===a&&(0,gn.jsx)(fn,{isOpen:!0,onRequestClose:p}),"updateTest"===a&&C&&(0,gn.jsx)(Sn,{testId:C,isOpen:!0,onRequestClose:p}),"presentationList"===a&&(0,gn.jsx)(Bn,{onEdit:function(g){t(g),h("updatePresentation")}}),"testList"===a&&(0,gn.jsx)(Wn,{onEdit:function(g){l(g),h("updateTest")}}),"bookingList"===a&&(0,gn.jsx)(Vn,{}),"attendeeList"===a&&(0,gn.jsx)(vn,{}),"addAdmin"===a&&(0,gn.jsx)(Rn,{}),"editAdmins"===a&&(0,gn.jsx)(Xn,{}),"viewParents"===a&&(0,gn.jsx)(Xu,{}),(0,gn.jsx)(Hu,{isOpen:"QRScanner"===a,onRequestClose:function(){Z(!1),c(null)}})]})};var Nu=function(g){var I=g.parentId,t=r((0,e.useState)(""),2),n=t[0],C=t[1],l=r((0,e.useState)(""),2),o=l[0],a=l[1],c=r((0,e.useState)(""),2),i=c[0],A=c[1],s=r((0,e.useState)(""),2),d=s[0],u=s[1],m=hg(),b=function(){var g=se(ie().mark((function g(){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,h();case 2:g.sent&&m("/parent",{replace:!0});case 4:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}(),Z=function(){var g=se(ie().mark((function g(){return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,h();case 2:g.sent&&p();case 4:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}(),h=function(){var g=se(ie().mark((function g(){var e;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=3,ut.post("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/child"),{name:n,previousSchool:o,dateOfBirth:i,gender:d,parent:I},Ie());case 3:if(201!==(e=g.sent).status){g.next=9;break}return console.log("Child created:",e.data),g.abrupt("return",!0);case 9:return console.error("Failed to create child:",e.data),g.abrupt("return",!1);case 11:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}(),p=function(){C(""),a(""),A(""),u("")};return(0,gn.jsx)("div",{className:"form-container",children:(0,gn.jsxs)("form",{className:"form",onSubmit:function(g){return g.preventDefault()},children:[(0,gn.jsx)("h2",{className:"form-title",children:"\ud559\uc0dd\ucd94\uac00"}),(0,gn.jsx)("p",{className:"text-red",children:"(\ubcf8\uc778\uc790\ub9e4\uac00 \uc790\ub140\uac00 \uc544\ub2cc \uacbd\uc6b0, \uc608\uc57d\uc740 \ubb34\ud6a8 \ucc98\ub9ac\ub429\ub2c8\ub2e4.)"}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"name",children:"\ud559\uc0dd(\uc720\uc544) \ud55c\uae00\uba85:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",value:n,onChange:function(g){return C(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"previousSchool",children:"\ud604\uc7ac \uc7ac\uc6d0\uc911\uc778 \uae30\uad00\uba85:"}),(0,gn.jsx)("input",{className:"form-input",type:"text",value:o,onChange:function(g){return a(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"dateOfBirth",children:"\uc0dd\ub144\uc6d4\uc77c:"}),(0,gn.jsx)("input",{className:"form-input",type:"date",value:i,onChange:function(g){return A(g.target.value)},required:!0})]}),(0,gn.jsxs)("div",{className:"form-field",children:[(0,gn.jsx)("label",{className:"form-label",htmlFor:"gender",children:"\uc131\ubcc4:"}),(0,gn.jsxs)("select",{className:"form-input",value:d,onChange:function(g){return u(g.target.value)},required:!0,children:[(0,gn.jsx)("option",{value:"",children:"\uc131\ubcc4\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),(0,gn.jsx)("option",{value:"male",children:"\ub0a8\uc131"}),(0,gn.jsx)("option",{value:"female",children:"\uc5ec\uc131"})]})]}),(0,gn.jsx)("button",{className:"form-button",onClick:b,children:"\uc800\uc7a5"}),(0,gn.jsx)("button",{className:"form-button secondary",onClick:Z,children:"\ub2e4\ub978\ud559\uc0dd \ucd94\uac00\ud558\uae30"})]})})},Ku="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAJNJREFUSEvFlUEOwCAIBNen9WVtf9anNSSSEKMV2qV68aIzoAEKkldJ5sMrOGogurvj8ggEulfiCSAkmQksXBwbgMsdPvD4RJ/hEsgoAwp8JKDBewIqvBXQ4VaQAldBGvw3gYjSsrB1kCJpC40u6VUyVbKkVWizpGSytF33MqEPHCvReonMG/dMDkHt4dkfvAbrxRvnNSYZuwlEMQAAAABJRU5ErkJggg==",Fu=["_id"];var xu=function(){var g=r((0,e.useState)({_id:te(),name:"",phone:"",email:"",campus:""}),2),I=g[0],t=g[1],n=r((0,e.useState)(!1),2),C=n[0],l=n[1];(0,e.useEffect)((function(){t({_id:te(),name:ne(),phone:Ce(),email:oe(),campus:le()})}),[]);var o=function(){var g=se(ie().mark((function g(){var e,t,n,C;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return l(!0),I._id,e=bt(I,Fu),g.next=4,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/parent/").concat(I._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 4:if(t=g.sent,l(!1),!t.ok){g.next=14;break}return qt.success("Parent updated successfully"),g.next=10,t.json();case 10:n=g.sent,localStorage.setItem("user",JSON.stringify(n)),g.next=18;break;case 14:return g.next=16,t.json();case 16:C=g.sent,qt.error("Failed to update parent: "+C.message);case 18:case"end":return g.stop()}}),g)})));return function(){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{className:"container",children:[(0,gn.jsx)("div",{className:"top-left-arrow",children:(0,gn.jsx)(Lg,{to:"/parent",children:(0,gn.jsx)("img",{src:Ku,alt:"Back to Parent Page"})})}),(0,gn.jsxs)("div",{className:"edit-parent",children:[(0,gn.jsx)("h3",{children:"\ub0b4 \uc815\ubcf4"}),(0,gn.jsxs)("div",{className:"input-group",children:[(0,gn.jsx)("label",{children:"\ud559\ubd80\ubaa8\uc774\ub984:"}),(0,gn.jsx)("input",{value:I.name,onChange:function(g){return t(ce(ce({},I),{},{name:g.target.value}))}}),(0,gn.jsx)("label",{children:"\uc804\ud654\ubc88\ud638:"}),(0,gn.jsx)("input",{value:I.phone,onChange:function(g){return t(ce(ce({},I),{},{phone:g.target.value}))}}),(0,gn.jsx)("label",{children:"\uc774\uba54\uc77c:"}),(0,gn.jsx)("input",{value:I.email,onChange:function(g){return t(ce(ce({},I),{},{email:g.target.value}))}}),(0,gn.jsx)("label",{children:"\ucea0\ud37c\uc2a4:"}),(0,gn.jsx)("p",{children:I.campus})]}),(0,gn.jsx)("div",{className:"actions",children:(0,gn.jsx)("button",{className:"save-button",onClick:o,disabled:C,children:C?"\uc800\uc7a5...":"\uc800\uc7a5"})})]})]})};function Eu(g,e){return e||(e=g.slice(0)),Object.freeze(Object.defineProperties(g,{raw:{value:Object.freeze(e)}}))}function zu(g){var e,I,t="";if("string"==typeof g||"number"==typeof g)t+=g;else if("object"==typeof g)if(Array.isArray(g))for(e=0;e<g.length;e++)g[e]&&(I=zu(g[e]))&&(t&&(t+=" "),t+=I);else for(e in g)g[e]&&(t&&(t+=" "),t+=e);return t}var Mu=function(){for(var g,e,I=0,t="";I<arguments.length;)(g=arguments[I++])&&(e=zu(g))&&(t&&(t+=" "),t+=e);return t};var Uu=!!t.useInsertionEffect&&t.useInsertionEffect,Du=Uu||function(g){return g()};Uu||e.useLayoutEffect;var Qu={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Lu(g){var e=Object.create(null);return function(I){return void 0===e[I]&&(e[I]=g(I)),e[I]}}var Tu=/[A-Z]|^ms/g,ju=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Ou=function(g){return 45===g.charCodeAt(1)},Pu=function(g){return null!=g&&"boolean"!==typeof g},qu=Lu((function(g){return Ou(g)?g:g.replace(Tu,"-$&").toLowerCase()})),_u=function(g,e){switch(g){case"animation":case"animationName":if("string"===typeof e)return e.replace(ju,(function(g,e,I){return gm={name:e,styles:I,next:gm},e}))}return 1===Qu[g]||Ou(g)||"number"!==typeof e||0===e?e:e+"px"};function $u(g,e,I){if(null==I)return"";if(void 0!==I.__emotion_styles)return I;switch(typeof I){case"boolean":return"";case"object":if(1===I.anim)return gm={name:I.name,styles:I.styles,next:gm},I.name;if(void 0!==I.styles){var t=I.next;if(void 0!==t)for(;void 0!==t;)gm={name:t.name,styles:t.styles,next:gm},t=t.next;return I.styles+";"}return function(g,e,I){var t="";if(Array.isArray(I))for(var n=0;n<I.length;n++)t+=$u(g,e,I[n])+";";else for(var C in I){var l=I[C];if("object"!==typeof l)null!=e&&void 0!==e[l]?t+=C+"{"+e[l]+"}":Pu(l)&&(t+=qu(C)+":"+_u(C,l)+";");else if(!Array.isArray(l)||"string"!==typeof l[0]||null!=e&&void 0!==e[l[0]]){var o=$u(g,e,l);switch(C){case"animation":case"animationName":t+=qu(C)+":"+o+";";break;default:t+=C+"{"+o+"}"}}else for(var a=0;a<l.length;a++)Pu(l[a])&&(t+=qu(C)+":"+_u(C,l[a])+";")}return t}(g,e,I);case"function":if(void 0!==g){var n=gm,C=I(g);return gm=n,$u(g,e,C)}}if(null==e)return I;var l=e[I];return void 0!==l?l:I}var gm,em=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var Im=function(g,e,I){if(1===g.length&&"object"===typeof g[0]&&null!==g[0]&&void 0!==g[0].styles)return g[0];var t=!0,n="";gm=void 0;var C=g[0];null==C||void 0===C.raw?(t=!1,n+=$u(I,e,C)):n+=C[0];for(var l=1;l<g.length;l++)n+=$u(I,e,g[l]),t&&(n+=C[l]);em.lastIndex=0;for(var o,a="";null!==(o=em.exec(n));)a+="-"+o[1];var r=function(g){for(var e,I=0,t=0,n=g.length;n>=4;++t,n-=4)e=1540483477*(65535&(e=255&g.charCodeAt(t)|(255&g.charCodeAt(++t))<<8|(255&g.charCodeAt(++t))<<16|(255&g.charCodeAt(++t))<<24))+(59797*(e>>>16)<<16),I=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&I)+(59797*(I>>>16)<<16);switch(n){case 3:I^=(255&g.charCodeAt(t+2))<<16;case 2:I^=(255&g.charCodeAt(t+1))<<8;case 1:I=1540483477*(65535&(I^=255&g.charCodeAt(t)))+(59797*(I>>>16)<<16)}return(((I=1540483477*(65535&(I^=I>>>13))+(59797*(I>>>16)<<16))^I>>>15)>>>0).toString(36)}(n)+a;return{name:r,styles:n,next:gm}};var tm=function(){function g(g){var e=this;this._insertTag=function(g){var I;I=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(g,I),e.tags.push(g)},this.isSpeedy=void 0===g.speedy||g.speedy,this.tags=[],this.ctr=0,this.nonce=g.nonce,this.key=g.key,this.container=g.container,this.prepend=g.prepend,this.insertionPoint=g.insertionPoint,this.before=null}var e=g.prototype;return e.hydrate=function(g){g.forEach(this._insertTag)},e.insert=function(g){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(g){var e=document.createElement("style");return e.setAttribute("data-emotion",g.key),void 0!==g.nonce&&e.setAttribute("nonce",g.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var I=function(g){if(g.sheet)return g.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===g)return document.styleSheets[e]}(e);try{I.insertRule(g,I.cssRules.length)}catch(Og){0}}else e.appendChild(document.createTextNode(g));this.ctr++},e.flush=function(){this.tags.forEach((function(g){return g.parentNode&&g.parentNode.removeChild(g)})),this.tags=[],this.ctr=0},g}(),nm=Math.abs,Cm=String.fromCharCode,lm=Object.assign;function om(g){return g.trim()}function am(g,e,I){return g.replace(e,I)}function rm(g,e){return g.indexOf(e)}function cm(g,e){return 0|g.charCodeAt(e)}function im(g,e,I){return g.slice(e,I)}function Am(g){return g.length}function sm(g){return g.length}function dm(g,e){return e.push(g),g}var um=1,mm=1,bm=0,Zm=0,hm=0,pm="";function Gm(g,e,I,t,n,C,l){return{value:g,root:e,parent:I,type:t,props:n,children:C,line:um,column:mm,length:l,return:""}}function ym(g,e){return lm(Gm("",null,null,"",null,null,0),g,{length:-g.length},e)}function Bm(){return hm=Zm>0?cm(pm,--Zm):0,mm--,10===hm&&(mm=1,um--),hm}function fm(){return hm=Zm<bm?cm(pm,Zm++):0,mm++,10===hm&&(mm=1,um++),hm}function Sm(){return cm(pm,Zm)}function Wm(){return Zm}function Vm(g,e){return im(pm,g,e)}function vm(g){switch(g){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Rm(g){return um=mm=1,bm=Am(pm=g),Zm=0,[]}function km(g){return pm="",g}function Xm(g){return om(Vm(Zm-1,Hm(91===g?g+2:40===g?g+1:g)))}function Jm(g){for(;(hm=Sm())&&hm<33;)fm();return vm(g)>2||vm(hm)>3?"":" "}function Ym(g,e){for(;--e&&fm()&&!(hm<48||hm>102||hm>57&&hm<65||hm>70&&hm<97););return Vm(g,Wm()+(e<6&&32==Sm()&&32==fm()))}function Hm(g){for(;fm();)switch(hm){case g:return Zm;case 34:case 39:34!==g&&39!==g&&Hm(hm);break;case 40:41===g&&Hm(g);break;case 92:fm()}return Zm}function wm(g,e){for(;fm()&&g+hm!==57&&(g+hm!==84||47!==Sm()););return"/*"+Vm(e,Zm-1)+"*"+Cm(47===g?g:fm())}function Nm(g){for(;!vm(Sm());)fm();return Vm(g,Zm)}var Km="-ms-",Fm="-moz-",xm="-webkit-",Em="comm",zm="rule",Mm="decl",Um="@keyframes";function Dm(g,e){for(var I="",t=sm(g),n=0;n<t;n++)I+=e(g[n],n,g,e)||"";return I}function Qm(g,e,I,t){switch(g.type){case"@layer":if(g.children.length)break;case"@import":case Mm:return g.return=g.return||g.value;case Em:return"";case Um:return g.return=g.value+"{"+Dm(g.children,t)+"}";case zm:g.value=g.props.join(",")}return Am(I=Dm(g.children,t))?g.return=g.value+"{"+I+"}":""}function Lm(g){return km(Tm("",null,null,null,[""],g=Rm(g),0,[0],g))}function Tm(g,e,I,t,n,C,l,o,a){for(var r=0,c=0,i=l,A=0,s=0,d=0,u=1,m=1,b=1,Z=0,h="",p=n,G=C,y=t,B=h;m;)switch(d=Z,Z=fm()){case 40:if(108!=d&&58==cm(B,i-1)){-1!=rm(B+=am(Xm(Z),"&","&\f"),"&\f")&&(b=-1);break}case 34:case 39:case 91:B+=Xm(Z);break;case 9:case 10:case 13:case 32:B+=Jm(d);break;case 92:B+=Ym(Wm()-1,7);continue;case 47:switch(Sm()){case 42:case 47:dm(Om(wm(fm(),Wm()),e,I),a);break;default:B+="/"}break;case 123*u:o[r++]=Am(B)*b;case 125*u:case 59:case 0:switch(Z){case 0:case 125:m=0;case 59+c:-1==b&&(B=am(B,/\f/g,"")),s>0&&Am(B)-i&&dm(s>32?Pm(B+";",t,I,i-1):Pm(am(B," ","")+";",t,I,i-2),a);break;case 59:B+=";";default:if(dm(y=jm(B,e,I,r,c,n,o,h,p=[],G=[],i),C),123===Z)if(0===c)Tm(B,e,y,y,p,C,i,o,G);else switch(99===A&&110===cm(B,3)?100:A){case 100:case 108:case 109:case 115:Tm(g,y,y,t&&dm(jm(g,y,y,0,0,n,o,h,n,p=[],i),G),n,G,i,o,t?p:G);break;default:Tm(B,y,y,y,[""],G,0,o,G)}}r=c=s=0,u=b=1,h=B="",i=l;break;case 58:i=1+Am(B),s=d;default:if(u<1)if(123==Z)--u;else if(125==Z&&0==u++&&125==Bm())continue;switch(B+=Cm(Z),Z*u){case 38:b=c>0?1:(B+="\f",-1);break;case 44:o[r++]=(Am(B)-1)*b,b=1;break;case 64:45===Sm()&&(B+=Xm(fm())),A=Sm(),c=i=Am(h=B+=Nm(Wm())),Z++;break;case 45:45===d&&2==Am(B)&&(u=0)}}return C}function jm(g,e,I,t,n,C,l,o,a,r,c){for(var i=n-1,A=0===n?C:[""],s=sm(A),d=0,u=0,m=0;d<t;++d)for(var b=0,Z=im(g,i+1,i=nm(u=l[d])),h=g;b<s;++b)(h=om(u>0?A[b]+" "+Z:am(Z,/&\f/g,A[b])))&&(a[m++]=h);return Gm(g,e,I,0===n?zm:o,a,r,c)}function Om(g,e,I){return Gm(g,e,I,Em,Cm(hm),im(g,2,-2),0)}function Pm(g,e,I,t){return Gm(g,e,I,Mm,im(g,0,t),im(g,t+1,-1),t)}var qm=function(g,e,I){for(var t=0,n=0;t=n,n=Sm(),38===t&&12===n&&(e[I]=1),!vm(n);)fm();return Vm(g,Zm)},_m=function(g,e){return km(function(g,e){var I=-1,t=44;do{switch(vm(t)){case 0:38===t&&12===Sm()&&(e[I]=1),g[I]+=qm(Zm-1,e,I);break;case 2:g[I]+=Xm(t);break;case 4:if(44===t){g[++I]=58===Sm()?"&\f":"",e[I]=g[I].length;break}default:g[I]+=Cm(t)}}while(t=fm());return g}(Rm(g),e))},$m=new WeakMap,gb=function(g){if("rule"===g.type&&g.parent&&!(g.length<1)){for(var e=g.value,I=g.parent,t=g.column===I.column&&g.line===I.line;"rule"!==I.type;)if(!(I=I.parent))return;if((1!==g.props.length||58===e.charCodeAt(0)||$m.get(I))&&!t){$m.set(g,!0);for(var n=[],C=_m(e,n),l=I.props,o=0,a=0;o<C.length;o++)for(var r=0;r<l.length;r++,a++)g.props[a]=n[o]?C[o].replace(/&\f/g,l[r]):l[r]+" "+C[o]}}},eb=function(g){if("decl"===g.type){var e=g.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(g.return="",g.value="")}};function Ib(g,e){switch(function(g,e){return 45^cm(g,0)?(((e<<2^cm(g,0))<<2^cm(g,1))<<2^cm(g,2))<<2^cm(g,3):0}(g,e)){case 5103:return xm+"print-"+g+g;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return xm+g+g;case 5349:case 4246:case 4810:case 6968:case 2756:return xm+g+Fm+g+Km+g+g;case 6828:case 4268:return xm+g+Km+g+g;case 6165:return xm+g+Km+"flex-"+g+g;case 5187:return xm+g+am(g,/(\w+).+(:[^]+)/,xm+"box-$1$2"+Km+"flex-$1$2")+g;case 5443:return xm+g+Km+"flex-item-"+am(g,/flex-|-self/,"")+g;case 4675:return xm+g+Km+"flex-line-pack"+am(g,/align-content|flex-|-self/,"")+g;case 5548:return xm+g+Km+am(g,"shrink","negative")+g;case 5292:return xm+g+Km+am(g,"basis","preferred-size")+g;case 6060:return xm+"box-"+am(g,"-grow","")+xm+g+Km+am(g,"grow","positive")+g;case 4554:return xm+am(g,/([^-])(transform)/g,"$1"+xm+"$2")+g;case 6187:return am(am(am(g,/(zoom-|grab)/,xm+"$1"),/(image-set)/,xm+"$1"),g,"")+g;case 5495:case 3959:return am(g,/(image-set\([^]*)/,xm+"$1$`$1");case 4968:return am(am(g,/(.+:)(flex-)?(.*)/,xm+"box-pack:$3"+Km+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+xm+g+g;case 4095:case 3583:case 4068:case 2532:return am(g,/(.+)-inline(.+)/,xm+"$1$2")+g;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Am(g)-1-e>6)switch(cm(g,e+1)){case 109:if(45!==cm(g,e+4))break;case 102:return am(g,/(.+:)(.+)-([^]+)/,"$1"+xm+"$2-$3$1"+Fm+(108==cm(g,e+3)?"$3":"$2-$3"))+g;case 115:return~rm(g,"stretch")?Ib(am(g,"stretch","fill-available"),e)+g:g}break;case 4949:if(115!==cm(g,e+1))break;case 6444:switch(cm(g,Am(g)-3-(~rm(g,"!important")&&10))){case 107:return am(g,":",":"+xm)+g;case 101:return am(g,/(.+:)([^;!]+)(;|!.+)?/,"$1"+xm+(45===cm(g,14)?"inline-":"")+"box$3$1"+xm+"$2$3$1"+Km+"$2box$3")+g}break;case 5936:switch(cm(g,e+11)){case 114:return xm+g+Km+am(g,/[svh]\w+-[tblr]{2}/,"tb")+g;case 108:return xm+g+Km+am(g,/[svh]\w+-[tblr]{2}/,"tb-rl")+g;case 45:return xm+g+Km+am(g,/[svh]\w+-[tblr]{2}/,"lr")+g}return xm+g+Km+g+g}return g}var tb=[function(g,e,I,t){if(g.length>-1&&!g.return)switch(g.type){case Mm:g.return=Ib(g.value,g.length);break;case Um:return Dm([ym(g,{value:am(g.value,"@","@"+xm)})],t);case zm:if(g.length)return function(g,e){return g.map(e).join("")}(g.props,(function(e){switch(function(g,e){return(g=e.exec(g))?g[0]:g}(e,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Dm([ym(g,{props:[am(e,/:(read-\w+)/,":-moz-$1")]})],t);case"::placeholder":return Dm([ym(g,{props:[am(e,/:(plac\w+)/,":"+xm+"input-$1")]}),ym(g,{props:[am(e,/:(plac\w+)/,":-moz-$1")]}),ym(g,{props:[am(e,/:(plac\w+)/,Km+"input-$1")]})],t)}return""}))}}],nb=function(g){var e=g.key;if("css"===e){var I=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(I,(function(g){-1!==g.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(g),g.setAttribute("data-s",""))}))}var t=g.stylisPlugins||tb;var n,C,l={},o=[];n=g.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(g){for(var e=g.getAttribute("data-emotion").split(" "),I=1;I<e.length;I++)l[e[I]]=!0;o.push(g)}));var a,r,c=[Qm,(r=function(g){a.insert(g)},function(g){g.root||(g=g.return)&&r(g)})],i=function(g){var e=sm(g);return function(I,t,n,C){for(var l="",o=0;o<e;o++)l+=g[o](I,t,n,C)||"";return l}}([gb,eb].concat(t,c));C=function(g,e,I,t){a=I,function(g){Dm(Lm(g),i)}(g?g+"{"+e.styles+"}":e.styles),t&&(A.inserted[e.name]=!0)};var A={key:e,sheet:new tm({key:e,container:n,nonce:g.nonce,speedy:g.speedy,prepend:g.prepend,insertionPoint:g.insertionPoint}),nonce:g.nonce,inserted:l,registered:{},insert:C};return A.sheet.hydrate(o),A};I(110);function Cb(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];return Im(e)}var lb=function(){var g=Cb.apply(void 0,arguments),e="animation-"+g.name;return{name:e,styles:"@keyframes "+e+"{"+g.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function ob(g){for(var e="https://mui.com/production-error/?code="+g,I=1;I<arguments.length;I+=1)e+="&args[]="+encodeURIComponent(arguments[I]);return"Minified MUI error #"+g+"; visit "+e+" for the full message."}function ab(g){if("string"!==typeof g)throw new Error(ob(7));return g.charAt(0).toUpperCase()+g.slice(1)}var rb=ab;function cb(g,e){var I=Fn({},e);return Object.keys(g).forEach((function(t){if(t.toString().match(/^(components|slots)$/))I[t]=Fn({},g[t],I[t]);else if(t.toString().match(/^(componentsProps|slotProps)$/)){var n=g[t]||{},C=e[t];I[t]={},C&&Object.keys(C)?n&&Object.keys(n)?(I[t]=Fn({},C),Object.keys(n).forEach((function(g){I[t][g]=cb(n[g],C[g])}))):I[t]=C:I[t]=n}else void 0===I[t]&&(I[t]=g[t])})),I}function ib(g){var e=g.theme,I=g.name,t=g.props;return e&&e.components&&e.components[I]&&e.components[I].defaultProps?cb(e.components[I].defaultProps,t):t}function Ab(g){return null!==g&&"object"===typeof g&&g.constructor===Object}function sb(g){if(!Ab(g))return g;var e={};return Object.keys(g).forEach((function(I){e[I]=sb(g[I])})),e}function db(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},t=I.clone?Fn({},g):g;return Ab(g)&&Ab(e)&&Object.keys(e).forEach((function(n){"__proto__"!==n&&(Ab(e[n])&&n in g&&Ab(g[n])?t[n]=db(g[n],e[n],I):I.clone?t[n]=Ab(e[n])?sb(e[n]):e[n]:t[n]=e[n])})),t}var ub=["values","unit","step"],mb=function(g){var e=Object.keys(g).map((function(e){return{key:e,val:g[e]}}))||[];return e.sort((function(g,e){return g.val-e.val})),e.reduce((function(g,e){return Fn({},g,ae({},e.key,e.val))}),{})};var bb={borderRadius:4},Zb={xs:0,sm:600,md:900,lg:1200,xl:1536},hb={keys:["xs","sm","md","lg","xl"],up:function(g){return"@media (min-width:".concat(Zb[g],"px)")}};function pb(g,e,I){var t=g.theme||{};if(Array.isArray(e)){var n=t.breakpoints||hb;return e.reduce((function(g,t,C){return g[n.up(n.keys[C])]=I(e[C]),g}),{})}if("object"===typeof e){var C=t.breakpoints||hb;return Object.keys(e).reduce((function(g,t){if(-1!==Object.keys(C.values||Zb).indexOf(t)){g[C.up(t)]=I(e[t],t)}else{var n=t;g[n]=e[n]}return g}),{})}return I(e)}function Gb(){var g,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null==(g=e.keys)?void 0:g.reduce((function(g,I){return g[e.up(I)]={},g}),{}))||{}}function yb(g,e){return g.reduce((function(g,e){var I=g[e];return(!I||0===Object.keys(I).length)&&delete g[e],g}),e)}function Bb(g,e){var I=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||"string"!==typeof e)return null;if(g&&g.vars&&I){var t="vars.".concat(e).split(".").reduce((function(g,e){return g&&g[e]?g[e]:null}),g);if(null!=t)return t}return e.split(".").reduce((function(g,e){return g&&null!=g[e]?g[e]:null}),g)}function fb(g,e,I){var t,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;return t="function"===typeof g?g(I):Array.isArray(g)?g[I]||n:Bb(g,I)||n,e&&(t=e(t,n,g)),t}var Sb=function(g){var e=g.prop,I=g.cssProperty,t=void 0===I?g.prop:I,n=g.themeKey,C=g.transform,l=function(g){if(null==g[e])return null;var I=g[e],l=Bb(g.theme,n)||{};return pb(g,I,(function(g){var I=fb(l,C,g);return g===I&&"string"===typeof g&&(I=fb(l,C,"".concat(e).concat("default"===g?"":ab(g)),g)),!1===t?I:ae({},t,I)}))};return l.propTypes={},l.filterProps=[e],l};var Wb=function(g,e){return e?db(g,e,{clone:!1}):g};var Vb={m:"margin",p:"padding"},vb={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Rb={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},kb=function(g){var e={};return function(I){return void 0===e[I]&&(e[I]=g(I)),e[I]}}((function(g){if(g.length>2){if(!Rb[g])return[g];g=Rb[g]}var e=r(g.split(""),2),I=e[0],t=e[1],n=Vb[I],C=vb[t]||"";return Array.isArray(C)?C.map((function(g){return n+g})):[n+C]})),Xb=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Jb=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Yb=[].concat(Xb,Jb);function Hb(g,e,I,t){var n,C=null!=(n=Bb(g,e,!1))?n:I;return"number"===typeof C?function(g){return"string"===typeof g?g:C*g}:Array.isArray(C)?function(g){return"string"===typeof g?g:C[g]}:"function"===typeof C?C:function(){}}function wb(g){return Hb(g,"spacing",8)}function Nb(g,e){if("string"===typeof e||null==e)return e;var I=g(Math.abs(e));return e>=0?I:"number"===typeof I?-I:"-".concat(I)}function Kb(g,e,I,t){if(-1===e.indexOf(I))return null;var n=function(g,e){return function(I){return g.reduce((function(g,t){return g[t]=Nb(e,I),g}),{})}}(kb(I),t);return pb(g,g[I],n)}function Fb(g,e){var I=wb(g.theme);return Object.keys(g).map((function(t){return Kb(g,e,t,I)})).reduce(Wb,{})}function xb(g){return Fb(g,Xb)}function Eb(g){return Fb(g,Jb)}function zb(g){return Fb(g,Yb)}xb.propTypes={},xb.filterProps=Xb,Eb.propTypes={},Eb.filterProps=Jb,zb.propTypes={},zb.filterProps=Yb;var Mb=function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];var t=e.reduce((function(g,e){return e.filterProps.forEach((function(I){g[I]=e})),g}),{}),n=function(g){return Object.keys(g).reduce((function(e,I){return t[I]?Wb(e,t[I](g)):e}),{})};return n.propTypes={},n.filterProps=e.reduce((function(g,e){return g.concat(e.filterProps)}),[]),n};function Ub(g){return"number"!==typeof g?g:"".concat(g,"px solid")}var Db=Sb({prop:"border",themeKey:"borders",transform:Ub}),Qb=Sb({prop:"borderTop",themeKey:"borders",transform:Ub}),Lb=Sb({prop:"borderRight",themeKey:"borders",transform:Ub}),Tb=Sb({prop:"borderBottom",themeKey:"borders",transform:Ub}),jb=Sb({prop:"borderLeft",themeKey:"borders",transform:Ub}),Ob=Sb({prop:"borderColor",themeKey:"palette"}),Pb=Sb({prop:"borderTopColor",themeKey:"palette"}),qb=Sb({prop:"borderRightColor",themeKey:"palette"}),_b=Sb({prop:"borderBottomColor",themeKey:"palette"}),$b=Sb({prop:"borderLeftColor",themeKey:"palette"}),gZ=function(g){if(void 0!==g.borderRadius&&null!==g.borderRadius){var e=Hb(g.theme,"shape.borderRadius",4);return pb(g,g.borderRadius,(function(g){return{borderRadius:Nb(e,g)}}))}return null};gZ.propTypes={},gZ.filterProps=["borderRadius"];Mb(Db,Qb,Lb,Tb,jb,Ob,Pb,qb,_b,$b,gZ);var eZ=function(g){if(void 0!==g.gap&&null!==g.gap){var e=Hb(g.theme,"spacing",8);return pb(g,g.gap,(function(g){return{gap:Nb(e,g)}}))}return null};eZ.propTypes={},eZ.filterProps=["gap"];var IZ=function(g){if(void 0!==g.columnGap&&null!==g.columnGap){var e=Hb(g.theme,"spacing",8);return pb(g,g.columnGap,(function(g){return{columnGap:Nb(e,g)}}))}return null};IZ.propTypes={},IZ.filterProps=["columnGap"];var tZ=function(g){if(void 0!==g.rowGap&&null!==g.rowGap){var e=Hb(g.theme,"spacing",8);return pb(g,g.rowGap,(function(g){return{rowGap:Nb(e,g)}}))}return null};tZ.propTypes={},tZ.filterProps=["rowGap"];Mb(eZ,IZ,tZ,Sb({prop:"gridColumn"}),Sb({prop:"gridRow"}),Sb({prop:"gridAutoFlow"}),Sb({prop:"gridAutoColumns"}),Sb({prop:"gridAutoRows"}),Sb({prop:"gridTemplateColumns"}),Sb({prop:"gridTemplateRows"}),Sb({prop:"gridTemplateAreas"}),Sb({prop:"gridArea"}));function nZ(g,e){return"grey"===e?e:g}Mb(Sb({prop:"color",themeKey:"palette",transform:nZ}),Sb({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:nZ}),Sb({prop:"backgroundColor",themeKey:"palette",transform:nZ}));function CZ(g){return g<=1&&0!==g?"".concat(100*g,"%"):g}var lZ=Sb({prop:"width",transform:CZ}),oZ=function(g){if(void 0!==g.maxWidth&&null!==g.maxWidth){return pb(g,g.maxWidth,(function(e){var I;return{maxWidth:(null==(I=g.theme)||null==(I=I.breakpoints)||null==(I=I.values)?void 0:I[e])||Zb[e]||CZ(e)}}))}return null};oZ.filterProps=["maxWidth"];var aZ=Sb({prop:"minWidth",transform:CZ}),rZ=Sb({prop:"height",transform:CZ}),cZ=Sb({prop:"maxHeight",transform:CZ}),iZ=Sb({prop:"minHeight",transform:CZ}),AZ=(Sb({prop:"size",cssProperty:"width",transform:CZ}),Sb({prop:"size",cssProperty:"height",transform:CZ}),Mb(lZ,oZ,aZ,rZ,cZ,iZ,Sb({prop:"boxSizing"})),{border:{themeKey:"borders",transform:Ub},borderTop:{themeKey:"borders",transform:Ub},borderRight:{themeKey:"borders",transform:Ub},borderBottom:{themeKey:"borders",transform:Ub},borderLeft:{themeKey:"borders",transform:Ub},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:gZ},color:{themeKey:"palette",transform:nZ},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:nZ},backgroundColor:{themeKey:"palette",transform:nZ},p:{style:Eb},pt:{style:Eb},pr:{style:Eb},pb:{style:Eb},pl:{style:Eb},px:{style:Eb},py:{style:Eb},padding:{style:Eb},paddingTop:{style:Eb},paddingRight:{style:Eb},paddingBottom:{style:Eb},paddingLeft:{style:Eb},paddingX:{style:Eb},paddingY:{style:Eb},paddingInline:{style:Eb},paddingInlineStart:{style:Eb},paddingInlineEnd:{style:Eb},paddingBlock:{style:Eb},paddingBlockStart:{style:Eb},paddingBlockEnd:{style:Eb},m:{style:xb},mt:{style:xb},mr:{style:xb},mb:{style:xb},ml:{style:xb},mx:{style:xb},my:{style:xb},margin:{style:xb},marginTop:{style:xb},marginRight:{style:xb},marginBottom:{style:xb},marginLeft:{style:xb},marginX:{style:xb},marginY:{style:xb},marginInline:{style:xb},marginInlineStart:{style:xb},marginInlineEnd:{style:xb},marginBlock:{style:xb},marginBlockStart:{style:xb},marginBlockEnd:{style:xb},displayPrint:{cssProperty:!1,transform:function(g){return{"@media print":{display:g}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:eZ},rowGap:{style:tZ},columnGap:{style:IZ},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:CZ},maxWidth:{style:oZ},minWidth:{transform:CZ},height:{transform:CZ},maxHeight:{transform:CZ},minHeight:{transform:CZ},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});var sZ=function(){function g(g,e,I,t){var n,C=(ae(n={},g,e),ae(n,"theme",I),n),l=t[g];if(!l)return ae({},g,e);var o=l.cssProperty,a=void 0===o?g:o,r=l.themeKey,c=l.transform,i=l.style;if(null==e)return null;if("typography"===r&&"inherit"===e)return ae({},g,e);var A=Bb(I,r)||{};if(i)return i(C);return pb(C,e,(function(e){var I=fb(A,c,e);return e===I&&"string"===typeof e&&(I=fb(A,c,"".concat(g).concat("default"===e?"":ab(e)),e)),!1===a?I:ae({},a,I)}))}return function e(I){var t,n=I||{},C=n.sx,l=n.theme,o=void 0===l?{}:l;if(!C)return null;var a=null!=(t=o.unstable_sxConfig)?t:AZ;function r(I){var t=I;if("function"===typeof I)t=I(o);else if("object"!==typeof I)return I;if(!t)return null;var n=Gb(o.breakpoints),C=Object.keys(n),l=n;return Object.keys(t).forEach((function(I){var n,C,r=(n=t[I],C=o,"function"===typeof n?n(C):n);if(null!==r&&void 0!==r)if("object"===typeof r)if(a[I])l=Wb(l,g(I,r,o,a));else{var c=pb({theme:o},r,(function(g){return ae({},I,g)}));!function(){for(var g=arguments.length,e=new Array(g),I=0;I<g;I++)e[I]=arguments[I];var t=e.reduce((function(g,e){return g.concat(Object.keys(e))}),[]),n=new Set(t);return e.every((function(g){return n.size===Object.keys(g).length}))}(c,r)?l=Wb(l,c):l[I]=e({sx:r,theme:o})}else l=Wb(l,g(I,r,o,a))})),yb(C,l)}return Array.isArray(C)?C.map(r):r(C)}}();sZ.filterProps=["sx"];var dZ=sZ,uZ=["breakpoints","palette","spacing","shape"];var mZ=function(){for(var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.breakpoints,I=void 0===e?{}:e,t=g.palette,n=void 0===t?{}:t,C=g.spacing,l=g.shape,o=void 0===l?{}:l,a=mt(g,uZ),r=function(g){var e=g.values,I=void 0===e?{xs:0,sm:600,md:900,lg:1200,xl:1536}:e,t=g.unit,n=void 0===t?"px":t,C=g.step,l=void 0===C?5:C,o=mt(g,ub),a=mb(I),r=Object.keys(a);function c(g){var e="number"===typeof I[g]?I[g]:g;return"@media (min-width:".concat(e).concat(n,")")}function i(g){var e="number"===typeof I[g]?I[g]:g;return"@media (max-width:".concat(e-l/100).concat(n,")")}function A(g,e){var t=r.indexOf(e);return"@media (min-width:".concat("number"===typeof I[g]?I[g]:g).concat(n,") and ")+"(max-width:".concat((-1!==t&&"number"===typeof I[r[t]]?I[r[t]]:e)-l/100).concat(n,")")}return Fn({keys:r,values:a,up:c,down:i,between:A,only:function(g){return r.indexOf(g)+1<r.length?A(g,r[r.indexOf(g)+1]):c(g)},not:function(g){var e=r.indexOf(g);return 0===e?c(r[1]):e===r.length-1?i(r[e]):A(g,r[r.indexOf(g)+1]).replace("@media","@media not all and")},unit:n},o)}(I),c=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(g.mui)return g;var e=wb({spacing:g}),I=function(){for(var g=arguments.length,I=new Array(g),t=0;t<g;t++)I[t]=arguments[t];return(0===I.length?[1]:I).map((function(g){var I=e(g);return"number"===typeof I?"".concat(I,"px"):I})).join(" ")};return I.mui=!0,I}(C),i=db({breakpoints:r,direction:"ltr",components:{},palette:Fn({mode:"light"},n),spacing:c,shape:Fn({},bb,o)},a),A=arguments.length,s=new Array(A>1?A-1:0),d=1;d<A;d++)s[d-1]=arguments[d];return(i=s.reduce((function(g,e){return db(g,e)}),i)).unstable_sxConfig=Fn({},AZ,null==a?void 0:a.unstable_sxConfig),i.unstable_sx=function(g){return dZ({sx:g,theme:this})},i},bZ=e.createContext("undefined"!==typeof HTMLElement?nb({key:"css"}):null);bZ.Provider;var ZZ=function(g){return(0,e.forwardRef)((function(I,t){var n=(0,e.useContext)(bZ);return g(I,n,t)}))};var hZ=e.createContext({});var pZ=function(){var g,I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e.useContext(hZ);return t&&(g=t,0!==Object.keys(g).length)?t:I},GZ=mZ();var yZ=function(){return pZ(arguments.length>0&&void 0!==arguments[0]?arguments[0]:GZ)};function BZ(g,e){var I;return Fn({toolbar:(I={minHeight:56},ae(I,g.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),ae(I,g.up("sm"),{minHeight:64}),I)},e)}function fZ(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,g),I)}function SZ(g){if(g.type)return g;if("#"===g.charAt(0))return SZ(function(g){g=g.slice(1);var e=new RegExp(".{1,".concat(g.length>=6?2:1,"}"),"g"),I=g.match(e);return I&&1===I[0].length&&(I=I.map((function(g){return g+g}))),I?"rgb".concat(4===I.length?"a":"","(").concat(I.map((function(g,e){return e<3?parseInt(g,16):Math.round(parseInt(g,16)/255*1e3)/1e3})).join(", "),")"):""}(g));var e=g.indexOf("("),I=g.substring(0,e);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(I))throw new Error(ob(9,g));var t,n=g.substring(e+1,g.length-1);if("color"===I){if(t=(n=n.split(" ")).shift(),4===n.length&&"/"===n[3].charAt(0)&&(n[3]=n[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(t))throw new Error(ob(10,t))}else n=n.split(",");return{type:I,values:n=n.map((function(g){return parseFloat(g)})),colorSpace:t}}function WZ(g){var e=g.type,I=g.colorSpace,t=g.values;return-1!==e.indexOf("rgb")?t=t.map((function(g,e){return e<3?parseInt(g,10):g})):-1!==e.indexOf("hsl")&&(t[1]="".concat(t[1],"%"),t[2]="".concat(t[2],"%")),t=-1!==e.indexOf("color")?"".concat(I," ").concat(t.join(" ")):"".concat(t.join(", ")),"".concat(e,"(").concat(t,")")}function VZ(g){var e="hsl"===(g=SZ(g)).type||"hsla"===g.type?SZ(function(g){var e=(g=SZ(g)).values,I=e[0],t=e[1]/100,n=e[2]/100,C=t*Math.min(n,1-n),l=function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(g+I/30)%12;return n-C*Math.max(Math.min(e-3,9-e,1),-1)},o="rgb",a=[Math.round(255*l(0)),Math.round(255*l(8)),Math.round(255*l(4))];return"hsla"===g.type&&(o+="a",a.push(e[3])),WZ({type:o,values:a})}(g)).values:g.values;return e=e.map((function(e){return"color"!==g.type&&(e/=255),e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function vZ(g,e){if(g=SZ(g),e=fZ(e),-1!==g.type.indexOf("hsl"))g.values[2]*=1-e;else if(-1!==g.type.indexOf("rgb")||-1!==g.type.indexOf("color"))for(var I=0;I<3;I+=1)g.values[I]*=1-e;return WZ(g)}function RZ(g,e){if(g=SZ(g),e=fZ(e),-1!==g.type.indexOf("hsl"))g.values[2]+=(100-g.values[2])*e;else if(-1!==g.type.indexOf("rgb"))for(var I=0;I<3;I+=1)g.values[I]+=(255-g.values[I])*e;else if(-1!==g.type.indexOf("color"))for(var t=0;t<3;t+=1)g.values[t]+=(1-g.values[t])*e;return WZ(g)}var kZ={black:"#000",white:"#fff"},XZ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},JZ={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},YZ={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},HZ={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},wZ={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},NZ={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},KZ={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},FZ=["mode","contrastThreshold","tonalOffset"],xZ={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:kZ.white,default:kZ.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},EZ={text:{primary:kZ.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:kZ.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function zZ(g,e,I,t){var n=t.light||t,C=t.dark||1.5*t;g[e]||(g.hasOwnProperty(I)?g[e]=g[I]:"light"===e?g.light=RZ(g.main,n):"dark"===e&&(g.dark=vZ(g.main,C)))}function MZ(g){var e=g.mode,I=void 0===e?"light":e,t=g.contrastThreshold,n=void 0===t?3:t,C=g.tonalOffset,l=void 0===C?.2:C,o=mt(g,FZ),a=g.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:wZ[200],light:wZ[50],dark:wZ[400]}:{main:wZ[700],light:wZ[400],dark:wZ[800]}}(I),r=g.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:JZ[200],light:JZ[50],dark:JZ[400]}:{main:JZ[500],light:JZ[300],dark:JZ[700]}}(I),c=g.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:YZ[500],light:YZ[300],dark:YZ[700]}:{main:YZ[700],light:YZ[400],dark:YZ[800]}}(I),i=g.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:NZ[400],light:NZ[300],dark:NZ[700]}:{main:NZ[700],light:NZ[500],dark:NZ[900]}}(I),A=g.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:KZ[400],light:KZ[300],dark:KZ[700]}:{main:KZ[800],light:KZ[500],dark:KZ[900]}}(I),s=g.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:HZ[400],light:HZ[300],dark:HZ[700]}:{main:"#ed6c02",light:HZ[500],dark:HZ[900]}}(I);function d(g){var e=function(g,e){var I=VZ(g),t=VZ(e);return(Math.max(I,t)+.05)/(Math.min(I,t)+.05)}(g,EZ.text.primary)>=n?EZ.text.primary:xZ.text.primary;return e}var u=function(g){var e=g.color,I=g.name,t=g.mainShade,n=void 0===t?500:t,C=g.lightShade,o=void 0===C?300:C,a=g.darkShade,r=void 0===a?700:a;if(!(e=Fn({},e)).main&&e[n]&&(e.main=e[n]),!e.hasOwnProperty("main"))throw new Error(ob(11,I?" (".concat(I,")"):"",n));if("string"!==typeof e.main)throw new Error(ob(12,I?" (".concat(I,")"):"",JSON.stringify(e.main)));return zZ(e,"light",o,l),zZ(e,"dark",r,l),e.contrastText||(e.contrastText=d(e.main)),e},m={dark:EZ,light:xZ};return db(Fn({common:Fn({},kZ),mode:I,primary:u({color:a,name:"primary"}),secondary:u({color:r,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:u({color:c,name:"error"}),warning:u({color:s,name:"warning"}),info:u({color:i,name:"info"}),success:u({color:A,name:"success"}),grey:XZ,contrastThreshold:n,getContrastText:d,augmentColor:u,tonalOffset:l},m[I]),o)}var UZ=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var DZ={textTransform:"uppercase"},QZ='"Roboto", "Helvetica", "Arial", sans-serif';function LZ(g,e){var I="function"===typeof e?e(g):e,t=I.fontFamily,n=void 0===t?QZ:t,C=I.fontSize,l=void 0===C?14:C,o=I.fontWeightLight,a=void 0===o?300:o,r=I.fontWeightRegular,c=void 0===r?400:r,i=I.fontWeightMedium,A=void 0===i?500:i,s=I.fontWeightBold,d=void 0===s?700:s,u=I.htmlFontSize,m=void 0===u?16:u,b=I.allVariants,Z=I.pxToRem,h=mt(I,UZ);var p=l/14,G=Z||function(g){return"".concat(g/m*p,"rem")},y=function(g,e,I,t,C){return Fn({fontFamily:n,fontWeight:g,fontSize:G(e),lineHeight:I},n===QZ?{letterSpacing:"".concat((l=t/e,Math.round(1e5*l)/1e5),"em")}:{},C,b);var l},B={h1:y(a,96,1.167,-1.5),h2:y(a,60,1.2,-.5),h3:y(c,48,1.167,0),h4:y(c,34,1.235,.25),h5:y(c,24,1.334,0),h6:y(A,20,1.6,.15),subtitle1:y(c,16,1.75,.15),subtitle2:y(A,14,1.57,.1),body1:y(c,16,1.5,.15),body2:y(c,14,1.43,.15),button:y(A,14,1.75,.4,DZ),caption:y(c,12,1.66,.4),overline:y(c,12,2.66,1,DZ),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return db(Fn({htmlFontSize:m,pxToRem:G,fontFamily:n,fontSize:l,fontWeightLight:a,fontWeightRegular:c,fontWeightMedium:A,fontWeightBold:d},B),h,{clone:!1})}function TZ(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var jZ=["none",TZ(0,2,1,-1,0,1,1,0,0,1,3,0),TZ(0,3,1,-2,0,2,2,0,0,1,5,0),TZ(0,3,3,-2,0,3,4,0,0,1,8,0),TZ(0,2,4,-1,0,4,5,0,0,1,10,0),TZ(0,3,5,-1,0,5,8,0,0,1,14,0),TZ(0,3,5,-1,0,6,10,0,0,1,18,0),TZ(0,4,5,-2,0,7,10,1,0,2,16,1),TZ(0,5,5,-3,0,8,10,1,0,3,14,2),TZ(0,5,6,-3,0,9,12,1,0,3,16,2),TZ(0,6,6,-3,0,10,14,1,0,4,18,3),TZ(0,6,7,-4,0,11,15,1,0,4,20,3),TZ(0,7,8,-4,0,12,17,2,0,5,22,4),TZ(0,7,8,-4,0,13,19,2,0,5,24,4),TZ(0,7,9,-4,0,14,21,2,0,5,26,4),TZ(0,8,9,-5,0,15,22,2,0,6,28,5),TZ(0,8,10,-5,0,16,24,2,0,6,30,5),TZ(0,8,11,-5,0,17,26,2,0,6,32,5),TZ(0,9,11,-5,0,18,28,2,0,7,34,6),TZ(0,9,12,-6,0,19,29,2,0,7,36,6),TZ(0,10,13,-6,0,20,31,3,0,8,38,7),TZ(0,10,13,-6,0,21,33,3,0,8,40,7),TZ(0,10,14,-6,0,22,35,3,0,8,42,7),TZ(0,11,14,-7,0,23,36,3,0,9,44,8),TZ(0,11,15,-7,0,24,38,3,0,9,46,8)],OZ=["duration","easing","delay"],PZ={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},qZ={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function _Z(g){return"".concat(Math.round(g),"ms")}function $Z(g){if(!g)return 0;var e=g/36;return Math.round(10*(4+15*Math.pow(e,.25)+e/5))}function gh(g){var e=Fn({},PZ,g.easing),I=Fn({},qZ,g.duration);return Fn({getAutoHeightDuration:$Z,create:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.duration,C=void 0===n?I.standard:n,l=t.easing,o=void 0===l?e.easeInOut:l,a=t.delay,r=void 0===a?0:a;mt(t,OZ);return(Array.isArray(g)?g:[g]).map((function(g){return"".concat(g," ").concat("string"===typeof C?C:_Z(C)," ").concat(o," ").concat("string"===typeof r?r:_Z(r))})).join(",")}},g,{easing:e,duration:I})}var eh={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Ih=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function th(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.mixins,I=void 0===e?{}:e,t=g.palette,n=void 0===t?{}:t,C=g.transitions,l=void 0===C?{}:C,o=g.typography,a=void 0===o?{}:o,r=mt(g,Ih);if(g.vars)throw new Error(ob(18));var c=MZ(n),i=mZ(g),A=db(i,{mixins:BZ(i.breakpoints,I),palette:c,shadows:jZ.slice(),typography:LZ(c,a),transitions:gh(l),zIndex:Fn({},eh)});A=db(A,r);for(var s=arguments.length,d=new Array(s>1?s-1:0),u=1;u<s;u++)d[u-1]=arguments[u];return(A=d.reduce((function(g,e){return db(g,e)}),A)).unstable_sxConfig=Fn({},AZ,null==r?void 0:r.unstable_sxConfig),A.unstable_sx=function(g){return dZ({sx:g,theme:this})},A}var nh=th(),Ch="$$material";function lh(g){return function(g){var e=g.props,I=g.name,t=g.defaultTheme,n=g.themeId,C=yZ(t);return n&&(C=C[n]||C),ib({theme:C,name:I,props:e})}({props:g.props,name:g.name,defaultTheme:nh,themeId:Ch})}var oh=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/;var ah=function(g,e,I){var t=g.key+"-"+e.name;!1===I&&void 0===g.registered[t]&&(g.registered[t]=e.styles)},rh=Lu((function(g){return oh.test(g)||111===g.charCodeAt(0)&&110===g.charCodeAt(1)&&g.charCodeAt(2)<91})),ch=function(g){return"theme"!==g},ih=function(g){return"string"===typeof g&&g.charCodeAt(0)>96?rh:ch},Ah=function(g,e,I){var t;if(e){var n=e.shouldForwardProp;t=g.__emotion_forwardProp&&n?function(e){return g.__emotion_forwardProp(e)&&n(e)}:n}return"function"!==typeof t&&I&&(t=g.__emotion_forwardProp),t},sh=function(g){var e=g.cache,I=g.serialized,t=g.isStringTag;return ah(e,I,t),Du((function(){return function(g,e,I){ah(g,e,I);var t=g.key+"-"+e.name;if(void 0===g.inserted[e.name]){var n=e;do{g.insert(e===n?"."+t:"",n,g.sheet,!0),n=n.next}while(void 0!==n)}}(e,I,t)})),null},dh=function g(I,t){var n,C,l=I.__emotion_real===I,o=l&&I.__emotion_base||I;void 0!==t&&(n=t.label,C=t.target);var a=Ah(I,t,l),r=a||ih(o),c=!r("as");return function(){var i=arguments,A=l&&void 0!==I.__emotion_styles?I.__emotion_styles.slice(0):[];if(void 0!==n&&A.push("label:"+n+";"),null==i[0]||void 0===i[0].raw)A.push.apply(A,i);else{0,A.push(i[0][0]);for(var s=i.length,d=1;d<s;d++)A.push(i[d],i[0][d])}var u=ZZ((function(g,I,t){var n=c&&g.as||o,l="",i=[],s=g;if(null==g.theme){for(var d in s={},g)s[d]=g[d];s.theme=e.useContext(hZ)}"string"===typeof g.className?l=function(g,e,I){var t="";return I.split(" ").forEach((function(I){void 0!==g[I]?e.push(g[I]+";"):t+=I+" "})),t}(I.registered,i,g.className):null!=g.className&&(l=g.className+" ");var u=Im(A.concat(i),I.registered,s);l+=I.key+"-"+u.name,void 0!==C&&(l+=" "+C);var m=c&&void 0===a?ih(n):r,b={};for(var Z in g)c&&"as"===Z||m(Z)&&(b[Z]=g[Z]);return b.className=l,b.ref=t,e.createElement(e.Fragment,null,e.createElement(sh,{cache:I,serialized:u,isStringTag:"string"===typeof n}),e.createElement(n,b))}));return u.displayName=void 0!==n?n:"Styled("+("string"===typeof o?o:o.displayName||o.name||"Component")+")",u.defaultProps=I.defaultProps,u.__emotion_real=u,u.__emotion_base=o,u.__emotion_styles=A,u.__emotion_forwardProp=a,Object.defineProperty(u,"toString",{value:function(){return"."+C}}),u.withComponent=function(e,I){return g(e,Fn({},t,I,{shouldForwardProp:Ah(u,I,!0)})).apply(void 0,A)},u}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(g){dh[g]=dh(g)}));var uh=["variant"];function mh(g){return 0===g.length}function bh(g){var e=g.variant,I=mt(g,uh),t=e||"";return Object.keys(I).sort().forEach((function(e){t+="color"===e?mh(t)?g[e]:ab(g[e]):"".concat(mh(t)?e:ab(e)).concat(ab(g[e].toString()))})),t}var Zh=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function hh(g){return"ownerState"!==g&&"theme"!==g&&"sx"!==g&&"as"!==g}var ph=mZ();function Gh(g){var e,I=g.defaultTheme,t=g.theme,n=g.themeId;return e=t,0===Object.keys(e).length?I:t[n]||t}var yh=function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=g.themeId,I=g.defaultTheme,t=void 0===I?ph:I,n=g.rootShouldForwardProp,C=void 0===n?hh:n,l=g.slotShouldForwardProp,o=void 0===l?hh:l,a=function(g){return dZ(Fn({},g,{theme:Gh(Fn({},g,{defaultTheme:t,themeId:e}))}))};return a.__mui_systemSx=!0,function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(g,e){Array.isArray(g.__emotion_styles)&&(g.__emotion_styles=e(g.__emotion_styles))}(g,(function(g){return g.filter((function(g){return!(null!=g&&g.__mui_systemSx)}))}));var n,l,c=I.name,A=I.slot,s=I.skipVariantsResolver,d=I.skipSx,u=I.overridesResolver,m=void 0===u?(n=(l=A)?l.charAt(0).toLowerCase()+l.slice(1):l)?function(g,e){return e[n]}:null:u,b=mt(I,Zh),Z=void 0!==s?s:A&&"Root"!==A&&"root"!==A||!1,h=d||!1;var p=hh;"Root"===A||"root"===A?p=C:A?p=o:function(g){return"string"===typeof g&&g.charCodeAt(0)>96}(g)&&(p=void 0);var G=function(g,e){return dh(g,e)}(g,Fn({shouldForwardProp:p,label:undefined},b)),y=function(I){for(var n=arguments.length,C=new Array(n>1?n-1:0),l=1;l<n;l++)C[l-1]=arguments[l];var o=C?C.map((function(g){return"function"===typeof g&&g.__emotion_real!==g?function(I){return g(Fn({},I,{theme:Gh(Fn({},I,{defaultTheme:t,themeId:e}))}))}:g})):[],A=I;c&&m&&o.push((function(g){var I=Gh(Fn({},g,{defaultTheme:t,themeId:e})),n=function(g,e){return e.components&&e.components[g]&&e.components[g].styleOverrides?e.components[g].styleOverrides:null}(c,I);if(n){var C={};return Object.entries(n).forEach((function(e){var t=r(e,2),n=t[0],l=t[1];C[n]="function"===typeof l?l(Fn({},g,{theme:I})):l})),m(g,C)}return null})),c&&!Z&&o.push((function(g){var I=Gh(Fn({},g,{defaultTheme:t,themeId:e}));return function(g,e,I,t){var n,C=g.ownerState,l=void 0===C?{}:C,o=[],a=null==I||null==(n=I.components)||null==(n=n[t])?void 0:n.variants;return a&&a.forEach((function(I){var t=!0;Object.keys(I.props).forEach((function(e){l[e]!==I.props[e]&&g[e]!==I.props[e]&&(t=!1)})),t&&o.push(e[bh(I.props)])})),o}(g,function(g,e){var I=[];e&&e.components&&e.components[g]&&e.components[g].variants&&(I=e.components[g].variants);var t={};return I.forEach((function(g){var e=bh(g.props);t[e]=g.style})),t}(c,I),I,c)})),h||o.push(a);var s=o.length-C.length;if(Array.isArray(I)&&s>0){var d=new Array(s).fill("");(A=[].concat(i(I),i(d))).raw=[].concat(i(I.raw),i(d))}else"function"===typeof I&&I.__emotion_real!==I&&(A=function(g){return I(Fn({},g,{theme:Gh(Fn({},g,{defaultTheme:t,themeId:e}))}))});var u=G.apply(void 0,[A].concat(i(o)));return g.muiName&&(u.muiName=g.muiName),u};return G.withConfig&&(y.withConfig=G.withConfig),y}}({themeId:Ch,defaultTheme:nh,rootShouldForwardProp:function(g){return hh(g)&&"classes"!==g}}),Bh=yh,fh=function(g){return g},Sh=function(){var g=fh;return{configure:function(e){g=e},generate:function(e){return g(e)},reset:function(){g=fh}}}(),Wh={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Vh(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",t=Wh[e];return t?"".concat(I,"-").concat(t):"".concat(Sh.generate(g),"-").concat(e)}function vh(g){return Vh("MuiCircularProgress",g)}!function(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",t={};e.forEach((function(e){t[e]=Vh(g,e,I)}))}("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var Rh,kh,Xh,Jh,Yh,Hh,wh,Nh,Kh=["className","color","disableShrink","size","style","thickness","value","variant"],Fh=44,xh=lb(Yh||(Yh=Rh||(Rh=Eu(["\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n"])))),Eh=lb(Hh||(Hh=kh||(kh=Eu(["\n  0% {\n    stroke-dasharray: 1px, 200px;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -15px;\n  }\n\n  100% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -125px;\n  }\n"])))),zh=function(g){var e=g.classes,I=g.variant,t=g.color,n=g.disableShrink;return function(g,e){var I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,t={};return Object.keys(g).forEach((function(n){t[n]=g[n].reduce((function(g,t){if(t){var n=e(t);""!==n&&g.push(n),I&&I[t]&&g.push(I[t])}return g}),[]).join(" ")})),t}({root:["root",I,"color".concat(rb(t))],svg:["svg"],circle:["circle","circle".concat(rb(I)),n&&"circleDisableShrink"]},vh,e)},Mh=Bh("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:function(g,e){var I=g.ownerState;return[e.root,e[I.variant],e["color".concat(rb(I.color))]]}})((function(g){var e=g.ownerState,I=g.theme;return Fn({display:"inline-block"},"determinate"===e.variant&&{transition:I.transitions.create("transform")},"inherit"!==e.color&&{color:(I.vars||I).palette[e.color].main})}),(function(g){return"indeterminate"===g.ownerState.variant&&Cb(wh||(wh=Xh||(Xh=Eu(["\n      animation: "," 1.4s linear infinite;\n    "]))),xh)})),Uh=Bh("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:function(g,e){return e.svg}})({display:"block"}),Dh=Bh("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:function(g,e){var I=g.ownerState;return[e.circle,e["circle".concat(rb(I.variant))],I.disableShrink&&e.circleDisableShrink]}})((function(g){var e=g.ownerState,I=g.theme;return Fn({stroke:"currentColor"},"determinate"===e.variant&&{transition:I.transitions.create("stroke-dashoffset")},"indeterminate"===e.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(function(g){var e=g.ownerState;return"indeterminate"===e.variant&&!e.disableShrink&&Cb(Nh||(Nh=Jh||(Jh=Eu(["\n      animation: "," 1.4s ease-in-out infinite;\n    "]))),Eh)})),Qh=e.forwardRef((function(g,e){var I=lh({props:g,name:"MuiCircularProgress"}),t=I.className,n=I.color,C=void 0===n?"primary":n,l=I.disableShrink,o=void 0!==l&&l,a=I.size,r=void 0===a?40:a,c=I.style,i=I.thickness,A=void 0===i?3.6:i,s=I.value,d=void 0===s?0:s,u=I.variant,m=void 0===u?"indeterminate":u,b=mt(I,Kh),Z=Fn({},I,{color:C,disableShrink:o,size:r,thickness:A,value:d,variant:m}),h=zh(Z),p={},G={},y={};if("determinate"===m){var B=2*Math.PI*((Fh-A)/2);p.strokeDasharray=B.toFixed(3),y["aria-valuenow"]=Math.round(d),p.strokeDashoffset="".concat(((100-d)/100*B).toFixed(3),"px"),G.transform="rotate(-90deg)"}return(0,gn.jsx)(Mh,Fn({className:Mu(h.root,t),style:Fn({width:r,height:r},G,c),ownerState:Z,ref:e,role:"progressbar"},y,b,{children:(0,gn.jsx)(Uh,{className:h.svg,ownerState:Z,viewBox:"".concat(22," ").concat(22," ").concat(Fh," ").concat(Fh),children:(0,gn.jsx)(Dh,{className:h.circle,style:p,ownerState:Z,cx:Fh,cy:Fh,r:(Fh-A)/2,fill:"none",strokeWidth:A})})}))})),Lh=Qh;var Th=function(){var g=dn().token,I=r((0,e.useState)([]),2),t=(I[0],I[1]),n=r((0,e.useState)([]),2),C=n[0],l=n[1],o=r((0,e.useState)(!1),2),a=o[0],c=o[1],A=r((0,e.useState)(!0),2),s=A[0],d=A[1];(0,e.useEffect)((function(){var e=function(){var e=se(ie().mark((function e(){var I,n;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/child"),{headers:{Authorization:"Bearer ".concat(g)}});case 4:if(!(I=e.sent).ok){e.next=13;break}return e.next=8,I.json();case 8:n=e.sent,t(n),l(n.map((function(g){return ce(ce({},g),{},{dateOfBirth:g.dateOfBirth?new Date(g.dateOfBirth).toISOString().split("T")[0]:""})}))),e.next=14;break;case 13:console.error("Failed to fetch children");case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.error("Error fetching children:",e.t0);case 19:return e.prev=19,d(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,16,19,22]])})));return function(){return e.apply(this,arguments)}}();e()}),[g]);var u=function(){var e=se(ie().mark((function e(I){var n,o,a,r;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c(!0),n=C[I],e.next=5,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/child/").concat(n._id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(g)},body:JSON.stringify(n)});case 5:if(!(o=e.sent).ok){e.next=16;break}return e.next=9,o.json();case 9:a=e.sent,r=C.map((function(g,e){return e===I?a:g})),t(r),l(r),qt.success("Child updated successfully"),e.next=17;break;case 16:qt.error("Failed to update child");case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(0),console.error("Error updating child:",e.t0),qt.error("An error occurred while updating child");case 23:return e.prev=23,c(!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[0,19,23,26]])})));return function(g){return e.apply(this,arguments)}}(),m=function(){var e=se(ie().mark((function e(I,t){var n;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this child?")){e.next=13;break}return e.prev=2,e.next=5,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/child/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(g)}});case 5:e.sent.ok?(qt.success("Child deleted successfully"),n=C.filter((function(g,e){return e!==I})),l(n)):qt.error("Failed to delete child"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.error("Error deleting child:",e.t0),qt.error("An error occurred while deleting child");case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(g,I){return e.apply(this,arguments)}}(),b=function(g,e,I){var t=i(C);t[g]&&(t[g][e]=I),l(t)};return s?(0,gn.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"50px"},children:(0,gn.jsx)(Lh,{})}):(0,gn.jsxs)("div",{className:"container",children:[(0,gn.jsx)("div",{className:"top-left-arrow",children:(0,gn.jsx)(Lg,{to:"/parent",children:(0,gn.jsx)("img",{src:Ku,alt:"Back to Parent Page"})})}),(0,gn.jsx)("h3",{children:"\ud559\uc0dd\uc815\ubcf4 \ud3b8\uc9d1"}),(0,gn.jsx)(Lg,{to:"/add-child",children:(0,gn.jsx)("button",{className:"button","aria-label":"Add Child",children:"\ud559\uc0dd \ucd94\uac00"})}),(0,gn.jsx)("div",{className:"edit-child-box",children:C.map((function(g,e){return(0,gn.jsxs)("div",{className:"child-details-card",children:[(0,gn.jsxs)("h5",{children:["\ud559\uc0dd(\uc720\uc544)",e+1]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"\ud559\uc0dd(\uc720\uc544) \ud55c\uae00\uba85"}),(0,gn.jsx)("input",{value:g.name,onChange:function(g){return b(e,"name",g.target.value)}})]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"\ud604\uc7ac \uc7ac\uc6d0\uc911\uc778 \uae30\uad00\uba85:"}),(0,gn.jsx)("input",{value:g.previousSchool,onChange:function(g){return b(e,"previousSchool",g.target.value)}})]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"\uc0dd\ub144\uc6d4\uc77c:"}),(0,gn.jsx)("input",{type:"date",value:g.dateOfBirth,onChange:function(g){return b(e,"dateOfBirth",g.target.value)}})]}),(0,gn.jsxs)("div",{className:"child-input",children:[(0,gn.jsx)("label",{children:"\uc131\ubcc4:"}),(0,gn.jsxs)("select",{value:g.gender,onChange:function(g){return b(e,"gender",g.target.value)},children:[(0,gn.jsx)("option",{value:"male",children:"\ub0a8\uc131"}),(0,gn.jsx)("option",{value:"female",children:"\uc5ec\uc131"})]})]}),(0,gn.jsxs)("div",{children:[(0,gn.jsx)("label",{children:(0,gn.jsx)("strong",{children:"2024\ub144 \uc608\ube44 \ud559\ub144/\uc5f0\ub839"})}),(0,gn.jsx)("p",{children:g.testGrade})]}),(0,gn.jsxs)("div",{className:"child-actions",children:[(0,gn.jsx)("button",{className:"save-button",onClick:function(){return u(e)},disabled:a,children:a?"\uc800\uc7a5...":"\uc800\uc7a5"}),(0,gn.jsx)("button",{className:"delete-button",onClick:function(){return m(e,g._id)},disabled:a,children:"\uc0ad\uc81c"})]})]},g.id||e)}))})]})};var jh={container:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",backgroundColor:"#ffffff"},input:{width:"100%",padding:"10px",marginBottom:"10px",borderRadius:"5px",border:"1px solid #ddd"},button:{width:"100%",padding:"10px",borderRadius:"5px",backgroundColor:"#007BFF",color:"#ffffff",border:"none"}},Oh=function(g){var I=g.onResetRequested,t=r((0,e.useState)(""),2),n=t[0],C=t[1],l=function(){var g=se(ie().mark((function g(){var e,t;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/forgot-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:n})});case 4:return e=g.sent,g.next=7,e.json();case 7:t=g.sent,e.ok?(qt.success("SMS has been sent. Please check your phone."),I()):qt.error(t.error),g.next=14;break;case 11:g.prev=11,g.t0=g.catch(0),qt.error("An error occurred while processing your request.");case 14:case"end":return g.stop()}}),g,null,[[0,11]])})));return function(){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{style:jh.container,children:[(0,gn.jsx)("input",{style:jh.input,type:"text",placeholder:"Phone Number",value:n,onChange:function(g){return C(g.target.value)}}),(0,gn.jsx)("button",{style:jh.button,onClick:l,children:"Request Password Reset"})]})};var Ph={container:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",backgroundColor:"#ffffff"},input:{width:"100%",padding:"10px",marginBottom:"10px",borderRadius:"5px",border:"1px solid #ddd"},button:{width:"100%",padding:"10px",borderRadius:"5px",backgroundColor:"#007BFF",color:"#ffffff",border:"none"}},qh=function(){var g=r((0,e.useState)(""),2),I=g[0],t=g[1],n=r((0,e.useState)(""),2),C=n[0],l=n[1],o=function(){var g=se(ie().mark((function g(){var e,t;return ie().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,"https://palbackend-a8f4e5171ddb.herokuapp.com",g.next=4,fetch("".concat("https://palbackend-a8f4e5171ddb.herokuapp.com","/api/users/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:I,newPassword:C})});case 4:return e=g.sent,g.next=7,e.json();case 7:t=g.sent,e.ok?qt.success("Password has been successfully reset."):qt.error(t.error),g.next=14;break;case 11:g.prev=11,g.t0=g.catch(0),qt.error("An error occurred while processing your request.");case 14:case"end":return g.stop()}}),g,null,[[0,11]])})));return function(){return g.apply(this,arguments)}}();return(0,gn.jsxs)("div",{style:Ph.container,children:[(0,gn.jsx)("input",{style:Ph.input,type:"text",placeholder:"Reset Token",value:I,onChange:function(g){return t(g.target.value)}}),(0,gn.jsx)("input",{style:Ph.input,type:"password",placeholder:"New Password",value:C,onChange:function(g){return l(g.target.value)}}),(0,gn.jsx)("button",{style:Ph.button,onClick:o,children:"Reset Password"})]})};var _h={container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",padding:"20px",backgroundColor:"#f0f0f0"},logo:{width:"200px",marginBottom:"20px",cursor:"pointer"},content:{width:"100%",maxWidth:"400px",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",backgroundColor:"#ffffff"},cancelButton:{marginTop:"20px",padding:"10px 20px",border:"none",borderRadius:"5px",backgroundColor:"#d9534f",color:"#ffffff",cursor:"pointer"}},$h=function(){var g=hg(),I=r((0,e.useState)(!1),2),t=I[0],n=I[1];return(0,gn.jsxs)("div",{style:_h.container,children:[(0,gn.jsx)("img",{src:cn,alt:"Logo",style:_h.logo,onClick:function(){return g("/")}}),(0,gn.jsxs)("div",{style:_h.content,children:[t?(0,gn.jsx)(qh,{}):(0,gn.jsx)(Oh,{onResetRequested:function(){return n(!0)}}),(0,gn.jsx)("button",{style:_h.cancelButton,onClick:function(){return g("/")},children:"Cancel"})]}),(0,gn.jsx)(zt,{})]})};var gp=function(){return(0,gn.jsxs)(un,{children:[(0,gn.jsx)(zt,{}),(0,gn.jsxs)(Ug,{children:[(0,gn.jsx)(hn,{}),(0,gn.jsxs)(Ng,{children:[(0,gn.jsx)(Hg,{path:"/",element:(0,gn.jsx)(An,{})}),(0,gn.jsx)(Hg,{path:"/register",element:(0,gn.jsx)(Zn,{})}),(0,gn.jsx)(Hg,{path:"/login",element:(0,gn.jsx)(mn,{})}),(0,gn.jsx)(Hg,{path:"/admin",element:(0,gn.jsx)(wu,{})}),(0,gn.jsx)(Hg,{path:"/add-child",element:(0,gn.jsx)(Nu,{})}),(0,gn.jsx)(Hg,{path:"/update-details",element:(0,gn.jsx)(xu,{})}),(0,gn.jsx)(Hg,{path:"/update-child",element:(0,gn.jsx)(Th,{})}),(0,gn.jsx)(Hg,{path:"/change-password",element:(0,gn.jsx)($h,{})}),(0,gn.jsx)(Hg,{path:"/parent/*",element:(0,gn.jsx)(rn,{})})]})]})]})},ep=function(g){g&&g instanceof Function&&I.e(787).then(I.bind(I,787)).then((function(e){var I=e.getCLS,t=e.getFID,n=e.getFCP,C=e.getLCP,l=e.getTTFB;I(g),t(g),n(g),C(g),l(g)}))};ue().setAppElement("#root"),n.createRoot(document.getElementById("root")).render((0,gn.jsx)(e.StrictMode,{children:(0,gn.jsx)(gp,{})})),ep()}()}();
//# sourceMappingURL=main.ebfac4bb.js.map